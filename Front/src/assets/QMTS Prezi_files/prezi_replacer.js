;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_replacer";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi_cet_model_editor":dependencies[0],"prezi_editor_commander":dependencies[1],"prezi_plugin_api":dependencies[2],"prezi_utils":dependencies[3]}};})());};})(arguments);var moduleImpl=(function(){return module(function(g){function l(a,b){return a.kind!==b.kind?!1:a.kind!==c.ReplaceableKind.none&&b.kind!==c.ReplaceableKind.none?a.ref.id===b.ref.id:!0}function h(a,b){a:{switch(b.kind){case c.ReplaceKind.animatedImage:b=b.source===c.ReplaceSource.asset?a.parent.add.animatedImage(b.asset):b.object;break a;case c.ReplaceKind.image:b=b.source===c.ReplaceSource.asset?a.parent.add.image(b.asset):b.object;break a;case c.ReplaceKind.pdf:b=b.source===c.ReplaceSource.asset?a.parent.add.pdf(b.asset):b.object;
break a}b=void 0}const d=a.layoutBox.extendToSquare();b.fitInto(d);b.moveBehind(a);a.delete()}var m=g.dependencies.prezi_editor_commander,n=g.dependencies.prezi_utils,e=g.dependencies.prezi_cet_model_editor,f={createReplacableTracker:function(a,b){return new f.ReplacableObjectTrackerImpl(a,b)}};Object.defineProperty(f,"__esModule",{value:!0});var p=e.base.ObjectKind;f.ReplacableObjectTrackerImpl=class{constructor(a,b){this.readerSession=b;this.prevReplaceable={kind:c.ReplaceableKind.none};this.handlers=
[];a.onSelectionChange((a)=>{this.manageReplacableChange(a.allObjects);this.prevSelectionInfo=a});a.onDocumentChange(()=>{null!=this.prevSelectionInfo&&this.manageReplacableChange(this.prevSelectionInfo.allObjects)})}manageReplacableChange(a){const b=this.calcNewReplacable(a);l(this.prevReplaceable,b)||(this.handlers.forEach((a)=>a(b)),this.prevReplaceable=b)}calcNewReplacable(a){if(1!==a.length)return{kind:c.ReplaceableKind.none};{const b=a[0];if(this.readerSession.document.read((a)=>{a=a.lookup.resolve(b);
return a.is(p.lockable)&&a.locked}))return{kind:c.ReplaceableKind.none};switch(b.kind){case e.base.ObjectKind.image:return{kind:c.ReplaceableKind.image,ref:b};case e.base.ObjectKind.animatedImage:return{kind:c.ReplaceableKind.animatedImage,ref:b};case e.base.ObjectKind.pdf:case e.base.ObjectKind.swf:return{kind:c.ReplaceableKind.pdf,ref:b};default:return{kind:c.ReplaceableKind.none}}}}onReplaceableChange(a){this.handlers.push(a)}};var k={replaceObject:function(a,b,d){switch(b.kind){case c.ReplaceableKind.none:break;
case c.ReplaceableKind.animatedImage:a=a.lookup.resolve(b.ref);d.kind===c.ReplaceKind.animatedImage&&d.source===c.ReplaceSource.asset?a.imageAsset=d.asset:h(a,d);break;case c.ReplaceableKind.image:a=a.lookup.resolve(b.ref);if(d.kind===c.ReplaceKind.image){b=m.EditorCommander.createImageMaskingCommander();const e=a.layoutBox;d.source===c.ReplaceSource.asset?(a.isPlaceholder=!1,a.imageAsset=d.asset,a.mask=b.imageMaskForLayoutBox(e,a.imageAsset),a.fitInto(e)):(d.object.mask=b.imageMaskForLayoutBox(e,
d.object.imageAsset),d.object.fitInto(e),d.object.moveBehind(a),a.delete())}else h(a,d);break;case c.ReplaceableKind.pdf:a=a.lookup.resolve(b.ref);d.kind===c.ReplaceKind.pdf&&d.source===c.ReplaceSource.asset&&a.is(e.base.ObjectKind.pdf)?(b=a.layoutBox.extendToSquare(),a.pdfAsset=d.asset,a.isPlaceholder=!1,a.fitInto(b)):h(a,d);break;default:n.Utils.assertNever(b)}}};Object.defineProperty(k,"__esModule",{value:!0});var c={};Object.defineProperty(c,"__esModule",{value:!0});(function(a){a.none="none";
a.image="image";a.animatedImage="animatedImage";a.pdf="pdf"})(c.ReplaceableKind||(c.ReplaceableKind={}));c.createReplacableTracker=function(a,b){return f.createReplacableTracker(a,b)};(function(a){a.pdf="pdf";a.image="image";a.animatedImage="animatedImage"})(c.ReplaceKind||(c.ReplaceKind={}));(function(a){a.asset="asset";a.object="object"})(c.ReplaceSource||(c.ReplaceSource={}));c.replaceObject=function(a,b,c){return k.replaceObject(a,b,c)};return c});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_replacer",["require","prezi_cet_model_editor","prezi_editor_commander","prezi_plugin_api","prezi_utils"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_replacer.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi_cet_model_editor"),require("prezi_editor_commander"),require("prezi_plugin_api"),require("prezi_utils"));}else{this["prezi_replacer"]=__factory(this["prezi_cet_model_editor"],this["prezi_editor_commander"],this["prezi_plugin_api"],this["prezi_utils"]);}}).call(this);