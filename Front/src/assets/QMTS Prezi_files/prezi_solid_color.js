;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_solid_color";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi.engine.dom":dependencies[0],"prezi.geometry":dependencies[1],"prezi_brand_kit_cta":dependencies[2],"prezi_cet_model_editor":dependencies[3],"prezi_editor_commander":dependencies[4],"prezi_featureswitcher":dependencies[5],"prezi_i18n":dependencies[6],"prezi_logger":dependencies[7],"prezi_plugin_api":dependencies[8],"prezi_plugin_meta":dependencies[9],"prezi_styleschemeprovider":dependencies[10],"prezi_utils":dependencies[11],"prezi_widgets":dependencies[12]}};})());};})(arguments);var moduleImpl=(function(){return module(function(f){var p=f.dependencies.prezi_cet_model_editor,m=f.dependencies.prezi_plugin_api,q=f.dependencies.prezi_utils,r=f.dependencies.prezi_i18n,l=f.dependencies.prezi_editor_commander,u=f.dependencies.prezi_widgets,k=f.dependencies.prezi_brand_kit_cta,t=f.dependencies.prezi_featureswitcher,x=f.dependencies.prezi_logger,v={};Object.defineProperty(v,"__esModule",{value:!0});var g=p.base.ObjectKind,w=p.base.FillKind;v.SolidColorPlugin=class{init(a){this.longRunningExecutor=l.createLongRunningExecutor(this.session);
this.uiRoot=a.declareUI({currentTopic:null,currentSelection:[],currentColor:null,currentPresetIndex:-1,colorTargetPresetColors:[],colorableItems:[],brandKitCTA:t.isActive("js-present-editor-brandkit-enabled")&&t.isActive("js-show-brand-kit-paywalls")?k.BrandKitCTA.sul:k.BrandKitCTA.none},(a,b)=>{const {colorableItems:d}=a;0<d.length&&(this.createPresetDropdown(a,b),this.createColorPicker(a,b))});a.onCurrentTopicChange((a)=>{this.session.document.read((b)=>{this.updateColorTargetTopics(b,{currentTopic:a})})});
a.onSelectionChange((a)=>{this.session.document.read((b)=>{this.updateColorTargetTopics(b,{currentSelection:a.allObjects.map((a)=>a.id)})})});a.onDocumentChange(()=>{this.session.document.read((a)=>{this.updateColorTargetTopics(a,{})})})}processMessage(a){switch(a){case "canEditBrandKit":this.uiRoot.setState({brandKitCTA:k.BrandKitCTA.canEditTeam});break;case "canNotEditBrandKit":this.uiRoot.setState({brandKitCTA:k.BrandKitCTA.canNotEditTeam});break;default:q.Utils.assertNever(a)}}createColorPicker(a,
e){const {currentColor:b,colorableItems:d}=a,g=(a)=>(b)=>{l.EditorCommander.createColorGroup(b,d.map((a)=>b.lookup.base(a))).applyColor(a,!0);this.uiRoot.setState({currentColor:a})};e.createPropertyBarItem((a)=>{const d=r.I18n.ts("Color overlay"),e={solidFill:{fillKind:w.solid,color:b},current:w.solid,canPickClearFill:!0,hasAlpha:!0};return a.popupButton((a)=>({id:"solid-colorpicker",popupHeader:[a.sectionHeader({content:d})],groupWeight:1,weight:.6,tooltipText:d,hideArrow:!0,content:{icon:m.IconSmallId.FillColor,
fills:Object.assign(Object.assign({},e),{radialFill:null,linearFill:null})},onOpen:()=>this.logCTAOpened(),popupContent:[...k.createBrandKitColorCTA(a,this.uiRoot.getState().brandKitCTA,"PRESENT_COLOR_PICKER_PDF"),a.colorPicker({id:"solid-colorpicker",fills:Object.assign(Object.assign({},e),{canPickClearFill:!0}),expanded:!0,onChange:(a,d)=>{const c=d.source;let e=d.newFill.fillKind===w.solid?d.newFill.color:null;null===b&&null!==e&&(e=Object.assign(Object.assign({},e),{a:.8}));this.longRunningExecutor.update("applySolidColorInTransaction",
a,d,g(e),(a)=>{c!==u.ColorPickerChangeSource.opacitySlider&&c!==u.ColorPickerChangeSource.opacityNumericField||this.logOpacityChanges(a,c)})},showThemeColors:!0,isOverlayColorPicker:!0})]}))})}logOpacityChanges(a,e){const b=e===u.ColorPickerChangeSource.opacitySlider?"CHANGE_OPACITY_SLIDER":"CHANGE_OPACITY_INPUT_VALUE";this.getSelectionFlattenVisuals(a).forEach((a)=>{x.avro.Avro.createDefaultLogger().logModifiedObject({object_type:a,modify_action:b,topic_relationship:a,object_id:a.id})})}getSelectionFlattenVisuals(a){return this.flatten(this.session.selection.getSelectionInfo(a).allObjects)}flatten(a){if(!a.every((a)=>
a.is(g.topic)&&1===a.simpleChildren(p.base.ChildVisibilityKind.outsideAndInside).length))return a;let e=[];a.forEach((a)=>{a.is(g.topic)&&e.push(...a.simpleChildren(p.base.ChildVisibilityKind.outsideAndInside))});return e}logCTAOpened(){t.isActive("js-present-editor-brandkit-enabled")&&t.isActive("js-show-brand-kit-paywalls")&&x.avro.Avro.createDefaultLogger().logShownUpgradeToTeamCta({team_upgrade_trigger:"PRESENT_COLOR_PICKER_PDF"})}createPresetDropdown(a,e){const {currentPresetIndex:b,colorTargetPresetColors:d,
colorableItems:g}=a,f=[];d.forEach((a,b)=>{a=this.getPresetForColor(a.color);f.push({id:`${b}`,imgUrl:a.imgUrl})});0<d.length&&e.createPropertyBarItem((a)=>a.popupButton((a)=>({id:"solid-color-presetdropdown",tooltipText:r.I18n.ts("Style presets"),content:{icon:m.IconSmallId.StylePresets},groupWeight:1,weight:.5,popupHeader:[a.sectionHeader({content:r.I18n.ts("Style presets")})],popupContent:[a.simpleList((a)=>({items:f.map((c)=>{const b=f.findIndex((a)=>a.id===c.id);return a.image({id:c.id,src:{url:c.imgUrl},
dataLookup:d[b].styes.filterStyle,onClick:(a)=>{this.session.document.executeApiCommand(a,{name:"applySolidColorPreset",run:(a)=>{const c=l.EditorCommander.createColorGroup(a,g.map((c)=>a.lookup.base(c)));c.setPresets(d[b].styes);c.applyPresets()}})}})}).concat(this.createClearPresetItem(a,g)),itemLayout:m.ListItemLayout.fixed,itemType:m.ListItemType.small,showTitle:!1,progress:m.ListProgress.finished,flexGrow:1,activeId:0<=b?f[b].id:"clear-preset"})),a.infoMessage(r.I18n.ts("Style presets generate automatically and change according to your color scheme."))]})))}createClearPresetItem(a,
e){return a.image({id:"clear-preset",src:{url:q.Utils.svgToUrl('<svg width="69" height="69" viewBox="0 0 69 69" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path d="M0 69L69 0" stroke="#FA375A" stroke-width="2"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>')},dataLookup:"clear-preset-filter",onClick:(a)=>{this.session.document.executeApiCommand(a,{name:"clearSolidColorPreset",run:(a)=>{const b=l.EditorCommander.createColorGroup(a,e.map((b)=>a.lookup.base(b)));b.setPresets({shapeStyle:null,
filterStyle:null,arcStyle:null});b.applyPresets()}})}})}getPresetForColor(a){const e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="${[-50,-50,100,100]}"
				width="${100}" height="${100}">
				<rect fill="${l.toCssColor(a)}" x="${-50}" y="${-50}" width="${100}" height="${100}"/>
			</svg>`;return{imgUrl:q.Utils.svgToUrl(e),hasLightColor:l.hasLightColor(a,1)}}updateColorTargetTopics(a,e){e=Object.assign(Object.assign({},this.uiRoot.getState()),e);var b=0<e.currentSelection.length?e.currentSelection:[e.currentTopic],d=b.every((c)=>{c=a.lookup.base(c);return null==c?!1:c.is(g.planetTopic)||c.is(g.stackTopic)?!0:!1}),f=b.every((c)=>{c=a.lookup.base(c);return null==c?!1:c.is(g.pdf)||c.is(g.swf)||c.is(g.image)||c.is(g.chart)});const m=l.EditorCommander.createLayoutQuery(),h=l.EditorCommander.createColorGroup(a,
[]);let k=!1;d&&b.forEach((c)=>{c=a.lookup.base(c);if(c.is(g.planetTopic)||c.is(g.stackTopic)){c=h.helper.getColorableVisualObjects(c).filter((a)=>m.isTopicShapeObject(a));const a=c.filter((a)=>a.is(g.pdf)||a.is(g.swf)||a.is(g.image)||a.is(g.chart));k=k||c.length!==a.length;h.addObjects(a)}});f&&b.forEach((c)=>{c=a.lookup.base(c);switch(c.kind){case g.pdf:case g.image:case g.swf:case g.chart:c.locked||h.addObjects([c]);break;default:k=!0}});b=null;let n=[];d=-1;!k&&0<h.size()?(b=h.getMainColors().filter((a)=>
null!=a),d=b.map((a)=>a.a).reduce((a,b)=>Math.max(a,b),0),b=1<b.length?{r:0,g:0,b:0,a:d}:0<b.length?b[0]:null,d=h.getPresets(),n=d.reduce((a,b)=>{const c=h.helper.getColorsForStyle(b.styleEnum);return a=null==a?c:q.Utils.arrayEquals(a,c,(a,c)=>h.helper.colorEquals(a.color,c.color))?a.map((a,b)=>Object.assign(Object.assign({},a),{styes:Object.assign(Object.assign({},a.styes),c[b].styes)})):[]},null),n=null!=n?n.filter((a)=>null!=a&&null!=a.color):[],d=d.reduce((a,b)=>{const c=h.helper.getColorFromStyleDeclaration(b.styleClass);
b=n.findIndex((a)=>h.helper.colorEquals(a.color,c));return null==a||a===b?b:-1},null),d=null==d?-1:d,f=h.editorIds()):f=[];this.uiRoot.setState(Object.assign(Object.assign({},e),{currentColor:b,colorTargetPresetColors:n,currentPresetIndex:d,colorableItems:f}))}};f={};Object.defineProperty(f,"__esModule",{value:!0});f.lazyModule={createPlugin(){return new v.SolidColorPlugin}};return f});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_solid_color",["require","prezi.engine.dom","prezi.geometry","prezi_brand_kit_cta","prezi_cet_model_editor","prezi_editor_commander","prezi_featureswitcher","prezi_i18n","prezi_logger","prezi_plugin_api","prezi_plugin_meta","prezi_styleschemeprovider","prezi_utils","prezi_widgets"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_solid_color.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi.engine.dom"),require("prezi.geometry"),require("prezi_brand_kit_cta"),require("prezi_cet_model_editor"),require("prezi_editor_commander"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_logger"),require("prezi_plugin_api"),require("prezi_plugin_meta"),require("prezi_styleschemeprovider"),require("prezi_utils"),require("prezi_widgets"));}else{this["prezi_solid_color"]=__factory(this["prezi.engine.dom"],this["prezi.geometry"],this["prezi_brand_kit_cta"],this["prezi_cet_model_editor"],this["prezi_editor_commander"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_logger"],this["prezi_plugin_api"],this["prezi_plugin_meta"],this["prezi_styleschemeprovider"],this["prezi_utils"],this["prezi_widgets"]);}}).call(this);