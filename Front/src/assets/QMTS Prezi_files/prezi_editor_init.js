;(function(){var baseUrl;var __factory=function(){var jqueryUi=arguments[0];var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_editor_init";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi.engine.dom":dependencies[1],"prezi_app_utils":dependencies[2],"prezi_bacon":dependencies[3],"prezi_canvas_listener":dependencies[4],"prezi_cet":dependencies[5],"prezi_cet_model":dependencies[6],"prezi_cet_model_editor":dependencies[7],"prezi_cet_renderer":dependencies[8],"prezi_client_player":dependencies[9],"prezi_coeditui":dependencies[10],"prezi_editor_controller":dependencies[11],"prezi_editor_error":dependencies[12],"prezi_editor_store_common":dependencies[13],"prezi_editor_store_mode":dependencies[14],"prezi_editor_store_ui":dependencies[15],"prezi_editor_ui":dependencies[16],"prezi_error_page":dependencies[17],"prezi_externalserviceprovider":dependencies[18],"prezi_featureswitcher":dependencies[19],"prezi_i18n":dependencies[20],"prezi_insights":dependencies[21],"prezi_logger":dependencies[22],"prezi_meeting":dependencies[23],"prezi_nativeapitypes":dependencies[24],"prezi_playback":dependencies[25],"prezi_plugin_api":dependencies[26],"prezi_plugin_meta":dependencies[27],"prezi_service_data":dependencies[28],"prezi_service_media":dependencies[29],"prezi_sound_playback":dependencies[30],"prezi_spotlight":dependencies[31],"prezi_support":dependencies[32],"prezi_templatechooser":dependencies[33],"prezi_templateservice":dependencies[34],"prezi_textmodel":dependencies[35],"prezi_thumbnail_render":dependencies[36],"prezi_uaparser":dependencies[37],"prezi_utils":dependencies[38],"prezi_check_webgl":dependencies[39],"prezi_ppt_preload":dependencies[40],"prezi_test_preload":dependencies[41]}};})(),jqueryUi);};})(arguments);var moduleImpl=(function(){return module(function(l){var ea=l.dependencies["prezi.engine.dom"],q=l.dependencies.prezi_bacon,ka=l.dependencies.prezi_canvas_listener,g=l.dependencies.prezi_cet,f=l.dependencies.prezi_cet_model,R=l.dependencies.prezi_cet_renderer,fa=l.dependencies.prezi_client_player,la=l.dependencies.prezi_coeditui,V=l.dependencies.prezi_editor_controller,r=l.dependencies.prezi_editor_error,ma=l.dependencies.prezi_editor_store_common,u=l.dependencies.prezi_editor_store_mode,S=l.dependencies.prezi_editor_ui,ha=l.dependencies.prezi_error_page,
D=l.dependencies.prezi_externalserviceprovider,x=l.dependencies.prezi_featureswitcher,P=l.dependencies.prezi_i18n,X=l.dependencies.prezi_insights,m=l.dependencies.prezi_logger,T=l.dependencies.prezi_meeting,M=l.dependencies.prezi_nativeapitypes,na=l.dependencies.prezi_playback,A=l.dependencies.prezi_plugin_api,Y=l.dependencies.prezi_plugin_meta,d=l.dependencies.prezi_service_data,oa=l.dependencies.prezi_service_media,pa=l.dependencies.prezi_sound_playback,qa=l.dependencies.prezi_spotlight,ra=l.dependencies.prezi_support,
ia=l.dependencies.prezi_templatechooser,sa=l.dependencies.prezi_templateservice,ta=l.dependencies.prezi_thumbnail_render,ja=l.dependencies.prezi_uaparser,Q=l.dependencies.prezi_utils,ua=l.dependencies.prezi_check_webgl,va=l.dependencies.prezi_ppt_preload,wa=l.dependencies.prezi_test_preload,N=l.dependencies.prezi_cet_model_editor,n=l.dependencies.prezi_app_utils,E={};Object.defineProperty(E,"__esModule",{value:!0});E.Fa={appVersion:"unknown",featureList:"",width:600,height:400,fixedSize:!1,appSource:n.AppSource.PREZI_PAGE,
language:"en",showSpinnerOnStartup:!0,isNewPreziFranklin:!1,createNew:!1,isLoggedIn:!1,isPrezipage:!1,showFileMenuShowInfo:!1,showNavigationOnboarding:!1,abtestVariants:{}};E.Ea={userCanEdit:!0,userCanComment:!0,navbarHeight:0,hasEndScreen:!1,onLoad:()=>{},lockToPath:!1,internal:!0,startFromStep:0,startFromAction:0,autoplay:!1,logAllFrames:!1,loggerCategory:n.LoggerCategory.JS_EDITOR};var y={};Object.defineProperty(y,"__esModule",{value:!0});y.kb=class{Fb(a,b,c){new y.sa(a,window,b,c)}Cb(a,b,c){new xa(a,
window,b,c)}};y.da=class{constructor(a,b,c,e){this.yb=a;this.Ua=b;this.store=e;this.handle=null;this.eb=q.Bacon.newBus();this.Pa=y.da.Ca;this.Ta().onValue((a)=>{this.isOffline=a});this.Ba();c.onValue(()=>{this.isOffline||this.Ba()});a=e.getBoolModeStream(n.EditorMode.edit);q.Bacon.combineWith((a,b)=>({lc:a,saveAvailabilityStatus:b}),a,e.getSaveAvailabilityStatusStream()).onValue((a)=>this.kc=a.lc&&a.saveAvailabilityStatus===u.SaveAvailabilityStatus.enabled);this.store.addSaveTypeStream(this.eb)}Qb(a,
b){return a===u.CoeditStatus.connectionClosed||a===u.CoeditStatus.connectionLost||2===b}Ta(){return q.Bacon.combineWith((a,b)=>({coeditStatus:a,networkStatus:b}),this.store.getCoeditStatusStream(),this.store.getNetworkStatusStream()).map((a)=>{const {coeditStatus:b,networkStatus:c}=a;return this.Qb(b,c)}).skipDuplicates()}Ba(){this.Ob();this.handle=this.Ua.setInterval(()=>{this.kc&&(this.eb.push("AUTO"),this.yb.save())},this.Pa)}Ob(){null!==this.handle&&this.Ua.clearInterval(this.handle);this.handle=
null}};y.da.Ca=12E4;class xa extends y.da{constructor(a,b,c,e){super(a,b,c,e)}}y.sa=class extends y.da{constructor(a,b,c,e){super(a,b,c,e);this.Ta().onValue((a)=>{this.Pa=a?y.sa.sb:y.da.Ca;this.Ba()})}};y.sa.sb=3E4;var W={};Object.defineProperty(W,"__esModule",{value:!0});W.Ga=class{constructor(){this.logger=null}bc(){this.logger=m.LoggerModule.getLoggerManager().createLogger("prezi_editor_init.ExternalServiceLogHelper")}logSaveWithRevision(a){null!=this.logger&&this.logger.info({action:"save_with_revision",
object:"document",trigger:"machine",payload:{Nc:a}})}logUploadPreviewImages(){null!=this.logger&&this.logger.info({action:"upload",object:"preview_images",trigger:"xml_save"})}logSaveError(a,b,c){null!=this.logger&&this.logger.error({action:"save_error",object:"document",trigger:"machine",payload:{error_message:a,error_data:c,revision:b}})}logSaveSuccess(a){null!=this.logger&&this.logger.info({action:"save_success",object:"document",trigger:"machine",payload:{revision:a}})}logTemplateFallbackToStatic(a,
b){null!=this.logger&&(b={action:"templateservice_fallback_to_static_public",object:"template",trigger:"machine",payload:{error_message:a,url:b,_type:"debug"}},"timeout"===a?this.logger.warn(b):this.logger.error(b))}};var w={};Object.defineProperty(w,"__esModule",{value:!0});var p=N.base.ObjectKind;w.aa=class{static Lc(){return{action:"created",object:"new_prezi",trigger:"machine"}}static Mc(){return{action:"loaded",object:"new_prezi",trigger:"machine"}}static Ac(a){return{action:"step_count_available",
object:"new_prezi",trigger:"machine",track_insights:{event:X.InsighstEvent.LOADED,path_step_count:a}}}static getLogParentType(a,b){return null==a?null:"kind"in a?a.is(p.overview)?"OVERVIEW":a.parent.is(p.overview)?"OVERVIEW":"TOPIC":null==g.Cet.createHierarchyQuery(b).getParentId(a)?"OVERVIEW":"TOPIC"}static getObjectType(a,b){return null==a?null:"kind"in a?w.aa.Rb(a):w.aa.Sb(a,b)}static Sb(a,b){if(null==a)return null;switch(a.getDef()){case f.CetModel.ID.Z_LINE:return"LINE";case f.CetModel.ID.Z_ARROW:return"ARROW";
case f.CetModel.ID.Z_BRACKET_FRAME:return"BRACKETFRAME";case f.CetModel.ID.Z_CIRCLE_FRAME:case f.CetModel.ID.Z_INVISIBLE_FRAME:case f.CetModel.ID.Z_RECTANGLE_FRAME:case f.CetModel.ID.Z_TOPIC_CONTAINER:return a=g.Cet.createHierarchyQuery(b).getParentId(a),null==a||a===b.getPreziW().getOverview().getId()?"TOPIC":"SUBTOPIC";case f.CetModel.ID.Z_IMAGE:return"IMAGE";case f.CetModel.ID.Z_VIDEO:return"VIDEO";case f.CetModel.ID.Z_TEXT:case f.CetModel.ID.Z_RICH_TEXT:return f.CetModel.textKludge.hasUrl(a)?
"URL":"TEXT";case f.CetModel.ID.Z_PDF:return a=a.getWrapper(f.CetModel.ID.Z_PDF.W),b=a.getOnlineAssetUrl(),a=a.getAssetSourceFilename()?a.getAssetSourceFilename().toLowerCase():"",this.Sa(b,a);case f.CetModel.ID.Z_SHAPE:return"SHAPE";case f.CetModel.ID.Z_CHART_PDF:return"CHART";case f.CetModel.ID.OVERVIEW:return"OVERVIEW";case f.CetModel.ID.FADE_IN_OBJECT:case f.CetModel.ID.FADE_IN_OBJECTS:case f.CetModel.ID.FADE_OUT_OBJECT:case f.CetModel.ID.FADE_OUT_OBJECTS:case f.CetModel.ID.ZOOM_TO_OBJECT:case f.CetModel.ID.FADE_IN_OBJECT_EP:case f.CetModel.ID.FADE_IN_OBJECTS_EP:case f.CetModel.ID.FADE_OUT_OBJECT_EP:case f.CetModel.ID.FADE_OUT_OBJECTS_EP:case f.CetModel.ID.ZOOM_TO_OBJECT_EP:return"ANIMATION";
case f.CetModel.ID.Z_ZOOM_AREA:return"ZOOMAREA";case f.CetModel.ID.Z_ANIMATED_IMAGE:return"ANIMATEDIMAGE";default:return null}}static Rb(a){return null==a?null:a.is(p.page)?"PAGE":a.is(p.arrow)?"ARROW":a.is(p.line)?"LINE":a.is(p.topic)?a.parent.is(p.overview)?"TOPIC":"SUBTOPIC":a.is(p.image)?"IMAGE":a.is(p.video)?"VIDEO":a.is(p.text)?0<Q.Utils.getUrlsInString(a.getText()).length?"URL":"TEXT":a.is(p.pdf)?(a=a.pdfAsset,null==a?null:this.Sa(a.url,a.assetSourceFilename?a.assetSourceFilename.toLowerCase():
"")):a.is(p.shape)?"SHAPE":a.is(p.chart)?"CHART":a.is(p.overview)?"OVERVIEW":a.is(p.zoomArea)?"ZOOMAREA":a.is(p.bracketFrame)?"BRACKETFRAME":a.is(p.animatedImage)?"ANIMATEDIMAGE":null}static Sa(a,b){if(b.endsWith(".ppt")||b.endsWith(".pptx"))return"PPT";a=a&&-1<a.indexOf("templateadmin-pdf-symbol");b=-1<b.indexOf("img.icons8.com");return a||b?"SYMBOL":"PDF"}static Ub(a){return null==a?null:"kind"in a?a.is(p.overview)?"CONTENT":w.aa.Vb(a):w.aa.Wb(a)}static Wb(a){if(null!=g.Cet.getReferer(a,f.CetModel.ID.VISUAL))return"VISUAL";
if(null!=g.Cet.getReferer(a,f.CetModel.ID.COVER))return"COVER";if(null!=g.Cet.getReferer(a,f.CetModel.ID.CONTENT))return"CONTENT";if(null!=g.Cet.getReferer(a,f.CetModel.ID.SURFACE))return"SURFACE";if(null!=g.Cet.getReferer(a,f.CetModel.ID.MASTER))return"MASTER";a=a.get(f.CetModel.ID.HAS_CHILDREN_DEPRECATED.MANUAL_COVERS_PARENT);return null!=a&&0<a.length?"COVER":"CONTENT"}static Vb(a){try{switch(a.parent.kind){case p.overview:case p.page:case p.planetTopic:case p.stackTopic:return"CONTENT";case p.cover:return"COVER";
case p.visual:return"VISUAL";case p.master:return"MASTER";case p.surface:return"SURFACE";default:return Q.Utils.assertNever(a.parent)}}catch(b){return"UNKNOWN"}}};var B={};Object.defineProperty(B,"__esModule",{value:!0});B.ea=class{constructor(a,b,c){this.na=a;this.f=b;this.xc=c;this.Xa=[];a=this.na.filter((a)=>a.type===g.CetNetworkEventType.SessionReady).map(()=>this.$a(this.getPeerKeyValueStores()));b=this.na.filter((a)=>a.type===g.CetNetworkEventType.PeerKeyValueStoreChanged).map(()=>this.getPeerKeyValueStores().popChanges());
c=this.na.filter((a)=>a.type===g.CetNetworkEventType.KeyValueStoresReset).map(()=>this.$a(this.getPeerKeyValueStores()));this.Bb=b.merge(a).merge(c);this.Ic()}getPeerKeyValueStores(){return this.f.getPeerKeyValueStores()}getOwnKeyValueStore(){return this.f.getOwnKeyValueStore()}$a(a){let b=a.getPeerClientUuids().map((b)=>{let c=a.getKeyValueStore(b);return c.getKeys().map((a)=>({key:a,value:c.getValue(a)})).map((a)=>({peerClientUuid:b,keyValueStoreChange:a}))});return b.length?b.reduce((a,b)=>a.concat(b)):
[]}Ic(){this.yc=this.Bb.map((a)=>a.filter((a)=>a.keyValueStoreChange.key===B.ea.ta).map((a)=>{let b=JSON.parse(a.keyValueStoreChange.value);return{clientUuid:a.peerClientUuid,selectedEntityIds:b}})).flatMap(q.Bacon.fromArray);this.xc.onValue((a)=>{(a=a.allEntityIds)&&this.getOwnKeyValueStore()&&(this.Xa=a,this.getOwnKeyValueStore().setValue(B.ea.ta,JSON.stringify(a)))});this.na.filter((a)=>a.type===g.CetNetworkEventType.KeyValueStoresReset).onValue(()=>{this.getOwnKeyValueStore().setValue(B.ea.ta,
JSON.stringify(this.Xa))})}};B.ea.ta="SELECTION_CHANGE";var Z={};Object.defineProperty(Z,"__esModule",{value:!0});Z.PreziLoadingProgressMonitor=class{constructor(a){this.oc=a;this.xa=q.Bacon.newBus();this.ya=this.xa.toProperty();this.ac()}ga(){this.sendEvent(d.PreziLoaderEventType.PreziXMLLoadError,100)}ac(){const a=this.oc.map((a)=>{switch(a.type){case d.PreziLoaderEventType.StartLoading:return this.ha(a.type,20);case d.PreziLoaderEventType.MetaDataLoaded:return this.ha(a.type,40);case d.PreziLoaderEventType.NewPrezi:case d.PreziLoaderEventType.CetSessionCreated:return this.ha(a.type,
80);case d.PreziLoaderEventType.MetaDataLoadError:case d.PreziLoaderEventType.PreziXMLLoadError:case d.PreziLoaderEventType.PreziConversionNotAllowedError:case d.PreziLoaderEventType.PreziCreationError:case d.PreziLoaderEventType.AllAssetsLoaded:return this.ha(a.type,100)}return null}).filter((a)=>null!==a);this.xa.plug(a);this.ya.onValue(()=>null)}sendEvent(a,b){this.xa.push(this.ha(a,b))}ha(a,b){switch(a){case d.PreziLoaderEventType.MetaDataLoadError:case d.PreziLoaderEventType.PreziXMLLoadError:case d.PreziLoaderEventType.AssetLoadError:case d.PreziLoaderEventType.PreziCreationError:case d.PreziLoaderEventType.PreziConversionNotAllowedError:case d.PreziLoaderEventType.PdomSessionCreationError:a=
4;break;case d.PreziLoaderEventType.TemplateChooserLoaded:case d.PreziLoaderEventType.EditorStartEventForPrezipage:a=2;break;case d.PreziLoaderEventType.AllAssetsLoaded:a=3;break;case d.PreziLoaderEventType.EditorInit:a=5;break;default:a=1}return{eventType:a,progress:b}}};var aa={};Object.defineProperty(aa,"__esModule",{value:!0});aa.ub=class{constructor(){this.logger=m.LoggerModule.getLoggerManager().createLogger("SaveStatLogger")}rc(a,b){a=g.Cet.createPreziDOMStatCollector(a).collectBasicStats();
this.logger.info({action:"save",object:"document",trigger:"machine",payload:a});m.avro.Avro.createDefaultLogger().logSavedPresentationStats({save_type:b,num_youtube_videos:a.num_youtube_videos,num_vimeo_videos:a.num_vimeo_videos,num_videos:a.num_videos,num_texts:a.num_texts,num_swfs:a.num_swfs,num_shapes:a.num_shapes,num_real_texts:a.num_real_texts,num_placeholders:a.num_placeholders,num_placeholder_texts:a.num_placeholder_texts,num_pdfs:a.num_pdfs,num_pages:a.num_pages,num_objects:a.num_objects,
num_lines:a.num_lines,num_images:a.num_images,num_groups:a.num_groups,num_arrows:a.num_arrows,num_characters:a.num_characters,num_pixel_count:a.num_pixel_count,num_steps:a.num_steps,num_animations:a.num_animations,num_audios:a.num_audios,num_topics:a.num_topics,num_planet_topics:a.num_planet_topics,num_stack_topics:a.num_stack_topics,num_charts:a.num_charts,num_of_topics_with_more_than_one_video:a.num_of_topics_with_more_than_one_video})}};var ba={};Object.defineProperty(ba,"__esModule",{value:!0});
ba.vb=class{constructor(a,b,c,e){this.Kc=a;let k,h=[];this.logger=m.LoggerModule.getLoggerManager().createLogger("prezi_editor_init.SlackNotifier");b.onValue((a)=>{k=a.oid});c.filter((a)=>a===M.SaveState.dirty).take(1).onValue(()=>{c.filter((a)=>a===M.SaveState.saved).take(1).onValue(()=>{k&&this.Kc.sendSlackSaveNotification(k,h,this.onError.bind(this))})});e.onValue((a)=>{h=a.filter((a)=>!a.isDisconnected()).map((a)=>""+a.getUserId()).filter((a,b,c)=>c.indexOf(a)===b)})}onError(a){this.logger.error({action:"error",
object:"boxfish.Slacknotifier",trigger:"machine",category:"slackservice_structured",payload:{error_message:a}})}};var U={};Object.defineProperty(U,"__esModule",{value:!0});U.tb=class{constructor(a){this.hostName=a}check(){return fetch(`//${this.hostName}/online-check/`)}};U.rb=class{constructor(a){this.wc=a}Zb(a,b,c){const e=m.LoggerModule.createLogRecordFormatter(Object.assign(Object.assign({},c),{category:"jseditor_structured_fallback"}));b=b.scan(null,(a,b)=>({bb:null==a?null:a.ba,ba:b})).filter((a)=>
null!=a).filter((a)=>null!=a).flatMap((a)=>{if(a.ba.isOnline)return null!=a.bb&&a.bb.isOnline?q.Bacon.once({w:!0,isOnline:a.ba.isOnline,response:a.ba.response}):q.Bacon.once({w:!0,isOnline:!0,response:a.ba.response});{const b=q.Bacon.newBus();this.wc.check().then(()=>b.push({w:!0,isOnline:!1,response:a.ba.response})).catch(()=>b.push({w:!1,isOnline:!1,response:a.ba.response}));return b}});b.skipDuplicates((a,b)=>a.w===b.w&&a.isOnline===b.isOnline).onValue((b)=>{a.log(e.createLogRecord("fallback",
m.Level.INFO,{action:"connection_change",object:"fallback",trigger:"machine",payload:{healthCheck:b.w,isOnline:b.isOnline}}))});return b.skipDuplicates((a,b)=>a.w===b.w)}};var G={},za=this&&G.Ka||function(a,b,c,e){function k(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,d){function h(a){try{g(e.next(a))}catch(z){d(z)}}function v(a){try{g(e["throw"](a))}catch(z){d(z)}}function g(a){a.done?c(a.value):k(a.value).then(h,v)}g((e=e.apply(a,b||[])).next())})};
Object.defineProperty(G,"__esModule",{value:!0});var H;(function(a){a[a.Ja=0]="Save";a[a.Ha=1]="ForceSaveAndGetStorageProperties"})(H||(H={}));G.pb=class{constructor(a,b,c){this.elementId=a;this.cetSessionFactory=b;this.ca=c;this.va=q.Bacon.newBus();this.Wa=m.LoggerModule.now();this.Va=!1;this.ma=q.Bacon.newBus();this.za=m.LoggerModule.createLogHelper();this.Ra=q.Bacon.newBus()}Oa(){return{preziOid:this.options.preziId}}Hb(a,b){return{triggerSave:()=>{this.logger.info({action:"triggerSave",object:"desktopExternalServiceProvider",
trigger:"machine"});this.va.push(H.Ja)},triggerForceSaveAndGetStorageProperties:()=>{this.logger.info({action:"triggerForcedSaveAndGetStorageProperties",object:"desktopExternalServiceProvider",trigger:"machine"});this.va.push(H.Ha)},isClosing:(a)=>{this.logger.info({action:"isClosing",object:"desktopExternalServiceProvider",trigger:"machine",payload:{closing:a}});a?this.f.forwardRemoteEditingEvents(!1):this.f.forwardRemoteEditingEvents(!0)},startPdfExport:()=>{a.startPdfExport({progressCallback:(a,
e)=>{b.reportPdfExportProgress(a,e)},finishedCallback:(a)=>{a.resultStatus===A.ExportResultStatus.success?b.reportPdfExportCompleted({pdfData:a.data}):b.reportPdfExportCompleted({error:a.errorMessage})}})},cancelPdfExport:()=>{a.cancelPdfExport()},getNavigationProvider:()=>this.Ya,mobileClickerStatusStream:this.mobileClickerStatusStream,createFromTemplateId:(a,b)=>{const c=x.isActive("js-prezi-video")?P.I18n.ts("(For Prezi Video) Untitled presentation"):null;this.startEditing({templateId:a,templateCategory:b,
title:c})},getEditorUIController:()=>this.Qa}}La(a){var b=document.createElement("style");b.textContent=a.assetLoaderProvider.getUiFontCss();window.document.body.appendChild(b);a=window.document.getElementById(this.elementId);a.innerHTML="";b=window.document.createElement("div");b.setAttribute("id","js-player");a.appendChild(b)}Tb(){if("desktop"===this.options.externalServiceType){const a=ja.PreziUAParser.createUAParser().os.name.toLowerCase();return-1<a.indexOf("mac")?"mac":-1<a.indexOf("win")?"windows":
"unknown"}return"website"}getAppSource(){return"desktop"===this.options.externalServiceType?"desktop":this.options.appSource}initLoggers(a,b){this.ca.initLoggers(this.getConfig(),a,{getLogTopicRelationship:(a)=>w.aa.Ub(a),getLogObjectType:(a)=>w.aa.getObjectType(a,b()),getLogParentType:(a)=>w.aa.getLogParentType(a,b())});this.ua=n.AppUtilsModule.createActivityLogger();n.AppUtilsModule.createLogHelperUtils();n.AppUtilsModule.createAppInitUtils().logUserInfo(this.options);this.Xb()}Xb(){const a=m.LoggerModule.getLoggerManager().createLogger("prezi.util.Utils.ActorSystem");
Q.Utils.ActorSystem().setLogger({info(b,c,e,k){a.info({action:e,object:b,trigger:c,payload:k})},warn(b,c,e,k){a.warn({action:e,object:b,trigger:c,payload:k})},error(b,c,e,k,h){h?m.LoggerModule.logException(a,b,e,h,k):a.error({action:e,object:b,trigger:c,payload:k})},debug(b,c,e,k){a.debug({action:e,object:b,trigger:c,payload:k})}})}loadTimerStart(a,b){this.za.loadTimerStart(this.logger,a,b)}loadTimerEnd(a,b,c){this.za.loadTimerEnd(this.logger,a,n.EditorMode[b.kind],R.RendererKind[R.RendererKind.WebGl],
c)}logResourceAttributes(){this.za.logResourceAttributes(this.logger)}createCetSession(a){a=this.cetSessionFactory().createCetSession(a,n.AppUtilsModule.getLogHelperUtils(),a.getCoeditOptions());!this.options.userCanEdit&&this.options.userCanComment&&a.setSessionMode(D.CetSessionMode.FallbackReadOnly);this.options.useFallbackStorageServices&&a.setSessionMode(D.CetSessionMode.FallbackLocalSave);return a}Db(a,b,c){const e="landing_page"===this.options.appSource?t.j.qb:t.j.nb,k=g.Cet.createAssetManager(a.assetLoaderProvider);
a=g.Cet.createCetApplication({headless:!1,speedMeasurementOptions:{measureSpeed:!0,speedMeasurementMode:e},rendererKind:R.RendererKind.WebGl,tryRetainMainCanvas:!1,highDPICanvas:!0,isDesktop:a.isDesktop()},b,k,{updateList:[]},c.getIsGridEnabledStream(),c.getModeStream().map((a)=>a.kind).skipDuplicates());a.getMainStage().setVideoControlVisibility(!this.options.isFollower);a.getSpeedMeter().setLogAllFrames(this.options.logAllFrames);return a}Yb(a,b,c){g.Cet.setupPdomLogging(m.Level.ALL);b.ya.onValue((a)=>
{c.reportProgress(a.eventType,a.progress)});n.AppUtilsModule.setLogHelperUtilsCurrentTopicStream(a.getCurrentTopicStream())}loadPreziMetaData(a){return a.getPreziLoader().getLoaderStream().map((a)=>a.type===d.PreziLoaderEventType.MetaDataLoaded?a:null).filter((a)=>null!=a)}loadPrezi(a,b){b.getPreziLoader().loadPrezi(this.o,a)}createFollowerController(a,b){return this.options.isFollower?T.MeetingModule.createFollowerController(this.options,a,()=>this.loadPreziMetaData(b),(a)=>this.loadPrezi(a,b)):
null}createPresenterController(a,b,c){return!this.options.isFollower&&this.options.isLoggedIn?T.MeetingModule.createPresenterController(this.options,a,b,c):null}createEditorOnboardingController(a,b){return ra.SupportModule.createEditorOnboardingController(a,b,this.options)}createCoeditUIController(a,b,c){b=new B.ea(this.getNetworkEventStream(a),a,b.getSelectionStream());let e=this.getNetworkEventStream(a).filter((a)=>a.type===g.CetNetworkEventType.RoomInfoChanged).map(()=>a.getNetworkUserList());
return la.CoeditUIModule.createCoeditUIController(e,b.yc,c.openPopup)}createEditorUI(a,b,c,e,k,h,v,g,l,ca,ya,z,f,n,q,p,t,u,r){const F=oa.MediaServiceModule.createMediaService(a.mediaUploadProvider,a.assetLoaderProvider,a),C=d.DataServiceModule.createUserSettingsStore(a);return S.EditorUIModule.createEditorUI(b,this.ua,c,F,l,C,a,e,k,h,v,g,this.ca.getGlobalExceptionStream().merge(m.LoggerModule.getLoggerManager().getErrorStreamOnLocal().map((a)=>`${a}`)),ca,ya,z,f,n,q,p,t,u,r)}ib(a,b){return q.Bacon.combineWith((a)=>
a.kind===n.EditorMode.playback?null:{errorCase:r.EditorErrorCase.EXTERNAL_EDIT_DETECTED,unclosable:!0},b.getModeStream(),a).filter((a)=>null!=a)}vc(a,b){this.ma.push(a);b.updateMetadata(a)}Za(a,b){const c=m.LoggerModule.getLoggerManager();null==a.oid?c.setPreziId(a.desktopId):c.setPreziId(a.oid);c.setSchemaVersion(a.schema_version);c.setOwnerId(a.owner_id);this.ma.push(a);b.setMetadata(a)}getMetadataStream(){return this.ma}ra(a,b,c){b&&b.getEditmode()&&b.getEditmode().getAnimationScene()?b.getEditmode().getAnimationScene().update():
b&&b.getEditScene()&&b.getEditScene().update();c&&c.getPlayback()&&c.getPlayback().getScene()&&c.getPlayback().getScene().update();a.getBaseScene()&&a.getBaseScene().update()}Ab(){const a=[];for(let b=0;b<window.localStorage.length;++b){const c=window.localStorage.key(b);c.startsWith("presenterview.")&&a.push(c)}a.forEach((a)=>window.localStorage.removeItem(a))}startEditor(a,b,c,e,k,h){x.isActive("js-unique-differentiation")&&($("html").addClass("prevent-mac-swiping"),$("body").addClass("prevent-mac-swiping"));
this.Va=!0;const v=this.ka(this.Oa(),this.options);this.logger.info({action:"loaded",object:"new_prezi",trigger:"machine"});this.Ab();k.startEditor(a,b);b=e.getPathNavigator().getPath().getStepCount();this.logger.info(w.aa.Ac(b));this.loadTimerEnd(m.LoadEvent.Editor,a);e.addAllAssetsLoadedHandler(()=>{m.avro.Avro.createDefaultLogger().logLoadedEditor({workflow_mode:"STANDARD"});this.loadTimerEnd(m.LoadEvent.Assets,a);a.kind!==n.EditorMode.templateChooser&&a.kind!==n.EditorMode.edit||d.DataServiceModule.createUserSettingsStore(v).setBoolean(d.UserSettingBooleanKeys.EDITOR_SEEN,
!0);this.qc(a);this.options.isFollower&&this.loadTimerEnd(m.LoadEvent.LivePrezi,a);c.sendEvent(d.PreziLoaderEventType.AllAssetsLoaded,100)});this.options.isPrezipage&&this.loadTimerEnd(m.LoadEvent.PreziPage,a);c.sendEvent(d.PreziLoaderEventType.EditorStartEventForPrezipage,85);b=e.getAutoPlayer().getEventStream().filter((a)=>a.getType()===g.AutoPlayEventType.STOP||a.getType()===g.AutoPlayEventType.START).map((a)=>a.getType()===g.AutoPlayEventType.START?a.getAutoPlayer().getInterval()/1E3:0);n.AppUtilsModule.setLogHelperUtilsAutoPlayDelayChangeStream(b);
n.AppUtilsModule.setLogHelperUtilsZoomingStream(e.getCet().getMainStage().getCamera().getZoomingStream());this.hc(e,this.o,h);k.handleDeeplinks()}qc(a){a.kind===n.EditorMode.edit&&x.isActive("js-actret-abtest-prezi-present-improve-record-video-flow")&&m.avro.Avro.createDefaultLogger().logEnteredAbTestExperience({ab_test_name:"js-actret-abtest-prezi-present-improve-record-video-flow"})}Fc(a,b){a.getEditScene().hasAnyUncommitedChange()&&(this.logger.info({action:"saveDocumentAfterLoadIfFixedBySystems",
object:"prezi",trigger:"machine"}),b.save())}fc(a,b,c){this.va.onValue((b)=>{switch(b){case H.Ja:a.save();break;case H.Ha:a.forceSaveAndGetStorageProperties((a)=>{c.forceSaveWithStoragePropertiesFinished(a)})}});this.Fc(b,a)}uc(a,b,c,e,k,h,d,g,l){this.loadTimerEnd(m.LoadEvent.Document,this.editorMode);this.logger.info({action:"open",object:"document",trigger:"machine",payload:{topicType:b.getDocument().getTopicType()}});this.loadTimerStart(m.LoadEvent.Editor);if(this.Va)this.ra(b,k,e),k.restartEditor(),
k.setDocument(a),e.reset(this.options),"function"===typeof this.options.onLoad&&setTimeout(this.options.onLoad,0);else h.getStateStream().take(1).onValue((a)=>{this.startEditor(a.mode,a.userHasEditRights,c,e,k,h);this.loadTimerStart(m.LoadEvent.Assets);this.loadTimerStart(m.LoadEvent.FirstValidFrame)});e.isEditingEnabled()&&(this.fc(g,k,l),b.getSceneHierarchy().setAutoCommitScene(k.getEditScene()));h.getIsFollowerStream().filter((a)=>!a&&this.options.isLoggedIn).onValue(()=>{d.attachSaveDependency(()=>
g.save())})}Cc(a,b,c,e,k,h,g,l,m,f){const v=a.getPreziLoader().getLoaderStream().filter((a)=>a.type===d.PreziLoaderEventType.FeaturePreviewModeWithSaveDisabled||a.type===d.PreziLoaderEventType.PdomSessionCreated).map((a)=>a.type===d.PreziLoaderEventType.FeaturePreviewModeWithSaveDisabled);g.addFeaturePreviewModeWithSaveDisabledStream(v);a.getPreziLoader().getLoaderStream().onValue((a)=>{a.type===d.PreziLoaderEventType.FeaturePreviewModeWithSaveDisabled&&b.push({errorCase:r.EditorErrorCase.FEATURE_PREVIEW_MODE_SAVE_DISABLED,
customDialogContent:f.getCustomErrorDialog(r.EditorErrorCase.FEATURE_PREVIEW_MODE_SAVE_DISABLED,!0)})});a.getPreziLoader().getLoaderStream().onValue((a)=>{switch(a.type){case d.PreziLoaderEventType.MetaDataLoadError:b.push(a.payload);break;case d.PreziLoaderEventType.PreziXMLLoadError:b.push({errorCase:r.EditorErrorCase.PREZI_XML_LOAD_ERROR,unclosable:!0});break;case d.PreziLoaderEventType.PreziConversionNotAllowedError:b.push({errorCase:r.EditorErrorCase.PREZI_CONVERSION_NOT_ALLOWED,unclosable:!0});
break;case d.PreziLoaderEventType.PreziConversionFailedError:null!=a.payload?b.push({errorCase:r.EditorErrorCase.ASSET_LOAD_ERROR_DURING_PREZI_CONVERSION,unclosable:!0}):b.push({errorCase:r.EditorErrorCase.PREZI_CONVERSION_FAILED,unclosable:!0});break;case d.PreziLoaderEventType.MetaDataLoaded:this.Za(a.payload,c);break;case d.PreziLoaderEventType.MetaDataUpdated:this.vc(a.payload,c);break;case d.PreziLoaderEventType.CetSessionCreated:this.ra(e,c,h);break;case d.PreziLoaderEventType.PreziLoaded:this.uc(a.payload,
e,k,h,c,g,l,m,f)}})}qa(){const a=this.ka({preziOid:""},this.options);null==document.querySelector("#error-ui")&&ha.showCoeditErrorPage({rootElementId:this.elementId,isDesktop:"desktop"===this.options.externalServiceType,hostName:this.options.hostName,userId:this.options.userId}).then(()=>{a.reportProgress(4,100);this.logger.info({action:"success",object:"coedit_error_page",trigger:"editor_init",payload:{_type:"debug"}})}).catch(()=>{this.logger.info({action:"failure",object:"coedit_error_page",trigger:"editor_init",
payload:{_type:"debug"}})})}getNetworkEventStream(a){return a.getPreziLoader().getNetworkEventStream().merge(this.Ra)}Dc(a,b,c,e,k,h,d){const v=this.getNetworkEventStream(a),l=(a)=>v.filter((b)=>b.type===a).map((a)=>a),f=(a,b)=>{l(a).onValue((a)=>b(a))};b.plug(this.ib(v.filter((a)=>a.type===g.CetNetworkEventType.MultiUserLockError),e));f(g.CetNetworkEventType.MultiUserLockError,()=>{c.ga()});this.ic(k,e.getSaveStateStream(),v);f(g.CetNetworkEventType.HardResetedPreziIsAvailable,(a)=>h.handleHardReset(a.preziId,
a.preziXml,a.sessionState));((a)=>{let b=!1;f(g.CetNetworkEventType.Finished,(a)=>{h.handleConnectionClosed(a.preziId);d.coeditFinishedAndWaitingForGoOnline()});f(g.CetNetworkEventType.OfflineTimerTriggered,()=>{h.handleOfflineTimerTriggered()});f(g.CetNetworkEventType.Reconnected,(c)=>{b&&(b=!1,h.handleReconnectAfterConnectionLost(c.preziId,!T.MeetingModule.isRemotePresentationInProgress(a.getPresenterState())),d.coeditReconnected())});f(g.CetNetworkEventType.ConnectionLost,(a)=>{b||(b=!0,h.handleConnectionLost(a.preziId),
d.connectionLost())})})(e);f(g.CetNetworkEventType.InvalidDocumentStateError,()=>b.push({errorCase:r.EditorErrorCase.INVALID_PREZI_STATE,unclosable:!0}));f(g.CetNetworkEventType.AccessDeniedError,()=>{b.push({errorCase:r.EditorErrorCase.DOCUMENT_ACCESS_DENIED_FOR_USER,unclosable:!0});c.ga();this.qa()});f(g.CetNetworkEventType.IllegalStateError,()=>{b.push({errorCase:r.EditorErrorCase.CONNECTING_TO_PREZI_DOCUMENT_SERVER_FAILED,unclosable:!0});c.ga();this.qa()});f(g.CetNetworkEventType.TransportError,
()=>{b.push({errorCase:r.EditorErrorCase.CONNECTING_TO_PREZI_DOCUMENT_SERVER_FAILED,unclosable:!0});c.ga();this.qa()});f(g.CetNetworkEventType.InitialConnectionFailure,(a)=>{h.handleInitialConnectionFailure(a.preziId);d.coeditInitialConnectionFailure();b.push({errorCase:r.EditorErrorCase.CONNECTING_TO_PREZI_DOCUMENT_SERVER_FAILED,unclosable:!0});c.ga();this.qa()})}Jb(a){const b=q.Bacon.newBus();a.onSaveAvailabilityUpdate((a)=>{a?b.push(u.SaveAvailabilityStatus.enabled):b.push(u.SaveAvailabilityStatus.disabled)});
return b.toProperty(u.SaveAvailabilityStatus.enabled)}Ib(a,b){const c=q.Bacon.newBus();a.onNetworkOnlineStatusUpdate((a)=>{a?c.push(1):c.push(2)});return c.toProperty(b?2:1)}Eb(a){return this.getNetworkEventStream(a).map((a)=>{switch(a.type){case g.CetNetworkEventType.ConnectionLost:return u.CoeditStatus.connectionLost;case g.CetNetworkEventType.ReconnectingFromFinished:return u.CoeditStatus.connectionLost;case g.CetNetworkEventType.Finished:return u.CoeditStatus.connectionClosed;case g.CetNetworkEventType.Reconnected:return u.CoeditStatus.connected;
case g.CetNetworkEventType.OfflineTimerTriggered:return u.CoeditStatus.offlineTimerTriggered;case g.CetNetworkEventType.SessionReady:return u.CoeditStatus.connected;default:return null}}).filter((a)=>null!=a).toProperty(u.CoeditStatus.uninitialized)}$b(a,b,c,e,k,h,d,g,f,l,m,n){var v=a.getSaveStateStream().filter((a)=>a===M.SaveState.errorExternalEdit);v=this.ib(v,a);b.plug(v);this.Cc(c,b,e,g,k,f,a,l,m,n);this.Dc(c,b,k,a,e,h,d)}setDocument(a,b){b.updateWithIPrezi(a)}cc(a,b){x.isActive("js-disable-save-confirmation")||
(b.getSaveStateStream().map((a)=>a===M.SaveState.saved||a===M.SaveState.errorExternalEdit).skipDuplicates().toProperty().onValue((b)=>{a.setHasUnsavedChanges(!b)}),b.getSaveStateStream().skipDuplicates().toProperty().onValue((b)=>{a.setSaveState(b)}))}jc(a,b,c,e,k,h,d,g){n.AppUtilsModule.setLogHelperUtilsFullScreenChangeStream(h.getFullScreenChangeStream());d.getEditorStore().addChangeModeActionStream(k);d.registerSetInfoLayerModeCallback(this.options.setInfoLayerMode);d.addErrorValueStream(e);d.setXmlLoaderCallback((b)=>
this.setDocument(ea.DOM.loadXml(b),a));this.options.userCanEdit&&(this.cc(b,c),c.addSaveStateActionStream(g))}gc(a,b,c){let e=a.getPreziLoader().getLoaderStream().map((a)=>a.type===d.PreziLoaderEventType.MetaDataLoaded?a.payload:null).filter((a)=>null!=a);c=c.getSaveStateStream();let k=this.getNetworkEventStream(a).filter((a)=>a.type===g.CetNetworkEventType.RoomInfoChanged).map(()=>a.getNetworkUserList());new ba.vb(b,e,c,k)}isDesktop(){return"desktop"===this.options.externalServiceType}nc(){try{const a=
{alpha:!0,depth:!0,stencil:!0},b=document.createElement("canvas");return null!=(b.getContext("webgl",a)||b.getContext("experimental-webgl",a))}catch(a){return!1}}mc(){try{if("object"===typeof WebAssembly&&"function"===typeof WebAssembly.instantiate){const a=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(a instanceof WebAssembly.Module)return new WebAssembly.Instance(a)instanceof WebAssembly.Instance}}catch(a){}return!1}zb(){const a=!x.isActive("js-check-webassembly")||this.mc(),b=
this.nc();if(!a)throw Error("Webassembly is not available");if(!b)throw Error("WebGl is not supported");}tc(a,b){this.options=a;const c=this.ka({preziOid:""},this.options);this.initLoggers(c,()=>this.o.getBaseScene());a=m.LoggerModule.getLoggerManager().createLogger("prezi_editor_init.EditorInitImpl");this.La(c);a.info({action:"show",object:"webgl_context_error_page",trigger:"editor_init",payload:{_type:"debug",reason:b}});ha.showWebglContextErrorPage({rootElementId:this.elementId,isDesktop:"desktop"===
this.options.externalServiceType,hostName:this.options.hostName,userId:this.options.userId}).then(()=>{c.reportProgress(6,100);this.logger.info({action:"success",object:"webgl_context_error_page",trigger:"editor_init",payload:{_type:"debug"}})}).catch(()=>{this.logger.info({action:"failure",object:"webgl_context_error_page",trigger:"editor_init",payload:{_type:"debug"}})})}getConfig(){const a=this.getAppSource(),b=this.Tb(),c=n.AppUtilsModule.createAppInitUtils().isStaffOrTestUser(this.options.email);
return{appVersion:this.options.appVersion,preziId:this.options.preziId,organizationId:this.options.organizationId,category:this.options.loggerCategory,appSource:a,userId:this.options.userId,ownerId:this.options.ownerId,schemaVersion:this.options.schemaVersion,putmaId:this.options.putmaId,platform:b,isStaffUser:c,canEdit:this.options.userCanEdit,isNewPrezi:this.options.createNew,sessionId:m.LoggerModule.getSessionId()}}Gb(a){this.options=a;this.Kb=this.Oa();a=this.ka(this.Kb,this.options);this.initLoggers(a,
()=>this.o.getBaseScene());return a}init(a,b,c,e,k,h,f,l,p,t){this.startEditing=e;this.mobileClickerStatusStream=q.Bacon.newBus();var v=new W.Ga,F=this.isDesktop()?null:(new U.rb(new U.tb(this.options.hostName))).Zb(m.LoggerModule.createFallbackLoggerProvider(),h.getLoggerConnectionStream(),this.getConfig());this.logger=e=m.LoggerModule.getLoggerManager().createLogger("prezi_editor_init.EditorInitImpl");b.getModeStream().onValue((a)=>{this.editorMode=a});this.ua.setEditorModeStream(b.getModeStream().map((a)=>
a.kind));this.f=this.createCetSession(h);const ca=(a)=>{a=b.getIsFullscreenStream().combineAndSample((a,b)=>({isFullscreen:a,Ma:b}),a).filter((a)=>!a.isFullscreen||a.Ma.newMode!==n.EditorMode.edit).map((a)=>a.Ma);b.addChangeModeActionStream(a)};var u=V.EditorControllerModule.createConnectivityController((a)=>ca(a),(a)=>b.addUserHasEditRightsStream(a),this.f,this.o);const r=this.isDesktop()?D.ExternalServiceProviderModule.getDesktopCoeditEventHandler(u):D.ExternalServiceProviderModule.getBrowserCoeditEventHandler(u);
F=this.isDesktop()?D.ExternalServiceProviderModule.getDesktopOnlineStatusProvider(r):D.ExternalServiceProviderModule.getBrowserOnlineStatusProvider(r,this.options.hostName,F.map((a)=>a.w).skipDuplicates());const C=this.isDesktop()?g.Cet.createCoeditOfflineOnlineSwitchHandler(this.options.useFallbackStorageServices,a.kind===n.EditorMode.playback):g.Cet.createDummyCoeditOfflineOnlineSwitchHandler();this.f.afterSync((a)=>C.tell().cetSyncFinished(a));F.onDesktopNetworkOnlineStatusUpdate((a)=>{C.tell().desktopNetworkOnlineStatusUpdate(a)});
b.getModeStream().onValue((a)=>C.tell().editorModeChanged(a.kind===n.EditorMode.playback));D.ExternalServiceProviderModule.initNativeToJsApi(this.Hb(k.applicationController,h),r,h,{mediaAssetSyncSuccess:(a,b)=>{C.tell().mediaAssetSyncSuccess(a,b)},mediaAssetSyncNonRetryableFailure:(a,b)=>{C.tell().mediaAssetSyncNonRetryableFailure(a,b)},mediaAssetSyncRetryableFailure:(a,b)=>{C.tell().mediaAssetSyncRetryableFailure(a,b)}});this.La(h);X.PreziInsights.init(m.LoggerModule.getLoggerManager().getConfig().sessionId);
v.bc();this.options.isPrezipage&&this.loadTimerStart(m.LoadEvent.PreziPage,this.options.applicationStartTime);this.options.isFollower&&this.loadTimerStart(m.LoadEvent.LivePrezi,this.options.applicationStartTime);null!=this.options.applicationStartTime&&(this.loadTimerStart(m.LoadEvent.Js,this.options.applicationStartTime),this.loadTimerEnd(m.LoadEvent.Js,this.editorMode,this.Wa));this.loadTimerStart(m.LoadEvent.AppInit,this.Wa);this.logResourceAttributes();v=q.Bacon.newBus();u=q.Bacon.newBus();const w=
this.Db(h,this.f,b);this.o=w;Q.Utils.createIndexedStorage("GridOptions").then((a)=>za(this,void 0,void 0,function*(){var c,e;const h=null!==(e=null===(c=yield a.read("enabled"))||void 0===c?void 0:c.value)&&void 0!==e?e:!0;b.setGridEnabled(h);b.getIsGridEnabledStream().onValue((b)=>{a.put({key:"enabled",value:b})})})).catch(()=>{});const x=q.Bacon.newBus();b.addCoeditOfflineOnlineSwitchStream(x);C.tell().actionsWired({getIMediaAssets:()=>this.f.getIMediaAssets(),reloadEditor(){r.reloadEditor()},enableOnlineMediaInsert(){r.enableOnlineMediaInsert()},
disableOnlineMediaInsert(){r.disableOnlineMediaInsert()},syncMediaAsset(a){r.syncMediaAsset(a)},addMediaAssetPatch:(a)=>{this.o.getMediaAssetPatcher().addOfflineOnlinePatch(a)},coeditGoOnline:()=>{this.f.goOnline()},setSwitchingUiStateToNoSyncInProgress(){x.push({kind:"NoSyncInProgress"})},setSwitchingUiStateToOfflineMediaInserted(){x.push({kind:"OfflineMediaInserted"})},setSwitchingUiStateToSyncing(a,b){x.push({kind:"MediaSync",offlineMediaAssetSyncMaxCount:a,offlineMediaAssetSyncCurrentCount:b})}});
const A=new Z.PreziLoadingProgressMonitor(this.f.getPreziLoader().getLoaderStream());this.Yb(b,A,h);const E=this.createCoeditUIController(this.f,b,c),B=this.createFollowerController(h,this.f),H=this.createEditorOnboardingController(b,h),N=m.LoggerModule.getLoggerManager(),K=d.DataServiceModule.createUserLicenseStore(h);b.addUserLicenseInformationStream(q.Bacon.fromPromise(K.loadLicense()));b.getDeferredUserLicenseInformationStream().onValue((a)=>N.setLicenseTypeOid(a.featureSet.licenseTypeOid));b.addLogoStream(this.ma.filter((a)=>
null!=a.logo_type).map((a)=>a.logo_type));const O=fa.PlayerUIModule.createPlayerUI("js-player",this.options,this.getMetadataStream(),w,h,h,this.mobileClickerStatusStream,b.getDeferredUserLicenseInformationStream(),b.getLogoStream().toProperty(),this.ua),G=this.createPresenterController(b,O,h);this.options.isFollower?B.attachInitDependencies(b,O):this.options.isLoggedIn&&G.attachInitDependencies();var I=this.options.userCanEdit?ta.ThumbnailRenderModule.createPreviewGenerator():null;const L=this.options.userCanEdit?
new Aa:null;I=this.f.getPreziSaver(w.getCetSessionEditStream(),I,L);const R=this.f.getMetadataSaver();let J;const P=V.EditorControllerModule.createBasicEditController(()=>J.getEditScene(),I);J=this.createEditorUI(h,O,b,B,G,E,H,P,w,a,K,c,I,k,f,l,p,R,t);null!=L&&L.xb(J);this.Ra.plug(J.getExternalCetNetworkEvenStreamForTest());a=new y.kb;this.isDesktop()?a.Fb(I,this.f.getSyncTriggeredStream(),b):a.Cb(I,this.f.getSyncTriggeredStream(),b);this.$b(b,v,this.f,J,A,r,C.tell(),w,O,G,P,h);b.addCoeditStatusStream(this.Eb(this.f));
b.addNetworkStatusStream(this.Ib(F,this.options.useFallbackStorageServices));b.addSaveAvailabilityStatusStream(this.Jb(F));const T=new aa.ub;b.getSaveTypeStream().sampledBy(I.getSaveStateStream().filter((a)=>M.SaveState.saving===a)).onValue((a)=>T.rc(this.f.getIPrezi(),a));this.jc(w,h,b,v,u,O,J,I.getSaveStateStream());this.gc(this.f,h,b);this.options.useFallbackStorageServices&&r.handleStartInOfflineMode();b.addNavigationEventStream(w.getMainStage().getPathNavigator().getPathNavigationStream());this.Ya=
fa.PlayerUIModule.createDesktopNavigationConnector();this.Ya.init(O,h);this.Qa=S.EditorUIModule.createDesktopEditorUIController();this.Qa.init(J);return{o:w,f:this.f,fa:u,i:J,v:h,Na:r,la:A,playerUI:O,Aa:v,logger:e}}integration_test_overrideAudioPlayer(a){this.gb.integration_test_overrideAudioPlayer(a)}hc(a,b,c){this.gb=pa.SoundPlaybackModule.createSoundPlayback(a.getPathNavigator().getPathNavigationStream(),b.getSoundDownloadedObservable(),c.getModeStream().map((a)=>a.kind));a.setMuteController(this.gb)}ka(a,
b){return this.isDesktop()?D.ExternalServiceProviderModule.desktopExternalServiceProvider(a,b.userId):D.ExternalServiceProviderModule.browserExternalServiceProvider(b,new W.Ga)}ic(a,b,c){let e=()=>{if(null!=a&&null!=a.getEditScene()){const b=a.getEditScene(),c=b.getUncommitedChanges();c.length?this.logger.warn({action:"RequestSync-UncommitedChanges",object:"prezi",trigger:"machine",payload:c}):b.triggerSync()}};c.filter((a)=>a.type===g.CetNetworkEventType.Reconnected).onValue(()=>e());c.filter((a)=>
a.type===g.CetNetworkEventType.RequestSync).onValue(()=>e());let d=!1,h=!1;b.onValue((a)=>{d=a===M.SaveState.saving;!d&&h&&(h=!1,e())});c.filter((a)=>a.type===g.CetNetworkEventType.RemoteChangesAvailable).onValue(()=>{d?h=!0:e()})}};class Aa{xb(a){this.i=a}forceCommitEvenIfBreaksUndoHistoryAndSceneConsistency(){this.i.getEditScene().rc_DONT_USE_THIS_METHOD_DISCUSS_WITH_API_TEAM({message:"forceCommitEvenIfBreaksUndoHistoryAndSceneConsistency",snapshotBefore:{reset:()=>{}},snapshotAfter:{reset:()=>
{}}});this.i.getEditScene().update()}updateEditSceneEvenIfNotActive(){this.i.getEditScene().update()}}var K={},Ba=this&&K.Ka||function(a,b,c,e){function d(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,k){function h(a){try{f(e.next(a))}catch(z){k(z)}}function g(a){try{f(e["throw"](a))}catch(z){k(z)}}function f(a){a.done?c(a.value):d(a.value).then(h,g)}f((e=e.apply(a,b||[])).next())})};Object.defineProperty(K,"__esModule",{value:!0});K.Ia=class{static cb(a){return Ba(this,
void 0,void 0,function*(){yield Promise.all([a.registerPreloadedPlugin(Y.testPreloaded,wa),a.registerPreloadedPlugin(Y.pptPreload,va),a.registerPreloadedPlugin(Y.checkWebgl,ua)])})}};var t={},da=this&&t.Ka||function(a,b,c,e){function d(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,k){function h(a){try{f(e.next(a))}catch(z){k(z)}}function g(a){try{f(e["throw"](a))}catch(z){k(z)}}function f(a){a.done?c(a.value):d(a.value).then(h,g)}f((e=e.apply(a,b||[])).next())})};
Object.defineProperty(t,"__esModule",{value:!0});t.j=class{constructor(a,b){this.elementId=a;this.cetSessionFactory=b;this.ca=n.AppUtilsModule.createAppInitUtils();this.pa=q.Bacon.newBus();this.ab=!1;this.jb=q.Bacon.newBus();this.wa=q.Bacon.newBus();this.sc=A.createMessageHandler();this.options=this.ca.shallowExtend(E.Fa,E.Ea);this.u=new G.pb(this.elementId,this.cetSessionFactory,this.ca);this.fb=!1;this.wa.plug(this.u.getMetadataStream().map((a)=>Object.assign({kind:A.DocumentEventKind.Metadata},
V.EditorControllerModule.pluginMetaDataFromNativeMetadata(a))))}extendWithOptions(a,b){this.Mb();this.options=this.ca.shallowExtend(this.options,a);this.oa=b}ec(a,b,c,e,d,h){if(!this.ab){this.ab=!0;const k=this.jb.toProperty();k.onValue(()=>{});const g=this.wa.toProperty();g.onValue(()=>{});const f="desktop"===this.options.externalServiceType;c=S.createDialogController(b,this.v,c,f);this.ia=A.createPluginSession(a,b,b,e.controller,this.v,this.v,b,c,c,()=>{null!=this.i&&this.i.uiChanged()},this.v,
f,d.filter((a)=>0<=a.actions.indexOf(ka.ShortcutAction.CUSTOM)).map((a)=>a.event),S.createKeyboardEventMatcher(ja.PreziUAParser.isMac()),this.sc,this.options.userId,k,g,{hostName:this.options.hostName,isProduction:Q.Utils.isPreziComRequest(this.options.hostName)},(a)=>{switch(a){case A.ExportFormat.pdf:this.v.reportPdfExportInitialized();break;default:Q.Utils.assertNever(a)}},h);K.Ia.cb(this.ia.applicationController);b=document.createElement("div");document.body.appendChild(b);A.initPreloadedUI(b,
this.ia.applicationController,a,e)}}Ec(){this.ia.applicationController.resetPreloadedPlugins();this.zc=K.Ia.cb(this.ia.applicationController)}integration_test_preloadedPluginsRegistered(){return this.zc}integration_test_overrideAudioPlayer(a){this.u.integration_test_overrideAudioPlayer(a)}Nb(a,b){a=a||"";b.pptCreation&&(a=a.concat(",prezioption-pptcreate"));return a}Pb(a){return a.userCanEdit||a.userCanComment?a.startInPresentMode||!a.userCanEdit?{kind:n.EditorMode.playback,showTopmenu:!0,linkClickedFlow:!1,
presenterNotesFlow:!1}:{kind:n.EditorMode.edit,editingKind:u.EditingKind.normal}:{kind:n.EditorMode.view}}initEditor(){var a=this.Nb(this.options.featureList,this.options);x.initFeatureSwitcher(this.options.abtestVariants,a,(new URL(window.location.href)).searchParams.get("feature_preview")||"");P.I18n.init(this.options.language||"en");a=this.Pb(this.options);const b=d.DataServiceModule.createDeviceSettings(this.options.userId);var c=b.getInteractionMode();c=ma.EditorStoreModule.createEditorStore(a,
this.options.userCanEdit,this.options.userCanComment,this.options.userCanPresent,c);c.addInteractionModeStream(b.getInteractionModeStream());const e=S.createVisibleElementsController(c);try{this.u.zb()}catch(F){this.fb=!0;this.u.tc(this.options,F.message);return}this.v=this.u.Gb(this.options);const k=q.Bacon.newBus(),h=q.Bacon.newBus(),g=qa.createSpotlight();this.ec(c,e,k,g,h,b);a=this.u.init(a,c,e,(a)=>{this.Gc(a)},this.ia,this.v,g,k,h,b);this.o=a.o;this.f=a.f;this.fa=a.fa;this.i=a.i;this.dc(this.v);
this.Na=a.Na;this.la=a.la;this.playerUI=a.playerUI;this.Aa=a.Aa;this.logger=a.logger}Gc(a){this.i.startEditing(a)}hb(a){if(a){this.logger.info({action:"create",object:"new_prezi_from_template",trigger:"machine",payload:{templateId:a}});var b=sa.TemplateServiceModule.createTemplateService(this.v);N.CetModelEditor.loadTemplateData(b,{templateId:a,themeId:null}).then((b)=>{b=this.updateTemplateInfo(b,a);b=this.createPrezi(b);b.onValue((b)=>{this.logger.info({action:"created",object:"new_prezi_from_template",
trigger:"machine",payload:{_type:"debug",templateId:a,success:b}})});b.onError((a)=>{(null===a||void 0===a?void 0:a.message)===ia.CreationLimitReachedError&&(a=(new URL(window.location.href)).searchParams,window.location.href="/p/create-prezi/"+(a.has("editor_loader")?`?${"editor_loader"}=${a.get("editor_loader")}`:""))})})}else this.logger.info({action:"missing_template_or_theme",object:"new_prezi_from_template",trigger:"machine",payload:{_type:"debug",templateId:a}})}updateTemplateInfo(a,b){a=ea.DOM.createLocalSessionWithCorrection(a,
()=>{}).getPrezi();let c=a.getTypedTemplateInfo();c.updateBaseId(b);c.updateThemeId("not-used");return a.freeze()}startApplication(){return da(this,void 0,void 0,function*(){this.fb||(this.u.loadTimerEnd(m.LoadEvent.AppInit,this.u.editorMode),this.u.loadTimerStart(m.LoadEvent.RendererInit),yield this.o.getSceneRender().getRenderer().getIsReady(),this.u.loadTimerEnd(m.LoadEvent.RendererInit,this.u.editorMode),this.options.isFollower?this.i.startMeeting():this.options.createNew?this.options.fromTemplate?
this.hb(this.options.fromTemplate.templateId):this.options.pptCreation?this.hb("ppt_20_min_w48"):(null!=this.oa&&(this.oa.setTemplatePreviewCetController(this.i.getTemplatePreviewCetController()),this.oa.setStartEditingController(this.i.getStartEditingController()),this.oa.setPushNotificationController(V.EditorControllerModule.createPushNotificationController(d.DataServiceModule.createUserSettingsStore(this.v)))),this.Jc()):null!=this.options.preziId&&(this.u.loadTimerStart(m.LoadEvent.Document),
this.f.getPreziLoader().loadPrezi(this.o,this.options.preziId)),this.la.sendEvent(d.PreziLoaderEventType.EditorInit,40))})}getSelectTemplateStream(){return this.pa}createPrezi(a,b,c=!0){const e=q.Bacon.newBus(),d=b&&b.title||P.I18n.ts("Untitled presentation");b=b&&b["private"];this.wa.push({kind:A.DocumentEventKind.Create,templateInfo:N.CetModelEditor.readTemplateInfo(a)});this.f.getPreziCreator().createPrezi(this.o,d,"",a,this.getSchemaVersion(),b).onValue((a)=>{a.kind!==g.CetPreziCreatorResultKind.success?
(this.Aa.push({errorCase:r.EditorErrorCase.PREZI_CREATION_FAILED,unclosable:!1}),a.kind===g.CetPreziCreatorResultKind.creationLimitReached&&e.error({message:ia.CreationLimitReachedError})):(this.u.loadTimerStart(m.LoadEvent.Assets),this.v.updatePreziIdInUrl(a.metadata.oid),this.u.Za(a.metadata,this.i),this.i.getBasicEditController().forceSaveAndGetStorageProperties(),c&&this.activateEditMode());e.push(a.kind===g.CetPreziCreatorResultKind.success)});return e}Jc(){this.pa=q.Bacon.newBus();this.logger.info({action:"created",
object:"new_prezi",trigger:"machine"});this.i.startTemplateChooser((a,b)=>{this.pa.plug(this.createPrezi(a,b));return this.pa})}getSchemaVersion(){return t.j.ob}getPlayer(){return this.playerUI}getEditor(){return this.i}getLoadingProgress(){return this.la.ya}getStepCount(){return this.getPlayer().getPlayback()?this.getPlayer().getPlayback().getStepCount():-1}resetToEditorForTest(){return da(this,void 0,void 0,function*(){this.o.getMainStage().resetForTest();const a=this.i.getEditScene();null!=a&&
(a.requestCommitForTest(),this.u.ra(this.o,this.i,this.playerUI));this.Ec();yield this.getEditor().reset();yield this.load();this.u.ra(this.o,this.i,this.playerUI)})}load(){this.f.getPreziLoader().loadPrezi(this.o,this.options.preziId);return new Promise((a)=>{this.f.getPreziLoader().getLoaderStream().filter((a)=>a.type===d.PreziLoaderEventType.PreziLoaded).onValue(()=>a())})}resetToTemplateChooserForTest(){this.getEditor().reset({kind:n.EditorMode.templateChooser})}getTemplatePreviewHelper(){return this.i.getTemplatePreviewCetController().getTestHelper()}integration_test_getTextEntityText(a){return f.CetModel.textKludge.getRawText(this.i.getEditScene().getEntityById(a))}integration_test_setTextEntityText(a,
b){this.i.integration_test_getZObjectEditor().executeApiCommand({name:"setTextForTestCmd",run:(c)=>{c=c.lookup.text(a);c.wrapWidth=400;c.setText(b)}})}getPreziDataClientForTest(){return this.v}activateEditMode(){this.fa.push({newMode:n.EditorMode.edit,trigger:"prezipage"})}activatePresentMode(){this.fa.push(this.options.userCanEdit||this.options.userCanComment?{newMode:n.EditorMode.playback,trigger:"prezipage",shouldGoFullscreen:!1,shouldSeekPathToStart:!1,showTopmenu:!0,linkClickedFlow:!1,presenterNotesFlow:!1}:
{newMode:n.EditorMode.view,trigger:"prezipage"});this.playerUI.getPlayback().initPosition(!1);this.pc()}activateInfoMode(){this.fa.push({newMode:n.EditorMode.info,trigger:"prezipage"})}printHierarchy(a,b){x.isActive("js-developer-features")&&this.i.printHierarchy(a,b)}getSteps(){const a=this.getPlayer().getPathNavigator().getPath(),b=a.getStartPoint();return a.getAllPathPositions().filter((a)=>!a.isBefore(b))}getThumbnailForTest(a,b){return da(this,void 0,void 0,function*(){if(!x.isActive("js-developer-features"))throw"";
const c=this.getSteps();for(let k=0;k<c.length;k++){const l=(new Date).getTime();var e=c[k],d=this.playerUI.getPlayback().getScene();const m=this.playerUI.getPathNavigator().getPath();var h=na.PlaybackModule.createVisibilityFilter(d,m.getTargetForStep(e.getStep()),!0,e),f=this.o.getMainStage();e=m.getTargetForPathPosition(e);d=g.Cet.getViewportWorldIfFocusedOnEntity(d.getEntityById(e),d,this.playerUI.getCamera());f=(yield f.createSnapshotCanvas(d,{width:a,height:9*a/16},!0,h,!0,()=>!0)).canvas;h=
(new Date).getTime();d=`0000${k}`;yield this.Hc(f,`${b}/${d.substr(d.length-4)}.png`);f=(new Date).getTime();console.error(`Time ${k}: thumbnail: ${h-l}ms + send: ${f-h}ms = ${f-l}ms`)}})}Hc(a,b){return new Promise((c)=>{const e=a.toDataURL();a.width=0;const d=new XMLHttpRequest;d.onreadystatechange=function(){4===d.readyState&&200===d.status&&c()};d.open("POST","/save_data_url/",!0);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send("data="+encodeURIComponent(e)+"&path="+
encodeURIComponent(b))})}pc(){this.logger.info({action:"activated",object:"present_mode",trigger:"prezipage",track_insights:{event:X.InsighstEvent.STARTED,current_step_number:0}})}Mb(){this.options.startInPresentMode=this.options.startInPresentMode||/^#present$/.test(window.location.hash);this.options.deepLinkRoute=this.options.deepLinkRoute||window.parent.location.hash.substr(1);this.Bc()}Bc(){window.history.pushState("",this.Lb(),window.location.pathname+window.location.search)}Lb(){return document.title.replace(/&/g,
"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}dc(a){a=d.DataServiceModule.createUserSettingsStore(a);this.jb.plug(a.getAllUserSettingsStream().map((a)=>({JS_PATH_STEP_ANIMATION_ONBOARDING_SHOWN:a.boolean_settings[d.UserSettingBooleanKeys.JS_PATH_STEP_ANIMATION_ONBOARDING_SHOWN],REMOTE_PRESENTATION_ONBOARDING_SHOWN:a.boolean_settings[d.UserSettingBooleanKeys.REMOTE_PRESENTATION_ONBOARDING_SHOWN],CONCEPT_ONBOARDING_SHOWN:a.boolean_settings[d.UserSettingBooleanKeys.CONCEPT_ONBOARDING_SHOWN],
MULTI_PRODUCT_FORCE_SHOW_PITCH_ONBOARDING:a.boolean_settings[d.UserSettingBooleanKeys.MULTI_PRODUCT_FORCE_SHOW_PITCH_ONBOARDING],MULTI_PRODUCT_PITCH_ONBOARDING_SHOWN:a.boolean_settings[d.UserSettingBooleanKeys.MULTI_PRODUCT_PITCH_ONBOARDING_SHOWN],AUDIO_ONBOARDING_UPLOAD_SHOWN:a.boolean_settings[d.UserSettingBooleanKeys.AUDIO_ONBOARDING_UPLOAD_SHOWN],AUDIO_ONBOARDING_PLAY_SHOWN:a.boolean_settings[d.UserSettingBooleanKeys.AUDIO_ONBOARDING_PLAY_SHOWN],AUDIO_ONBOARDING_MUTE_SHOWN:a.boolean_settings[d.UserSettingBooleanKeys.AUDIO_ONBOARDING_MUTE_SHOWN],
AUDIO_ONBOARDING_PRESENT_SHOWN:a.boolean_settings[d.UserSettingBooleanKeys.AUDIO_ONBOARDING_PRESENT_SHOWN],EDITOR_SEEN:a.boolean_settings[d.UserSettingBooleanKeys.EDITOR_SEEN],BROWSER_NOTIFICATION_PERMISSION_DENIED:a.boolean_settings[d.UserSettingBooleanKeys.BROWSER_NOTIFICATION_PERMISSION_DENIED],JS_EDITOR_PPT_ONBOARDING:a.boolean_settings[d.UserSettingBooleanKeys.JS_EDITOR_PPT_ONBOARDING],STORYBLOCKS_TOPIC_ONBOARDING_SHOWN:a.boolean_settings[d.UserSettingBooleanKeys.STORYBLOCKS_TOPIC_ONBOARDING_SHOWN],
MY_LIBRARY_FAVORITES_ONBOARDING_SHOWN:a.boolean_settings[d.UserSettingBooleanKeys.MY_LIBRARY_FAVORITES_ONBOARDING_SHOWN],registration_date:a.registration_date,desktop_full:a.desktop_full})))}};t.j.qb="landing_page";t.j.nb="edit";t.j.ob="2";t.j.lb="/p/create-prezi/";t.j.Da="//prezi.com";t.j.wb={appSource:n.AppSource.LANDING_PAGE,userCanEdit:!1,userCanComment:!1,createPreziUrl:t.j.lb,hostName:t.j.Da,useFallbackStorageServices:!0,enableOfflineEditing:!1};t.j.mb={appSource:n.AppSource.EDIT_PAGE,hostName:t.j.Da};
var L={};Object.defineProperty(L,"__esModule",{value:!0});(function(a){a.createEditorInit=function(a,c){return new t.j(a,c)};a.main=function(a,c){window.preziEditorInitVersion=l.getModuleVersion();let b;$("#prezi-viewer").length?(b=new t.j("prezi-viewer",()=>N.CetModelEditor.cetSessionFactory()),b.extendWithOptions(t.j.wb)):(b=new t.j("prezi-player",()=>N.CetModelEditor.cetSessionFactory()),b.extendWithOptions(t.j.mb));b.extendWithOptions(a,c);b.initEditor();window.preziPlayerJS=b;b.startApplication()};
a.getDefaultPreziOptions=function(){return E.Fa};a.getDefaultPlayerOptions=function(){return E.Ea}})(L.EditorInitModule||(L.EditorInitModule={}));return L});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_editor_init",["require","jqueryUi","prezi.engine.dom","prezi_app_utils","prezi_bacon","prezi_canvas_listener","prezi_cet","prezi_cet_model","prezi_cet_model_editor","prezi_cet_renderer","prezi_client_player","prezi_coeditui","prezi_editor_controller","prezi_editor_error","prezi_editor_store_common","prezi_editor_store_mode","prezi_editor_store_ui","prezi_editor_ui","prezi_error_page","prezi_externalserviceprovider","prezi_featureswitcher","prezi_i18n","prezi_insights","prezi_logger","prezi_meeting","prezi_nativeapitypes","prezi_playback","prezi_plugin_api","prezi_plugin_meta","prezi_service_data","prezi_service_media","prezi_sound_playback","prezi_spotlight","prezi_support","prezi_templatechooser","prezi_templateservice","prezi_textmodel","prezi_thumbnail_render","prezi_uaparser","prezi_utils"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_editor_init.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1).concat([function(){return new Promise(function(resolve,reject){require(["prezi_check_webgl"],function(m){resolve(m.lazyModule);},function(err){reject(err);});});},function(){return new Promise(function(resolve,reject){require(["prezi_ppt_preload"],function(m){resolve(m.lazyModule);},function(err){reject(err);});});},function(){return new Promise(function(resolve,reject){require(["prezi_test_preload"],function(m){resolve(m.lazyModule);},function(err){reject(err);});});}]));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("jqueryUi"),require("prezi.engine.dom"),require("prezi_app_utils"),require("prezi_bacon"),require("prezi_canvas_listener"),require("prezi_cet"),require("prezi_cet_model"),require("prezi_cet_model_editor"),require("prezi_cet_renderer"),require("prezi_client_player"),require("prezi_coeditui"),require("prezi_editor_controller"),require("prezi_editor_error"),require("prezi_editor_store_common"),require("prezi_editor_store_mode"),require("prezi_editor_store_ui"),require("prezi_editor_ui"),require("prezi_error_page"),require("prezi_externalserviceprovider"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_insights"),require("prezi_logger"),require("prezi_meeting"),require("prezi_nativeapitypes"),require("prezi_playback"),require("prezi_plugin_api"),require("prezi_plugin_meta"),require("prezi_service_data"),require("prezi_service_media"),require("prezi_sound_playback"),require("prezi_spotlight"),require("prezi_support"),require("prezi_templatechooser"),require("prezi_templateservice"),require("prezi_textmodel"),require("prezi_thumbnail_render"),require("prezi_uaparser"),require("prezi_utils"),function(){return Promise.resolve(require("prezi_check_webgl").lazyModule);},function(){return Promise.resolve(require("prezi_ppt_preload").lazyModule);},function(){return Promise.resolve(require("prezi_test_preload").lazyModule);});}else{this["prezi_editor_init"]=__factory(jqueryUi,this["prezi.engine.dom"],this["prezi_app_utils"],this["prezi_bacon"],this["prezi_canvas_listener"],this["prezi_cet"],this["prezi_cet_model"],this["prezi_cet_model_editor"],this["prezi_cet_renderer"],this["prezi_client_player"],this["prezi_coeditui"],this["prezi_editor_controller"],this["prezi_editor_error"],this["prezi_editor_store_common"],this["prezi_editor_store_mode"],this["prezi_editor_store_ui"],this["prezi_editor_ui"],this["prezi_error_page"],this["prezi_externalserviceprovider"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_insights"],this["prezi_logger"],this["prezi_meeting"],this["prezi_nativeapitypes"],this["prezi_playback"],this["prezi_plugin_api"],this["prezi_plugin_meta"],this["prezi_service_data"],this["prezi_service_media"],this["prezi_sound_playback"],this["prezi_spotlight"],this["prezi_support"],this["prezi_templatechooser"],this["prezi_templateservice"],this["prezi_textmodel"],this["prezi_thumbnail_render"],this["prezi_uaparser"],this["prezi_utils"],function(){return Promise.resolve(this["prezi_check_webgl"].lazyModule);},function(){return Promise.resolve(this["prezi_ppt_preload"].lazyModule);},function(){return Promise.resolve(this["prezi_test_preload"].lazyModule);});}}).call(this);