;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_editor_store_common";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi.geometry":dependencies[0],"prezi_app_utils":dependencies[1],"prezi_bacon":dependencies[2],"prezi_cet":dependencies[3],"prezi_editor_store_audio":dependencies[4],"prezi_editor_store_contextmenu":dependencies[5],"prezi_editor_store_document":dependencies[6],"prezi_editor_store_focus":dependencies[7],"prezi_editor_store_meeting":dependencies[8],"prezi_editor_store_mode":dependencies[9],"prezi_editor_store_object":dependencies[10],"prezi_editor_store_save":dependencies[11],"prezi_editor_store_support":dependencies[12],"prezi_editor_store_text":dependencies[13],"prezi_editor_store_ui":dependencies[14],"prezi_externalserviceprovider":dependencies[15],"prezi_featureswitcher":dependencies[16],"prezi_logger":dependencies[17],"prezi_nativeapitypes":dependencies[18],"prezi_service_data":dependencies[19],"prezi_textmodel":dependencies[20],"prezi_utils":dependencies[21]}};})());};})(arguments);var moduleImpl=(function(){return module(function(e){function c(a){const b=k.Bacon.newBus();b.onValue(a);return b}var d=e.dependencies.prezi_app_utils,k=e.dependencies.prezi_bacon,f=e.dependencies.prezi_editor_store_focus,l=e.dependencies.prezi_editor_store_meeting,g=e.dependencies.prezi_editor_store_mode,r=e.dependencies.prezi_editor_store_object,u=e.dependencies.prezi_editor_store_support,v=e.dependencies.prezi_editor_store_text,m=e.dependencies.prezi_editor_store_ui,t=e.dependencies.prezi_externalserviceprovider,n=e.dependencies.prezi_logger,
w=e.dependencies.prezi_nativeapitypes,x=e.dependencies.prezi_service_data,h=e.dependencies.prezi_utils,p={};Object.defineProperty(p,"__esModule",{value:!0});p.$=class{constructor(a,b,q,e,h){this.O=k.Bacon.newBus();this.f={mode:{kind:d.EditorMode.edit,editingKind:g.EditingKind.normal},selectionInfo:r.emptySelectionInfo(),canvasHoveredEntityIds:null,uiHoveredEntityIds:null,canvasEditedEntityIds:[],openedPopupId_KILLME:null,openedSidebarId:null,isStorylineVisible:!0,openDialogProps:{kind:m.DialogKind.None},
textSelectionState:v.createEmptyTextSelectionState(),componentFocusMode:f.ComponentFocusModeKind.none,isUndoable:!1,isRedoable:!1,saveState:w.SaveState.saved,contextMenuState:null,contextMenuRequest:null,selectionSource:null,currentTopic:null,currentTopicNavigationType:null,followerState:{status:l.FollowerStatus.MeetingLoading,connection:l.ConnectionStatus.Default},presenterState:{status:l.PresenterStatus.Initial,connection:l.ConnectionStatus.Default,isEndPopupOpen:!1,followerCount:0},isFollower:!1,
userHasEditRights:!1,userHasCommentRights:!1,userHasPresentRights:!0,isFullscreen:!1,isOnboarding:!1,coverEditMode:null,commentingStateVersion:null,coeditStatus:g.CoeditStatus.uninitialized,coeditOfflineOnlineSwitchStatus:{kind:"NoSyncInProgress"},networkStatus:0,metadata:{_PreziMetadata_:void 0,oid:"0",title:"Untitled presentation",logo_type:t.PreziLogoType.DocumentBased,owner_id:0,copyright:0},saveAvailabilityStatus:g.SaveAvailabilityStatus.enabled,isEditingSessionClosed:!1,shownOnboardingStep:null,
propertyBarProps:{objectProps:[],structureType:null},supportWidgetState:{activeView:{id:u.SupportWidgetViews.OVERVIEW},isActive:!1,steps:[],topics:[],isVisible:!0},isBgUploadInProgress:!1,draggedEntityHoveredTopicId:null,audioState:null,navbarFullyVisible:!1,globalException:null,spellcheckStatus:"NOT_FUNCTIONAL",templateData:{templateId:null,themeId:null},isTopicZoomAreaEditEnabled:!1,codeSnippetEditorOpen:!1,userLicenseInformation:{userId:null,organizationId:null,isAdmin:!1,admins:[],featureSet:{analyticsEnabled:!1,
editChart:!0,isDefaultLicense:!0,isTeam:!1,licenseTypeOid:"",pitchAudio:!1,pitchBackgroundImageIntegration:!1,pitchComment:!0,pitchCreate:!0,pitchCustomSchemes:!1,pitchExtraStoryblocks:!1,pitchIconIntegration:!1,pitchImageIntegration:!1,pitchPrivacyPrivate:!1,pitchDesktop:!1,pitchPdfExport:!1,presenterView:!1,remotePresent:!0,unlimitedViewlinks:!1,videoUpload:!0,ownPreziLogo:!1,noWatermark:!1,customLogo:!1,isPaidLicense:!1,hasCoreLicense:!1,brandKit:!1}},logoType:t.PreziLogoType.Watermark,navigationEvent:null,
featurePreviewModeWithSaveDisabled:!1,interactionMode:{kind:x.InteractionKind.mouse,autoSwitchEnabled:!1},gridEnabled:!1,selectionAABBOnScreen:null,panModeEnabled:!1,panModeForced:!1};this.pa="followerState supportWidgetState isFullscreen isOnboarding coeditStatus networkStatus featurePreviewModeWithSaveDisabled openDialogProps logoType metadata gridEnabled".split(" ");this.v=!1;this.logger=n.LoggerModule.createPreLogger("EditorStoreImpl");this.f.mode=a;this.f.userHasEditRights=b;this.f.userHasCommentRights=
q;this.f.userHasPresentRights=e;this.f.interactionMode=h;this.N();this.U=k.Bacon.newBus();this.w=k.Bacon.newBus();this.L=k.Bacon.newBus();this.M=k.Bacon.newBus();this.Bb=this.U.toProperty(this.state);this.na=this.w.toProperty({state:this.state,rogueUIProps_killme:{}});this.ea=c((a)=>this.da(a));this.ma=c((a)=>this.Ya(a));this.la=c((a)=>this.ba(a));this.ca=c((a)=>this.Za(a));this.ta=c((a)=>this.setInteractionMode(a));this.Ma=c((a)=>this.setOpenSidebarId(a));this.La=c((a)=>this.setOpenedDialogProps(a));
this.Fb=c((a)=>this.wb(a));this.Pa=c((a)=>this.pb(a));this.ia=c((a)=>this.oa(a));this.Sa=c((a)=>this.setSaveState(a));this.Ea=c((a)=>this.jb(a));this.Da=c((a)=>this.ib(a));this.ka=c((a)=>this.Xa(a));this.ja=c((a)=>this.Wa(a));this.ra=c((a)=>this.bb(a));this.Oa=c((a)=>this.ob(a));this.za=c((a)=>this.gb(a));this.Gb=c((a)=>this.xb(a));this.Aa=c((a)=>this.cb(a));this.Ca=c((a)=>this.hb(a));this.ha=c((a)=>this.Va(a));this.ga=c((a)=>this.nb(a));this.qa=c((a)=>this.ab(a));this.Ka=c((a)=>this.mb(a));this.Ra=
c((a)=>this.qb(a));this.xa=c((a)=>this.$a(a));this.zb=c((a)=>this.rb(a));this.Cb=c((a)=>this.tb(a));this.Db=c((a)=>this.ub(a));this.ua=c((a)=>this.fb(a));this.aa=c((a)=>this.Ta(a));this.Ia=c((a)=>this.kb(a));this.sa=c((a)=>this.eb(a));this.Ab=c((a)=>this.sb(a));this.Eb=c((a)=>this.vb(a));this.Hb=c((a)=>this.yb(a));this.Ha=c((a)=>this.setLogo(a));this.fa=c((a)=>this.Ua(a));this.Ja=c((a)=>this.lb(a));this.Na=c((a)=>this.setPanModeEnabled(a,!0));this.m=null;this.j=!1;this.i=[]}reset(){this.N();this.u()}N(){const a=
{};for(let b in this.f)this.f.hasOwnProperty(b)&&(-1!==this.pa.indexOf(b)&&this.state&&this.state.hasOwnProperty(b)?a[b]=this.state[b]:a[b]=this.f[b]);this.state=a}addComponentFocusStream(a){this.ia.plug(a)}addChangeModeActionStream(a){this.ea.plug(a)}addCurrentTopicActionStream(a){this.ma.plug(a)}addCoverEditModeStream(a){this.la.plug(a)}addChangeEditingKindStream(a){this.ca.plug(a)}addSaveStateActionStream(a){this.Sa.plug(a)}addIsUndoableActionStream(a){this.Ea.plug(a)}addIsRedoableActionStream(a){this.Da.plug(a)}addRecalculateEntityUnderMouseActionStream(a){this.M.plug(a)}getRecalculateEntityUnderMouseActionStream(){return this.M}addTextSelectionStateStream(a){this.Fb.plug(a)}addPropertyBarPropsStream(a){this.Pa.plug(a)}getPropertyBarPropsStream(){return this.getStateStream().map((a)=>
a.propertyBarProps)}addHighlightEntitiesOnDragSelectActionStream(a){this.L.plug(a)}getHighlightEntitiesOnDragSelectActionStream(){return this.L}wb(a){if(null==a)throw Error("textSelectionState should not be null");this.state.textSelectionState.equals(a)||(this.state.textSelectionState=a,(a=null!=a&&a.isSingleSelection())&&this.state.componentFocusMode===f.ComponentFocusModeKind.none?this.state.componentFocusMode=f.ComponentFocusModeKind.textEditor:a||this.state.componentFocusMode!==f.ComponentFocusModeKind.textEditor||
(this.state.componentFocusMode=f.ComponentFocusModeKind.none),this.pushState())}pb(a){null==a&&(a={objectProps:[],structureType:null});this.state.propertyBarProps.objectProps.length===a.objectProps.length&&h.Utils.arrayEquals(a.objectProps,this.state.propertyBarProps.objectProps)||(this.state.propertyBarProps=a,this.pushState())}getTextSelectionStateStream(){return this.getStateStream().map((a)=>a.textSelectionState).skipDuplicates()}getTextSelectionState(){return this.state.textSelectionState}addChangeContextMenuStateStream(a){this.ka.plug(a)}addContextMenuRequestStream(a){this.ja.plug(a)}getContextMenuStream(){return this.getStateStream().map((a)=>
a.contextMenuState).skipDuplicates()}getContextMenuRequestStream(){return this.getStateStream().map((a)=>a.contextMenuRequest).skipDuplicates()}Xa(a){if(null===this.state.contextMenuState&&null!==a||!this.state.contextMenuState.equals(a))this.state.contextMenuState=a,this.pushState()}Wa(a){if(null===this.state.contextMenuRequest&&null!==a||this.state.contextMenuRequest.entityIds!==a.entityIds)this.state.contextMenuRequest=a,this.pushState()}oa(a){let b=this.state.componentFocusMode;switch(a){case f.ComponentFocusActionKind.exitAll:b=
f.ComponentFocusModeKind.none;break;case f.ComponentFocusActionKind.enterCanvas:b=f.ComponentFocusModeKind.canvas;break;case f.ComponentFocusActionKind.enterUi:b=f.ComponentFocusModeKind.ui;break;case f.ComponentFocusActionKind.enterUiInput:b=f.ComponentFocusModeKind.uiInput;break;case f.ComponentFocusActionKind.enterTextEditor:b=f.ComponentFocusModeKind.textEditor;break;case f.ComponentFocusActionKind.canvasInteracted:b=this.state.componentFocusMode===f.ComponentFocusModeKind.textEditor?f.ComponentFocusModeKind.textEditor:
f.ComponentFocusModeKind.none;break;default:h.Utils.assertNever(a)}this.state.componentFocusMode!==b&&(this.state.componentFocusMode=b,this.pushState())}getComponentFocusStream(){return this.getStateStream().map((a)=>a.componentFocusMode).skipDuplicates()}getSaveStateStream(){return this.getStateStream().map((a)=>a.saveState).skipDuplicates()}getIsUndoableStream(){return this.getStateStream().map((a)=>a.isUndoable).skipDuplicates()}getIsRedoableStream(){return this.getStateStream().map((a)=>a.isRedoable).skipDuplicates()}setOpenedPopupId_KILLME(a){this.state.openedPopupId_KILLME!==
a&&(this.state.openedPopupId_KILLME=a,this.pushState())}getOpenedPopupIdStream(){return this.getStateStream().map((a)=>a.openedPopupId_KILLME).skipDuplicates()}getDeferredOpenedPopupIdStream(){return this.getDeferredStateStream().map((a)=>a.state.openedPopupId_KILLME).skipDuplicates()}addOpenSidebarIdStream(a){this.Ma.plug(a)}setOpenSidebarId(a){"koi-sidebar-animations"!==a&&this.state.openedSidebarId!==a&&(this.state.openedSidebarId=a,this.pushState())}getOpenedSidebarIdStream(){return this.getStateStream().map((a)=>
a.openedSidebarId).skipDuplicates()}addOpenedDialogPropsStream(a){this.La.plug(a)}setOpenedDialogProps(a){null==a&&(a={kind:m.DialogKind.None});m.dialogPropsEq(this.state.openDialogProps,a)||(this.state.openDialogProps=a,this.pushState())}getOpenedDialogPropsStream(){return this.getStateStream().map((a)=>a.openDialogProps).skipDuplicates()}addFollowerStateStream(a){return this.ra.plug(a)}addPresenterStateStream(a){return this.Oa.plug(a)}geFollowerStateStream(){return this.getStateStream().map((a)=>
a.followerState).skipDuplicates()}getPresenterStateStream(){return this.getStateStream().map((a)=>a.presenterState).skipDuplicates()}getIsFollowerStream(){return this.getStateStream().map((a)=>a.isFollower).skipDuplicates()}addIsFollowerStream(a){this.za.plug(a)}getIsStorylineVisibleStream(){return this.getStateStream().map((a)=>a.isStorylineVisible).skipDuplicates()}setStorylineVisible(a){this.state.isStorylineVisible=a;this.pushState()}isStorylineVisible(){return this.state.isStorylineVisible}gb(a){this.state.isFollower=
a;this.pushState()}bb(a){this.state.followerState=a;this.pushState()}getUserHasEditRightsStream(){return this.getStateStream().map((a)=>a.userHasEditRights).skipDuplicates()}addUserHasEditRightsStream(a){this.Gb.plug(a)}xb(a){this.state.userHasEditRights=a;this.pushState()}getUserHasCommentRightsStream(){return this.getStateStream().map((a)=>a.userHasCommentRights).skipDuplicates()}getSaveAvailabilityStatusStream(){return this.getStateStream().map((a)=>a.saveAvailabilityStatus).skipDuplicates()}addSaveAvailabilityStatusStream(a){this.Ra.plug(a)}qb(a){this.state.saveAvailabilityStatus=
a;this.pushState()}getNetworkStatusStream(){return this.getStateStream().map((a)=>a.networkStatus).skipDuplicates()}getDeferredNetworkStatusStream(){return this.getDeferredStateStream().map((a)=>a.state.networkStatus).skipDuplicates()}getDeferredPanModeStream(){return this.getDeferredStateStream().map((a)=>a.state.panModeEnabled).skipDuplicates()}getNavigationEventStream(){return this.getStateStream().map((a)=>a.navigationEvent).filter((a)=>null!=a).skipDuplicates()}addNavigationEventStream(a){this.Ja.plug(a)}addPanModeFromKeyboardEventBus(a){this.Na.plug(a)}lb(a){this.state.navigationEvent=
a;this.pushState()}getDeferredNavigationEventStream(){return this.getDeferredStateStream().map((a)=>a.state.navigationEvent).filter((a)=>null!=a).skipDuplicates()}addNetworkStatusStream(a){this.Ka.plug(a)}mb(a){this.state.networkStatus=a;this.pushState()}setMetadata(a){this.state.metadata=a;this.pushState()}getMetadataStream(){return this.getStateStream().map((a)=>a.metadata).skipDuplicates()}getCoeditStatusStream(){return this.getStateStream().map((a)=>a.coeditStatus).skipDuplicates()}addCoeditStatusStream(a){this.ha.plug(a)}Va(a){this.state.coeditStatus=
a;this.pushState()}addFeaturePreviewModeWithSaveDisabledStream(a){this.qa.plug(a)}getFeaturePreviewModeWithSaveDisabledStream(){return this.getStateStream().map((a)=>a.featurePreviewModeWithSaveDisabled).skipDuplicates()}addCoeditOfflineOnlineSwitchStream(a){this.ga.plug(a)}nb(a){this.state.coeditOfflineOnlineSwitchStatus=a;this.pushState()}ab(a){this.state.featurePreviewModeWithSaveDisabled=a;this.pushState()}getIsOnboardingStream(){return this.getStateStream().map((a)=>a.isOnboarding).skipDuplicates()}addIsOnboardingStream(a){this.Ca.plug(a)}getIsFullscreenStream(){return this.getStateStream().map((a)=>
a.isFullscreen).skipDuplicates()}addIsFullscreenStream(a){this.Aa.plug(a)}getEditingSessionClosed(){return this.getStateStream().map((a)=>a.isEditingSessionClosed).skipDuplicates()}addEditingSessionClosedStream(a){this.xa.plug(a)}cb(a){this.state.isFullscreen=a;this.pushState()}hb(a){this.state.isOnboarding=a;this.pushState()}$a(a){this.state.isEditingSessionClosed=a;this.pushState()}fb(a){this.state.isBgUploadInProgress=a;this.pushState()}getIsBgUploadInProgressStream(){return this.getStateStream().map((a)=>
a.isBgUploadInProgress).skipDuplicates()}addIsBgUploadInProgressStream(a){this.ua.plug(a)}ob(a){this.state.presenterState={status:void 0!==a.status?a.status:this.state.presenterState.status,connection:void 0!==a.connection?a.connection:this.state.presenterState.connection,messageType:void 0!==a.messageType?a.messageType:this.state.presenterState.messageType,messageText:void 0!==a.messageText?a.messageText:this.state.presenterState.messageText,isEndPopupOpen:void 0!==a.isEndPopupOpen?a.isEndPopupOpen:
this.state.presenterState.isEndPopupOpen,followerCount:void 0!==a.followerCount?a.followerCount:this.state.presenterState.followerCount};this.pushState()}addCommentingStateChangeStream(a){a.onValue(()=>{this.state.commentingStateVersion++;this.pushState()})}da(a){if((this.state.userHasEditRights||a.newMode!==d.EditorMode.edit)&&this.state.mode.kind!==d.EditorMode.view&&!this.Ba(this.state.mode,a)){a.newMode!==d.EditorMode.edit&&(this.state.coverEditMode=null,this.state.selectionInfo=r.emptySelectionInfo());
switch(a.newMode){case d.EditorMode.playback:this.state.mode={kind:d.EditorMode.playback,showTopmenu:a.showTopmenu,linkClickedFlow:a.linkClickedFlow,presenterNotesFlow:a.presenterNotesFlow};break;case d.EditorMode.edit:this.state.mode={kind:d.EditorMode.edit,editingKind:g.EditingKind.normal};break;case d.EditorMode.animationPreview:case d.EditorMode.follow:case d.EditorMode.info:case d.EditorMode.templateChooser:case d.EditorMode.view:this.state.mode={kind:a.newMode};break;default:h.Utils.assertNever(a)}this.Ga(a);
this.pushState()}}Ba(a,b){return a.kind===d.EditorMode.playback&&b.newMode===d.EditorMode.playback?a.showTopmenu===b.showTopmenu&&a.linkClickedFlow===b.linkClickedFlow&&a.presenterNotesFlow===b.presenterNotesFlow:a.kind===b.newMode}Ya(a){if(this.state.currentTopic!==a.newCurrentTopic||this.state.currentTopicNavigationType!==a.navigationType)this.state.currentTopic=a.newCurrentTopic,this.state.currentTopicNavigationType=a.navigationType,this.pushState()}va(a,b){if(null==a&&null==b)return!0;if(null!=
b&&null==a||null==b&&null!=a)return!1;switch(a.kind){case g.CoverEditModeKind.titleEditOnly:case g.CoverEditModeKind.advanced:return a.kind===b.kind&&b.topicId===a.topicId;case g.CoverEditModeKind.insideAdvanced:return a.kind===b.kind&&b.topicOrOverviewId===a.topicOrOverviewId;default:return h.Utils.assertNever(a)}}ba(a){this.va(a,this.state.coverEditMode)||(this.state.coverEditMode=a);this.pushState()}Za(a){if(this.state.mode.kind!==d.EditorMode.edit)throw Error(`Cannot change editing kind from ${this.state.mode.kind} mode`);
this.ya(this.state.mode,a)||(this.state.mode=Object.assign({kind:d.EditorMode.edit},a),this.pushState())}ya(a,b){return a.editingKind===g.EditingKind.imageMask&&b.editingKind===g.EditingKind.imageMask?a.maskedImageId===b.maskedImageId&&a.target===b.target&&a.isFixedAspect===b.isFixedAspect:a.editingKind===g.EditingKind.drawInsert&&b.editingKind===g.EditingKind.drawInsert?!0:a.editingKind===b.editingKind}setSaveState(a){this.state.saveState!==a&&(this.state.saveState=a,this.pushState())}jb(a){this.state.isUndoable!==
a&&(this.state.isUndoable=a,this.pushState())}ib(a){this.state.isRedoable!==a&&(this.state.isRedoable=a,this.pushState())}removeCanvasHoveredEntityIds(a){if(null!=this.state.canvasHoveredEntityIds){const b=this.state.canvasHoveredEntityIds.filter((b)=>-1===a.indexOf(b));this.setCanvasHoveredEntityIds(b)}}Ga(a){let b="";switch(a.newMode){case d.EditorMode.playback:b="present_mode";break;case d.EditorMode.edit:b="edit_mode";break;case d.EditorMode.view:b="view_mode";break;case d.EditorMode.info:b="info";
break;case d.EditorMode.templateChooser:b="template_chooser_mode";break;case d.EditorMode.follow:b="follow_mode";break;case d.EditorMode.animationPreview:b="animation_preview_mode"}this.logger.info({action:"enter",object:b,trigger:a.trigger})}K(a){if(1<a.length){let b;if(null==this.state.coverEditMode)b=this.state.currentTopic;else switch(this.state.coverEditMode.kind){case g.CoverEditModeKind.advanced:case g.CoverEditModeKind.titleEditOnly:b=this.state.coverEditMode.topicId;break;case g.CoverEditModeKind.insideAdvanced:b=
this.state.coverEditMode.topicOrOverviewId;break;default:h.Utils.assertNever(this.state.coverEditMode)}return a.filter((a)=>a!==b)}return a}Fa(a){if(null==this.state.coverEditMode)return!1;switch(this.state.coverEditMode.kind){case g.CoverEditModeKind.advanced:return 1===a.length&&this.state.coverEditMode.topicId===a[0];case g.CoverEditModeKind.insideAdvanced:return 1===a.length&&this.state.coverEditMode.topicOrOverviewId===a[0];case g.CoverEditModeKind.titleEditOnly:return!1;default:return h.Utils.assertNever(this.state.coverEditMode)}}setSelection(a,
b=null){var c=!1;this.o(a.allEntityIds,this.state.selectionInfo.allEntityIds)&&this.o(a.groupIds,this.state.selectionInfo.groupIds)&&this.o(a.nonGroupedEntityIds,this.state.selectionInfo.nonGroupedEntityIds)||(this.state.selectionInfo={groupIds:a.groupIds,nonGroupedEntityIds:this.K(a.nonGroupedEntityIds),allEntityIds:this.K(a.allEntityIds)},this.setCanvasHoveredEntityIds([]),c=this.Fa(a.allEntityIds),!this.state.isTopicZoomAreaEditEnabled&&c&&n.avro.Avro.createDefaultLogger().logEditTopicZoomArea({object_id:a.allEntityIds[0]}),
this.state.isTopicZoomAreaEditEnabled=c,this.state.mode.kind===d.EditorMode.edit&&(this.state.mode={kind:d.EditorMode.edit,editingKind:g.EditingKind.normal}),c=!0);b!==this.state.selectionSource&&(this.state.selectionSource=b,c=!0);c&&this.pushState()}getSelection(){return this.state.selectionInfo}getSelectionSource(){return this.state.selectionSource}o(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}setCanvasHoveredEntityIds(a){h.Utils.arrayEquals(this.state.canvasHoveredEntityIds,
a)||(this.state.canvasHoveredEntityIds=a,this.pushState())}setUiHoveredEntityIds(a){h.Utils.arrayEquals(this.state.uiHoveredEntityIds,a)||(this.state.uiHoveredEntityIds=a,this.pushState())}setDraggedEntityHoveredTopicId(a){a!==this.state.draggedEntityHoveredTopicId&&(this.state.draggedEntityHoveredTopicId=a,this.pushState())}setCanvasEditedEntities(a){h.Utils.arrayEquals(this.state.canvasEditedEntityIds,a)||(this.state.canvasEditedEntityIds=a,this.pushState())}setTopicZoomAreaEditEnabled(a){this.state.isTopicZoomAreaEditEnabled!==
a&&(this.state.isTopicZoomAreaEditEnabled=a,this.pushState())}getIsTopicZoomAreaEditEnabledStream(){return this.getStateStream().map((a)=>a.isTopicZoomAreaEditEnabled).skipDuplicates()}setGridEnabled(a){this.state.gridEnabled!==a&&(this.state.gridEnabled=a,this.pushState())}getIsGridEnabledStream(){return this.getStateStream().map((a)=>a.gridEnabled).skipDuplicates()}setSelectionAABBOnScreen(a){(null==a?null==this.state.selectionAABBOnScreen:null!=this.state.selectionAABBOnScreen&&a.equals(this.state.selectionAABBOnScreen))||
(this.state.selectionAABBOnScreen=a,this.pushState())}getPresenterState(){return this.state.presenterState}getStateStream(){return this.Bb}getDeferredStateStream(){return this.na}getModeStream(){return this.getStateStream().map((a)=>a.mode).skipDuplicates()}getDeferredModeStream(){return this.getDeferredStateStream().map((a)=>a.state.mode).skipDuplicates()}getCurrentTopicStream(){return this.getStateStream().map((a)=>a.currentTopic).skipDuplicates()}getDeferredCurrentTopicStream(){return this.getDeferredStateStream().map((a)=>
a.state.currentTopic).skipDuplicates()}getCurrentTopicNavigationStream(){return this.getStateStream().map((a)=>({newCurrentTopic:a.currentTopic,navigationType:a.currentTopicNavigationType})).skipDuplicates((a,b)=>a.navigationType===b.navigationType&&a.newCurrentTopic===b.newCurrentTopic)}getCoverEditModeStream(){return this.getStateStream().map((a)=>a.coverEditMode).skipDuplicates()}getSelectionStream(){return this.getStateStream().map((a)=>a.selectionInfo).skipDuplicates()}getDeferredSelectionStream(){return this.getDeferredStateStream().map((a)=>
a.state.selectionInfo).skipDuplicates()}getDeferredContextMenuRequestStream(){return this.getDeferredStateStream().map((a)=>a.state.contextMenuRequest).skipDuplicates()}getSelectionSourceStream(){return this.getStateStream().map((a)=>a.selectionSource).skipDuplicates()}getCanvasHoverStream(){return this.getStateStream().map((a)=>a.canvasHoveredEntityIds).skipDuplicates()}getUiHoverStream(){return this.getStateStream().map((a)=>a.uiHoveredEntityIds).skipDuplicates()}getDraggedEntityHoveredTopicIdStream(){return this.getStateStream().map((a)=>
a.draggedEntityHoveredTopicId).skipDuplicates()}getCanvasEditedEntityIdsStream(){return this.getStateStream().map((a)=>a.canvasEditedEntityIds).skipDuplicates()}getBoolModeStream(a){return this.getModeStream().map((b)=>b.kind===a)}rb(a){this.state.shownOnboardingStep!==a&&(this.state.shownOnboardingStep=a,this.pushState())}getShownOnboardingStepStream(){return this.getStateStream().map((a)=>a.shownOnboardingStep).skipDuplicates()}addShownOnboardingStepStream(a){this.zb.plug(a)}ub(a){let b=!1;for(let c of this.state.supportWidgetState.steps)c.userSettingKey===
a.key&&(c.isDone=c.isDone||a.value,b=!0);b&&this.pushState()}addSupportWidgetStepStream(a){this.Db.plug(a)}tb(a){this.state.supportWidgetState={isActive:void 0!==a.isActive?a.isActive:this.state.supportWidgetState.isActive,activeView:void 0!==a.activeView?a.activeView:this.state.supportWidgetState.activeView,steps:void 0!==a.steps?a.steps:this.state.supportWidgetState.steps,topics:void 0!==a.topics?a.topics:this.state.supportWidgetState.topics,searchProps:void 0!==a.searchProps?a.searchProps:this.state.supportWidgetState.searchProps,
isVisible:void 0!==a.isVisible?a.isVisible:this.state.supportWidgetState.isVisible};this.pushState()}getSupportWidgetStateStream(){return this.getStateStream().map((a)=>a.supportWidgetState).skipDuplicates()}getSupportWidgetState(){return this.state.supportWidgetState}addSupportWidgetStateStream(a){this.Cb.plug(a)}Ta(a){this.state.audioState=a;this.pushState()}getAudioStateStream(){return this.getStateStream().map((a)=>a.audioState).skipDuplicates()}addAudioStateStream(a){this.aa.plug(a)}kb(a){this.state.navbarFullyVisible=
a;this.pushState()}eb(a){var b,c;null===(c=(b=window).Ib)||void 0===c?void 0:c.call(b,a);this.state.globalException=a;this.pushState()}sb(a){this.state.spellcheckStatus=a;this.pushState()}yb(a){this.state.userLicenseInformation=a;this.pushState()}setLogo(a){this.state.logoType=a;this.pushState()}Ua(a){this.state.codeSnippetEditorOpen=a;this.pushState()}vb(a){if(this.state.templateData.templateId!==a.templateId||this.state.templateData.themeId!==a.themeId)this.state.templateData=a,this.pushState()}getNavbarFullyVisibleStream(){return this.getStateStream().map((a)=>
a.navbarFullyVisible).skipDuplicates()}getSpellcheckStatusStream(){return this.getStateStream().map((a)=>a.spellcheckStatus).skipDuplicates()}addNavbarFullyVisibleStream(a){this.Ia.plug(a)}addGlobalExceptionStream(a){this.sa.plug(a)}addSpellcheckStatusStream(a){this.Ab.plug(a)}addCodeSnippetEditorOpenStream(a){this.fa.plug(a)}getCodeSnippetEditorOpenStream(){return this.getStateStream().map((a)=>a.codeSnippetEditorOpen).skipDuplicates()}getTemplateDataStream(){return this.getDeferredStateStream().map((a)=>
a.state.templateData).skipDuplicates((a,b)=>a.templateId===b.templateId&&a.themeId===b.themeId)}addTemplateDataStream(a){this.Eb.plug(a)}getUserLicenseInformationStream(){return this.getStateStream().map((a)=>a.userLicenseInformation).skipDuplicates()}getUserLicenseInformation(){return this.state.userLicenseInformation}addUserLicenseInformationStream(a){this.Hb.plug(a)}getDeferredUserLicenseInformationStream(){return this.getDeferredStateStream().map((a)=>a.state.userLicenseInformation).skipDuplicates()}getLogoStream(){return this.getStateStream().map((a)=>
a.logoType).skipDuplicates()}addLogoStream(a){this.Ha.plug(a)}addInteractionModeStream(a){this.ta.plug(a)}getInteractionModeStream(){return this.getStateStream().map((a)=>a.interactionMode).skipDuplicates((a,b)=>(null===a||void 0===a?void 0:a.autoSwitchEnabled)===(null===b||void 0===b?void 0:b.autoSwitchEnabled)&&(null===a||void 0===a?void 0:a.kind)===(null===b||void 0===b?void 0:b.kind))}setInteractionMode(a){if(a.autoSwitchEnabled!==this.state.interactionMode.autoSwitchEnabled||a.kind!==this.state.interactionMode.kind)this.state.interactionMode=
a,this.pushState()}pushState(){this.U.push(this.state);this.J()}J(){this.j||(this.j=!0,this.wa()&&this.m()||window.setTimeout(()=>{this.u()},0))}wa(){return null!=this.m}initDeferredStream(a,b){null!=a&&null!=b&&(this.m=a,this.Qa=b,this.Qa.onValue(()=>{window.setTimeout(()=>{this.u()},0)}))}u(){if(this.j){this.j=!1;const a={};if(!this.v){this.v=!0;try{for(let b=0;b<this.i.length;b++)try{this.i[b](a)}catch(q){n.LoggerModule.logException(this.logger,"lambda","pushDeferred",q)}}finally{this.i=[],this.v=
!1}}this.w.push({state:this.state,rogueUIProps_killme:a})}}syncUpdateWithState(a){this.i.push(a);this.J()}addSaveTypeStream(a){this.O.plug(a)}getSaveTypeStream(){return this.O}setPanModeEnabled(a,b=!1){a?(b||(this.state.panModeForced=!0),this.state.panModeEnabled=!0,this.pushState()):this.state.panModeForced&&!b?(this.state.panModeForced=!1,this.state.panModeEnabled=!1,this.pushState()):!this.state.panModeForced&&b&&(this.state.panModeEnabled=!1,this.pushState())}getIsPanModeEnabledStream(){return this.getStateStream().map((a)=>
a.panModeEnabled).skipDuplicates()}};e={};Object.defineProperty(e,"__esModule",{value:!0});(function(a){a.createEditorStore=function(a,c,d,e,f){return new p.$(a,c,d,e,f)}})(e.EditorStoreModule||(e.EditorStoreModule={}));return e});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_editor_store_common",["require","prezi.geometry","prezi_app_utils","prezi_bacon","prezi_cet","prezi_editor_store_audio","prezi_editor_store_contextmenu","prezi_editor_store_document","prezi_editor_store_focus","prezi_editor_store_meeting","prezi_editor_store_mode","prezi_editor_store_object","prezi_editor_store_save","prezi_editor_store_support","prezi_editor_store_text","prezi_editor_store_ui","prezi_externalserviceprovider","prezi_featureswitcher","prezi_logger","prezi_nativeapitypes","prezi_service_data","prezi_textmodel","prezi_utils"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_editor_store_common.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi.geometry"),require("prezi_app_utils"),require("prezi_bacon"),require("prezi_cet"),require("prezi_editor_store_audio"),require("prezi_editor_store_contextmenu"),require("prezi_editor_store_document"),require("prezi_editor_store_focus"),require("prezi_editor_store_meeting"),require("prezi_editor_store_mode"),require("prezi_editor_store_object"),require("prezi_editor_store_save"),require("prezi_editor_store_support"),require("prezi_editor_store_text"),require("prezi_editor_store_ui"),require("prezi_externalserviceprovider"),require("prezi_featureswitcher"),require("prezi_logger"),require("prezi_nativeapitypes"),require("prezi_service_data"),require("prezi_textmodel"),require("prezi_utils"));}else{this["prezi_editor_store_common"]=__factory(this["prezi.geometry"],this["prezi_app_utils"],this["prezi_bacon"],this["prezi_cet"],this["prezi_editor_store_audio"],this["prezi_editor_store_contextmenu"],this["prezi_editor_store_document"],this["prezi_editor_store_focus"],this["prezi_editor_store_meeting"],this["prezi_editor_store_mode"],this["prezi_editor_store_object"],this["prezi_editor_store_save"],this["prezi_editor_store_support"],this["prezi_editor_store_text"],this["prezi_editor_store_ui"],this["prezi_externalserviceprovider"],this["prezi_featureswitcher"],this["prezi_logger"],this["prezi_nativeapitypes"],this["prezi_service_data"],this["prezi_textmodel"],this["prezi_utils"]);}}).call(this);