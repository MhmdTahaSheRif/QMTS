;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_alignment_tools";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi.engine.dom":dependencies[0],"prezi.geometry":dependencies[1],"prezi_cet_model":dependencies[2],"prezi_cet_model_editor":dependencies[3],"prezi_editor_commander":dependencies[4],"prezi_featureswitcher":dependencies[5],"prezi_i18n":dependencies[6],"prezi_logger":dependencies[7],"prezi_plugin_api":dependencies[8],"prezi_utils":dependencies[9]}};})());};})(arguments);var moduleImpl=(function(){return module(function(h){var p=h.dependencies.prezi_cet_model_editor,g=h.dependencies.prezi_plugin_api,l=h.dependencies.prezi_i18n,r=h.dependencies.prezi_logger,t=h.dependencies.prezi_utils,q={};Object.defineProperty(q,"__esModule",{value:!0});var e;(function(a){a.left="left";a.right="right";a.top="top";a.bottom="bottom";a.centerVertical="centerVertical";a.centerHorizontal="centerHorizontal"})(e||(e={}));var m;(function(a){a.horizontal="horizontal";a.vertical="vertical"})(m||(m={}));const u=[{kind:m.horizontal,
icon:g.IconSmallId.DistributeHorizontal,title:l.I18n.ts("Distribute horizontally")},{kind:m.vertical,icon:g.IconSmallId.DistributeVertical,title:l.I18n.ts("Distribute vertically")}],v=[{kind:e.top,icon:g.IconSmallId.AlignContentTop,title:l.I18n.ts("Align top")},{kind:e.centerHorizontal,icon:g.IconSmallId.AlignContentMiddle,title:l.I18n.ts("Align middle")},{kind:e.bottom,icon:g.IconSmallId.AlignContentBottom,title:l.I18n.ts("Align bottom")},{kind:e.left,icon:g.IconSmallId.AlignContentLeft,title:l.I18n.ts("Align left")},
{kind:e.centerVertical,icon:g.IconSmallId.AlignContentCenter,title:l.I18n.ts("Align center")},{kind:e.right,icon:g.IconSmallId.AlignContentRight,title:l.I18n.ts("Align right")}];q.AlignmentToolsPlugin=class{init(a){a.onDocumentChange(()=>{this.session.document.read((a)=>{a=this.session.selection.getReadonlySelectionInfo(a);this.updateStateBySelection(a)})});a.onSelectionChange((a)=>{this.session.document.read((b)=>{const c={allObjects:a.allObjects.map((a)=>b.lookup.resolve(a)),groups:a.groups.map((a)=>
b.lookup.resolve(a)),nonGroupedObjects:a.nonGroupedObjects.map((a)=>b.lookup.resolve(a))};this.updateStateBySelection(c)})});this.uiRoot=a.declareUI({hasMultiSelection:!1,hasLockedElements:!1},(a,b)=>{a.hasMultiSelection&&!a.hasLockedElements&&b.createPropertyBarItem((a)=>{const b={id:"AlignmentDropdownMenu",tooltip:l.I18n.ts("Align"),groupWeight:9,weight:102};return a.submenu(Object.assign(Object.assign({},b),{icon:g.IconSmallId.AlignContentLeft,items:[...this.createAlignItems(),g.SubmenuSeparatorConst,
...this.createDistributeItems()]}))})})}updateStateBySelection(a){this.uiRoot.setState({hasMultiSelection:1<a.groups.length+a.nonGroupedObjects.length,hasLockedElements:a.allObjects.some((a)=>a.is(p.base.ObjectKind.lockable)&&a.locked)})}createAlignItems(){return v.map((a)=>({id:`align-${a.kind}`,onClick:(d)=>{this.align(a.kind,d)},icon:a.icon,title:a.title,tooltip:a.title}))}createDistributeItems(){return u.map((a)=>({id:`distribute-${a.kind}`,onClick:(d)=>this.distribute(a.kind,d),icon:a.icon,title:a.title,
tooltip:a.title}))}align(a,d){this.session.document.executeApiCommand(d,{name:"alignGroup",run:(b)=>{const c=this.getLayoutables(b),d=this.getAllObjectsToAnimate(b),f=this.getGroupLayoutBox(c,b);b.animated(d,()=>{c.forEach((b)=>{let d=0,n=0;var k=b.layoutBox.aabb;switch(a){case e.left:d=f.topLeft.x-k.topLeft.x;break;case e.right:d=f.topRight.x-k.topRight.x;break;case e.top:n=f.topLeft.y-k.topLeft.y;break;case e.bottom:n=f.bottomLeft.y-k.bottomLeft.y;break;case e.centerHorizontal:n=f.center.y-k.center.y;
break;case e.centerVertical:d=f.center.x-k.center.x}k=b.layoutBox;b.fitInto(k.move(k.center,k.center.translate({x:d,y:n})));r.avro.Avro.createDefaultLogger().logAlignObjects({alignment_type:this.getAlignmentType(a),object_type:this.getObjectType(c)})})})}})}getAlignmentType(a){switch(a){case e.left:return"LEFT";case e.right:return"RIGHT";case e.top:return"TOP";case e.bottom:return"BOTTOM";case e.centerVertical:return"CENTER";case e.centerHorizontal:return"MIDDLE";default:return t.Utils.assertNever(a)}}getObjectType(a){let d=
null;for(let b=1;b<a.length;b++){const c=a[b];if(!("kind"in c))return"MULTIPLE";if(null==d)d=c;else if(d.kind!==c.kind)return"MULTIPLE"}return d}distribute(a,d){this.session.document.executeApiCommand(d,{name:"distributeGroup",run:(b)=>{const c=this.getLayoutables(b),d=this.getGroupLayoutBox(c,b);b=a===m.horizontal?this.distributeHorizontally(d,c,b):this.distributeVertically(d,c,b);r.avro.Avro.createDefaultLogger().logAlignObjects({alignment_type:b,object_type:this.getObjectType(c)})}})}distributeVertically(a,
d,b){const c=this.getAllObjectsToAnimate(b);let e=0;d.forEach((a)=>{e+=a.layoutBox.aabb.size.height});const f=(a.size.height-e)/(d.length-1),g=d.slice().sort((a,b)=>a.layoutBox.aabb.topCenter.y-b.layoutBox.aabb.topCenter.y);let h=a.topCenter.y;b.animated(c,()=>{g.forEach((a)=>{const b=a.layoutBox.aabb,c=a.layoutBox;a.fitInto(c.move(c.topCenter,c.topCenter.translate({x:0,y:h-c.topCenter.y})));h+=b.size.height+f})});return"VERTICAL"}distributeHorizontally(a,d,b){const c=this.getAllObjectsToAnimate(b);
let e=0;d.forEach((a)=>{e+=a.layoutBox.aabb.size.width});const f=(a.size.width-e)/(d.length-1),h=d.slice().sort((a,b)=>a.layoutBox.aabb.centerLeft.x-b.layoutBox.aabb.centerLeft.x);let g=a.centerLeft.x;b.animated(c,()=>{h.forEach((a)=>{const b=a.layoutBox.aabb,c=a.layoutBox;a.fitInto(c.move(c.center,c.center.translate({x:g+b.size.width/2-a.layoutBox.center.x,y:0})));g+=b.size.width+f})});return"HORIZONTAL"}getGroupLayoutBox(a){return a.slice(1).reduce((a,b)=>a.union(b.layoutBox.aabb),a[0].layoutBox.aabb)}getAllObjectsToAnimate(a){var d=
this.session.selection.getSelectionInfo(a);a=[...d.allObjects];d=d.allObjects[0].parent.contentChildren;for(let b of d)if(b.is(p.base.ObjectKind.arc)&&(null!=b.connectorEnd||null!=b.connectorStart))for(let c of a)c!==b.connectorStart&&c!==b.connectorEnd||a.push(b);return a}getLayoutables(a){var d=this.session.selection.getSelectionInfo(a),b=new Map;a=[];var c=[...d.nonGroupedObjects];d=d.groups.map((a)=>a.layoutGroup);for(var e of c)if(c=e,!c.is(p.base.ObjectKind.arc))b.has(c)||b.set(c,[]);else if(null==
c.connectorEnd||null==c.connectorStart)if(null==c.connectorEnd&&null==c.connectorStart)a.push(c);else if(null!=c.connectorStart&&null==c.connectorEnd)if(b.has(c.connectorStart)){var f=b.get(c.connectorStart);f.push(c);b.set(c.connectorStart,f)}else b.set(c.connectorStart,[c]);else null==c.connectorStart&&null!=c.connectorEnd&&(b.has(c.connectorEnd)?(f=b.get(c.connectorEnd),f.push(c),b.set(c.connectorEnd,f)):b.set(c.connectorEnd,[c]));for(let [c,f]of b)e=c,b=f,0!==b.length?(e=e.createLayoutGroupWith(b),
d.push(e)):a.push(e);return[...a,...d]}};h={};Object.defineProperty(h,"__esModule",{value:!0});h.lazyModule={createPlugin(){return new q.AlignmentToolsPlugin}};return h});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_alignment_tools",["require","prezi.engine.dom","prezi.geometry","prezi_cet_model","prezi_cet_model_editor","prezi_editor_commander","prezi_featureswitcher","prezi_i18n","prezi_logger","prezi_plugin_api","prezi_utils"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_alignment_tools.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi.engine.dom"),require("prezi.geometry"),require("prezi_cet_model"),require("prezi_cet_model_editor"),require("prezi_editor_commander"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_logger"),require("prezi_plugin_api"),require("prezi_utils"));}else{this["prezi_alignment_tools"]=__factory(this["prezi.engine.dom"],this["prezi.geometry"],this["prezi_cet_model"],this["prezi_cet_model_editor"],this["prezi_editor_commander"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_logger"],this["prezi_plugin_api"],this["prezi_utils"]);}}).call(this);