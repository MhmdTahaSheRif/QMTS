;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_ppt_edit";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi_cet_model_editor":dependencies[0],"prezi_featureswitcher":dependencies[1],"prezi_i18n":dependencies[2],"prezi_plugin_api":dependencies[3],"prezi_plugin_meta":dependencies[4]}};})());};})(arguments);var moduleImpl=(function(){return module(function(f){var d=f.dependencies.prezi_cet_model_editor,e=f.dependencies.prezi_plugin_api,g=f.dependencies.prezi_i18n,h={};Object.defineProperty(h,"__esModule",{value:!0});const k={slides:[],j:[],w:!1,u:!1,o:!1,v:!1};h.aa=class{processMessage(){}init(c){c.onSelectionChange(()=>{this.session.document.read((b)=>this.i(b))});c.onCurrentTopicChange((b)=>{this.f.setState({currentTopic:b});this.session.document.read((a)=>this.i(a))});c.onDocumentChange(()=>this.session.document.read((b)=>{const a=
b.lookup.findAll(d.base.ObjectKind.slide).filter((a)=>!a.locked);this.f.setState({j:a.map((a)=>a.id)});this.i(b)}));this.f=c.declareUI(k,(b,a)=>{0<b.slides.length&&a.createPropertyBarItem((a)=>a.popupButton((a)=>({id:"slide-background-edit",groupWeight:1,weight:7,content:{icon:e.IconSmallId.BackgroundRemove},tooltipText:g.I18n.ts("Slide background"),popupContent:this.ba(a,b)})))})}ba(c,b){return[c.sectionHeader({content:g.I18n.ts("Global (all slides)"),bottomPadding:!0}),c.button(e.ButtonSize.Small,
e.ButtonAlign.Start,(a)=>[a.button({id:"remove-all-background",color:e.ButtonColor.Gray,content:{text:g.I18n.ts("Remove all slide backgrounds")},disabled:!b.v,onClick:(a)=>{this.session.document.executeApiCommand(a,{name:"removeAllBackground",run:(a)=>{this.$(a,!1);this.i(a)}})}})]),c.button(e.ButtonSize.Small,e.ButtonAlign.Start,(a)=>[a.button({id:"show-all-background",color:e.ButtonColor.Gray,content:{text:g.I18n.ts("Show all slide backgrounds")},disabled:!b.o,onClick:(a)=>{this.session.document.executeApiCommand(a,
{name:"showAllBackground",run:(a)=>{this.$(a,!0);this.i(a)}})}})]),c.separator(),c.sectionHeader({content:g.I18n.ts("Selected slide"),bottomPadding:!0}),c.checkbox({id:"checkbox-remove-slide-background",checked:!b.w,label:g.I18n.ts("Remove slide background"),onCheck:(a,b)=>this.session.document.executeApiCommand(a,{name:b?"remove-background":"show-background",run:(a)=>{this.setBackground(a,!b);this.i(a)}})}),c.checkbox({id:"checkbox-show-slide-background",checked:!b.u,label:g.I18n.ts("Show slide background"),
onCheck:(a,b)=>this.session.document.executeApiCommand(a,{name:b?"show-background":"remove-background",run:(a)=>{this.setBackground(a,b);this.i(a)}})})]}$(c,b){this.f.getState().j.map((a)=>c.lookup.slide(a)).forEach((a)=>a.variant=b?d.base.SlideVariant.Original:d.base.SlideVariant.NoBackground)}setBackground(c,b){this.f.getState().slides.map((a)=>c.lookup.slide(a)).forEach((a)=>this.ca(a,b))}ca(c,b){c.is(d.base.ObjectKind.slide)&&(c.variant=b?d.base.SlideVariant.Original:d.base.SlideVariant.NoBackground)}i(c){let b=
this.session.selection.getReadonlySelectionInfo(c).allObjects;var a=this.f.getState().currentTopic;a&&0===b.length&&(a=c.lookup.base(a))&&a.is(d.base.ObjectKind.topic)&&(b=a.simpleChildren(d.base.ChildVisibilityKind.inside));a=this.f.getState().j.map((a)=>c.lookup.slide(a)).filter((a)=>null!=a);const f=(a,b)=>a.is(d.base.ObjectKind.topic)?a.simpleChildren(d.base.ChildVisibilityKind.outside).find((a)=>a===b):!1,e=a.filter((a)=>b.find((b)=>b===a||f(b,a)));this.f.setState({slides:e.map((a)=>a.id),u:e.some((a)=>
a.variant===d.base.SlideVariant.NoBackground),w:e.some((a)=>a.variant===d.base.SlideVariant.Original),o:a.some((a)=>a.variant===d.base.SlideVariant.NoBackground),v:a.some((a)=>a.variant===d.base.SlideVariant.Original)})}};f={};Object.defineProperty(f,"__esModule",{value:!0});f.lazyModule={createPlugin(){return new h.aa}};return f});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_ppt_edit",["require","prezi_cet_model_editor","prezi_featureswitcher","prezi_i18n","prezi_plugin_api","prezi_plugin_meta"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_ppt_edit.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi_cet_model_editor"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_plugin_api"),require("prezi_plugin_meta"));}else{this["prezi_ppt_edit"]=__factory(this["prezi_cet_model_editor"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_plugin_api"],this["prezi_plugin_meta"]);}}).call(this);