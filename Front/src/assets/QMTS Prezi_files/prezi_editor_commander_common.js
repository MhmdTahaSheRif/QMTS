;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_editor_commander_common";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi.engine.dom":dependencies[0],"prezi_cet_model_editor":dependencies[1]}};})());};})(arguments);var moduleImpl=(function(){return module(function(m){function r(a,b){a=b.get(a.id);return null==a?{}:a.hasColorFilter()?{colorFilter:c.colorFilterFromPdom(a.getColorFilter())}:{}}function z(a,b){a=b.get(a.id);if(null==a)return{};b={};a.hasGradStartColor()&&a.hasGradStartAlpha()&&a.hasGradEndColor()&&a.hasGradEndAlpha()?b={fill:{fillKind:c.base.FillKind.linear,startColor:Object.assign(Object.assign({},a.getGradStartColor().getRGBData()),{a:a.getGradStartAlpha()}),endColor:Object.assign(Object.assign({},a.getGradEndColor().getRGBData()),
{a:a.getGradEndAlpha()})}}:a.hasColor()&&a.hasAlpha()&&(b={fill:{fillKind:c.base.FillKind.solid,color:Object.assign(Object.assign({},a.getColor().getRGBData()),{a:a.getAlpha()})}});let g={};a.hasBorderColor()&&a.hasBorderAlpha()&&a.hasBorderThickness()&&(g={border:{thickness:a.getBorderThickness(),color:Object.assign(Object.assign({},a.getBackgroundColor().getRGBData()),{a:a.getBorderAlpha()})}});let d={};a.hasColorFilter()&&(d={colorFilter:c.colorFilterFromPdom(a.getColorFilter())});return Object.assign(Object.assign(Object.assign({},
b),g),d)}function l(a){return f.relBoxFromLB(a.is(c.base.ObjectKind.text)?a.textBox:a.layoutBox)}function A(a,b){if(!a.coverLayoutId)return null;b=b.get(a.coverLayoutId);if(null==b)return null;const c=a.zoomLayoutBox.asReferenceFrame;var d=b.variants[0];b=f.relBoxFromJSON(d.defaultContentAreaType===f.ContentAreaType._1by1?d.contentArea1by1:d.contentArea16by9).withReferenceFrame(c);if(1>d.objects.length||1>a.visual.contentChildren.length)return null;d=d.objects.map((a)=>f.relBoxFromJSON(a.layoutBox).withReferenceFrame(c)).reduce((a,
b)=>a.union(b)).withReferenceFrame(c);a=a.visual.contentChildren.map((a)=>a.layoutBox).reduce((a,b)=>a.union(b)).withReferenceFrame(c);return b.align(d.topLeft,d.bottomRight,a.topLeft,a.bottomRight)}function B(a,b){null==b&&(b=a.visual.contentChildren.map((a)=>a.layoutBox).reduce((a,b)=>a.union(b)));a=b.size.width/b.size.height;return Math.abs(a-1)<Math.abs(a-16/9)?[e.f(b.withSize(Object.assign(Object.assign({},b.size),{width:b.size.height}))),f.ContentAreaType._1by1]:[e.f(b.withSize(Object.assign(Object.assign({},
b.size),{width:16*b.size.height/9}))),f.ContentAreaType._16by9]}var c=m.dependencies.prezi_cet_model_editor,C=m.dependencies["prezi.engine.dom"],e={j:function(a){a=a.overview.contentChildren.find((a)=>a.is(c.base.ObjectKind.image));return null!=a&&-1!==a.imageAsset.assetSourceFilename.indexOf("thumbnail")?a.imageAsset.url:""},w:function(a,b){a=b.cover.contentChildren.find((a)=>a.is(c.base.ObjectKind.image));return null!=a?a.imageAsset.url:""},o:function(a){const b=new Map;for(a=C.DOM.loadXml(a).getDocumentStyle().getStyleDeclarations().iterator();a.hasNext();){const c=
a.next(),d=c.getStyleSelector().toString();d.startsWith("#")&&b.set(d.slice(1),c.getStyleBlock())}return b},v:function(a,b){a=b.get(a.id);return null==a?{}:a.hasBackgroundAlpha()&&a.hasBackgroundColor()?{background:Object.assign(Object.assign({},a.getBackgroundColor().getRGBData()),{a:a.getBackgroundAlpha()})}:{}},m:function(a,b){switch(a.kind){case c.base.ObjectKind.shape:return Object.assign({objectKind:c.base.ObjectKind.shape,shapeKind:a.shapeKind,shapeStyle:a.shapeStyle,layoutBox:l(a)},z(a,b));
case c.base.ObjectKind.pdf:return Object.assign({objectKind:c.base.ObjectKind.pdf,pdfAsset:a.pdfAsset,filterStyle:a.filterStyle,layoutBox:l(a)},r(a,b));case c.base.ObjectKind.image:return Object.assign({objectKind:c.base.ObjectKind.image,imageAsset:a.imageAsset,filterStyle:a.filterStyle,layoutBox:l(a)},r(a,b));case c.base.ObjectKind.text:return Object.assign({objectKind:c.base.ObjectKind.text,text:a.getText(),layoutBox:l(a)},(0,e.u)(a,b));default:throw Error("Unsupported element in snippet "+a.kind);
}},u:function(a,b){return Object.assign({characterProps:a.getCharacterProps()[0],paragraphProps:a.getParagraphs()[0].getParagraphProps(),isPlaceholder:a.isPlaceholder},(0,e.v)(a,b))},J:function(a){return Object.assign(Object.assign({},a),{layoutBox:a.layoutBox.toJSON()})},f:function(a){return{point:{x:Math.round(1E4*(a.center.x+Number.EPSILON))/1E4,y:Math.round(1E4*(a.center.y+Number.EPSILON))/1E4},size:{height:Math.round(1E4*(a.size.height+Number.EPSILON))/1E4,width:Math.round(1E4*(a.size.width+
Number.EPSILON))/1E4},rotation:Math.round(1E4*(a.rotationRad+Number.EPSILON))/1E4}}};Object.defineProperty(e,"__esModule",{value:!0});e.i=(a)=>{a=/(?:anchor|a)-(top|bottom|center|t|b|c)-(left|right|center|l|r|c)/g.exec(a);let b={ry:-1,rx:-1};a&&(b={ry:"t"===a[1][0]?-1:"b"===a[1][0]?1:0,rx:"l"===a[2][0]?-1:"r"===a[2][0]?1:0});return b};var t={convertTopicShapeXmlToJson:function(a,b){return a.read((g)=>{const d=e.o(a.toXml()),k=e.j(g);g=g.overview.topicChildren.map((a)=>{if(!a.is(c.base.ObjectKind.planetTopic))throw Error(`topic must be planets: + ${a.id}`);
var n=[...a.visual.contentChildren].sort((a,b)=>a.isAbove(b)?1:-1);let k=a.visual.contentChildren.filter((a)=>a.visualLayoutRole===c.base.VisualLayoutRole.contentArea);2>k.length&&(k=a.visual.contentChildren.filter((a)=>a.is(c.base.ObjectKind.shape)));var g=a.cover.contentChildren.find((a)=>a.is(c.base.ObjectKind.text));const p=k.sort((a,b)=>a.layoutBox.size.width/a.layoutBox.size.height-b.layoutBox.size.width/b.layoutBox.size.height).map((a)=>e.m(a,d));if(void 0===g)throw Error(`${b}: Default content area not specified.`);
if(-1!==g.getText().indexOf("1:1"))g=!0;else if(-1!==g.getText().indexOf("16:9"))g=!1;else throw Error(`${b}: Default content area not specified.`);n=n.filter((a)=>-1===k.indexOf(a)&&!a.is(c.base.ObjectKind.text)).map((a)=>e.m(a,d));if(2===p.length)return{defaultContentAreaType:g?f.ContentAreaType._1by1:f.ContentAreaType._16by9,contentArea1by1:p[0].layoutBox.toJSON(),contentArea16by9:p[1].layoutBox.toJSON(),objects:n.map((a)=>e.J(a))};throw Error(`${b}: Two content areas are expected, in variant: ${a.id}, found: [${k.map((a)=>
a.id)}]`);});return{thumbnailUrl:k,variants:g}})}};Object.defineProperty(t,"__esModule",{value:!0});var u={convertTopicOverviewXmlToJson:function(a){return a.read((a)=>{const b=e.j(a);a=a.overview.topicChildren.map((a)=>{if(!a.is(c.base.ObjectKind.planetTopic))throw Error("topic is not planet: "+a.id);var b=a.visual.contentChildren.map((a)=>a.layoutBox).reduce((a,b)=>a.union(b));b=f.relBoxFromLB(b.extendToSquare()).toJSON();const d=a.topicChildren.map((b)=>{b=b.visual.contentChildren.map((b)=>b.layoutBox.withReferenceFrame(a.referenceFrame)).reduce((a,
b)=>a.union(b));return f.relBoxFromLB(b.extendToSquare()).toJSON()});return{anchorLayoutBox:b,subtopicLayoutBoxes:d}});return{thumbnailUrl:b,variants:a}})}};Object.defineProperty(u,"__esModule",{value:!0});var v={convertContentLayoutXmlToJsons:function(a,b){const g=(a,b)=>{a=b.cover.contentChildren.find((a)=>a.is(c.base.ObjectKind.text));return null!=a?a.getText().replace(":","by").replace("PPT","ContentLayout").trim():""};return b.read((b)=>new Map(b.overview.topicChildren.map((d)=>{if(!d.is(c.base.ObjectKind.planetTopic))throw"error in content layout snippet";
const f=g(b,d),n=e.w(b,d),[k,l]=B(d,A(d,a)),q=d.contentChildren.filter((a)=>a.is(c.base.ObjectKind.text)||a.is(c.base.ObjectKind.image)).sort((a,b)=>a.isAbove(b)?1:-1).map((a)=>a.id);var h=d.contentChildren.find((a)=>a.is(c.base.ObjectKind.text)&&-1!==["title","subtitle","subtitle_2"].indexOf(a.textStyle)?!0:a.contentLayoutRole===c.base.ContentLayoutRole.contentTitle);let m=null;h&&h.is(c.base.ObjectKind.text)&&(m={hasBackground:null!=h.background,backgroundCornerRadius:null!=h.background?h.backgroundCornerRadius:
null,area:e.f(h.textBox),anchor:e.i(h.getText()),fontSize:h.getFontSizes()[0],style:h.textStyle,zIndex:q.indexOf(h.id)});h=d.contentChildren.filter((a)=>a.is(c.base.ObjectKind.text)&&a.contentLayoutRole!==c.base.ContentLayoutRole.contentTitle&&-1===["title","subtitle","subtitle_2"].indexOf(a.textStyle)).map((a)=>({hasBackground:null!=a.background,backgroundCornerRadius:null!=a.background?a.backgroundCornerRadius:null,area:e.f(a.textBox),anchor:e.i(a.getText()),fontSize:a.getFontSizes()[0],style:a.textStyle,
zIndex:q.indexOf(a.id)}));d=d.contentChildren.filter((a)=>a.is(c.base.ObjectKind.image)).map((a)=>({area:e.f(a.layoutBox),zIndex:q.indexOf(a.id)}));return[f,{thumbnailUrl:n,type:l,contentArea:k,title:m,texts:h,images:d}]})))}};Object.defineProperty(v,"__esModule",{value:!0});var w={convertOverviewXmlToJson:function(a){return a.read((a)=>{const b=e.j(a);a=a.overview.topicChildren.map((a)=>{if(!a.is(c.base.ObjectKind.planetTopic))throw Error("topic is not planet: "+a.id);const b=a.topicChildren.map((a)=>
f.relBoxFromLB(a.layoutBox.extendToSquare()).toJSON()),d=a.simpleChildren(c.base.ChildVisibilityKind.inside).filter((a)=>a.is(c.base.ObjectKind.text)).map((a)=>a).map((a)=>({hasBackground:null!=a.background,backgroundCornerRadius:null!=a.background?a.backgroundCornerRadius:null,anchor:e.i(a.getText()),style:a.textStyle,area:e.f(a.textBox)}));return{anchorLayoutBox:e.f(a.zoomLayoutBox),subtopicLayoutBoxes:b,titles:d}});return{thumbnailUrl:b,variants:a}})}};Object.defineProperty(w,"__esModule",{value:!0});
var f={relBoxFromJSON:function(a){return new x(a.point,a.size,a.rotation)},relBoxFromLB:function(a){return new x({x:a.center.x,y:a.center.y},a.size,a.rotationRad)},convertTopicShapeXmlToJson:function(a,b){return t.convertTopicShapeXmlToJson(a,b)},convertTopicOverviewXmlToJson:function(a){return u.convertTopicOverviewXmlToJson(a)},convertContentLayoutXmlToJsons:function(a,b){return v.convertContentLayoutXmlToJsons(a,b)},convertOverviewXmlToJson:function(a){return w.convertOverviewXmlToJson(a)},formatXml:function(a){let b=
"";a=a.replace(/(>)(<)(\/*)/g,"$1\r\n$2$3");let c=0;a.split("\r\n").forEach((a)=>{let d=0;a.match(/.+<\/\w[^>]*>$/)?d=0:a.match(/^<\/\w/)?0!==c&&--c:d=a.match(/^<\w[^>]*[^\/]>.*$/)?1:0;let e="";for(let a=0;a<c;a++)e+="  ";b+=e+a+"\r\n";c+=d});return b}};Object.defineProperty(f,"__esModule",{value:!0});class x{constructor(a,b,c){this.point=a;this.size=b;this.rotation=c}withReferenceFrame(a){return a.layoutBox(this.point,this.size).withRotationRad(this.rotation)}toJSON(){return{point:this.point,size:this.size,
rotation:this.rotation}}}(function(a){a.titleText="titleText";a.bodyText="bodyText";a.image="image"})(f.ContentLayoutElementKind||(f.ContentLayoutElementKind={}));var y;(function(a){a._1by1="1:1";a._16by9="16:9"})(y=f.ContentAreaType||(f.ContentAreaType={}));f.defaultContentArea=function(a){return a.defaultContentAreaType===y._1by1?a.contentArea1by1:a.contentArea16by9};return f});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_editor_commander_common",["require","prezi.engine.dom","prezi_cet_model_editor"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_editor_commander_common.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi.engine.dom"),require("prezi_cet_model_editor"));}else{this["prezi_editor_commander_common"]=__factory(this["prezi.engine.dom"],this["prezi_cet_model_editor"]);}}).call(this);