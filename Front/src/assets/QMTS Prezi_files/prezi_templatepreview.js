;(function(){var baseUrl;var __factory=function(){var React=arguments[0];var ReactDOM=arguments[1];var ReactTransitionGroup=arguments[2];var StyledComponents=arguments[3];var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_templatepreview";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi_canvas_listener":dependencies[4],"prezi_dragon":dependencies[5],"prezi_featureswitcher":dependencies[6],"prezi_i18n":dependencies[7],"prezi_koi_widgets":dependencies[8],"prezi_logger":dependencies[9],"prezi_privacypaywall":dependencies[10],"prezi_templatechooser":dependencies[11],"prezi_templateservice":dependencies[12],"prezi_utils":dependencies[13],"prezi_widgets":dependencies[14]}};})(),React,ReactDOM,ReactTransitionGroup,StyledComponents);};})(arguments);var moduleImpl=(function(){return module(function(f,b,v,U,V){v=null;var w=f.dependencies.prezi_canvas_listener,q=f.dependencies.prezi_dragon,e=f.dependencies.prezi_i18n,m=f.dependencies.prezi_koi_widgets,h=f.dependencies.prezi_logger,F=f.dependencies.prezi_privacypaywall,x={};Object.defineProperty(x,"__esModule",{value:!0});x.CancelablePromiseImpl=class{constructor(a){this.promise=a;this.cancelled=new Promise((a,b)=>{this.cancel=()=>{b({isCancelled:!0});return!0}})}getPromise(){return Promise.race([this.promise,this.cancelled]).then((a)=>
{this.cancel=()=>!1;return a})}};var g={getDifficultyName:function(a){switch(a){case 0:return"NOVICE";case 1:return"SKILLED";case 2:return"MASTER";default:return"NOSKILL"}}};Object.defineProperty(g,"__esModule",{value:!0});g.Timer=class{constructor(a,d){this.func=a;this.timeout=d;this.handle=null}start(a){this.func=a||this.func;setTimeout(this.func,this.timeout)}cancel(){null!==this.handle&&(clearTimeout(this.handle),this.handle=null)}};var y={};Object.defineProperty(y,"__esModule",{value:!0});y.Logging=
class{constructor(){this.logger=h.LoggerModule.getLoggerManager().createLogger("prezi_templatepreview.Logging")}logTemplatePreviewStarted(a){this.loadingStartTime=Date.now();this.logger.info(this.addDefaultTemplateChooserLogFields({object:"template_live_preview",action:"start_loading",trigger:"machine",payload:{template_name:a.name,template_id:a.templateId,template_organization_id:a.orgId}}))}logTemplatePreviewLoaded(a,d,b){const k=Date.now()-this.loadingStartTime;this.logger.info(this.addDefaultTemplateChooserLogFields({object:"template_live_preview",
action:"finish_loading",trigger:"machine",payload:{template_name:a.name,template_id:a.templateId,template_organization_id:a.orgId,duration:k}}));h.avro.Avro.createDefaultLogger().logOpenTemplatePreview({template_name:a.name,template_skill:g.getDifficultyName(a.difficulty),template_id:a.templateId,preview_percentage:0===b?b:d/b*100,preview_progress:d,preview_total:b})}logClosePreview(a,d,b){let k="unknown_source";switch(d){case c.ClosePreviewSource.CLOSE_BUTTON:k="preview_close_button";break;case c.ClosePreviewSource.BACKGROUND_CLICK:k=
"overlay"}this.logger.info(this.addDefaultTemplateChooserLogFields({action:"close_preview",object:"template",trigger:k,payload:{template_id:a.templateId,step:b}}));h.avro.Avro.createDefaultLogger().logCloseTemplatePreview({template_name:a.name,template_skill:g.getDifficultyName(a.difficulty),template_id:a.templateId})}logNavigation(a,d,b,c){this.logger.info(this.addDefaultTemplateChooserLogFields({object:"template_live_preview",action:d,trigger:"button",payload:{template_name:a.name,template_id:a.templateId,
step:b}}));h.avro.Avro.createDefaultLogger().logClickTemplatePreviewNavigation({template_name:a.name,template_skill:g.getDifficultyName(a.difficulty),template_id:a.templateId,preview_percentage:0===c?c:b/c*100,preview_progress:b,preview_total:c})}logStartEditing(a,b){this.logger.info(this.addDefaultTemplateChooserLogFields({action:"create",object:"prezi",trigger:"use_template_button",payload:{template_id:a.templateId,step:b}}));h.avro.Avro.createDefaultLogger().logClickUseThisTemplate({template_name:a.name,
template_skill:g.getDifficultyName(a.difficulty),template_id:a.templateId})}logError(a,b,k){this.logger.info(this.addDefaultTemplateChooserLogFields({object:"template_live_preview",action:"error",trigger:"machine",payload:{template_id:a,step:b,error:k}}))}addDefaultTemplateChooserLogFields(a){this.setPitchSchemaVersion();a=Object.assign({feature:"template_chooser",payload:{}},a);a.payload=Object.assign({feature:"template_chooser"},a.payload);return a}setPitchSchemaVersion(){"unknown"===h.LoggerModule.getLoggerManager().getSchemaVersion()&&
h.LoggerModule.getLoggerManager().setSchemaVersion("2")}logRestartButtonClicked(a){h.avro.Avro.createDefaultLogger().logClickReplayTemplatePreview({template_name:a.name,template_skill:g.getDifficultyName(a.difficulty),template_id:a.templateId})}};var z={};Object.defineProperty(z,"__esModule",{value:!0});z.RestartButton=({onClick:a})=>b.createElement("div",{className:"restart-button",style:{width:48,height:48,position:"absolute",top:22,right:24,borderRadius:30,border:"solid 1px rgba(255, 255, 255, 0.6)"},
onClick:(b)=>{b.stopPropagation();a(b)}},b.createElement("img",{style:{position:"relative",left:10,top:13},src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMyIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIzIDIwIj48cGF0aCBmaWxsPSIjRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iIGQ9Ik0xMyAwQzcuNTYgMCAzLjE0IDQuMzQzIDMuMDA2IDkuNzVIMGw0LjUgNSA0LjUtNUg1LjUwN0E3LjQ5OCA3LjQ5OCAwIDAgMSAyMC41IDEwYTcuNSA3LjUgMCAwIDEtMTEuOTM4IDYuMDQ1bC0xLjcyIDEuODM0QTkuOTU5IDkuOTU5IDAgMCAwIDEzIDIwYzUuNTIzIDAgMTAtNC40NzcgMTAtMTBTMTguNTIzIDAgMTMgMCIvPjwvc3ZnPg0K"}));
var A={};Object.defineProperty(A,"__esModule",{value:!0});A.EndingOverlay=class extends b.PureComponent{constructor(){super(...arguments);this.onButtonClick=(a)=>{a.stopPropagation();this.setState({useThisTemplateButtonClicked:!0});this.props.onButtonClick(a)};this.state={useThisTemplateButtonClicked:!1}}render(){return b.createElement("div",{style:{backgroundColor:`rgba(21, 34, 53, ${this.props.isSemiTransparent?"0.7":"1"})`,zIndex:101,position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",
justifyContent:"center",alignItems:"center"},onClick:this.props.onOverlayClick},b.createElement("div",null,b.createElement(m.KoiWidgets.Button,{content:this.props.useTemplateStarted&&this.state.useThisTemplateButtonClicked?b.createElement(q.Spinner,{size:"sm",color:"white"}):b.createElement("span",null,e.I18n.ts("Use this template")),className:`start-editing-button overlay-button${this.props.pulsateButton?" pulsate":""}`,"data-lookup":"start-editing",onClick:this.onButtonClick,disabled:this.props.useTemplateStarted&&
!this.state.useThisTemplateButtonClicked})),this.props.showRestartButton&&b.createElement(z.RestartButton,{onClick:this.props.onRestartButtonClick}))}};var B={};Object.defineProperty(B,"__esModule",{value:!0});B.LoadingOverlay=({onOverlayClick:a})=>b.createElement("div",{style:{backgroundColor:"#152235",zIndex:101,position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},onClick:a},b.createElement(q.Spinner,{size:"md",color:"blue"}));var l={};Object.defineProperty(l,
"__esModule",{value:!0});l.LeftButton=(a)=>{const d=b.createElement(m.KoiWidgets.Button,{key:"left-button",className:`template-navigation-button${a.disabled?" disabled":""}`,icon:"icon-arrow-left",lookupId:"template-navigate-previous",onClick:a.navigate});return a.disabled?d:b.createElement(m.KoiWidgets.Tooltip,{key:"left-tooltip",content:d,tooltip:e.I18n.ts("Go backward"),pointerPosition:2,hideAfter:1E3,appearWithAnimation:!0})};l.RightButtton=(a)=>{const d=b.createElement(m.KoiWidgets.Button,{key:"right-button",
className:`template-navigation-button${a.disabled?" disabled":""}`,icon:"icon-arrow-right",lookupId:"template-navigate-next",onClick:a.navigate});return a.disabled?d:b.createElement(m.KoiWidgets.Tooltip,{key:"right-tooltip",content:d,tooltip:e.I18n.ts("Explore this template"),pointerPosition:2,hideAfter:1E3,appearWithAnimation:!0})};l.PreviewNavigation=class extends b.Component{constructor(){super(...arguments);this.handleKeyUpEvent=(a)=>{this.props.disabled||(a.keyCode!==w.Key.RIGHT_ARROW||this.props.isBuffering?
a.keyCode===w.Key.LEFT_ARROW&&(a.preventDefault(),this.props.goToPrevious()):(a.preventDefault(),this.props.goToNext()))}}componentDidMount(){window.addEventListener("keyup",this.handleKeyUpEvent)}componentWillUnmount(){window.removeEventListener("keyup",this.handleKeyUpEvent)}render(){return b.createElement("div",{className:"template-navigation-buttons"},this.props.isBuffering&&b.createElement("div",{style:{float:"left",display:"inline-flex",alignItems:"center",justifyContent:"center",height:"100%",
position:"absolute",left:12}},b.createElement(q.Spinner,{size:"sm",color:"blue"})),b.createElement(l.LeftButton,{disabled:this.props.disabled||this.props.isFirstStep,navigate:this.props.goToPrevious}),b.createElement(l.RightButtton,{disabled:this.props.disabled||this.props.isLastStep||this.props.isBuffering,navigate:this.props.goToNext}))}};l.PreviewNavigation.displayName="PreviewNavigation";var n={};Object.defineProperty(n,"__esModule",{value:!0});const G=e.I18n;n.PreviewPlayer=class extends b.Component{constructor(a){super(a);
this.setTemplatePreview=(a)=>this.templatePreview=$(a);this.setTemplatePreviewOuter=(a)=>this.templatePreviewOuter=$(a);this.setStartEditingButtonContainer=(a)=>this.startEditingButtonContainer=$(a);this.handleResize=()=>{let a=this.templatePreview.width(),b=9*a/16;const c=this.templatePreview.height()-parseInt(this.templatePreviewOuter.css("margin-top"),10)-(this.startEditingButtonContainer?this.startEditingButtonContainer.outerHeight(!0)||0:0);b>c&&(b=c,a=16*b/9);this.templatePreviewOuter.css({width:`${a}px`,
height:`${b}px`})};this.computeStartEditingContext=()=>{if(null!=this.props.startEditingController){let a={templateId:this.props.selectedTemplate.templateId,templateCategory:this.props.selectedTemplate.category};-1<this.props.selectedTemplate.category.indexOf("Video templates")&&(a.preziVideoTemplate=!0);null!=this.props.title&&0<this.props.title.length&&(a.title=this.props.title);this.props.privacy===F.PrivacySetting.PRIVATE&&(a.private=!0);return{createOptions:a,afterCreateAction:this.props.afterCreateAction}}return null};
this.handleStartEditing=()=>{this.setState({useTemplateStarted:!0});if(null!=this.props.startEditingController){let a=this.computeStartEditingContext();null!=a&&this.props.startEditingController.startEditing(a.createOptions,this.props.handleStartEditingError,a.afterCreateAction)}this.logging.logStartEditing(this.props.selectedTemplate,this.props.step)};this.startEditing=(a)=>{a.stopPropagation();this.state.useTemplateStarted||(this.setState({useThisTemplateButtonClicked:!0}),this.handleStartEditing())};
this.loadingTimeoutTimer=new g.Timer(()=>{this.props.loadingOverlay&&this.logging.logError((this.props.selectedTemplate||{templateId:"unknown"}).templateId,this.props.step,"timeout: loadingOverlay still present after 10s")},1E4);this.closeTemplatePreview=(a)=>{a.stopPropagation();this.handleClosePreview(c.ClosePreviewSource.CLOSE_BUTTON)};this.onClickTemplatePreview=()=>{null!=this.props.selectedTemplate&&this.handleClosePreview(c.ClosePreviewSource.BACKGROUND_CLICK)};this.onDummyClick=(a)=>a.stopPropagation();
this.logNavigation=(a,b)=>this.logging.logNavigation(this.props.selectedTemplate,a,b,this.props.totalStepCount);this.handleEscKey=(a)=>{a.keyCode===w.Key.ESC&&this.handleClosePreview(c.ClosePreviewSource.ESC_KEY_PRESSED)};this.state={useTemplateStarted:!1,useThisTemplateButtonClicked:!1};this.handleRestartButtonClick=()=>{this.props.goToFirst();this.logging.logRestartButtonClicked(this.props.selectedTemplate)};this.onStartClick=(a)=>{this.props.startButtonHandler?this.props.startButtonHandler(this.startEditing,
a):this.startEditing(a)};this.getStartEditingButtonText=()=>this.props.startButtonText?this.props.startButtonText:this.props.deemphasizeButton?e.I18n.ts("Continue"):e.I18n.ts("Use this template");this.logging=new y.Logging;this.logging.logTemplatePreviewStarted(a.selectedTemplate);a.startEditing&&this.handleStartEditing()}handleClosePreview(a){this.state.useTemplateStarted||(this.props.handlePreviewClose(),this.logging.logClosePreview(this.props.selectedTemplate,a,this.props.step))}componentDidMount(){this.handleResize();
window.addEventListener("resize",this.handleResize);window.addEventListener("keyup",this.handleEscKey);this.loadingTimeoutTimer.start()}componentDidUpdate(a){!a.startEditing&&this.props.startEditing?this.handleStartEditing():null==a.startEditingController&&null!=this.props.startEditingController&&this.state.useTemplateStarted&&this.handleStartEditing();this.props.hideStartButton!==a.hideStartButton&&this.handleResize();a.loadingOverlay&&!this.props.loadingOverlay&&this.logging.logTemplatePreviewLoaded(this.props.selectedTemplate,
this.props.step,this.props.totalStepCount);null!=this.props.error&&this.logging.logError(this.props.selectedTemplate.templateId,this.props.step,this.props.error);0!==a.step&&0===this.props.step?this.logNavigation("first_step",0):a.step<this.props.step?this.logNavigation("next_step",this.props.step):a.step>this.props.step&&this.logNavigation("previous_step",this.props.step)}componentWillUnmount(){window.removeEventListener("resize",this.handleResize);window.removeEventListener("keyup",this.handleEscKey);
this.loadingTimeoutTimer.cancel()}render(){const a=G.ts(this.props.selectedTemplate.name,{context:"Template name"});return b.createElement("div",{className:"template-preview-container"},b.createElement("div",{className:"template-preview with-overlay",ref:this.setTemplatePreview,onClick:this.onClickTemplatePreview},b.createElement("div",{className:"template-preview-outer",ref:this.setTemplatePreviewOuter,onClick:this.onDummyClick,style:this.props.previewContainerStyle},b.createElement("div",{className:"template-title-container"},
b.createElement("div",{className:"template-preview-title"},a)),this.props.children,this.props.loadingOverlay&&b.createElement(B.LoadingOverlay,{onOverlayClick:this.props.pulsateStartEditingButton}),(this.props.isLastStep||this.props.isError)&&b.createElement(A.EndingOverlay,{onOverlayClick:this.props.pulsateStartEditingButton,onButtonClick:this.onStartClick,onRestartButtonClick:this.handleRestartButtonClick,showRestartButton:!this.props.isError,pulsateButton:this.props.pulsateButton,isSemiTransparent:!this.props.isError,
useTemplateStarted:this.state.useTemplateStarted}),b.createElement(l.PreviewNavigation,{disabled:this.props.loadingOverlay||this.props.isError||2>=this.props.totalStepCount,isBuffering:this.props.isBuffering,isFirstStep:this.props.isFirstStep,isLastStep:this.props.isLastStep,goToPrevious:this.props.goToPrevious,goToNext:this.props.goToNext})),b.createElement("div",{className:"close-preview icon-close",onClick:this.closeTemplatePreview}),!this.props.hideStartButton&&b.createElement("div",{className:"start-editing-button-container",
ref:this.setStartEditingButtonContainer},b.createElement(m.KoiWidgets.Button,{style:this.state.useTemplateStarted&&!this.state.useThisTemplateButtonClicked?{opacity:.5}:{},content:this.state.useTemplateStarted&&this.state.useThisTemplateButtonClicked?b.createElement(q.Spinner,{size:"sm",color:"white"}):b.createElement("span",null,this.getStartEditingButtonText()),className:`start-editing-button${this.props.pulsateButton?" pulsate":""}${this.props.deemphasizeButton?" deemphasize":""}`,"data-lookup":"start-editing",
onClick:this.onStartClick}))))}};n.PreviewPlayer.displayName="PreviewPlayer";var r={};Object.defineProperty(r,"__esModule",{value:!0});r.PreviewVideoContainer=class extends b.PureComponent{constructor(){super(...arguments);this.css={position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"hidden"};this.setVideoRef=(a)=>{this.videoRef=a};this.preventContextMenu=(a)=>{a.preventDefault()};this.onError=()=>{this.props.onError(this.videoRef.error)};this.stopPlaying=(a)=>()=>{null!=this.videoRef&&(this.videoRef.pause(),
this.videoRef.currentTime=a)};this.checkBuffering=()=>{const a=this.isBuffering(this.state.startTime,this.state.stopTime);this.state.buffering!==a&&(this.setState({buffering:a}),this.props.onBufferChange(a))};this.state={startTime:0,stopTime:0,buffering:!0}}isBuffering(a,b){if(null==this.videoRef||null==this.videoRef.buffered)return!0;for(let d=0;d<this.videoRef.buffered.length;d++)if(this.videoRef.buffered.start(d)<=a&&this.videoRef.buffered.end(d)>=b)return!1;return!0}playNextStep(){if(this.state.stopTime>
this.state.startTime)if(this.props.jumpToFrame)this.videoRef.currentTime=this.state.stopTime;else{const a=1E3*(this.state.stopTime-this.state.startTime);this.videoPauseTimeout=window.setTimeout(this.stopPlaying(this.state.stopTime),a);this.playbackFinishedTimeout=window.setTimeout(()=>this.props.onPlayingStepFinished(),a-500);this.videoRef.play()}else this.videoRef.currentTime=this.state.stopTime}updateVideoPosition(){null!=this.videoRef&&((clearTimeout(this.videoPauseTimeout),clearTimeout(this.playbackFinishedTimeout),
this.videoRef.pause(),this.state.buffering)?.1>this.state.startTime&&(this.videoRef.currentTime=0):this.playNextStep())}componentWillReceiveProps(a){if(this.props.step!==a.step||this.props.templatePreviewMetadata!==a.templatePreviewMetadata||this.props.jumpToFrame!==a.jumpToFrame){var b=a.templatePreviewMetadata.stepTimes[this.props.step];a=a.templatePreviewMetadata.stepTimes[a.step];var c=this.isBuffering(b,a);this.setState({startTime:b,stopTime:a,buffering:c});this.props.onBufferChange(c)}}componentDidUpdate(){this.updateVideoPosition()}componentWillUnmount(){clearTimeout(this.videoPauseTimeout);
clearTimeout(this.playbackFinishedTimeout)}getVideoElement(){const a=this.props.isBlurred?{filter:"blur(5px)"}:{};return this.props.autoplay?b.createElement("div",{dangerouslySetInnerHTML:{__html:`
				<video
					style=${a}
					width="100%"
					height="100%"
					muted
					autoPlay
					controls
					playsInline
				>
					<source src="${this.props.templatePreviewUrl}" type="video/mp4">
				</video>

			`}}):b.createElement("video",{width:"100%",height:"100%",ref:this.setVideoRef,style:a,src:this.props.templatePreviewUrl,onContextMenu:this.preventContextMenu,onError:this.onError,onProgress:this.checkBuffering,onCanPlay:this.checkBuffering},b.createElement("source",{type:"video/mp4"}))}render(){return b.createElement("div",{style:this.css,onClick:this.props.pulsateStartEditingButton,onDoubleClick:this.props.pulsateStartEditingButton},null!=this.props.templatePreviewUrl&&this.getVideoElement())}};
r.PreviewVideoContainer.displayName="PreviewVideoContainer";var p={},H=this&&p.__awaiter||function(a,b,c,e){function d(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,k){function f(a){try{g(e.next(a))}catch(C){k(C)}}function h(a){try{g(e["throw"](a))}catch(C){k(C)}}function g(a){a.done?c(a.value):d(a.value).then(f,h)}g((e=e.apply(a,b||[])).next())})};Object.defineProperty(p,"__esModule",{value:!0});p.TemplatePreviewLite=class extends b.Component{constructor(){super(...arguments);
this.goToNext=()=>{if(this.state.isPlaying)this.setState({isPlaying:!1,jumpToFrame:!0});else{const a=this.state.step+1;a<this.state.templatePreviewMetadata.stepTimes.length&&this.setState({step:a,isPlaying:!0,jumpToFrame:!1})}};this.goToPrevious=()=>{const a=this.state.step-1;0<=a&&this.setState({step:a,isPlaying:!1,jumpToFrame:!1})};this.goToFirst=()=>{this.setState({step:0})};this.onPlayingStepFinished=()=>{this.setState({isPlaying:!1})};this.onVideoBufferChange=(a)=>this.setState({initialLoading:this.state.initialLoading&&
a,isBuffering:!this.state.initialLoading&&a});this.onVideoError=(a)=>this.setState({initialLoading:!1,isBuffering:!1,isError:!0,error:a});this.state={step:0,initialLoading:!0,isBuffering:!1,isPlaying:!1,jumpToFrame:!1,isError:!1,error:null,templatePreviewUrl:null,templatePreviewMetadata:{stepTimes:[],autoplay:!1}}}componentDidMount(){return H(this,void 0,void 0,function*(){const a=this.props.selectedTemplate.video;this.loadTemplatePreviewLiteMetadata=c.makeCancelablePromise(this.props.templateService.loadTemplatePreviewLiteMetadata(this.props.selectedTemplate));
try{const b=yield this.loadTemplatePreviewLiteMetadata.getPromise();this.setState({templatePreviewUrl:a,templatePreviewMetadata:b})}catch(d){c.isCancelled(d)||this.setState({templatePreviewUrl:null,templatePreviewMetadata:{stepTimes:[],autoplay:!1},initialLoading:!1,isError:!0,error:d})}})}componentWillUnmount(){null!=this.loadTemplatePreviewLiteMetadata&&this.loadTemplatePreviewLiteMetadata.cancel()}render(){const a=0===this.state.step,d=this.state.templatePreviewMetadata.stepTimes.length,c=this.state.step===
d-1,g=this.state.initialLoading&&!this.state.templatePreviewMetadata.autoplay;var f=this.props.selectedTemplate.templateId;f="ppt_20_min_w48"===f||"blank"===f?e.I18n.ts("Start editing"):e.I18n.ts("Use this template");return b.createElement(n.PreviewPlayer,Object.assign({selectedTemplate:this.props.selectedTemplate,handleStartEditingError:this.props.handleStartEditingError,handlePreviewClose:this.props.handlePreviewClose,loadingOverlay:g,startEditingController:this.props.startEditingController,isFirstStep:a,
isLastStep:c,goToNext:this.goToNext,goToPrevious:this.goToPrevious,goToFirst:this.goToFirst,step:this.state.step,pulsateStartEditingButton:this.props.pulsateStartEditingButton,pulsateButton:this.props.pulsateButton,isBuffering:this.state.isBuffering,isError:this.state.isError,error:this.state.error,totalStepCount:d,startButtonText:f,deemphasizeButton:this.props.deemphasizeButton},this.props.privacyPaywallPreviewProps,{afterCreateAction:this.props.afterCreateAction}),b.createElement(r.PreviewVideoContainer,
{pulsateStartEditingButton:this.props.pulsateStartEditingButton,templatePreviewUrl:this.state.templatePreviewUrl,templatePreviewMetadata:this.state.templatePreviewMetadata,step:this.state.step,jumpToFrame:this.state.jumpToFrame,onPlayingStepFinished:this.onPlayingStepFinished,onBufferChange:this.onVideoBufferChange,onError:this.onVideoError,isBlurred:c,autoplay:this.state.templatePreviewMetadata.autoplay}),this.props.children)}};p.TemplatePreviewLite.displayName="TemplatePreviewLite";var D={};Object.defineProperty(D,
"__esModule",{value:!0});D.TemplatePreviewLoading=class extends b.Component{constructor(){super(...arguments);this.dummyCallback=()=>!1;this.state={isLoading:!0,error:null}}componentDidMount(){this.loadingTimeout=window.setTimeout(()=>this.setState({isLoading:!1,error:"TemplatePreviewCetController initilization timeout"}),1E4)}componentWillUnmount(){clearTimeout(this.loadingTimeout)}render(){return b.createElement(n.PreviewPlayer,Object.assign({selectedTemplate:this.props.selectedTemplate,handlePreviewClose:this.props.handlePreviewClose,
handleStartEditingError:this.props.handleStartEditingError,loadingOverlay:this.state.isLoading,startEditingController:this.props.startEditingController,isFirstStep:!0,isLastStep:!1,goToNext:this.dummyCallback,goToPrevious:this.dummyCallback,goToFirst:this.dummyCallback,step:0,pulsateStartEditingButton:this.props.pulsateStartEditingButton,pulsateButton:this.props.pulsateButton,isBuffering:!1,isError:!this.state.isLoading,error:this.state.error,totalStepCount:0},this.props.privacyPaywallPreviewProps,
{afterCreateAction:this.props.afterCreateAction}),this.props.children)}};var t={};Object.defineProperty(t,"__esModule",{value:!0});const I=e.I18n;var J={position:"absolute",zIndex:200,bottom:0,width:"100%",backgroundColor:"#F3F5F9",color:"#475262",height:"auto",borderRadius:"0 0 4px 4px"},K={backgroundColor:"#1B2739",color:"#ffffff"},L={marginLeft:"6%",marginRight:"6%",paddingTop:30},M={fontSize:24,marginBottom:null,lineHeight:1.5},N={marginRight:"75px",marginBottom:30},O={paddingLeft:"6%"},P={fontFamily:"RalewayRegular,Helvetica,sans-serif",
marginLeft:"auto",marginRight:"auto",textAlign:"left",fontSize:"24px",lineHeight:"30px"},Q={fontWeight:"bold"},R={marginLeft:"auto",marginRight:"auto",textAlign:"left",fontSize:13,opacity:.5},S={marginLeft:15,marginBottom:30},T={fontFamily:"RalewayRegular,Helvetica,sans-serif"};t.TemplatePaywallBanner=class extends b.Component{constructor(a){super(a)}render(){if(!this.props.isVisible)return null;const a=e.I18n.tsFormatKeys("Get the most from this <strong>{templateName}</strong> template as well as tons of other great benefits when you upgrade to {packageName}.",
{templateName:I.ts(this.props.templateName,{context:"Template name"}),packageName:this.props.upgradeInfo.packageName});return b.createElement(b.Fragment,null,b.createElement("div",{style:J},b.createElement("div",{className:" v",style:K},b.createElement("div",{className:"close-banner icon-close close-small",onClick:this.props.closeBanner}),b.createElement("div",{className:"row",style:L},b.createElement("p",{className:"template-paywall-banner-message",style:M,dangerouslySetInnerHTML:{__html:a}})),b.createElement("div",
{className:"row",style:O},this.props.upgradeInfo.price&&b.createElement("div",{className:"pull-left",style:S},b.createElement("div",{style:P},b.createElement("span",{style:Q},this.props.upgradeInfo.price),b.createElement("span",null,"/",e.I18n.ts("month"))),b.createElement("div",{style:R},e.I18n.ts("BILLED ANNUALLY"))),b.createElement("div",{className:"pull-right",style:N},b.createElement("button",{type:"button",style:T,className:"btn-sm gold",onClick:()=>{this.props.showTemplatePaywallCallback();
return!1}},this.props.upgradeInfo.isTrialEligible?e.I18n.ts("Start your FREE trial"):e.I18n.ts("Upgrade now")))))))}};t.TemplatePaywallBanner.displayName="TemplatePaywallBanner";var u={};Object.defineProperty(u,"__esModule",{value:!0});u.TemplatePreview=class extends b.Component{constructor(){super(...arguments);this.state={pulsateButton:!1,showBanner:this.props.selectedTemplate.isPlusTemplate};this.pulsateStartEditingButton=()=>{this.setState({pulsateButton:!0});setTimeout(()=>this.setState({pulsateButton:!1}),
1E3)}}injectPlusPaywallBannerIntoPreview(a){return b.Children.map(a,(a)=>b.isValidElement(a)?null!=a.props.selectedTemplate?b.cloneElement(a,{},[a.props.children,b.createElement(t.TemplatePaywallBanner,{closeBanner:()=>this.setState({showBanner:!1}),isVisible:this.state.showBanner,templateName:a.props.selectedTemplate.name,upgradeInfo:this.props.upgradeInfo,showTemplatePaywallCallback:this.props.showTemplatePaywallCallback})]):a:a)}render(){let a=this.getPreview();this.props.showTemplatePaywall&&
!this.props.isPrivacyEditorShown&&(a=this.injectPlusPaywallBannerIntoPreview(a));return this.props.privacyPaywallTemplatePreviewSection.createPrivacyTemplatePreviewWrapper(a)}getPreview(){const a=this.props.selectedTemplate,c=Object.assign({pulsateButton:this.state.pulsateButton,pulsateStartEditingButton:this.pulsateStartEditingButton,deemphasizeButton:this.props.showTemplatePaywall&&this.state.showBanner},this.props);return this.props.templateService.hasTemplatePreviewLite(a)?b.createElement(p.TemplatePreviewLite,
Object.assign({},c)):null!=this.props.templatePreviewCetController?this.props.templatePreviewCetController.createTemplatePreviewCet(c):b.createElement(D.TemplatePreviewLoading,Object.assign({},c))}};u.TemplatePreview.displayName="TemplatePreview";var E={};Object.defineProperty(E,"__esModule",{value:!0});E.TemplatePreviewControllerImpl=class{createTemplatePreview(a){return b.createElement(u.TemplatePreview,Object.assign({},a))}};var c={};Object.defineProperty(c,"__esModule",{value:!0});(function(a){a[a.CLOSE_BUTTON=
0]="CLOSE_BUTTON";a[a.BACKGROUND_CLICK=1]="BACKGROUND_CLICK";a[a.ESC_KEY_PRESSED=2]="ESC_KEY_PRESSED"})(c.ClosePreviewSource||(c.ClosePreviewSource={}));c.PreviewPlayerComponent=n.PreviewPlayer;c.makeCancelablePromise=function(a){return new x.CancelablePromiseImpl(a)};c.isCancelled=function(a){return!!a.isCancelled};c.createTemplatePreviewController=function(){return new E.TemplatePreviewControllerImpl};v=c;f=document.createElement("style");f.textContent=".template-preview-outer{box-shadow:rgba(21,34,53,0.6) 0 30px 25px}.template-preview{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;left:318px;right:0;top:0;bottom:0;background-color:#475262;color:#fff;overflow:hidden}.template-preview .template-chooser-tooltip .koi-floating-popup-content{background-color:#efcf1c;color:#152235;font-size:13px;font-family:'RalewayMedium';letter-spacing:.5px;height:36px;line-height:13px}.template-preview .template-chooser-tooltip .koi-floating-popup-pointer{background-color:#efcf1c}.app-container,.app-container div,.app-container div canvas{width:100%;height:100%}.template-preview-header{background-color:#152235;height:36px;padding-right:18px;color:#fff}.start-editing-button-container{position:absolute}.start-editing-button-container .koi-spinner-container{position:absolute;top:9px;left:91px;width:30px;height:30px}.koi-button.start-editing-button{background-color:#3181ff;color:#fff;font-family:\"RalewaySemiBold\";font-size:16px;text-align:center;width:212px;height:48px;line-height:48px;letter-spacing:.5px;border-radius:4px;cursor:pointer;border:1px solid #3181ff;transition:background .2s ease}.koi-button.start-editing-button:hover{background-color:#1e55eb}.koi-button.start-editing-button.pulsate{-webkit-animation:pulsate .5s ease-in-out 0s 1 normal both running;-moz-animation:pulsate .5s ease-in-out 0s 1 normal both running;-ms-animation:pulsate .5s ease-in-out 0s 1 normal both running;-o-animation:pulsate .5s ease-in-out 0s 1 normal both running;animation:pulsate .5s ease-in-out 0s 1 normal both running;-webkit-animation-name:pulsate;-webkit-animation-duration:.5s;-webkit-animation-iteration-count:1;-webkit-animation-timing-function:ease-in-out;-webkit-animation-delay:0s;-webkit-animation-direction:normal;-webkit-animationanimation-fill-mode:both;-webkit-animation-play-state:running}.koi-button.start-editing-button.deemphasize{background-color:#152235;border-color:#152235}.koi-button.start-editing-button.deemphasize:hover{background-color:#1e55eb;border-color:#3181ff}.koi-button.start-editing-button.hidden{visibility:hidden}.koi-button.start-editing-button.overlay-button{background:transparent;border-radius:3px;border:solid 1px rgba(255,255,255,0.6)}.koi-button.start-editing-button.overlay-button:hover{background-color:rgba(255,255,255,0.17)}.restart-button:hover{background-color:rgba(255,255,255,0.17)}.template-navigation-buttons{bottom:0;white-space:nowrap;width:100%;background-color:#152235;text-align:center;overflow:hidden}.template-navigation-buttons .koi-tooltip{display:inline-block}.template-navigation-buttons .koi-tooltip .koi-floating-popup-content,.template-navigation-buttons .koi-tooltip .koi-floating-popup-pointer{font-size:11px;border:1px solid rgba(255,255,255,0.3);background:#152235}.template-navigation-buttons .koi-tooltip .koi-floating-popup-container{background:none;box-shadow:none;bottom:8px !important;top:auto !important}.template-navigation-buttons .koi-tooltip .koi-floating-popup-pointer.koi-pointer-bottom{border-left:none;border-top:none;height:10px;bottom:-5px;top:auto;width:10px;z-index:201}.template-navigation-buttons .koi-tooltip .koi-floating-popup-pointer-shadow.koi-pointer-bottom{display:none;height:10px;width:10px;z-index:199}.template-navigation-buttons .koi-tooltip .koi-floating-popup-content{border-radius:4px;color:#fff;font-family:\"RalewayMedium\";font-size:13px;letter-spacing:.5px;padding:9px 12px}.template-navigation-buttons .template-navigation-button{border-radius:0;color:#fff;cursor:pointer;padding:5px 30px 0 30px !important;background-color:transparent}.template-navigation-buttons .template-navigation-button>i{padding-bottom:2px}.template-navigation-buttons .template-navigation-button.disabled{color:#475262}.template-navigation-buttons .template-navigation-button.template-navigation-onboarding{-webkit-animation:blink 1.2s ease-in-out 0s infinite normal both running;-moz-animation:blink 1.2s ease-in-out 0s infinite normal both running;-ms-animation:blink 1.2s ease-in-out 0s infinite normal both running;-o-animation:blink 1.2s ease-in-out 0s infinite normal both running;animation:blink 1.2s ease-in-out 0s infinite normal both running;-webkit-animation-name:blink;-webkit-animation-duration:1.2s;-webkit-animation-iteration-count:infinite;-webkit-animation-timing-function:ease-in-out;-webkit-animation-delay:0s;-webkit-animation-direction:normal;-webkit-animationanimation-fill-mode:both;-webkit-animation-play-state:running}.template-preview-container .template-navigation-buttons{overflow:visible}.template-preview-container .template-navigation-buttons .koi-floating-popup-container{bottom:30px !important}@-webkit-keyframes blink{0%{background:#4cd3d1}50%{background:rgba(76,211,209,0)}100%{background:#4cd3d1}}@-moz-keyframes blink{0%{background:#4cd3d1}50%{background:rgba(76,211,209,0)}100%{background:#4cd3d1}}@keyframes blink{0%{background:#4cd3d1}50%{background:rgba(76,211,209,0)}100%{background:#4cd3d1}}@-webkit-keyframes pulsate{0%{-webkit-transform:scale(1)}20%{-webkit-transform:scale(1.1)}60%{-webkit-transform:scale(.9)}100%{-webkit-transform:scale(1)}}@-moz-keyframes pulsate{0%{transform:scale(1)}20%{transform:scale(1.1)}60%{transform:scale(.9)}100%{transform:scale(1)}}@keyframes pulsate{0%{-webkit-transform:scale(1);transform:scale(1)}20%{-webkit-transform:scale(1.1);transform:scale(1.1)}60%{-webkit-transform:scale(.9);transform:scale(.9)}100%{-webkit-transform:scale(1);transform:scale(1)}}@-webkit-keyframes appear{0%{-webkit-opacity:0}100%{-webkit-opacity:1}}@-webkit-keyframes appear{0%{opacity:0}100%{opacity:1}}.template-preview-container .template-preview-title{font-size:16px;font-family:'RalewayRegular';letter-spacing:.6px;text-overflow:ellipsis;white-space:nowrap;overflow-x:hidden;overflow-y:hidden}.template-preview-container .template-preview{z-index:1;padding:20px 20%;left:0;right:0;top:0;bottom:0;background:transparent}.template-preview-container .template-preview .template-preview-outer{position:relative;margin:90px auto 0 auto}.template-preview-container .template-preview .template-preview-outer .template-navigation-buttons{position:absolute;top:100%;border-radius:0 0 3px 3px}.template-preview-container .template-preview .template-preview-outer .domLayer.playerLayer{display:none}.template-preview-container .template-preview .template-preview-outer canvas{border-radius:3px 3px 0 0}.template-preview-container .template-preview .start-editing-button-container{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;margin-top:80px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.template-preview-container .template-preview .close-preview,.template-preview-container .template-preview .close-banner{cursor:pointer;position:absolute;top:20px;right:20px}.template-preview-container .template-preview .icon-close{font-size:25px;font-weight:900;color:#fff}.template-preview-container .template-preview .close-small{font-size:16px}.template-preview-container .with-overlay{background:rgba(0,0,0,0.7)}.template-preview-container .template-title-container{position:absolute !important;top:-30px;width:100%;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;white-space:nowrap}.template-navigation-buttons{height:30px}.template-navigation-buttons .template-navigation-button{width:210px;font-size:24px;height:30px;line-height:30px}.template-navigation-buttons .template-navigation-button:hover{background:#363f4f}.template-preview-container .template-navigation-buttons,.template-preview-container .template-navigation-button{height:48px}\n";
document.body.appendChild(f);return v});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_templatepreview",["require","react","react-dom","react-transition-group","styled-components","prezi_canvas_listener","prezi_dragon","prezi_featureswitcher","prezi_i18n","prezi_koi_widgets","prezi_logger","prezi_privacypaywall","prezi_templatechooser","prezi_templateservice","prezi_utils","prezi_widgets"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_templatepreview.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("react"),require("react-dom"),require("react-transition-group"),require("styled-components"),require("prezi_canvas_listener"),require("prezi_dragon"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_koi_widgets"),require("prezi_logger"),require("prezi_privacypaywall"),require("prezi_templatechooser"),require("prezi_templateservice"),require("prezi_utils"),require("prezi_widgets"));}else{this["prezi_templatepreview"]=__factory(React,ReactDOM,ReactTransitionGroup,StyledComponents,this["prezi_canvas_listener"],this["prezi_dragon"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_koi_widgets"],this["prezi_logger"],this["prezi_privacypaywall"],this["prezi_templatechooser"],this["prezi_templateservice"],this["prezi_utils"],this["prezi_widgets"]);}}).call(this);