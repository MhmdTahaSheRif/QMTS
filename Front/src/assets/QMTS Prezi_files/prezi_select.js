;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_select";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi.geometry":dependencies[0],"prezi_app_utils":dependencies[1],"prezi_bacon":dependencies[2],"prezi_cet":dependencies[3],"prezi_cet_model":dependencies[4],"prezi_cet_model_editor":dependencies[5],"prezi_cet_renderer":dependencies[6],"prezi_editor_commander":dependencies[7],"prezi_editor_store_common":dependencies[8],"prezi_editor_store_mode":dependencies[9],"prezi_editor_store_object":dependencies[10],"prezi_externalserviceprovider":dependencies[11],"prezi_featureswitcher":dependencies[12],"prezi_i18n":dependencies[13],"prezi_logger":dependencies[14],"prezi_plugin_meta":dependencies[15],"prezi_spellcheck":dependencies[16],"prezi_textmodel":dependencies[17],"prezi_utils":dependencies[18],"prezi_widgets":dependencies[19]}};})());};})(arguments);var moduleImpl=(function(){return module(function(y){var ka=null,Q=y.dependencies.prezi_app_utils,la=y.dependencies.prezi_bacon,r=y.dependencies.prezi_cet_renderer,m=y.dependencies.prezi_editor_commander,z=y.dependencies.prezi_editor_store_mode,oa=y.dependencies.prezi_externalserviceprovider,w=y.dependencies.prezi_featureswitcher,I=y.dependencies.prezi_i18n,pa=y.dependencies.prezi_logger,N=y.dependencies.prezi_spellcheck,qa=y.dependencies.prezi_textmodel,ma=y.dependencies.prezi_widgets,k=y.dependencies["prezi.geometry"],h=y.dependencies.prezi_cet,
q=y.dependencies.prezi_cet_model,t=y.dependencies.prezi_cet_model_editor,D=y.dependencies.prezi_editor_store_object,B=y.dependencies.prezi_utils,R={};Object.defineProperty(R,"__esModule",{value:!0});R.xd=class{constructor(a,b){this.tc=a;this.getScene=b}yf(a,b,c){a=[...new Set(a)];b=[...new Set(b)];const d=[...b];if(0<a.length){const b=t.CetModelEditor.createGroupQuery();for(var e of a)for(const a of b.getGroupMembers(this.getScene(),e))d.push(a.getId())}e=[...new Set(d)];this.tc.setSelection({groupIds:a,
nonGroupedEntityIds:b,allEntityIds:e},c)}Mc(a,b,c){switch(c){case D.SelectActionType.replace:return b;case D.SelectActionType.add:return[...a,...b];case D.SelectActionType.remove:return a.filter((a)=>0>b.indexOf(a));case D.SelectActionType.toggle:const d=new Set(a),e=new Set(b.filter((a)=>d.has(a)));return[...a,...b].filter((a)=>!e.has(a));default:return B.Utils.assertNever(c)}}select(a){const b=void 0===a.source?null:a.source,c=this.tc.getSelectionSource()===b?a.type:a.type===D.SelectActionType.remove?
D.SelectActionType.remove:D.SelectActionType.replace,d=this.tc.getSelection();this.yf(this.Mc(d.groupIds,a.selectedGroupIds,c),this.Mc(d.nonGroupedEntityIds,a.selectedEntityIds,c),b)}};var u={w:function(a){return{interactionType:l.InteractionType.none,ownerIds:a}},clickable:function(a){return{interactionType:l.InteractionType.clickable,ownerIds:[a]}},rc:function(a){return{interactionType:l.InteractionType.border,ownerIds:a}},topicZoomAreaBorder:function(a){return{interactionType:l.InteractionType.topicZoomAreaBorder,
ownerIds:[a]}},controlPoint:function(a){return{interactionType:l.InteractionType.controlPoint,ownerIds:a}},locked:function(a){return{interactionType:l.InteractionType.locked,ownerIds:a}},maskDrag:function(a){return{interactionType:l.InteractionType.maskDrag,ownerIds:[a]}},gf:function(a){return{interactionType:l.InteractionType.controlPoint,ownerIds:[a]}}};Object.defineProperty(u,"__esModule",{value:!0});var v={};Object.defineProperty(v,"__esModule",{value:!0});const ra={ja:0,ia:0,Wa:0,Xa:0,$b:0,hd:0},
K=()=>({borderColor:"#3181ff",ua:1,fillColor:"#000000",v:0,thickness:w.isActive("js-for-test-thick-selection")?6:1});v.Lb={border:w.isActive("js-unique-differentiation")?"#152235":"#ffffff",Yc:w.isActive("js-unique-differentiation")?"#ffffff":"#152235",ad:"#152235",$c:"#ffffff",v:0};v.Jd={border:"#3181ff",Yc:"#3181ff",ad:"#ffffff",$c:"#3181ff",v:0};class n{constructor(a,b){this.camera=a;this.f=b;this.fa=l.SelectionModule.getDecoratorKey()}kb(a,b,c,d,e){if(1>c.getHeight()||1>c.getWidth())return null;
const f={color:"#ffffff",borderColor:"#3181ff",opacity:.5},g=(b)=>{const {color:c,opacity:d,borderColor:g}=Object.assign(Object.assign({},f),e);h.Cet.setFillComponentWithSolidColor(b,k.Geometry.colorFromRGBString(c),d);h.Cet.setBorder(b,2,k.Geometry.colorFromRGBString(g),1);b.set(this.fa,u.w([a]));return b};return this.f.kb(b,(a,b)=>g(a,b),(a)=>{const {x:b,y:e}=this.rotate({x:c.topLeftVertex().x-d.getCenterX(),y:c.topLeftVertex().y-d.getCenterY()},d.getRotation()),f=k.Geometry.rectangleFromData({x:b,
y:e,height:c.getHeight(),width:c.getWidth()});a.set(r.CetRendererModule.getDrawingDimensionsKey(),f)},d)}jb(a,b,c,d){b=this.f.wa(b,c);return this.f.jb(n.Re(a),(b)=>{b.set(h.Cet.getEntityHittestDisabledKey(),!0,!0);b.set(this.fa,u.w([a]));return b},(a)=>{a.set(r.CetRendererModule.getArcComponentKey(),d)},b)}ce(a,b,c,d){var e=r.CetRendererModule.CurvedLineCalculation(),f=e.getStartPoint(a),g=e.getEndPoint(a),p=e.getOrigin(a),h=e.getRadius(a);const k=e.getStartAngle(a);e=e.getEndAngle(a);b*=this.f.getCameraTransform().getScale();
f={x:f.x*b,y:f.y*b};g={x:g.x*b,y:g.y*b};p={x:p.x*b,y:p.y*b};h*=b;a=a.getArcHeight()*b;return{headPos:g,tailPos:f,origin:p,radius:h,startAngle:k,endAngle:e,isStraight:0===a,isInverse:0<a,color:c,thickness:w.isActive("js-for-test-thick-selection")?12:1,alpha:d}}oa(a,b,c,d,e,f=0){var g=d;const p=this.f.wa(c,d);0<f&&(g=c.getScale()*this.f.getCameraTransform().getScale(),f/=g,g=d.inflate(f,f));c=this.f.wa(c,g);e=e?c:k.Geometry.obbFromRect(c.getBounds().getData());return 1>e.getHeight()||1>e.getWidth()?
null:this.f.Ja(a,b,(a)=>{a.set(r.CetRendererModule.getDrawingDimensionsKey(),k.Geometry.rectangleFromData({x:-p.getWidth()/2,y:-p.getHeight()/2,height:p.getHeight(),width:p.getWidth()}))},e)}$d(a,b,c,d){this.oa(n.$e(a),(b)=>{h.Cet.setZOrderComp(b,r.CetRendererModule.createZOrderComponent(0,r.LayerType.DecoratorLayer));b.setComponent(r.CetRendererModule.getDrawComponentKey(),r.CetRendererModule.createTextHittestRectangleRenderer());h.Cet.setFillComponentWithSolidColor(b,k.Geometry.colorFromRGBString("#000000"),
0);h.Cet.setBorder(b,w.isActive("js-for-test-thick-selection")?6:2,k.Geometry.colorFromRGBString("#3181ff"),1);b.set(this.fa,d?u.rc([a]):u.w([a]));return b},b,c,!0,6)}pa(a,b,c,d,e,f={}){this.Yd(a,b,c,e?u.rc(d):u.w(d),f)}Yd(a,b,c,d,e={}){const f=Object.assign(Object.assign({},K()),e);this.oa(n.Wc(a),(a)=>{h.Cet.setBorder(a,f.thickness,k.Geometry.colorFromRGBString(f.borderColor),f.ua);h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString(f.fillColor),f.v);a.set(this.fa,d);return a},
b,c,!0,6)}Od(a,b,c,d){const e=Object.assign(Object.assign({},Object.assign(Object.assign({},K()),{borderColor:"#ffffff"})),{borderColor:"#747c87"});this.oa(n.Wc(a),(a)=>{h.Cet.setBorder(a,e.thickness,k.Geometry.colorFromRGBString(e.borderColor),e.ua);h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString(e.fillColor),e.v);a.set(r.CetRendererModule.getDashedDecoratorComponentKey(),[2,2]);a.set(this.fa,u.rc(d));return a},b,c,!0,6)}Fc(a,b,c,d,e={}){const f=Object.assign(Object.assign({},
{borderColor:"#ffffff",ua:1,fillColor:"#000000",v:0,thickness:1}),e);this.oa(n.Ze(a),(a)=>{h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString(f.fillColor),f.v);h.Cet.setBorder(a,f.thickness,k.Geometry.colorFromRGBString(f.borderColor),f.ua);a.set(this.fa,d);return a},b,c,!0)}ha(a,b,c,d={},e={}){const {ownerIds:f,fd:g}=Object.assign(Object.assign({},{fd:!0,ownerIds:[c]}),d),p=Object.assign(Object.assign({},Object.assign(Object.assign({},K()),{thickness:w.isActive("js-for-test-thick-selection")?
4:1})),e);this.oa(n.Ve(c),(a)=>{h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString(p.fillColor),p.v);h.Cet.setBorder(a,p.thickness,k.Geometry.colorFromRGBString(p.borderColor),p.ua);a.set(this.fa,u.w(f));return a},a,b,g)}Nb(a,b,c){this.oa(n.Uc(c),(a)=>{h.Cet.setBorder(a,2,k.Geometry.colorFromRGBString("#3181ff"),1);h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString("#000000"),0);a.set(r.CetRendererModule.getDashedDecoratorComponentKey(),[5,5]);a.set(this.fa,u.w([c]));
return a},a,b,!0)}Rb(a,b,c,d,e){this.oa(a,(a)=>{h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString(e.border),e.v);h.Cet.setBorder(a,1,k.Geometry.colorFromRGBString(e.border),1);a.set(r.CetRendererModule.getInnerBorderColorKey(),k.Geometry.colorFromRGBString(e.Yc));a.set(l.SelectionModule.getDecoratorKey(),d);return a},b,c,!0,6)}Qd(a,b,c){this.oa(n.Uc(c),(a)=>{h.Cet.setBorder(a,2,k.Geometry.colorFromRGBString("#3181ff"),1);h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString("#000000"),
0);a.set(this.fa,u.w([c]));return a},a,b,!0)}Ua(a,b,c,d,e,f=l.ControlPointType.resize){this.ta(n.Xc(JSON.stringify(d)),d,f,a,e,c,u.controlPoint(b),{ia:n.Ia,ja:n.Ia})}Va(a,b,c){this.Ec(a,b,c);this.Ka(a,b,c)}Ka(a,b,c){const d=k.Geometry.rectangleFromData(n.Ib);this.Ua(a,c,d,m.ControlPointPosition.TOP_LEFT,b.getTopLeft());this.Ua(a,c,d,m.ControlPointPosition.TOP_RIGHT,b.getTopRight());this.Ua(a,c,d,m.ControlPointPosition.BOTTOM_LEFT,b.getBottomLeft());this.Ua(a,c,d,m.ControlPointPosition.BOTTOM_RIGHT,
b.getBottomRight())}lb(a,b,c,d,e,f={}){var g=l.ControlPointType.rotate;this.ta(n.Ye(JSON.stringify(d)),d,g,a,e,c,u.controlPoint(b),f)}Ec(a,b,c){const d=k.Geometry.rectangleFromData({x:0,y:0,width:0,height:0});var e=a.getRotationRad()+this.f.getCameraTransform().getRotationRad(),f=n.vd;let g={x:n.Ia/2-f/2,y:n.Ia/2-f/2};g={x:g.x*Math.cos(e)-g.y*Math.sin(e),y:g.x*Math.sin(e)+g.y*Math.cos(e)};e={ia:f,ja:f,Wa:g.x,Xa:g.y};const p={ia:f,ja:f,Wa:-g.y,Xa:g.x},h={ia:f,ja:f,Wa:g.y,Xa:-g.x};f={ia:f,ja:f,Wa:-g.x,
Xa:-g.y};this.lb(a,c,d,m.ControlPointPosition.TOP_LEFT,b.getTopLeft(),e);this.lb(a,c,d,m.ControlPointPosition.TOP_RIGHT,b.getTopRight(),p);this.lb(a,c,d,m.ControlPointPosition.BOTTOM_LEFT,b.getBottomLeft(),h);this.lb(a,c,d,m.ControlPointPosition.BOTTOM_RIGHT,b.getBottomRight(),f)}Xd(a,b,c,d,e){b=b.getTopLeft();const f=a.getRotationDeg()+this.f.getCameraTransform().getRotationDeg();this.f.Kd(n.Xe(`${c}_${d}_${f}_${e}`),k.Geometry.obbFromData(b.x,b.y,0,0,0).transform(a),d,e?"#3181ff":"#747c87")}mb(a,
b,c,d,e=!1){const f=this.f.wa(b,c);if(!(1>f.getHeight()||1>f.getWidth())){e=e?n.Cd:0;var g=e/(this.f.getCameraTransform().getScale()*b.getScale());this.Hc(m.ControlPointPosition.MIDDLE_LEFT,a,b,{x:c.getTopLeft().x-g,y:c.getTopLeft().y+c.getHeight()/2},f.getHeight(),d,-e);this.Hc(m.ControlPointPosition.MIDDLE_RIGHT,a,b,{x:c.getTopRight().x+g,y:c.getTopRight().y+c.getHeight()/2},f.getHeight(),d,e)}}Ob(a,b,c,d){const e=this.f.wa(b,c);1>e.getHeight()||1>e.getWidth()||(this.Bc(m.ControlPointPosition.MIDDLE_TOP,
a,b,{x:c.getTopLeft().x+c.getWidth()/2,y:c.getTopLeft().y},e.getWidth(),d),this.Bc(m.ControlPointPosition.MIDDLE_BOTTOM,a,b,{x:c.getBottomLeft().x+c.getWidth()/2,y:c.getBottomLeft().y},e.getWidth(),d))}Hc(a,b,c,d,e,f,g=0){this.ta(n.af(JSON.stringify(a)),a,b,c,d,k.Geometry.rectangleFromData({x:-3-g,y:-6,height:12,width:6}),u.controlPoint(f),{ja:n.zc+2*Math.abs(g),ia:.8*e,hd:g})}Bc(a,b,c,d,e,f){this.ta(n.Ue(JSON.stringify(a)),a,b,c,d,k.Geometry.rectangleFromData({x:-6,y:-3,width:12,height:6}),u.controlPoint(f),
{ja:.8*e,ia:n.zc})}ta(a,b,c,d,e,f,g,p={},G={}){const m=Object.assign(Object.assign({},Object.assign(Object.assign({},K()),{fillColor:"#ffffff",v:1,thickness:1})),G);p=Object.assign(Object.assign({},ra),p);G=0<p.ia?p.ia:f.getHeight();let n=0<p.ja?p.ja:f.getWidth();G=k.Geometry.rectangleFromData({x:-n/2,y:-G/2,width:n,height:G});e=this.f.dc(d,e);d=d.getRotationDeg()+this.f.getCameraTransform().getRotationDeg()+p.$b;d=k.Geometry.obbFromData(e.x+p.Wa,e.y+p.Xa,G.getWidth()-2*Math.abs(p.hd),G.getHeight(),
d);this.f.Ja(a,(a)=>{h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString(m.fillColor),m.v);h.Cet.setBorder(a,m.thickness,k.Geometry.colorFromRGBString(m.borderColor),m.ua);a.set(this.fa,g);a.set(l.SelectionModule.getControlPointKey(),{position:b,type:c});return a},(a)=>{a.set(r.CetRendererModule.getDrawingDimensionsKey(),f)},d)}Mb(a,b,c,d,e,f,g){c=k.Geometry.obbFromData(c.x,c.y,e.getWidth(),e.getHeight(),d);this.f.Mb(a,(a)=>{h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString("#000000"),
1);h.Cet.setBorder(a,f,g,1);a.set(this.fa,b);return a},(a)=>{a.set(r.CetRendererModule.getDrawingDimensionsKey(),e)},c)}Wd(a,b,c,d){d?this.pa(a,b,c,[a],!0,{v:.01}):this.Fc(a,b,c,u.clickable(a),{v:.01});const e=k.Geometry.rectangleFromData(n.Ib),f=d?l.ControlPointType.resizeMaskImage:l.ControlPointType.lockedMarker,g=d?{}:{borderColor:"#747c87"},p={ia:n.Ia,ja:n.Ia};[{rb:m.ControlPointPosition.TOP_LEFT,center:c.getTopLeft()},{rb:m.ControlPointPosition.TOP_RIGHT,center:c.getTopRight()},{rb:m.ControlPointPosition.BOTTOM_LEFT,
center:c.getBottomLeft()},{rb:m.ControlPointPosition.BOTTOM_RIGHT,center:c.getBottomRight()}].forEach(({rb:c,center:d})=>this.ta(n.Xc(JSON.stringify(c)),c,f,b,d,e,u.gf(a),p,g))}Vd(a,b,c,d,e){const f={borderColor:"#ffffff",ua:.6,v:.01};d?(this.pa(a+"_maskarea",b,c,[a],!0,f),e||(this.Ob(l.ControlPointType.heightResizeMaskArea,b,c,[a]),this.mb(l.ControlPointType.widthResizeMaskArea,b,c,[a]))):this.Fc(a+"_maskarea",b,c,u.clickable(a),f);const g=d?(b,c,d)=>{b.set(l.SelectionModule.getDecoratorKey(),u.controlPoint([a]));
b.set(l.SelectionModule.getControlPointKey(),{position:c,type:d});return b}:(b)=>b.set(l.SelectionModule.getDecoratorKey(),u.w([a]));d=d?{}:{borderColor:"#747c87"};this.Ta(m.ControlPointPosition.TOP_LEFT,b,c.getTopLeft(),d,(a)=>g(a,m.ControlPointPosition.TOP_LEFT,l.ControlPointType.resizeMaskArea));this.Ta(m.ControlPointPosition.TOP_RIGHT,b,c.getTopRight(),d,(a)=>g(a,m.ControlPointPosition.TOP_RIGHT,l.ControlPointType.resizeMaskArea));this.Ta(m.ControlPointPosition.BOTTOM_LEFT,b,c.getBottomLeft(),
d,(a)=>g(a,m.ControlPointPosition.BOTTOM_LEFT,l.ControlPointType.resizeMaskArea));this.Ta(m.ControlPointPosition.BOTTOM_RIGHT,b,c.getBottomRight(),d,(a)=>g(a,m.ControlPointPosition.BOTTOM_RIGHT,l.ControlPointType.resizeMaskArea))}ob(a,b,c,d){this.nb(a,m.ControlPointPosition.TOP_LEFT,b,c.getTopLeft(),d);this.nb(a,m.ControlPointPosition.TOP_RIGHT,b,c.getTopRight(),d);this.nb(a,m.ControlPointPosition.BOTTOM_LEFT,b,c.getBottomLeft(),d);this.nb(a,m.ControlPointPosition.BOTTOM_RIGHT,b,c.getBottomRight(),
d)}nb(a,b,c,d,e){if(w.isActive("js-unique-differentiation")){const f=k.Geometry.rectangleFromData(n.Ib);this.Ua(c,[a],f,b,d,e)}else this.Ta(b,c,d,{},(c)=>{c.set(l.SelectionModule.getDecoratorKey(),u.controlPoint([a]));c.set(l.SelectionModule.getControlPointKey(),{position:b,type:e});return c})}Ta(a,b,c,d,e){const f=Object.assign(Object.assign({},Object.assign(Object.assign({},K()),{fillColor:"#ffffff",v:1,thickness:2})),d),g=f.thickness;var p=this.f.getCameraTransform().invert().concat(b.invert());
d=b.getRotationDeg()+this.f.getCameraTransform().getRotationDeg();const l=a===m.ControlPointPosition.TOP_LEFT||a===m.ControlPointPosition.BOTTOM_LEFT?1:-1,q=a===m.ControlPointPosition.TOP_LEFT||a===m.ControlPointPosition.TOP_RIGHT?1:-1,sa=15*p.getScale(),r=15*p.getScale();p=g*p.getScale();b=this.f.dc(b,{x:c.x+l*sa/2-l*p,y:c.y+q*r/2-q*p});this.f.Sd(n.cf(m.ControlPointPosition[a]),a,(a,b)=>{h.Cet.setBorder(a,g,k.Geometry.colorFromRGBString(f.borderColor),f.ua);h.Cet.setFillComponentWithSolidColor(a,
k.Geometry.colorFromRGBString(f.fillColor),f.v);return e(a,b)},()=>{},k.Geometry.obbFromData(b.x,b.y,20,20,d))}Ic(a,b){this.f.Md(`${n.guid}.circle.zoom-out-area`,(a)=>{h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString(b),.3);a.set(l.SelectionModule.getDecoratorKey(),u.w([]));return a},(a)=>{h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString(b),.3);return a},a)}static Re(a){return""+n.guid+".arc."+a}static $e(a){return""+n.guid+".text-hittest-border."+a}static Hf(a){return""+
n.guid+".outline-decorator."+a}static Wc(a){return""+n.guid+".border."+a}static Ze(a){return""+n.guid+".secondary-border."+a}static Ve(a){return""+n.guid+".hover-border."+a}static Uc(a){return""+n.guid+".cover-edited-topic-border."+a}static Ef(a){return""+n.guid+".dragged-item-hovered-topic-border."+a}static bf(a){return""+n.guid+".zoom-area."+a}static Df(){return""+n.guid+".topic-area-overlay"}static fc(a){return""+n.guid+".topic-zoom-area."+a}static Xc(a){return""+n.guid+".control-resize-point."+
a}static Ye(a){return""+n.guid+".control-rotate-point."+a}static Ff(a){return""+n.guid+".locked-decorator."+a}static Te(a){return""+n.guid+".chain-topic-decorator."+a}static Se(a){return""+n.guid+".chain-link-decorator."+a}static cf(a){return""+n.guid+".control-resize-point.zoom-area."+a}static af(a){return""+n.guid+".control-widthresize-point."+a}static Ue(a){return""+n.guid+".control-heightresize-point."+a}static Vc(a){return""+n.guid+".control-linemanipulation-point."+a}static We(a){return""+n.guid+
".control-linemanipulation-point.middle."+a}static Gf(a){return""+n.guid+".control-orderindicator-point."+a}static Xe(a){return""+n.guid+".control-orderindicator-label."+a}rotate(a,b){return{x:a.x*Math.cos(b)+a.y*Math.sin(b),y:-1*a.x*Math.sin(b)+a.y*Math.cos(b)}}nf(a,b){let c=a.getPrezi().getChild(q.CetModel.ID.PREZI.OVERVIEW);return b.filter((d)=>{var e=a.getEntityById(d);d=h.Cet.createHierarchyQuery(a);for(e=d.getParentId(e);e!==c.getId()&&null!=e;){if(-1!==b.indexOf(e))return!1;e=d.getParentId(a.getEntityById(e))}return!0})}}
v.ba=n;n.guid="Decorator";n.Ia=22;n.zc=12;n.Cd=2;n.Ib={x:-4,y:-4,width:8,height:8};n.vd=33;var L={};Object.defineProperty(L,"__esModule",{value:!0});const ta=Math.pow(2,-30);L.If=()=>({color:"#ffffff",bgColor:"#2c86fb",ya:!1,va:!1,Ma:null,offsetX:0,offsetY:-8,fontSize:11,Eb:0,fontFamily:"RalewayMedium"});L.wc=class{constructor(a,b){this.camera=a;this.o=b;this.na=[]}Zb(){this.na=[]}Fa(){return this.na}Ld(a,b,c,d,e){if(null!=this.o){const p=a+"canvas-button-container",h=this.o.createElement(p);h.style.display=
"inline-flex";var f=a+"canvas-button-with-chevron";let k=document.getElementById(f);if(null==k){k=document.createElement("div");k.id=f;k.style.transform="translate(-50%, -100%)";k.style.display="inline-flex";k.style.flexDirection="column";k.style.alignItems="center";k.style.opacity="0.8";f=this.o.createElement(a+"canvas-button-decorator");f.style.display="inline-flex";f.style.alignItems="center";f.style.height="32px";f.style.borderRadius="6px";f.style.backgroundColor="#152235";f.style.padding="4px";
f.style.boxSizing="border-box";var g=a+"canvas-button";const c=document.createElement("div");c.id=g;c.style.display="inline-flex";c.style.alignItems="center";c.style.height="24px";c.style.borderRadius="4px";c.style.borderColor="#ffffff";c.style.borderStyle="solid";c.style.borderWidth="thin";c.style.backgroundColor="rgba(255, 255, 255, 0)";c.onmouseenter=()=>c.style.backgroundColor="rgba(255, 255, 255, 0.1)";c.onmouseleave=()=>c.style.backgroundColor="rgba(255, 255, 255, 0)";c.onmousedown=b;c.style.cursor=
"pointer";b=document.createAttribute("data-lookup");b.value=l.Lookup.zoomInButton;c.attributes.setNamedItem(b);b=this.Ya(a+"canvas-button-content-wrapper","12px");null!=e&&(g=document.createElement("span"),g.className=e,g.style.color="#ffffff",b.appendChild(g));a=this.createText(a+"canvas-label-text",d,"#ffffff","RalewaySemiBOld");b.appendChild(a);c.appendChild(b);f.appendChild(c);k.appendChild(f);h.appendChild(k)}c=c.transform(this.camera.getTransform());c=this.bb(c,this.camera.getMarginCorrectedViewport());
this.o.transformScreen(p,{x:c.x,y:-8+c.y},0);this.na.push(h)}}Ud(a,b,c){if(null!=this.o){const d=a+"canvas-icon-container",e=this.o.createElement(d);e.style.display="inline-flex";a+="canvas-icon";let f=document.getElementById(a);null==f?(b=document.createElement("img"),b.id=a,b.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzQiIGhlaWdodD0iMzQiIHZpZXdCb3g9IjAgMCAzNCAzNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMSIgeT0iMSIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iMTYiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjQuNzA0MyAxMi41NTQ1QzI1LjA5NDggMTIuMTY0IDI1LjA5NDggMTEuNTMwOCAyNC43MDQzIDExLjE0MDNMMjIuODU5OSA5LjI5NTk0QzIyLjQ2OTQgOC45MDU0MiAyMS44MzYyIDguOTA1NDIgMjEuNDQ1NyA5LjI5NTk1TDExLjIxODYgMTkuNTIzTDE0LjQ3NzIgMjIuNzgxNkwyNC43MDQzIDEyLjU1NDVaTTEzLjA3MzMgMjQuMTg1M0w5IDI1TDkuODE0NjYgMjAuOTI2OEwxMy4wNzMzIDI0LjE4NTNaIiBmaWxsPSJibGFjayIvPgo8ZyBmaWx0ZXI9InVybCgjZmlsdGVyMF9iKSI+CjxyZWN0IHg9IjEiIHk9IjEiIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgcng9IjE2IiBmaWxsPSJibGFjayIgZmlsbC1vcGFjaXR5PSIwLjgiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yNC43MDQzIDEyLjU1NDVDMjUuMDk0OCAxMi4xNjQgMjUuMDk0OCAxMS41MzA4IDI0LjcwNDMgMTEuMTQwM0wyMi44NTk5IDkuMjk1OTRDMjIuNDY5NCA4LjkwNTQyIDIxLjgzNjIgOC45MDU0MiAyMS40NDU3IDkuMjk1OTVMMTEuMjE4NiAxOS41MjNMMTQuNDc3MiAyMi43ODE2TDI0LjcwNDMgMTIuNTU0NVpNMTMuMDczMyAyNC4xODUzTDkgMjVMOS44MTQ2NiAyMC45MjY4TDEzLjA3MzMgMjQuMTg1M1oiIGZpbGw9IndoaXRlIi8+CjwvZz4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIzMyIgaGVpZ2h0PSIzMyIgcng9IjE2LjUiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS1vcGFjaXR5PSIwLjA4Ii8+CjxkZWZzPgo8ZmlsdGVyIGlkPSJmaWx0ZXIwX2IiIHg9Ii0zOSIgeT0iLTM5IiB3aWR0aD0iMTEyIiBoZWlnaHQ9IjExMiIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgo8ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPgo8ZmVHYXVzc2lhbkJsdXIgaW49IkJhY2tncm91bmRJbWFnZSIgc3RkRGV2aWF0aW9uPSIyMCIvPgo8ZmVDb21wb3NpdGUgaW4yPSJTb3VyY2VBbHBoYSIgb3BlcmF0b3I9ImluIiByZXN1bHQ9ImVmZmVjdDFfYmFja2dyb3VuZEJsdXIiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2JhY2tncm91bmRCbHVyIiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8L2RlZnM+Cjwvc3ZnPgo=",
b.style.height=c.getHeight()+"px",b.style.width=c.getWidth()+"px",b.style.transform="translate(-50%, -50%)",b.style.animationName="fadeIn",b.style.animationDuration="0.3s",b.style.webkitAnimationName="fadeIn",b.style.webkitAnimationDuration="0.3s",b.className="canvas-icon",e.appendChild(b),e.style.pointerEvents="none"):f.style.opacity=b?"0.8":"1";b=c.getCenterX();a=c.getCenterY();b={x:b,y:a};c=c.getRotationRadians();this.o.transformScreen(d,b,c);e.className="icon-decorator";this.na.push(e)}}Kd(a,
b,c,d){if(null!=this.o){var e=a+"canvas-path-element-label-container",f=this.o.createElement(e);f.style.display="inline-flex";f.style.zIndex="1";var g=a+"canvas-button-with-chevron";if(null==document.getElementById(g)){const b=document.createElement("div");b.id=g;b.style.display="inline-flex";b.style.height="22px";b.style.borderRadius="11px";b.style.backgroundColor=d;b.style.minWidth="22px";b.style.justifyContent="center";b.style.alignItems="center";b.className="gadgetFadeOnHover";a=this.createText(a+
"canvas-label-text",c,"#ffffff","RalewayBold","12px");a.style.marginLeft="4px";a.style.marginRight="4px";b.appendChild(a);f.appendChild(b)}b=b.transform(this.camera.getTransform());b=this.bb(b,this.camera.getMarginCorrectedViewport());this.o.transformScreen(e,{x:b.x-11,y:b.y-11},0);this.na.push(f)}}Pb(a,b,c,d){var e=Object.assign(Object.assign({},{color:"#ffffff",bgColor:"#2c86fb",ya:!1,va:!1,Ma:null,offsetX:0,offsetY:-8,fontSize:11,Eb:0,fontFamily:"RalewayMedium"}),d);if(null!=this.o){d=a+"canvas-label-container";
var f=a+"canvas-label-content-wrapper";const p=this.o.createElement(d);p.style.display="inline-flex";b=b.transform(this.camera.getTransform());p.style.height="18px";e.ya&&(p.style.zIndex="1");var g=document.getElementById(f);null==g&&(g=this.Ya(f,"18px"),g.style.backgroundColor=e.bgColor,g.style.borderRadius="3px",g.style.transform="translate(-50%, -100%)",e.ya&&(g.style.animationName="fadeOut",g.style.animationDuration="0.2s",g.style.animationDelay="3s",g.style.animationFillMode="forwards"),null!=
e.Ma&&(f=document.createElement("img"),f.src="data:image/svg+xml;charset=utf-8,"+e.Ma,f.style.height="12px",g.appendChild(f)),a=this.createText(a+"canvas-label-text",c,e.color,e.fontFamily,`${e.fontSize}px`),a.style.transform=`rotate(${e.Eb}deg)`,g.appendChild(a),p.appendChild(g));a=e.offsetX;c=e.offsetY;g=e.va?this.bb(b,this.camera.getMarginCorrectedViewport()):{x:(b.topLeftVertex().x+b.topRightVertex().x)/2,y:(b.topLeftVertex().y+b.topRightVertex().y)/2};a={x:a+g.x,y:c+g.y};e=e.va?0:b.getRotationRadians();
this.o.transformScreen(d,a,e);this.na.push(p)}}be(a,b){var c=Object.assign(Object.assign({},{color:"#ffffff",bgColor:"#2c86fb",ya:!1,va:!1,Ma:null,offsetX:0,offsetY:-8,fontSize:11,Eb:0,fontFamily:"RalewayMedium"}),{});if(null!=this.o){const f=this.o.createElement("label-id-2canvas-hover-text-container");f.style.display="inline-flex";a=a.transform(this.camera.getTransform());f.style.height="60px";f.style.width="280px";f.style.top="2px";c.ya&&(f.style.zIndex="1");var d=document.getElementById("label-id-2canvas-hover-text-content-wrapper");
if(null==d){d=this.Ya("label-id-2canvas-hover-text-content-wrapper","60px");d.style.width="280px";d.style.backgroundColor="rgba(21, 34, 53, 0.8)";d.style.backfaceVisibility="inherit";d.style.borderRadius="4px";d.style.transform="translate(-65.5%, -100%)";c.ya&&(d.style.animationName="fadeOut",d.style.animationDuration="0.2s",d.style.animationDelay="3s",d.style.animationFillMode="forwards");if(null!=c.Ma){var e=document.createElement("img");e.src="data:image/svg+xml;charset=utf-8,"+c.Ma;e.style.height=
"12px";d.appendChild(e)}b=this.createText("label-id-2canvas-label-text",b,c.color,c.fontFamily,"14px");b.style.whiteSpace="normal";b.style.letterSpacing="1.1px";b.style.marginRight="10px";b.style.marginLeft="10px";b.style.transform=`rotate(${c.Eb}deg)`;b.style.textOverflow="none";b.style.lineHeight="1.39";d.appendChild(b);b=document.createElement("div");b.innerHTML='\n\t\t\t\t<svg width="14" height="8" viewBox="0 0 14 7" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M7 7L0 0L14 0L7 7Z" fill="#152235" fill-opacity="0.8"/>\n\t\t\t\t</svg>\n\t\t\t\t';
b.style.height="4px";b.style.position="absolute";b.style.width="14px";b.style.zIndex="3000";b.style.top="54px";b.style.left="42px";d.appendChild(b);f.appendChild(d)}d=c.offsetX;b=c.offsetY;e=c.va?this.bb(a,this.camera.getMarginCorrectedViewport()):{x:(a.topLeftVertex().x+a.topRightVertex().x)/2,y:(a.topLeftVertex().y+a.topRightVertex().y)/2};d={x:d+e.x,y:b+e.y};c=c.va?0:a.getRotationRadians();this.o.transformScreen("label-id-2canvas-hover-text-container",d,c);this.na.push(f)}}ae(a,b=-8){if(null!=
this.o){var c=this.camera.getMarginCorrectedStageArea(),d=c.getCenter().x,e=c.getTop();c=this.o.createElement("universeLimitWarningcanvas-label-container");c.style.display="flex";d=k.Geometry.obbFromData(d,e+47,0,0,0);c.style.height="32px";c.style.padding="8px";e=document.getElementById("universeLimitWarningcanvas-label-content-wrapper");if(null==e){e=this.Ya("universeLimitWarningcanvas-label-content-wrapper","32px");e.style.backgroundColor="#222222";e.style.borderRadius="4px";e.style.transform="translate(-50%, -100%)";
const b=document.createElement("i");b.className=`${ma.IconSmallId.InfoWithCircle}`;b.style.height="16px";b.style.color="#ffffff";b.style.fontFamily="RalewaySemiBold";b.style.lineHeight="16px";e.appendChild(b);a=this.createText("universeLimitWarningcanvas-label-text",a,"#ffffff","RalewayMedium","12px");a.style.fontWeight="600";a.style.lineHeight="16px";e.appendChild(a);c.appendChild(e)}a=this.bb(d,this.camera.getMarginCorrectedStageArea());this.o.transformScreen("universeLimitWarningcanvas-label-container",
{x:a.x,y:b+a.y},0);this.na.push(c)}}Pd(a,b){var c=["growBlink"];if(null!=this.o){const e=a+"canvas-circle-container",f=a+"canvas-circle-content-wrapper";a=this.o.createElement(e);a.style.display="inline-flex";a.style.width="700px";a.style.height="700px";a.style.zIndex="100";var d=document.getElementById(f);null==d&&(d=this.Ya(f,"700px"),d.style.borderRadius="0px",d.style.transform="translate(-50%, 0%)",d.style.width="700px",d.style.height="700px",d.classList.add(...c),c=document.createElement("img"),
c.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='100' width='100'%3E%3Ccircle cx='50' cy='50' r='40' fill='white'/%3E%3C/svg%3E",c.style.width="700px",c.style.height="700px",d.appendChild(c),a.appendChild(d));c=(b.topLeftVertex().x+b.topRightVertex().x)/2;d=(b.topLeftVertex().y+b.topRightVertex().y)/2;c={x:c,y:d};b=b.getRotationRadians();this.o.transformScreen(e,c,b);this.na.push(a)}}Nd(a,b,c,d,e){if(null!=this.o){var f=this.o.getElement("canvas-custom-starting-point-decorator-container"),
g=this.o.getElement("canvas-custom-starting-point-decorator");null==f&&(f=this.o.createElement("canvas-custom-starting-point-decorator-container"),f.style.display="inline-flex",g=this.o.createElement("canvas-custom-starting-point-decorator"),g.style.display="initial",g.setAttribute("data-starting-point-id",a),g.setAttribute("data-position",d),g.style.width="24px",g.style.height="24px",g.style.borderRadius="50%",g.style.backgroundColor="#3181ff",g.style.boxShadow="0 3px 6px 0 rgba(21, 34, 53, 0.5)",
g.style.border="solid 2px #ffffff",g.style.position="relative",g.style.left="-15px",g.style.top="10px",g.style.cursor="pointer",g.style.backgroundPositionX="2px",g.style.backgroundPositionY="2px",g.style.boxSizing="border-box",f.appendChild(g));g.getAttribute("data-kind")!==d&&(g.style.backgroundImage="onParent"===d?"url(\"data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M5.5 8C5.5 8.82843 4.82843 9.5 4 9.5C3.17157 9.5 2.5 8.82843 2.5 8C2.5 7.17157 3.17157 6.5 4 6.5C4.82843 6.5 5.5 7.17157 5.5 8ZM9.5 8C9.5 8.82843 8.82843 9.5 8 9.5C7.17157 9.5 6.5 8.82843 6.5 8C6.5 7.17157 7.17157 6.5 8 6.5C8.82843 6.5 9.5 7.17157 9.5 8ZM12 9.5C12.8284 9.5 13.5 8.82843 13.5 8C13.5 7.17157 12.8284 6.5 12 6.5C11.1716 6.5 10.5 7.17157 10.5 8C10.5 8.82843 11.1716 9.5 12 9.5Z' fill='white'/%3E%3C/svg%3E%0A\")":
"url(\"data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M8 2.66669C5.66667 2.66669 4 4.55558 4 6.66669C4 9.55557 8 14 8 14C8 14 12 9.55558 12 6.66669C12 4.55558 10.3333 2.66669 8 2.66669ZM8 8C8.82843 8 9.5 7.32843 9.5 6.5C9.5 5.67157 8.82843 5 8 5C7.17157 5 6.5 5.67157 6.5 6.5C6.5 7.32843 7.17157 8 8 8Z' fill='white'/%3E%3C/svg%3E%0A\")",g.setAttribute("data-kind",d));g.onclick=
c;"onCurrentTopic"===d?(b=this.camera.getMarginCorrectedStageArea(),g=b.getRight()+-90,b=b.getTop()+20,this.o.transformScreen("canvas-custom-starting-point-decorator-container",{x:g,y:b},0)):(a=e||a,b=h.Cet.createScreenBoundsCalculator(b,this.camera).getWorldBoundsForLayout(a,h.TextBoundsOptions.Visible).getObb().transform(this.camera.getTransform()),a=b.getRotationRadians(),0!==a&&(g.style.transform=`rotate(${-a}rad)`),this.o.transformScreen("canvas-custom-starting-point-decorator-container",b.topRightVertex(),
a));this.na.push(f)}}bb(a,b){let c=null;var d=k.Geometry.obbFromRect(b.getData());b=[];const e=a.getVertices();for(let a=0;4>a;a++){var f=(a+1)%4;let c=[];d.containsPoint(e[a])&&c.push(e[a]);d.containsPoint(e[f])&&c.push(e[f]);f=k.Geometry.intersection().boundingBoxIntersectionWithLine(d,e[a],e[f],!0);c=c.concat(f);2===c.length&&(f=k.Geometry.distance(c[0],c[1]),f<ta||b.push({Pa:c[0],xa:c[1],pb:Math.asin(Math.abs(c[0].y-c[1].y)/f)}))}if(3<=Number(d.containsPoint(e[0]))+Number(d.containsPoint(e[1]))+
Number(d.containsPoint(e[2]))+Number(d.containsPoint(e[3]))&&0<b.length)b.sort((a,b)=>a.pb<b.pb-.01?-1:b.pb<a.pb-.01?1:a.Pa.y/2+a.xa.y/2<=a.xa.y/2+b.xa.y/2?-1:1),c={x:b[0].Pa.x/2+b[0].xa.x/2,y:b[0].Pa.y/2+b[0].xa.y/2};else{d=0;for(let a of b)b=k.Geometry.distance(a.Pa,a.xa),b>d&&(d=b,c={x:a.Pa.x/2+a.xa.x/2,y:a.Pa.y/2+a.xa.y/2})}null==c&&(c={x:a.topLeftVertex().x/2+a.topRightVertex().x/2,y:a.topLeftVertex().y/2+a.topRightVertex().y/2});return c}createText(a,b,c,d,e="11px"){const f=document.createElement("span");
f.id=a;f.innerText=b;f.style.marginLeft="3px";f.style.fontSize=e;f.style.fontWeight="500";f.style.fontStyle="normal";f.style.fontStretch="normal";f.style.lineHeight="1.09";f.style.letterSpacing="0.5px";f.style.color=c;f.style.fontFamily=d;f.style.whiteSpace="nowrap";f.style.textOverflow="ellipsis";f.style.overflow="hidden";return f}Ya(a,b){const c=document.createElement("div");c.id=a;c.style.height=b;c.style.display="inline-flex";c.style.alignItems="center";c.style.paddingLeft="6px";c.style.paddingRight=
"6px";c.style.backfaceVisibility="hidden";return c}};var E={};Object.defineProperty(E,"__esModule",{value:!0});const na=Math.pow(2,-30);E.Aa=class extends L.wc{constructor(a,b,c){super(a,b);this.Cf=c;this.qa=[]}update(a,b){super.Zb();this.scene=a;this.version=b;this.ef=this.camera.getTransform().invert();this.qa=[]}Fa(){return super.Fa()}dc(a,b){return this.camera.getTransform().transformPoint(a.transformPoint(b))}getCamera(){return this.camera}Rd(a,b,c){this.za(a.getId()+"clone"+a.getWrapper(q.CetModel.ID.MEDIA_ASSET.W).getOnlineAssetId(),
(c,e)=>{var d=r.CetRendererModule.createImageDrawComponent();c.setComponent(r.CetRendererModule.getDrawComponentKey(),d);d=a.getWrapper(q.CetModel.ID.TRANSFORMED_IMAGE.W);var g=c.getMutableWrapper(q.CetModel.ID.TRANSFORMED_IMAGE.W);c.set(q.CetModel.DEF(),q.CetModel.ID.Z_IMAGE);g.setMask(null);g.setHeight(d.getHeight());g.setWidth(d.getWidth());g.setImageScaleX(d.getImageScaleX());g.setImageScaleY(d.getImageScaleY());g.setIsFlipped(d.getIsFlipped());d=a.getWrapper(q.CetModel.ID.MEDIA_ASSET.W);g=c.getMutableWrapper(q.CetModel.ID.MEDIA_ASSET.W);
g.setAssetSourceFilename(d.getAssetSourceFilename());g.setOfflineAssetId(d.getOfflineAssetId());g.setOnlineAssetId(d.getOnlineAssetId());g.setOnlineAssetUrl(d.getOnlineAssetUrl());c.set(h.Cet.getDisableSpinnerKey(),!0);b(c,e);return c},(b)=>{const d=a.getWrapper(q.CetModel.ID.TRANSFORMED_IMAGE.W),f=b.getMutableWrapper(q.CetModel.ID.TRANSFORMED_IMAGE.W);f.setHeight(d.getHeight());f.setWidth(d.getWidth());b=b.getMutableWrapper(q.CetModel.ID.RECTANGULAR.W);b.setWidth(c.getWidth());b.setHeight(c.getHeight())},
c)}kb(a,b,c,d){return this.za(a,(a,c)=>{a.setComponent(r.CetRendererModule.getDrawComponentKey(),r.CetRendererModule.createHollowRectangleRenderer());return b(a,c)},(a,b)=>{let e=a.getMutableWrapper(q.CetModel.ID.RECTANGULAR.W);e.setWidth(d.getWidth());e.setHeight(d.getHeight());c(a,b)},d)}Ja(a,b,c,d,e=!1){return this.za(a,(a,c)=>{a.setComponent(r.CetRendererModule.getDrawComponentKey(),r.CetRendererModule.createRectangleRenderer());return b(a,c)},(a,b)=>{let e=a.getMutableWrapper(q.CetModel.ID.RECTANGULAR.W);
e.setWidth(d.getWidth());e.setHeight(d.getHeight());c(a,b)},d,e)}Mb(a,b,c,d){this.za(a,(a,c)=>{a.setComponent(r.CetRendererModule.getDrawComponentKey(),r.CetRendererModule.createAxRenderer());return b(a,c)},(a,b)=>{let e=a.getMutableWrapper(q.CetModel.ID.RECTANGULAR.W);e.setWidth(d.getWidth());e.setHeight(d.getHeight());c(a,b)},d)}jb(a,b,c,d){return this.za(a,(a,c)=>{a.setComponent(r.CetRendererModule.getDrawComponentKey(),r.CetRendererModule.createArcRenderer());return b(a,c)},(a,b)=>{let e=a.getMutableWrapper(q.CetModel.ID.RECTANGULAR.W);
e.setWidth(d.getWidth());e.setHeight(d.getHeight());c(a,b)},d)}Md(a,b,c,d){this.za(a,(a,c)=>{a.setComponent(r.CetRendererModule.getDrawComponentKey(),r.CetRendererModule.createCircleRenderer());return b(a,c)},(a,b)=>{let e=a.getMutableWrapper(q.CetModel.ID.RECTANGULAR.W);e.setWidth(d.getWidth());e.setHeight(d.getHeight());c(a,b)},d)}Sd(a,b,c,d,e){var f={height:15,width:15};this.za(a,(a,d)=>{a.setComponent(r.CetRendererModule.getDrawComponentKey(),r.CetRendererModule.createLShapeRenderer(this.ie(b),
f));return c(a,d)},(a,b)=>{let c=a.getMutableWrapper(q.CetModel.ID.RECTANGULAR.W);c.setWidth(e.getWidth());c.setHeight(e.getHeight());d(a,b)},e)}Zd(a,b,c,d,e){const f=k.Geometry.fromPoint({x:(d.x+e.x)/2,y:(d.y+e.y)/2}),g=f.clone().sub(k.Geometry.fromPoint(d)).length();d=Math.atan2(e.y-d.y,e.x-d.x);const h=k.Geometry.obbFromData(f.getX(),f.getY(),2*(g+40),1,360*d/(2*Math.PI));this.za(a,(a,c)=>{a.setComponent(r.CetRendererModule.getDrawComponentKey(),r.CetRendererModule.createRectangleRenderer());return b(a,
c)},(a,b)=>{let d=a.getMutableWrapper(q.CetModel.ID.RECTANGULAR.W);d.setWidth(h.getWidth());d.setHeight(h.getHeight());c(a,b)},h)}wa(a,b){return k.Geometry.obbFromRect(b.getData()).transform(a).transform(this.camera.getTransform())}getCameraTransform(){return this.camera.getTransform()}je(a,b){a=a.getEntityList().createEntity(b);a.set(h.Cet.getDefComponentKey(),q.CetModel.ID.Z_OBJECT);a.set(h.Cet.getDecoratorComponentKey(),!0);h.Cet.setTransformComp(a,k.Geometry.transform2dIdentity());h.Cet.setGrouping(a,
"NotGroup");h.Cet.setVisibility(a,!0,1);h.Cet.setZOrderComp(a,r.CetRendererModule.createZOrderComponent(this.qa.length+this.Cf,r.LayerType.DecoratorLayer));return a}za(a,b,c,d,e=!1){e=e?a:a+"."+this.version;this.qa.push(e);a=this.scene.getEntityById(e);null==a&&(a=this.je(this.scene,e),b(a,this.scene));c(a,this.scene);b=h.Cet.draw(a).calculateGraphicsBounds(a);h.Cet.updateTransform(a).setLocalToWorld(t.CetModelEditor.createLayoutEditor().localToWorldCompute(this.ef,b,d));d=a.get(l.SelectionModule.getDecoratorKey());
if(null==d||d.interactionType===l.InteractionType.controlPoint&&null==a.get(l.SelectionModule.getControlPointKey()))throw Error("Decorator component of entity is not set: "+a.getId());return a.getId()}sign(a){return a>na?1:a<-na?-1:0}ie(a){switch(a){case m.ControlPointPosition.TOP_LEFT:return r.LShapeOrientation.TOP_LEFT;case m.ControlPointPosition.TOP_RIGHT:return r.LShapeOrientation.TOP_RIGHT;case m.ControlPointPosition.BOTTOM_LEFT:return r.LShapeOrientation.BOTTOM_LEFT;case m.ControlPointPosition.BOTTOM_RIGHT:return r.LShapeOrientation.BOTTOM_RIGHT;
default:throw"Invalid position";}}};var S={};Object.defineProperty(S,"__esModule",{value:!0});S.nd=class{constructor(a,b,c,d,e,f){this.Vb=c;this.jf=d;this.uf=e;this.j=f;this.f=new L.wc(b,a)}init(a){this.ab=t.CetModelEditor.createEditorPathQuery(a);this.Fb=t.CetModelEditor.createTopicQuery(a);this.Oe=h.Cet.createHierarchyQuery(a);this.fb({currentTopicId:null,yb:!1});a.getSceneHierarchy().getRootScene().getImmediateChangeStream(null).onValue(()=>{null!=this.state.Ca&&this.fb({})});this.Vb.onValue((a)=>
{a=null!==a&&void 0!==a?a:this.Fb.getRootTopic();this.state.currentTopicId!==a&&this.fb({currentTopicId:a})});this.jf.onValue((a)=>{a=a.kind===Q.EditorMode.edit;this.state.yb!==a&&(this.fb({yb:a}),a||this.sc())});this.xb=!0}fb(a){this.state=Object.assign(Object.assign(Object.assign({},this.state),a),{Ca:null});this.j.markViewChanged()}update(a){var b,c;if(this.xb&&this.state.yb){if(null==this.state.Ca){var d=null;if(null!=(null===(c=null===(b=a.getPreziW())||void 0===b?void 0:b.getPathStartPointToken())||
void 0===c?void 0:c.getId())&&(b=this.ab.hasCustomStartPoint()?this.ab.getStartPoint():null,null!=b)){var {stepId:e,actionId:f}=this.ab.pathPositionToIds(b);d=null!=f?this.ab.getTargetEntitiesForActionById(f).allIds[0]:this.ab.getStepTargetId(e)}if(null==d)d={Qa:d,Da:"none",parentId:null};else if(null==this.state.currentTopicId||this.Fb.getTopicKind(this.state.currentTopicId)===t.TopicKind.Page)d={Qa:d,Da:"none",parentId:null};else if(d===this.state.currentTopicId)d={Qa:d,Da:"onCurrentTopic",parentId:null};
else if(-1<this.Fb.getReachableEntities(this.state.currentTopicId).indexOf(d))d={Qa:d,Da:"onEntity",parentId:null};else{const a=this.Oe.getAncestorEntities(d);b=this.Fb.getChildTopics(this.state.currentTopicId).find((b)=>-1<a.indexOf(b));d=null!=b?{Qa:d,Da:"onParent",parentId:b}:{Qa:d,Da:"none",parentId:null}}this.state=Object.assign(Object.assign({},this.state),{Ca:d})}"none"===this.state.Ca.Da?this.sc():(this.f.Zb(),this.f.Nd(this.state.Ca.Qa,a,this.uf,this.state.Ca.Da,this.state.Ca.parentId))}}getName(){return"CustomStartingPointSystem"}reset(){this.fb({currentTopicId:null,
yb:!1});this.sc()}sc(){0<this.f.Fa().length&&(this.f.Fa().forEach((a)=>{null!=a.parentNode&&a.parentNode.removeChild(a)}),this.f.Zb())}changesPdomComponents(){return!1}};var T={};Object.defineProperty(T,"__esModule",{value:!0});T.kd=class{constructor(a){this.ib=null;this.j=a;this.Kc=la.Bacon.newBus();this.Kc.onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.ib=a})}addAreaSelectionStream(a){this.Kc.plug(a)}decorate(a){if(null==this.ib||0===this.ib.getWidth()||0===this.ib.getHeight())return null;
const b=w.isActive("js-unique-differentiation")?k.Geometry.colorFromRGBString("#0D99FF"):k.Geometry.colorFromRGBString("#ffffff"),c=w.isActive("js-unique-differentiation")?k.Geometry.colorFromRGBString("#0D99FF"):k.Geometry.colorFromRGBString("#000000");return a.Ja("prezi_selection.AreaHighlightDecorator.highlight",(a)=>{h.Cet.setBorder(a,.5,c,1);h.Cet.setFillComponentWithSolidColor(a,b,.3);a.set(l.SelectionModule.getDecoratorKey(),u.w([]));return a},()=>{},k.Geometry.obbFromRect(this.ib.getData()))}};
var U={};Object.defineProperty(U,"__esModule",{value:!0});U.ld=class{constructor(a,b,c){this.camera=a;this.f=b;this.Ea=c}ea(a,b,c,d,e){this.Ea.ea(a,b,c,d,e);h.Cet.createTopicChildrenQuery(a).isVisibleOutsideAndInside(b)&&(c=a.getEntityById(b),d=h.Cet.createScreenBoundsCalculator(a,this.camera),a=h.Cet.transform(c).getLocalToWorld(),c=d.getLocalBoundsForHittest(c),a=k.Geometry.obbFromRect(c.getData()).transform(a),c=I.I18n.ts("Visible inside and outside",{context:"on-canvas information label about a topic visual when editing it inside a topic"}),
this.f.Pb(b,a,c,{ya:!0,va:!0}))}da(a,b,c,d,e){this.Ea.da(a,b,c,d,e)}};var V={};Object.defineProperty(V,"__esModule",{value:!0});V.md=class{constructor(a,b){this.f=a;this.Ea=b}ea(a,b,c,d,e){var f=a.getEntityById(b);const g=h.Cet.transform(f).getLocalToWorld();f=h.Cet.localBounds(f).getGraphicsBounds();this.Ea.ea(a,b,c,d,e);h.Cet.createTopicChildrenQuery(a).isVisibleOutsideAndInside(b)&&(a=k.Geometry.obbFromRect(f.getData()).transform(g),c=I.I18n.ts("Visible inside and outside",{context:"on-canvas information label about a topic visual when editing it on the topic cover"}),
this.f.Pb(b,a,c,{ya:!0,va:!0}))}da(a,b,c,d,e){this.Ea.da(a,b,c,d,e)}};var W={};Object.defineProperty(W,"__esModule",{value:!0});W.od=class{constructor(a,b,c,d,e,f,g,h,k,l,m){this.camera=a;this.f=b;this.Ra=c;this.zb=d;this.Ha=e;this.Gb=f;this.df=g;this.uc=h;this.hc=k;this.Db=l;this.La=m}Ea(a){switch(a.getDef()){case q.CetModel.ID.Z_TEXT:case q.CetModel.ID.Z_RICH_TEXT:return this.Ra;case q.CetModel.ID.Z_LINE:return this.zb;case q.CetModel.ID.Z_ARROW:return this.zb;case q.CetModel.ID.Z_TOPIC_CONTAINER:return this.Ha;
case q.CetModel.ID.Z_ZOOM_AREA:return this.Gb;case q.CetModel.ID.Z_IMAGE:return this.df;case q.CetModel.ID.Z_SHAPE:return this.uc;case q.CetModel.ID.OVERVIEW:return this.Db;case q.CetModel.ID.LOGO:case q.CetModel.ID.NEXT_LOGO_V1:return this.hc;default:return this.La}}Ne(a){if(null==a)return null;switch(a.kind){case z.CoverEditModeKind.advanced:case z.CoverEditModeKind.titleEditOnly:return a.topicId;case z.CoverEditModeKind.insideAdvanced:return null;default:B.Utils.assertNever(a)}}ac(a,b,c,d){const e=
b.getEntityById(a);a=t.CetModelEditor.createTopicQuery(b).getTopicKind(a);const f=this.Ea(e);b=h.Cet.createHierarchyQuery(b).getParentId(e);return a===t.TopicKind.Planet||a===t.TopicKind.Stack?this.Ha:null!=c&&b===this.Ne(c)||1===d.length&&b===d[0]?new V.md(this.f,f):new U.ld(this.camera,this.f,f)}};var J={cc:function(a){a=a.getObb();return{localBounds:k.Geometry.rectangleFromData({x:-a.getWidthHalf(),y:-a.getHeightHalf(),height:a.getHeight(),width:a.getWidth()}),Ga:k.Geometry.transform2dFromRad(a.getCenter(),
1,a.getRotationRadians())}}};Object.defineProperty(J,"__esModule",{value:!0});J.Hd=class{constructor(a,b,c,d){this.i=a;this.f=b;this.navigationControl=c;this.camera=d}te(a,b,c){const d=h.Cet.createScreenBoundsCalculator(a,this.camera).getWorldBoundsForInteraction(b);let {localBounds:e,Ga:f}=(0,J.cc)(d);const g=f.getScale()*this.camera.getTransform().getScale();e=e.inflate(x.u.ca/g,x.u.ca/g);this.i.pa(b,f,e,[b],!0);a.getEntityById(b).get(l.SelectionModule.getDisabledResizeControlPointKey())||(w.isActive("js-unique-differentiation")?
this.i.Va(f,e,[b]):this.i.Ka(f,e,[b]));0!==c.length||w.isActive("js-on-canvas-property-bar")||this.f.Ld(b+"zoom_in_btn",()=>this.Le(b,a),d.getObb(),I.I18n.ts("Zoom In",{context:"zoom in button on topic selection"}),ma.IconSmallId.ZoomIn)}Le(a,b){b=t.CetModelEditor.getPagesOfChapter(a,b);a=0<b.length?b[0]:a;t.CetModelEditor.setCameraAndPathFor({navigationControl:this.navigationControl,pathPosition:t.CetModelEditor.getPathPositionForTarget({navigationControl:this.navigationControl,targetId:a})});this.navigationControl.flyToId(a,
h.CameraNavigationTrigger.free)}oe(a,b,c){if(this.gd(c,[b])){const d=a.getEntityById(b);c=h.Cet.transform(d).getLocalToWorld();a=h.Cet.getViewportWorldIfFocusedOnEntity(d,a,this.camera).transform(h.Cet.transform(d).getWorldToLocal()).getBounds();this.i.ha(c,a,b)}else{a=h.Cet.createScreenBoundsCalculator(a,this.camera);var {localBounds:d,Ga:e}=(0,J.cc)(a.getWorldBoundsForInteraction(b));a=e.getScale()*this.camera.getTransform().getScale();d=d.inflate(x.u.ca/a,x.u.ca/a);this.i.ha(e,d,b)}}Wb(a,b,c,d){const e=
a.getEntityById(b),f=h.Cet.transform(e).getLocalToWorld(),g=h.Cet.calculateZoomBounds(a,e);d?(this.Gc(e,f,g,u.topicZoomAreaBorder(b),v.Jd,null!=c,a),this.i.ob(e.getId(),f,g,l.ControlPointType.topicZoomAreaResize)):(b=t.CetModelEditor.isPage(b,a)||!this.ff(c)?u.w([b]):u.clickable(b),this.Gc(e,f,g,b,v.Lb,null!=c,a))}Gc(a,b,c,d,e,f,g){this.i.Rb(v.ba.fc(d.interactionType),b,c,d,e);f&&(b=h.Cet.getViewportWorldIfFocusedOnEntity(a,g,this.camera),this.f.Pb(a.getId()+d.interactionType,b,I.I18n.ts("Topic zoom area",
{context:"label of the zoom area rectangle in cover edit mode"}),{color:e.ad,bgColor:e.$c}))}gd(a,b){if(null==a)return!1;switch(a.kind){case z.CoverEditModeKind.advanced:return 1===b.length&&a.topicId===b[0];case z.CoverEditModeKind.insideAdvanced:return 1===b.length&&a.topicOrOverviewId===b[0];case z.CoverEditModeKind.titleEditOnly:return!1;default:return B.Utils.assertNever(a)}}ff(a){if(null==a)return!1;switch(a.kind){case z.CoverEditModeKind.advanced:case z.CoverEditModeKind.insideAdvanced:return!0;
case z.CoverEditModeKind.titleEditOnly:return!1;default:return B.Utils.assertNever(a)}}};var x={};Object.defineProperty(x,"__esModule",{value:!0});x.u=class{constructor(a,b,c,d,e){this.camera=a;this.f=c;this.i=d;this.qf=e;this.Sa=new J.Hd(d,c,b,a)}ea(a,b,c,d,e){this.Sa.gd(c,[b])||this.Sa.te(a,b,e)}da(a,b,c,d,e){this.Sa.oe(a,b,e)}xe(a,b,c,d,e){if(null==b)this.qe(a,b,c,d);else switch(b.kind){case z.CoverEditModeKind.advanced:this.ke(a,b,d,e);break;case z.CoverEditModeKind.titleEditOnly:this.we(a,b);
break;case z.CoverEditModeKind.insideAdvanced:t.CetModelEditor.isOverview(b.topicOrOverviewId,a)||this.pe(a,b,d);break;default:B.Utils.assertNever(b)}}we(a,b){if(null!=a.getEntityById(b.topicId)){var c=h.Cet.createScreenBoundsCalculator(a,this.camera);a=this.camera.getTransform().invert();c=c.getScreenAABBForEntities([b.topicId],{topic:h.TopicBoundsOptions.layout}).inflate(x.u.ca,x.u.ca);this.i.ha(a,c,b.topicId)}}pe(a,b,c){this.Sa.Wb(a,b.topicOrOverviewId,b,c);var d=h.Cet.createScreenBoundsCalculator(a,
this.camera);c=this.camera.getTransform().invert();d=d.getScreenAABBForEntities([b.topicOrOverviewId],{topic:h.TopicBoundsOptions.zoomArea});a=a.getEntityById(b.topicOrOverviewId).getWrapper(q.CetModel.ID.HAS_PADDING.W).getPadding();a=null!=a&&0<a?(a-1)/2:0;this.i.Nb(c,d.inflate(d.getWidth()*a-x.u.Ac,d.getHeight()*a-x.u.Ac),b.topicOrOverviewId)}ke(a,b,c,d){if(null!=b&&null!=a.getEntityById(b.topicId)){var e=h.Cet.createScreenBoundsCalculator(a,this.camera);const f=this.camera.getTransform().invert();
e=e.getScreenAABBForEntities(this.Ke(a,b.topicId),{topic:h.TopicBoundsOptions.zoomArea}).inflate(x.u.ca,x.u.ca);this.i.Nb(f,e.inflate(x.u.ca,x.u.ca),b.topicId);d||this.Sa.Wb(a,b.topicId,b,c)}}qe(a,b,c,d){if(this.qf){const e=t.CetModelEditor.createTopicQuery(a).getTopicKind(c);e!==t.TopicKind.Planet&&e!==t.TopicKind.Page||this.Sa.Wb(a,c,b,d)}}le(a,b){var c=h.Cet.createScreenBoundsCalculator(a,this.camera);a=this.camera.getTransform().invert();c=c.getScreenAABBForEntities([b],{topic:h.TopicBoundsOptions.layout});
c=c.inflate(x.u.ca,x.u.ca);this.i.Qd(a,c,b)}Ke(a,b){a=h.Cet.createTopicChildrenQuery(a);return[b,...a.getChildrenIdsVisibleOutside(b)]}};x.u.ca=5;x.u.Ac=10;var O={};Object.defineProperty(O,"__esModule",{value:!0});O.xc=class{constructor(a,b){this.camera=a;this.i=b;this.eb=t.CetModelEditor.createGroupQuery()}Tc(a,b){var c=a.getPreziW().getEntity().get(m.EditorCommander.getMultiselectDecoratorComponentKey());if(null!=c)return b=t.CetModelEditor.createReferenceFrame(this.camera.getTransform().invert()),
b=c.withReferenceFrame(b),b=k.Geometry.transform2dFromRad(this.gb.getCenter(),1,0).rotateRadAroundPoint(b.center,b.rotationRad).concat(this.camera.getTransform().invert()),c=k.Geometry.rectangleFromData({x:-this.gb.getWidth()/2,y:-this.gb.getHeight()/2,width:this.gb.getWidth(),height:this.gb.getHeight()}),{Ga:b,localBounds:c};a=h.Cet.createScreenBoundsCalculator(a,this.camera);c=this.camera.getTransform().invert();if(w.isActive("js-unique-differentiation")){var d=c.getScale()*this.camera.getTransform().getScale();
d=x.u.ca/d;b=a.getScreenAABBForEntities(b,{text:h.TextBoundsOptions.SelectionBox,topic:h.TopicBoundsOptions.withPadding,topicPaddingX:d,topicPaddingY:d})}else b=a.getScreenAABBForEntities(b,{topic:h.TopicBoundsOptions.layout});this.gb=b;return{Ga:c,localBounds:b}}wb(a,b,c,d){const {Ga:e,localBounds:f}=this.Tc(a,b);w.isActive("js-unique-differentiation")&&b.forEach((e)=>{c.ac(e,a,d,b).da(a,e,null,!1,d)});const g=b.some((b)=>t.CetModelEditor.isLocked(b,a));this.i.pa("multiselect",e,f,b,!g);g||(w.isActive("js-unique-differentiation")?
this.i.Va(e,f,b):this.i.Ka(e,f,b))}Dc(a,b,c){b=this.eb.getGroupMembers(a,b).map((a)=>a.getId());var {Ga:d,localBounds:e}=this.Tc(a,b);this.i.ha(d,e,c,{fd:!0,ownerIds:b})}ne(a,b){this.Dc(a,b,"groupedit")}Qe(a,b){this.Dc(a,b,`grouphover-${b}`)}ea(a,b){var c=a.getEntityById(b);const d=h.Cet.transform(c).getLocalToWorld();c=h.Cet.localBounds(c).getGraphicsBounds();a=t.CetModelEditor.isLocked(b,a);this.i.pa(b,d,c,[b],!a);a||(w.isActive("js-unique-differentiation")?this.i.Va(d,c,[b]):this.i.Ka(d,c,[b]))}da(a,
b){var c=a.getEntityById(b);a=h.Cet.transform(c).getLocalToWorld();c=h.Cet.localBounds(c).getGraphicsBounds();this.i.ha(a,c,b)}};var X={};Object.defineProperty(X,"__esModule",{value:!0});X.rd=class extends O.xc{constructor(a,b,c){super(a,b);this.cb=c}ea(a,b,c,d){if(null!=d){var e=a.getEntityById(b);a=h.Cet.transform(e).getLocalToWorld();var f=h.Cet.world(e).getWorldBounds();c=h.Cet.localBounds(e).getGraphicsBounds();var g=e.getWrapper(q.CetModel.ID.Z_IMAGE.W),p=h.Cet.getMask_Killme(g);p={x:-p.getWidth()/
2-p.getTopLeft().x,y:-p.getHeight()/2-p.getTopLeft().y,width:g.getWidth(),height:g.getHeight()};g=k.Geometry.obbFromRect(p).transform(a).transform(this.camera.getTransform());f=f.transform(this.camera.getTransform());this.cb.Rd(e,(a)=>{a.set(l.SelectionModule.getDecoratorKey(),u.maskDrag(b));return a},g);e=k.Geometry.rectangleFromData(p);this.i.kb(b,b+d.dd,f,g,{color:"#ffffff",opacity:.3});this.i.Wd(b,a,e,d.target===z.MaskEditTarget.image);this.i.Vd(b,a,c,d.target===z.MaskEditTarget.mask,d.isFixedAspect)}else super.ea(a,
b,c,d)}};var P={};Object.defineProperty(P,"__esModule",{value:!0});P.yc=class{constructor(a,b,c){this.camera=a;this.f=b;this.i=c}Td(a,b,c,d,e,f,g){if(c.x!==d.x||c.y!==d.y)f=P.yc.mf(c,f),null!=b&&-1===b.indexOf(m.ControlPointPosition.MIDDLE_LEFT)||this.i.ta(v.ba.Vc(m.ControlPointPosition[m.ControlPointPosition.MIDDLE_LEFT]),m.ControlPointPosition.MIDDLE_LEFT,l.ControlPointType.line,a,c,k.Geometry.rectangleFromData({x:-6,y:-6,width:12,height:12}),u.controlPoint(g),{$b:-f}),null!=b&&-1===b.indexOf(m.ControlPointPosition.MIDDLE_RIGHT)||
this.i.ta(v.ba.Vc(m.ControlPointPosition[m.ControlPointPosition.MIDDLE_RIGHT]),m.ControlPointPosition.MIDDLE_RIGHT,l.ControlPointType.line,a,d,k.Geometry.rectangleFromData({x:-6,y:-6,width:12,height:12}),u.controlPoint(g),{$b:f}),null!=b&&-1===b.indexOf(m.ControlPointPosition.MIDDLE_CENTER)||null==e||this.i.ta(v.ba.We(m.ControlPointPosition[m.ControlPointPosition.MIDDLE_CENTER]),m.ControlPointPosition.MIDDLE_CENTER,l.ControlPointType.line,a,e,k.Geometry.rectangleFromData({x:-6,y:-6,width:12,height:12}),
u.controlPoint(g))}static mf(a,b){if(0===a.x&&0===a.y)return 0;a=k.Geometry.fromPoint(a);const c=k.Geometry.fromCoordinates(0,1);a.perpendicular();return 0<b?-180*Math.acos(a.dot(c)/a.length()*c.length()):180*Math.acos(a.dot(c)/a.length()*c.length())}Qc(a,b,c){const d=a.getEntityById(b),e=h.Cet.curvedLine(d);var f=d.getWrapper(q.CetModel.ID.HAS_THICKNESS.W),g=Math.abs(e.getStartEndDistance())+f.getThickness();f=Math.abs(e.getArcHeight())+f.getThickness();g=k.Geometry.rectangleFromData({x:-(g/2),y:-(f/
2),width:g,height:f});f=h.Cet.transform(d).getLocalToWorld();a=a.getTweener().getTweenedComponent(d.getId(),r.CetRendererModule.getVisibilityComponentKey());null==a&&(a=h.Cet.visibility(d));c=this.i.ce(e,f.getScale(),c,a.getAlpha());this.i.jb(b,f,g,c)}ea(a,b){this.Qc(a,b,k.Geometry.colorFromRGBString("#0000FF"));if(!t.CetModelEditor.isLocked(b,a)){var c=a.getEntityById(b);a=h.Cet.transform(c).getLocalToWorld();const e=h.Cet.curvedLine(c);var d=r.CetRendererModule.CurvedLineCalculation();const f=d.getStartPoint(e);
d=d.getEndPoint(e);const g={x:0,y:e.getArcHeight()/2};c=c.get(l.SelectionModule.getEnabledControlPointsKey());this.Td(a,c,f,d,g,e.getArcHeight(),[b])}}da(a,b){this.Qc(a,b,k.Geometry.colorFromRGBString("#3181ff"))}};var Y={};Object.defineProperty(Y,"__esModule",{value:!0});Y.sd=class{constructor(a,b,c){this.camera=a;this.f=b;c.onValue((a)=>this.networkStatus=a)}ea(){}da(a,b,c,d){var e,f=h.Cet.createScreenBoundsCalculator(a,this.camera).getLogoBoundsInScreen(a,b);if(null!=f){var g=f.topRightVertex(),
p=k.Geometry.obbFromRect({x:g.x,y:f.getCenterY()-16-8,width:48,height:48});this.Cc("hover_hit_area"+b,u.locked([b]),p);1===this.networkStatus&&(f=k.Geometry.obbFromRect({x:g.x+8,y:f.getCenterY()-16,width:32,height:32}),this.Cc("click_hit_area"+b,u.clickable(b),f),a=null===(e=a.getEntityById(c))||void 0===e?void 0:e.get(l.SelectionModule.getDecoratorKey()),this.f.Ud(b,null!=a&&a.interactionType===l.InteractionType.clickable&&1===a.ownerIds.length&&a.ownerIds[0]===b,f),b=k.Geometry.obbFromRect({x:g.x-
16,y:g.y,width:200,height:32}),d&&(d=I.I18n.ts("Unlock watermark-free presentations with Prezi Plus"),this.f.be(b.transform(this.camera.getTransform().invert()),d)))}}Cc(a,b,c){this.f.Ja(a,(a)=>{h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString("#000000"),.01);h.Cet.setBorder(a,0,k.Geometry.colorFromRGBString("#000000"),0);a.set(l.SelectionModule.getDecoratorKey(),b);return a},()=>{},c)}};var Z={};Object.defineProperty(Z,"__esModule",{value:!0});Z.ud=class{constructor(a,b,c){this.camera=
a;this.i=b;this.Vb=c;this.xb=!1;this.qb=this.Na=null}initialize(a){a.getImmediateChangeStream(null).onValue(()=>{this.qb=this.Na=null});this.Vb.onValue((b)=>{var c,d,e;this.qb=this.Na=null;this.currentTopicId=null!==b&&void 0!==b?b:null===(e=null===(d=null===(c=null===a||void 0===a?void 0:a.getPreziW())||void 0===c?void 0:c.getOverview())||void 0===d?void 0:d.getEntity())||void 0===e?void 0:e.getId()});this.xb=!0}se(a,b,c,d){this.xb||this.initialize(a.getRootScene());if(null==this.Na||null==this.qb)t.CetModelEditor.createTopicQuery(a),
this.qb=[],this.Na=new Map([...t.createPathLabelMap(a)].map(([a,b])=>[a,b.outsideLabel]));if([...c,...d].some((a)=>this.Na.has(a))){const p=h.Cet.createHierarchyQuery(a);var e=[...this.Na.entries()].map(([b,c])=>{const d=a.getEntityById(b);if(null!=d&&d.isDef(q.CetModel.ID.Z_OBJECT)){const a=p.getParentOrOverview(d);if(b!==a&&this.currentTopicId===a)return{id:b,label:c,entity:d}}return null}).filter((a)=>null!=a);const k=(0!==c.length||1===d.length)&&15>e.length,l=new Map;for(const {id:p,label:m,
entity:n}of e){e=1===c.length&&p===c[0];var f=h.Cet.createScreenBoundsCalculator(a,this.camera);if(n.isDef(q.CetModel.ID.Z_TOPIC_CONTAINER)){f=f.getWorldBoundsForInteraction(p);var g=J.cc(f);f=g.localBounds;g=g.Ga;const a=g.getScale()*this.camera.getTransform().getScale();f=f.inflate(x.u.ca/a,x.u.ca/a)}else f=f.getLocalBoundsForHittest(n),g=h.Cet.transform(n).getLocalToWorld();this.me(g,f,b,p,c,d,e,k,m);l.set(p,g.transformRectangle(f).getCenter())}if(k){const b=t.getLabelledIdsInOrder(a).filter((a)=>
l.has(a));b.forEach((a,c)=>{0<c&&(c=b[c-1],this.De(c,l.get(c),a,l.get(a)))})}}}me(a,b,c,d,e,f,g,h,l){1!==e.length||null!==c&&c.kind!==z.CoverEditModeKind.titleEditOnly||(g||this.i.Od(d,a,b,[d]),0===f.length&&this.i.Xd(a,b,d,l,g));h&&this.i.Mb(v.ba.Te(d),u.w([d]),this.camera.getTransform().transformPoint(a.transformPoint(b.getCenter())),a.getRotationRad(),k.Geometry.rectangleFromData({x:-2,y:-2,height:4,width:4}),w.isActive("js-for-test-thick-selection")?4:1,k.Geometry.colorFromRGBString("#3181ff"))}De(a,
b,c,d){var e={x:(b.x+d.x)/2,y:(b.y+d.y)/2},f=k.Geometry.distance(b,d);d=Math.atan2(d.y-b.y,d.x-b.x);b=w.isActive("js-for-test-thick-selection")?12:1;e=k.Geometry.transform2dFromRad(e,f/10,d);d=k.Geometry.rectangleFromData({x:-((10+b)/2),y:-((1+b)/2),width:10+b,height:1+b});const g=this.i.f.getCameraTransform().getScale(),h=g*e.getScale();30>f*g||(f={headPos:{x:-5*h+15,y:0},tailPos:{x:5*h-15,y:0},origin:null,radius:null,startAngle:null,endAngle:null,isStraight:!0,isInverse:!1,color:k.Geometry.colorFromRGBString("#EFCF1C"),
thickness:b,alpha:1},this.i.jb(v.ba.Se(`chain-from-${a}-to-${c}`),e,d,f))}};var aa={};Object.defineProperty(aa,"__esModule",{value:!0});aa.Ad=class{constructor(a,b){this.camera=a;this.i=b}ea(a,b){const c=a.getEntityById(b),d=h.Cet.transform(c).getLocalToWorld(),e=h.Cet.localBounds(c).getGraphicsBounds();a=t.CetModelEditor.isLocked(b,a);this.i.pa(b,d,e,[b],!a);a||(w.isActive("js-unique-differentiation")?this.i.Va(d,e,[b]):this.i.Ka(d,e,[b]),c.getWrapper(q.CetModel.ID.Z_SHAPE.W).getShapeType()!==q.ShapeType.Oval&&
(this.i.mb(l.ControlPointType.widthResize,d,e,[b]),this.i.Ob(l.ControlPointType.heightResize,d,e,[b])))}da(a,b){var c=a.getEntityById(b);a=h.Cet.transform(c).getLocalToWorld();c=h.Cet.localBounds(c).getGraphicsBounds();this.i.ha(a,c,b)}};var F={};Object.defineProperty(F,"__esModule",{value:!0});F.Ba=class{constructor(a,b,c,d){this.camera=a;this.f=b;this.i=c;this.j=d}addTextStateStream(a){a.onValue((a)=>{this.textSelectionState=a;null!=this.j&&null!=a&&this.j.markViewChanged()})}ea(a,b){var c=a.getEntityById(b);
const d=h.Cet.transform(c).getLocalToWorld();if(!t.CetModelEditor.createTextHelper().hasSelection(c)&&null!=t.CetModelEditor.createTextHelper().getCaretOffset(c)&&null!=this.textSelectionState){const a=t.CetModelEditor.createTextHelper().getCaretOffset(c);this.ue(d,h.Cet.localBounds(c).getGraphicsBounds(),c,a)}c=h.Cet.createScreenBoundsCalculator(a,this.camera).getLocalBoundsForHittest(c);a=t.CetModelEditor.isLocked(b,a);this.i.$d(b,d,c,!a);a||(w.isActive("js-unique-differentiation")?this.i.Va(d,
c,[b]):this.i.Ka(d,c,[b]),this.i.mb(l.ControlPointType.widthResize,d,c,[b],!0))}da(a,b){const c=a.getEntityById(b),d=h.Cet.transform(c).getLocalToWorld();a=h.Cet.createScreenBoundsCalculator(a,this.camera).getLocalBoundsForHittest(c);this.i.ha(d,a,b)}ve(a,b,c){a=a.getEntityById(b);c?(c=a.get(N.getSpellcheckComponentKey()),b=h.Cet.shapedText(a),c=this.he(b.getRawText(),Object.keys(c)),0<c.length?a.set(r.CetRendererModule.getTextUnderlineComponentKey(),c):a.discardOwnComponent(r.CetRendererModule.getTextUnderlineComponentKey())):
a.discardOwnComponent(r.CetRendererModule.getTextUnderlineComponentKey());a.getId()}ue(a,b,c,d){var e,f=c.get(r.CetRendererModule.getInEditFontSizeComponentKey()),g=h.Cet.shapedText(c);f=g.replaceTextWithStyle(0,g.getLength()," ",qa.TextModel.withFontSize(f));0>=g.getWrapWidth()&&(f=f.setWrapWidth(g.getLayoutBounds().getWidth()));g=0===g.getLength()||c.get(q.CetModel.ID.POSSIBLY_PLACEHOLDER.IS_PLACEHOLDER)?f:g;var p=g.getLineAt(d,!1),m=f.getLineAt(0,!1);f=m.ascent-m.descent;const n=g.locatePosition(d,
!1);var t=c.getWrapper(q.CetModel.ID.HAS_FONT.W);t=t.getDisplayBackground()?t.getBackgroundPadding():0;b={x:n.x-b.getData().width/2+t,y:n.y-b.getData().height/2+t+p.ascent-m.ascent+f/2};b=this.f.dc(a,b);p=a.getRotationDeg()+this.f.getCameraTransform().getRotationDeg();a=a.getScale()*this.f.getCameraTransform().getScale();let v=c.get(H.Jb.getEnableBlinkingCaretKey());null==v&&(v=!0);m=c.get(h.Cet.getTextSelectionFocusedComponentKey());v&&(v=m);d=null===(e=g.getCharacterStylesAt(d))||void 0===e?void 0:
e.getColorWithFallback(g.getBaseStyle());const x=k.Geometry.colorFromRGBString(null!=d?d.asHexString():"#000000");this.f.Ja("prezi_select.TextDecorator.caret."+c.getId(),(a,b)=>{w.isActive("js-disable-blinking-cursor")||(b.getTweener().createVisibilityAnimationHelper(A.ga.Hb).blinking(a,{duration:50,delay:0,delayBeforeRecurring:450}),a.set(F.Ba.gc,!0));a.set(H.Jb.Bd,!0);h.Cet.setBorder(a,-1,k.Geometry.colorFromRGBString("#ffffff"),1);h.Cet.setFillComponentWithSolidColor(a,x,1);a.set(l.SelectionModule.getDecoratorKey(),
u.w([a.getId()]));return a},(a,b)=>{w.isActive("js-disable-blinking-cursor")||v===a.get(F.Ba.gc)||(b=b.getTweener().createVisibilityAnimationHelper(A.ga.Hb),v?b.blinking(a,{duration:50,delay:0,delayBeforeRecurring:450}):b.removeVisibilityTweens(a),a.set(F.Ba.gc,v));h.Cet.setFillComponentWithSolidColor(a,x,1)},k.Geometry.obbFromData(b.x,b.y,2,f*a,p),!0)}he(a,b){const c=t.CetModelEditor.createTextHelper(),d=c.getSpecialTokens(a);let e;const f=[],g=new RegExp(/(?:[a-zA-Z'\d\u00C0-\u02AF\uac00-\ud7a3])+/,
"g");for(;null!=(e=g.exec(a));)-1!==b.indexOf(e[0])&&f.push({start:e.index,end:g.lastIndex});return f.filter((a)=>null==c.findSpecialToken(d,a.start,a.end))}};F.Ba.guid="prezi_select.TextDecorator";F.Ba.gc=q.CetModel.createValueComponentKey("lastBlinkingCaret",!1,!1);var ba={};Object.defineProperty(ba,"__esModule",{value:!0});ba.Id=class{constructor(a,b,c){this.camera=a;this.f=b;this.i=c}ea(a,b){var c=a.getEntityById(b);a=h.Cet.transform(c).getLocalToWorld();c=h.Cet.localBounds(c).getGraphicsBounds();
w.isActive("js-unique-differentiation")?(this.i.pa(b,a,c,[b],!0,{fillColor:"#FFFFFF",v:Number.MIN_VALUE}),this.i.Ec(a,c,[b]),this.i.ob(b,a,c,l.ControlPointType.resize)):(this.i.pa(b,a,c,[b],!0,{fillColor:"#3080FF",v:.2}),this.i.ob(b,a,c,l.ControlPointType.resize),this.i.mb(l.ControlPointType.widthResize,a,c,[b]),this.i.Ob(l.ControlPointType.heightResize,a,c,[b]))}da(a,b){var c=a.getEntityById(b);a=h.Cet.transform(c).getLocalToWorld();c=h.Cet.localBounds(c).getGraphicsBounds();w.isActive("js-unique-differentiation")?
this.i.ha(a,c,b):this.i.ha(a,c,b,{},{fillColor:"#3080FF",v:.2})}ye(a,b){var c=a.getEntityById(b);const d=h.Cet.transform(c);a=d.getLocalToWorld();c=h.Cet.world(c).getWorldBounds().transform(d.getWorldToLocal()).getBounds();this.i.Rb(v.ba.bf(b),a,c,u.w([b]),v.Lb)}};var ca={};Object.defineProperty(ca,"__esModule",{value:!0});ca.td=class{constructor(a,b){this.camera=a;this.f=b;this.helper=new v.ba(this.camera,this.f)}ea(a,b){const {localToWorld:c,localBounds:d}=this.bc(a);this.helper.pa("overview-border",
c,d,[b],!0);this.helper.ob(b,c,d,l.ControlPointType.overviewResize)}da(a,b){const {localToWorld:c,localBounds:d}=this.bc(a);this.helper.ha(c,d,b)}re(a,b,c){if(t.CetModelEditor.isOverview(b,a)&&(null==c||c.kind===z.CoverEditModeKind.insideAdvanced)){c=(null===c||void 0===c?void 0:c.kind)===z.CoverEditModeKind.insideAdvanced;var {localToWorld:a,localBounds:d}=this.bc(a);b=c||w.isActive("js-unique-differentiation")?u.clickable(b):u.w([b]);this.helper.Rb(v.ba.fc(b.interactionType),a,d,b,v.Lb);c&&(b=10/
(a.getScale()*this.camera.getTransform().getScale()),this.helper.Nb(a,d.inflate(-b,-b),"overview-border-marker"))}}bc(a){a=a.getPreziW().getOverview().getEntity();const b=h.Cet.transform(a);return{localToWorld:b.getLocalToWorld(),localBounds:h.Cet.world(a).getWorldBounds().transform(b.getWorldToLocal()).getBounds()}}};var da={};Object.defineProperty(da,"__esModule",{value:!0});da.pd=class{decorate(a,b){const c=k.Geometry.colorFromRGBString("#0D99FF"),d=k.Geometry.colorFromRGBString("#1AA651");b.isDrawInsertHoverMode&&
a.Ja("draw-insert-placeholder",(a)=>{h.Cet.setBorder(a,.5,d,1);h.Cet.setFillComponentWithSolidColor(a,c,.2);a.set(l.SelectionModule.getDecoratorKey(),u.w([]));return a},()=>{},k.Geometry.obbFromRect({x:b.stagePos.x,y:b.stagePos.y,width:b.size.width,height:b.size.height}))}};var A={};Object.defineProperty(A,"__esModule",{value:!0});A.ga=class{constructor(a,b,c,d,e,f,g,h,k,l,m,n,q,r,u,t,y,A,B,C){this.pf=a;this.ge=b;this.wf=c;this.fe=d;this.Pe=e;this.Bf=q;this.hf=r;this.camera=u;this.setSelectionAABBOnScreen=
A;this.j=B;this.Bb={isDrawInsertHoverMode:!1};this.Nc={isDrawInsertHoverMode:!1};this.isTopicZoomAreaEditEnabled=!1;a=f.toProperty(null);a.onValue(()=>{});this.Sb=[];this.Tb=[];this.$a=[];this.ub=[];this.kc=[];this.ra={ids:[],Za:null};this.vb=null;this.tb=[];this.currentTopic=this.newCurrentTopic=null;this.ed=[];this.pc=[];this.jc=[];this.ma=D.emptySelectionInfo();this.mc=D.emptySelectionInfo();this.sb=[];this.oc=[];this.Ub=this.lc=!1;this.f=new E.Aa(this.camera,t,50);this.cb=new E.Aa(this.camera,
t,0);this.i=new v.ba(this.camera,this.f);this.Jc=new T.kd(this.j);this.Ce=new da.pd;this.Oa=this.la=null;this.pf.onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.mc=a});this.ge.filterWithStream(h.map((a)=>a.kind===Q.EditorMode.edit&&a.editingKind===z.EditingKind.normal).toProperty(!0)).onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.ed=a});la.Bacon.combineWith((a,b)=>({Af:a,metadata:b}),this.Bf,this.hf).onValue(({Af:a,metadata:b})=>{if(b){var c=null==b.owner_id||b.owner_id===a.userId;
b=b.logo_type===oa.PreziLogoType.Watermark;a=a.featureSet.noWatermark;this.Zc=w.isActive("js-gm-watermark-paywall-on-click-and-present")&&c&&b&&!a}else this.Zc=!1});this.wf.onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.pc=a});this.fe.toEventStream().onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.jc=a});this.Pe.onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.kc=a.entityIds});a.onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.newCurrentTopic=a});g.onValue((a)=>
{null!=this.j&&this.j.markViewChanged();this.Ab=a;null!=this.Ab&&(this.draggedEntityHoveredTopicId=null)});h.onValue((a)=>{null!=a&&a.kind===Q.EditorMode.edit&&(null!=this.j&&this.j.markViewChanged(),this.Oa=a.editingKind===z.EditingKind.imageMask?{dd:a.maskedImageId,target:a.target,isFixedAspect:a.isFixedAspect}:null)});k.onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.draggedEntityHoveredTopicId=a});l.onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.isTopicZoomAreaEditEnabled=
a});m.onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.lc=null==a?!1:a.isEditing()});this.Ra=new F.Ba(this.camera,this.f,this.i,B);this.zb=new P.yc(this.camera,this.f,this.i);this.Ha=new x.u(this.camera,y,this.f,this.i,C);this.Db=new ca.td(this.camera,this.f);this.Gb=new ba.Id(this.camera,this.f,this.i);this.uc=new aa.Ad(this.camera,this.i);this.hc=new Y.sd(this.camera,this.f,n);this.La=new O.xc(this.camera,this.i);this.Xb=new W.od(this.camera,this.f,this.Ra,this.zb,this.Ha,this.Gb,new X.rd(this.camera,
this.i,this.cb),this.uc,this.hc,this.Db,this.La);this.lf=new Z.ud(this.camera,this.i,a)}getName(){return"selection"}addAreaSelectionStream(a){this.Jc.addAreaSelectionStream(a)}addTextStateStream(a){this.Ra.addTextStateStream(a)}addDrawInsertMouseHoverEventStream(a){a.onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.Bb=a})}zf(a){const b=[],c=[],d=h.Cet.createTopicChildrenQuery(a);a.getEntityList().forChangedMutableEntities((e)=>{for(let f of e)if(h.Cet.hasPdomComponent(f)){e=f.get(q.CetModel.ENTITY_OWNER_ID());
const g=a.getEntityById(e);null!=g&&(0===d.getChildrenIdsVisibleOutside(e).length?c.push(g.getId()):b.push(g.getId()))}},this.vf);this.oc=c.concat(this.sb.filter((c)=>null!=a.getEntityById(c)&&-1===b.indexOf(c)))}de(a,b){return null!=b&&1===b.length&&(a=a.getEntityById(b[0]).get(l.SelectionModule.getDecoratorKey()),null!=a)?{ids:a.ownerIds,Za:b[0]}:{ids:b,Za:null}}rf(a,b){return a.isDrawInsertHoverMode!==b.isDrawInsertHoverMode}update(a){this.zf(a);this.xf(a);var b=this.de(a,this.ed);this.ma!==this.mc||
!B.Utils.arrayEquals(this.ra.ids,b.ids)&&null==this.la||!B.Utils.arrayEquals(this.vb,this.pc)&&null==this.la||!B.Utils.arrayEquals(this.sb,this.oc)||this.ub!==this.kc||this.tb!==this.jc&&null==this.la||this.ka!==this.Ab||this.la!==this.Oa||this.Ub!==this.lc||this.currentTopic!==this.newCurrentTopic||this.rf(this.Nc,this.Bb)?(++A.ga.version,++A.ga.cd,this.ma=this.mc,this.ra=b,this.vb=this.pc,this.ub=this.kc,this.tb=this.jc,this.ka=this.Ab,this.la=this.Oa,this.sb=this.oc,this.Ub=this.lc,this.currentTopic=
this.newCurrentTopic,this.Nc=this.Bb):this.la!==this.Oa?(++A.ga.version,this.la=this.Oa):this.ra.Za!==b.Za&&(this.ra=b);this.f.update(a,A.ga.version);this.cb.update(a,A.ga.cd);null!==this.ma&&0!==this.ma.allEntityIds.length?(b=h.Cet.createScreenBoundsCalculator(a,this.camera).getScreenAABBForEntities(this.ma.allEntityIds,{text:h.TextBoundsOptions.SelectionBox}),this.setSelectionAABBOnScreen(b)):this.setSelectionAABBOnScreen(null);this.decorate(a);this.ic(a)}xf(a){null==this.Oa&&null!==this.la&&(a=
a.getEntityById(this.la.dd),null!=a&&(a.set(r.CetRendererModule.getImageMaskEditingStateComponentKey(),!1),pa.avro.Avro.createDefaultLogger().logCloseImageMaskingMode()))}decorate(a){const b=l.SelectionModule.getEditedGroupId(a,this.ma);null!=b&&this.La.ne(a,b);const c=this.ma.allEntityIds.filter((b)=>{let c=a.getEntityById(b);return null!=c&&null!=c.get(q.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD)&&0===a.getTweener().getTweenCount(b)});this.Ha.xe(a,this.Ab,this.currentTopic,this.isTopicZoomAreaEditEnabled,
this.Ub);this.Db.re(a,this.currentTopic,this.ka);w.isActive("js-unique-differentiation")&&a.getEntityList().forEach((b)=>{if(b.isDef(q.CetModel.ID.Z_ZOOM_AREA)){let c=a.getTweener().getTweenedComponent(b.getId(),r.CetRendererModule.getVisibilityComponentKey());null==c&&(c=h.Cet.visibility(b));c.isVisible()&&this.Gb.ye(a,b.getId())}});const d=(a)=>1!==c.length||-1===c.indexOf(a),e=null==this.ra.ids?[]:this.ra.ids.filter((b)=>{b=a.getEntityById(b);return this.Zc&&null!=b&&(b.isDef(q.CetModel.ID.LOGO)||
b.isDef(q.CetModel.ID.NEXT_LOGO_V1))});this.ec(a,b,null!=this.ra.ids?this.ra.ids.filter(d):[],this.ra.Za,c,e);this.ec(a,b,null!=this.vb?this.vb.filter(d):[],null,c);const f=h.Cet.createHierarchyQuery(a);this.sb.forEach((b)=>{f.getParentOrOverview(a.getEntityById(b))===this.currentTopic&&this.Ha.da(a,b,null,!1,this.ka)});null!=this.ub&&this.ec(a,b,this.i.nf(a,this.ub),null,this.ma.allEntityIds);this.lf.se(a,this.ka,c,this.tb);1<c.length?this.La.wb(a,c,this.Xb,this.ka):1===c.length&&this.Xb.ac(c[0],
a,this.ka,c).ea(a,c[0],this.ka,this.la,this.tb);null!=this.draggedEntityHoveredTopicId&&null==this.ka&&this.Ha.le(a,this.draggedEntityHoveredTopicId);this.Jc.decorate(this.f);this.Ce.decorate(this.f,this.Bb)}ec(a,b,c,d,e,f=[]){const {groupIds:g,entities:h}=l.SelectionModule.getGroupsWithEntities(a,c,[b,1===this.ma.groupIds.length?this.ma.groupIds[0]:null]);for(const c of h)b=c.getId(),this.Xb.ac(b,a,this.ka,e).da(a,b,d,-1!==f.indexOf(b),this.ka);for(const b of g)this.La.Qe(a,b)}ic(a){a=a.getEntityList();
const b=this.f.qa,c=this.f.Fa(),d=this.cb.qa;for(let c of this.Sb)-1===b.indexOf(c)&&a.deleteEntity(c);for(let b of this.Tb)-1===d.indexOf(b)&&a.deleteEntity(b);for(let a of this.$a)-1===c.indexOf(a)&&null!=a.parentElement&&a.parentElement.removeChild(a);this.Sb=b;this.Tb=d;this.$a=c}reset(){}init(a){a.getTweener().createVisibilityAnimationHelper(A.ga.Hb);this.vf=a.getEntityList().startNewTracking("SelectionSystemImpl-topic-child-change",[q.CetModel.ID.HAS_TOPIC_CHILDREN.TOPIC_CHILDREN],()=>!0)}changesPdomComponents(){return!1}getCurrentDecorators(){return[...this.Sb,
...this.Tb]}};A.ga.Hb="blinking-caret";A.ga.version=0;A.ga.cd=0;var C={};Object.defineProperty(C,"__esModule",{value:!0});C.sa=class{constructor(a,b){this.camera=a;this.f=b;this.jd=!1;this.i=new v.ba(a,b);this.camera.getZoomingLimitStream().onValue((a)=>this.jd=a===h.ZoomingLimit.ZoomInLimitReached)}Fe(a,b){switch(b.kind){case m.SnapResultKind.Align:this.Ae(b);break;case m.SnapResultKind.Highlight:this.Be(a,b);break;case m.SnapResultKind.UniverseLimit:this.He();break;default:B.Utils.assertNever(b)}}He(){this.f.ae(I.I18n.ts("Size limit reached"),
this.jd?48:0)}Ae(a){const {from:b,to:c}=this.Me([a.referenceSegment.P,a.referenceSegment.Q,a.subjectSegment.P,a.subjectSegment.Q]);b.x===c.x&&b.y===c.y||this.f.Zd(this.Yb(),(a)=>{h.Cet.setBorder(a,-1,k.Geometry.colorFromRGBString(C.sa.BORDER_COLOR),1);h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString(C.sa.qd),1);a.set(l.SelectionModule.getDecoratorKey(),u.w([]));return a},()=>{},b,c)}Me(a){a=a.sort((a,c)=>.001>Math.abs(a.x-c.x)?0:a.x-c.x).sort((a,c)=>.001>Math.abs(a.y-c.y)?0:a.y-
c.y);return{from:a[0],to:a[a.length-1]}}Be(a,b){b=a.getEntityById(b.referenceId);a=h.Cet.createScreenBoundsCalculator(a,this.camera).getScreenAABBForEntities([b.getId()],{topic:h.TopicBoundsOptions.layout});const c=this.camera.getTransform().invert();this.i.ha(c,a,b.getId(),{},{thickness:3})}Yb(){C.sa.bd++;return"snap-decorator_"+C.sa.bd}};C.sa.BORDER_COLOR="#3181ff";C.sa.qd="#F05A0F";C.sa.bd=0;var M={};Object.defineProperty(M,"__esModule",{value:!0});M.Kb=class{constructor(a,b){this.camera=a;this.f=
new E.Aa(a,b,0);this.sf=new C.sa(this.camera,this.f)}select(a,b){return h.Cet.hasPdomComponent(a)||b.getPreziW().getId()===a.getId()}getTriggerKeys(){return[m.EditorCommander.getSnapComponentKey()]}process(a,b){for(const c of a){a=b.getEntityList();const d=this.f.qa;if(null!=d)for(const b of d)a.deleteEntity(b);a=this.f.Fa();for(let b of a)null!=b.parentElement&&b.parentElement.removeChild(b);this.f.update(b,0);a=c.get(m.EditorCommander.getSnapComponentKey());null!=a&&null!=a.results&&a.results.forEach((a)=>
this.sf.Fe(b,a))}}getName(){return"SnapSystem"}init(a){a.getTweener().createVisibilityAnimationHelper(M.Kb.wd)}changesPdomComponents(){return!1}};M.Kb.wd="SnapConnectorDecorator";var ea={};Object.defineProperty(ea,"__esModule",{value:!0});ea.Ed=class{constructor(a,b){this.camera=a;this.f=b}Ge(a,b){if(null!=a.getEntityById(b.targetTopicId))switch(b.direction){case m.TopicNestingDirection.In:this.Ee(b,a);break;case m.TopicNestingDirection.Out:this.Ie(b,a);break;case m.TopicNestingDirection.None:break;
default:B.Utils.assertNever(b.direction)}}Ee(a,b){if(null!=b.getEntityById(a.targetTopicId)){var c=b.getTweener(),d=h.Cet.createTweenFactory();h.Cet.createTopicChildrenQuery(b).getChildrenIdsVisibleOutside(a.targetTopicId).forEach((e)=>{var f=b.getEntityById(e);f=h.Cet.transform(f).getLocalToWorld();var g=b.getAnimationScene().getEntityById(e);g=null!=g?h.Cet.transform(g).getLocalToWorld():f;f=k.Geometry.transform2dFromRad(f.getTranslation(),f.getScale()*a.factor,f.getRotationRad());f.equalsWithin(g,
Math.pow(2,-44))||(f=h.Cet.createTransformTween("TopicNestingDecorator-proximity",600,g,f),f.setEase(d.createExpOut(2.5,-10)),f.setDisableHittest(!1),c.addTween(e,f,!0))})}}Ie(a,b){var c=b.getEntityById(a.targetTopicId);c=h.Cet.createHierarchyQuery(b).getParentOrOverview(c);!b.getEntityById(c).isDef(q.CetModel.ID.OVERVIEW)&&a.nestingThresholdReached&&(b=this.camera.getMarginCorrectedStageArea().getTopLeft(),b=k.Geometry.obbFromData(b.x+-30,b.y+-20,700,700,0),this.Ic(b,a))}Yb(a){return`${"topic-nesting-decorator"}_${a.targetTopicId}.circle.zoom-out-area`}Ic(a,
b){this.f.Pd(this.Yb(b),a)}};var fa={};Object.defineProperty(fa,"__esModule",{value:!0});fa.Fd=class{constructor(a,b){this.camera=a;this.f=new E.Aa(a,b,0);this.ze=new ea.Ed(this.camera,this.f);this.$a=[]}update(a){this.f.update(a,0);let b=null;a.getEntityList().forChangedMutableEntities((a)=>{for(const c of a)b=c.get(m.EditorCommander.getTopicNestingComponentKey())},this.Je);null!=this.action&&null!=this.action.results&&(this.action.results.forEach((b)=>this.ze.Ge(a,b)),this.ic(a));this.action=b}ic(a){a=
a.getEntityList();const b=this.f.qa;if(null!=b)for(var c of b)a.deleteEntity(c);c=this.f.Fa();for(let a of this.$a)-1===c.indexOf(a)&&null!=a.parentElement&&a.parentElement.removeChild(a);this.$a=c}getName(){return"TopicGroupingSystem"}init(a){this.Je=a.getEntityList().startNewTracking("TopicNestingSystemImpl-topic-nesting",[m.EditorCommander.getTopicNestingComponentKey()],(b)=>b.getId()===a.getPrezi().getId())}reset(){}changesPdomComponents(){return!1}};var ha={};Object.defineProperty(ha,"__esModule",
{value:!0});ha.Dd=class{constructor(a,b,c,d){this.j=d;this.entityIds=[];this.Cb=this.Oc="NOT_FUNCTIONAL";this.f=new E.Aa(a,null,0);d=new v.ba(a,this.f);this.Ra=new F.Ba(a,this.f,d);b.onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.nc=a});c.skipDuplicates().onValue((a)=>{null!=this.j&&this.j.markViewChanged();this.Cb=a})}init(a){this.kf=a.getEntityList().startNewTracking("TextHighlight-newTextHighlights",[N.getSpellcheckComponentKey()],()=>!0);this.tf=a.getEntityList().startNewTracking("TextHighlight-textHighlightChanges",
[h.Cet.getShapedTextKey(),...q.CetModel.ID.TRANSFORMED.getFields(),q.CetModel.ID.ABSOLUTE.LOCAL_TO_WORLD,r.CetRendererModule.getLocalBoundsComponentKey(),q.CetModel.getRemovedEntityCompKey()],(a)=>a.hasComponent(N.getSpellcheckComponentKey()))}update(a){a.getEntityList().forChangedMutableEntities((a)=>{0<a.length&&(this.entityIds=this.entityIds.concat(a.map((a)=>a.getId())))},this.kf);a.getEntityList().forChangedMutableEntities((a)=>{0<a.length&&(this.entityIds=this.entityIds.concat(a.map((a)=>a.getId())))},
this.tf);if(0<this.entityIds.length){var b=a.getEntityList();let c=this.f.qa;if(null!=c)for(let a of c)b.deleteEntity(a);this.f.update(a,0);this.wb(a,this.entityIds)}else if(this.Oc!==this.Cb||this.currentTopicId!==this.nc)b=t.CetModelEditor.createTopicQuery(a).getReachableEntities(this.nc),this.wb(a,b),this.Oc=this.Cb,this.currentTopicId=this.nc;this.entityIds=[]}getName(){return"TextHighlightSystem"}changesPdomComponents(){return!1}reset(){}wb(a,b){b.forEach((b)=>{const c=a.getEntityById(b);(null===
c||void 0===c?0:c.hasComponent(N.getSpellcheckComponentKey()))&&this.Ra.ve(a,b,"ENABLED"===this.Cb)})}};var ia={};Object.defineProperty(ia,"__esModule",{value:!0});ia.yd=class{constructor(a){this.store=a}createSelectionSystem(a,b,c,d){return new A.ga(this.store.getSelectionStream(),this.store.getCanvasHoverStream(),this.store.getUiHoverStream(),this.store.getCanvasEditedEntityIdsStream(),this.store.getHighlightEntitiesOnDragSelectActionStream(),this.store.getCurrentTopicStream(),this.store.getCoverEditModeStream(),
this.store.getModeStream(),this.store.getDraggedEntityHoveredTopicIdStream(),this.store.getIsTopicZoomAreaEditEnabledStream(),this.store.getTextSelectionStateStream(),this.store.getNetworkStatusStream(),this.store.getUserLicenseInformationStream(),this.store.getMetadataStream(),a,b,c,(a)=>this.store.setSelectionAABBOnScreen(a),d,!0)}createSnapSystem(a,b,c){return a.createShaperSystem(new M.Kb(b,c))}createTopicNestingSystem(a,b){return new fa.Fd(a,b)}createTextHighlightSystem(a,b){return new ha.Dd(a,
this.store.getCurrentTopicStream(),this.store.getSpellcheckStatusStream(),b)}createCustomStartingPointSystem(a,b,c,d){return new S.nd(a,b,this.store.getCurrentTopicStream(),this.store.getModeStream(),c,d)}};var ja={};Object.defineProperty(ja,"__esModule",{value:!0});class ua{constructor(a,b,c){this.scene=a;this.camera=b;this.f=new E.Aa(b,c,0);this.i=new v.ba(b,this.f);this.vc=this.scene.getTweener().createVisibilityAnimationHelper("OverlayDrawer");this.f.update(a,0);this.aa=[]}ee(a){return(a.isDef(q.CetModel.ID.OVERVIEW)?
h.Cet.world(this.scene.getPreziW().getOverview().getEntity()).getWorldBounds():h.Cet.getViewportWorldIfFocusedOnEntity(a,this.scene,this.camera)).transform(h.Cet.transform(a).getWorldToLocal())}Qb(a,b){var c=this.scene.getEntityById(a),d=this.ee(c);const e=d.getCenter();var f=this.camera.getStageArea().getVertices();f=((a,b)=>k.Geometry.distance(a,b))(f.reduce((a,b)=>k.Geometry.distance(b,e)>k.Geometry.distance(a,e)?b:a,f[0]),e);f=d.inflateXY(f,f);d=this.f.wa(h.Cet.transform(c).getLocalToWorld(),
d.getBounds());c=this.f.wa(h.Cet.transform(c).getLocalToWorld(),f.getBounds());return this.i.kb(a,b,d,c,{color:"#000000"})}update(){this.aa=this.aa.filter((a)=>null!=this.scene.getEntityById(a.topicId)&&(null==a.entityId||null!=this.scene.getEntityById(a.entityId)));const a=this.aa.filter((a)=>"alive"===a.state||"fading-out"===a.state);var b=this.aa.filter((a)=>"removed"===a.state);const c=this.aa.filter((a)=>"to-fade"===a.state),d=this.aa.filter((a)=>"to-show"===a.state);this.f.update(this.scene,
0);a.forEach((a)=>{this.Qb(a.topicId,a.hb)});b.forEach((a)=>{this.scene.getEntityList().deleteEntity(a.entityId)});const e=this.camera.getMarginCorrectedViewport(),f=(a)=>{a=this.scene.getEntityById(a.topicId);const b=h.Cet.getViewportWorldIfFocusedOnEntity(a,this.scene,this.camera).transform(h.Cet.transform(a).getWorldToLocal());a=this.f.wa(h.Cet.transform(a).getLocalToWorld(),b.getBounds());return 1.4>=Math.max(e.getHeight(),a.getHeight())/Math.min(e.getHeight(),a.getHeight())};b=c.filter((a)=>
!f(a));const g=[];c.filter((a)=>f(a)).forEach((a)=>{const b=this.Qb(a.topicId,a.hb);null!=b&&(g.push(Object.assign(Object.assign({},a),{entityId:b,state:"alive"})),this.vc.fadeIn(this.scene.getEntityById(b),{duration:250,delay:0},()=>{}))});d.forEach((a)=>{const b=this.Qb(a.topicId,a.hb);null!=b&&(g.push(Object.assign(Object.assign({},a),{entityId:b,state:"alive"})),this.vc.fadeIn(this.scene.getEntityById(b),{duration:0,delay:0},()=>{}))});this.aa=a.concat(b).concat(g)}add(a,b){this.remove(a);const c=
this.scene.generateEntityId(),d=this.aa.filter((b)=>b.topicId!==a),e=this.aa.filter((b)=>b.topicId===a).map((a)=>Object.assign(Object.assign({},a),{state:"removed"}));d.push({topicId:a,hb:c,entityId:null,state:b});this.aa=d.concat(e)}remove(a){const b=this.aa.filter((b)=>b.topicId!==a&&null!=b.entityId),c=this.aa.filter((b)=>b.topicId===a),d=[];b.forEach((a)=>{d.push(Object.assign(Object.assign({},a),{state:"fading-out"}));const b=this.scene.getEntityById(a.entityId);null!=b&&this.vc.fadeOut(b,{duration:250,
delay:0},()=>{this.aa=this.aa.filter((b)=>a.hb!==b.hb).concat(Object.assign(Object.assign({},a),{state:"removed"}))})});this.aa=c.concat(d)}reset(){this.f.qa.forEach((a)=>{this.scene.getEntityList().deleteEntity(a)});this.f.update(this.scene,0);this.aa=[]}}ja.Gd=class{constructor(a,b){this.camera=a;this.o=b}init(a){this.qc=new ua(a,this.camera,this.o)}reset(){this.qc.reset()}decorate(a,b,c,d){c!==b&&this.qc.add(b,d?"to-fade":"to-show");this.qc.update()}};var H={};Object.defineProperty(H,"__esModule",
{value:!0});H.zd=class{constructor(){this.Bd=q.CetModel.createValueComponentKey("TEXT_CARET",!1,!1);this.eb=t.CetModelEditor.createGroupQuery()}createSelection(a){return new ia.yd(a)}createDecoratorEntityForTest(a){const b=new E.Aa(a.getCamera(),null,0),c=new v.ba(a.getCamera(),b);b.update(a.getModelScene(),0);return c.oa(v.ba.fc(l.InteractionType.none),(a)=>{h.Cet.setFillComponentWithSolidColor(a,k.Geometry.colorFromRGBString("#dcdcdc"),0);h.Cet.setBorder(a,1,k.Geometry.colorFromRGBString("#dcdcdc"),
1);a.set(this.getDecoratorKey(),u.w([]));return a},k.Geometry.transform2dFromRad({x:0,y:0},1,0),k.Geometry.rectangleFromData({x:0,y:0,width:1,height:1}),!0,6)}getDecoratorKey(){null==this.fa&&(this.fa=q.CetModel.createValueComponentKey("decorator",!1,!1));return this.fa}getControlPointKey(){null==this.Lc&&(this.Lc=q.CetModel.createValueComponentKey("controlPoint",!1,!1));return this.Lc}getEnabledControlPointsKey(){null==this.Sc&&(this.Sc=q.CetModel.createValueComponentKey("enabled_ctrl_points",!1,
!1));return this.Sc}getDisabledResizeControlPointKey(){null==this.Pc&&(this.Pc=q.CetModel.createValueComponentKey("disabledResizeControlPoint",!1,!1));return this.Pc}getEnableBlinkingCaretKey(){null==this.Rc&&(this.Rc=q.CetModel.createValueComponentKey("blinkingCaret",!1,!1));return this.Rc}restrictToEntityAndCtrlPointsSQStrategy(a){return(b)=>[...b].sort((b,d)=>{const c=(a)=>{a=a.get(l.SelectionModule.getDecoratorKey());return null!=a&&a.interactionType===l.InteractionType.controlPoint};b=b.getData().entity.getId()===
a||c(b.getData().entity);d=d.getData().entity.getId()===a||c(d.getData().entity);return b&&!d?-1:d&&!b?1:0})}createSelectionController(a,b){return new R.xd(a,b)}createCustomSelectionSystem(a,b,c,d,e,f,g,h,k,l,m,n,q,r,t,u,v,w,x){return new A.ga(a,b,c,d,e,f,g,h,k,l,m,n,q,r,t,u,v,w,x,!1)}createTopicOverlayAnimator(a,b){return new ja.Gd(a,b)}getEditedGroupId(a,b){return 0<b.groupIds.length?null:this.getContainerGroupId(a,b.nonGroupedEntityIds)}getContainerGroupId(a,b){if(null==b||0===b.length)return null;
const c=this.eb.getGroupIdFromEntityId(a,b[0]);if(null==c)return null;const d=new Set(this.eb.getGroupMembers(a,c).map((a)=>a.getId()));return b.every((a)=>d.has(a))?c:null}getGroupsWithEntities(a,b,c=[]){const d=new Set,e=[];for(const f of b){if(null==f)continue;b=a.getEntityById(f);if(null==b)continue;const g=this.eb.getGroupIdFromEntity(a,b);null!=g&&0>c.indexOf(g)?d.add(g):b.isDef(q.CetModel.ID.GROUP)?d.add(b.getId()):e.push(b)}return{entities:e,groupIds:Array.from(d)}}};H.Jb=new H.zd;var l={};
Object.defineProperty(l,"__esModule",{value:!0});(function(a){a.controlPoint="controlPoint";a.border="border";a.topicZoomAreaBorder="topicZoomAreaBorder";a.locked="locked";a.clickable="clickable";a.maskDrag="maskDrag";a.none="none"})(l.InteractionType||(l.InteractionType={}));(function(a){a.lockedMarker="lockedMarker";a.resize="resize";a.topicZoomAreaResize="topicZoomAreaResize";a.heightResize="heightResize";a.widthResize="widthResize";a.resizeMaskImage="resizeMaskImage";a.resizeMaskArea="resizeMaskArea";
a.heightResizeMaskArea="heightResizeMaskArea";a.widthResizeMaskArea="widthResizeMaskArea";a.line="line";a.overviewResize="overviewResize";a.rotate="rotate"})(l.ControlPointType||(l.ControlPointType={}));(function(a){a.zoomInButton="selection-zoom-in-button";a.placeholderButton="selection-placeholder-button"})(l.Lookup||(l.Lookup={}));l.SelectionModule=H.Jb;ka=l;y=document.createElement("style");y.textContent=".gadgetFadeOnHover{transition:opacity 500ms}.gadgetFadeOnHover:hover{opacity:0}\n";document.body.appendChild(y);
return ka});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_select",["require","prezi.geometry","prezi_app_utils","prezi_bacon","prezi_cet","prezi_cet_model","prezi_cet_model_editor","prezi_cet_renderer","prezi_editor_commander","prezi_editor_store_common","prezi_editor_store_mode","prezi_editor_store_object","prezi_externalserviceprovider","prezi_featureswitcher","prezi_i18n","prezi_logger","prezi_plugin_meta","prezi_spellcheck","prezi_textmodel","prezi_utils","prezi_widgets"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_select.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi.geometry"),require("prezi_app_utils"),require("prezi_bacon"),require("prezi_cet"),require("prezi_cet_model"),require("prezi_cet_model_editor"),require("prezi_cet_renderer"),require("prezi_editor_commander"),require("prezi_editor_store_common"),require("prezi_editor_store_mode"),require("prezi_editor_store_object"),require("prezi_externalserviceprovider"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_logger"),require("prezi_plugin_meta"),require("prezi_spellcheck"),require("prezi_textmodel"),require("prezi_utils"),require("prezi_widgets"));}else{this["prezi_select"]=__factory(this["prezi.geometry"],this["prezi_app_utils"],this["prezi_bacon"],this["prezi_cet"],this["prezi_cet_model"],this["prezi_cet_model_editor"],this["prezi_cet_renderer"],this["prezi_editor_commander"],this["prezi_editor_store_common"],this["prezi_editor_store_mode"],this["prezi_editor_store_object"],this["prezi_externalserviceprovider"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_logger"],this["prezi_plugin_meta"],this["prezi_spellcheck"],this["prezi_textmodel"],this["prezi_utils"],this["prezi_widgets"]);}}).call(this);