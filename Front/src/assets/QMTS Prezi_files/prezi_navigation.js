;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_navigation";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi.geometry":dependencies[0],"prezi_cet_model_editor":dependencies[1],"prezi_featureswitcher":dependencies[2],"prezi_i18n":dependencies[3],"prezi_logger":dependencies[4],"prezi_plugin_api":dependencies[5],"prezi_plugin_meta":dependencies[6],"prezi_utils":dependencies[7],"prezi_widgets":dependencies[8]}};})());};})(arguments);var moduleImpl=(function(){return module(function(f){var h=f.dependencies.prezi_i18n,k=f.dependencies.prezi_plugin_api,e=f.dependencies.prezi_cet_model_editor,g=f.dependencies.prezi_logger,v=f.dependencies.prezi_utils,m=f.dependencies.prezi_featureswitcher,q=f.dependencies.prezi_widgets,t={};Object.defineProperty(t,"__esModule",{value:!0});var n;(function(a){a[a.ZOOM_IN=0]="ZOOM_IN";a[a.ZOOM_OUT=1]="ZOOM_OUT"})(n||(n={}));var l;(function(a){a.forward="forward";a.backward="backward"})(l||(l={}));const r=Math.log((Math.exp(1)-Math.exp(.25))/
.75),u=Math.exp(1-r)-1;t.ca=class{init(a){this.f=a.declareUI({j:null,$:!1,aa:!1,pathElementId:null,o:null,currentTopicId:null,panModeEnabled:!1},(a,b)=>{m.isActive("js-navigation-control-bar")&&this.da(a,b)});a.onCurrentTopicChange((a)=>{this.f.setState({currentTopicId:a});this.session.document.read((b)=>{var c;const d=null===(c=b.lookup.simpleObjectParent(a))||void 0===c?void 0:c.ref;null!=d&&(c=b.structuredPath.pathElementsInOrder.filter(e.base.readerIs(e.base.ObjectKind.pathParent)).find((a)=>
a.target.id===d.id),null==c&&(c=b.structuredPath.editorPath),b=c.is(e.base.ObjectKind.visitPage)?c.parent:c,this.f.setState({j:b.is(e.base.ObjectKind.pathChild)?b.parent.target.ref:null}))});this.i(this.session.positionFinder.getCameraLayoutBox())});a.onNavigation((a)=>{this.session.document.read((b)=>{b=b.lookup.resolve(a.pathElementRef);return null==b||this.u(b)})||this.ba(a.pathElementRef.id)});m.isActive("js-navigation-control-bar")&&(a.onPanModeChange((a)=>{this.f.setState({panModeEnabled:a})}),
a.onCameraZoom((a)=>{this.i(a.cameraLayoutBox)}))}processMessage(a){if(a.mat.isValid())switch(a.kind){case "navigateBackwards":this.navigate(a.mat,l.v);break;case "navigateForward":this.navigate(a.mat,l.forward);break;case "goToOverview":this.goToOverview(a.mat);break;case "goBack":this.goBack(a.mat,this.f.getState());break;default:v.Utils.assertNever(a.kind)}}da(a,d){d.createNavigationBarItem((b)=>b.toolSwitch({leftTooltipText:h.I18n.ts("Select tool"),rightTooltipText:h.I18n.ts("Hand tool"),leftIcon:k.IconSmallId.SelectTool,
rightIcon:k.IconSmallId.HandTool,groupWeight:1,weight:11,id:"navigation-bar-tool-switch",activeSide:a.panModeEnabled?q.ActiveSide.right:q.ActiveSide.left,onClick:(c,b)=>{this.session.navigation.setPanMode(c,b===q.ActiveSide.right);c=this.session.document.read((a)=>a.overview.id);g.avro.Avro.createDefaultLogger().logClickNavigationBar({navigation_bar_item:b===q.ActiveSide.left?"SELECTION_TOOL":"HAND_TOOL",parent_type:a.currentTopicId===c?"OVERVIEW":"TOPIC"})}}));d.createNavigationBarItem((b)=>b.button({groupWeight:2,
weight:21,icon:k.IconSmallId.ChevronLeft,tooltip:h.I18n.ts("Previous"),id:"navigation-bar-previous",enabled:a.aa,onClick:(c)=>{this.navigate(c,l.v);c=this.session.document.read((a)=>a.overview.id);g.avro.Avro.createDefaultLogger().logClickNavigationBar({navigation_bar_item:"PREVIOUS_STEP",parent_type:a.currentTopicId===c?"OVERVIEW":"TOPIC"})}}));d.createNavigationBarItem((b)=>b.button({groupWeight:2,weight:22,icon:k.IconSmallId.ChevronRight,tooltip:h.I18n.ts("Next"),id:"navigation-bar-next",enabled:a.$,
onClick:(c)=>{this.navigate(c,l.forward);c=this.session.document.read((a)=>a.overview.id);g.avro.Avro.createDefaultLogger().logClickNavigationBar({navigation_bar_item:"NEXT_STEP",parent_type:a.currentTopicId===c?"OVERVIEW":"TOPIC"})}}));d.createNavigationBarItem((b)=>b.button({groupWeight:3,weight:31,icon:k.IconSmallId.Home,tooltip:h.I18n.ts("Overview"),id:"navigation-bar-overview",onClick:(c)=>{this.goToOverview(c);c=this.session.document.read((a)=>a.overview.id);g.avro.Avro.createDefaultLogger().logClickNavigationBar({navigation_bar_item:"GO_TO_OVERVIEW",
parent_type:a.currentTopicId===c?"OVERVIEW":"TOPIC"})}}));null!=a.j&&d.createNavigationBarItem((b)=>b.button({groupWeight:3,weight:32,icon:k.IconSmallId.ZoomOut,tooltip:h.I18n.ts("Go back"),id:"navigation-bar-go-back",onClick:(c)=>{this.goBack(c,a);c=this.session.document.read((a)=>a.overview.id);g.avro.Avro.createDefaultLogger().logClickNavigationBar({navigation_bar_item:"GO_BACK",parent_type:a.currentTopicId===c?"OVERVIEW":"TOPIC"})}}));d.createNavigationBarItem((b)=>b.repeatButton({id:"navigation-bar-zoom-out",
groupWeight:4,weight:41,tooltip:h.I18n.ts("Zoom out"),icon:k.IconSmallId.Minus,onRepeat:(c)=>{this.session.navigation.zoom(c,this.w(n.ZOOM_OUT),!0);c=this.session.document.read((a)=>a.overview.id);g.avro.Avro.createDefaultLogger().logClickNavigationBar({navigation_bar_item:"MINUS_ZOOM",parent_type:a.currentTopicId===c?"OVERVIEW":"TOPIC"})}}));d.createNavigationBarItem((b)=>b.button({id:"navigation-bar-zoom-to",groupWeight:4,weight:42,tooltip:h.I18n.ts("Zoom to 100%"),title:null==a.o?"100%":Math.round(100*
a.o).toString()+"%",onClick:(c)=>{this.session.document.read((b)=>{b=b.lookup.base(a.currentTopicId);null!=b&&(b.is(e.base.ObjectKind.planetTopic)||b.is(e.base.ObjectKind.overview)||b.is(e.base.ObjectKind.page))&&this.session.navigation.flyTo(c,b).then(()=>{this.i(this.session.positionFinder.getCameraLayoutBox())})});const b=this.session.document.read((a)=>a.overview.id);g.avro.Avro.createDefaultLogger().logClickNavigationBar({navigation_bar_item:"ZOOM_TO_FIT",parent_type:a.currentTopicId===b?"OVERVIEW":
"TOPIC"})}}));d.createNavigationBarItem((b)=>b.repeatButton({id:"navigation-bar-zoom-in",groupWeight:4,weight:43,tooltip:h.I18n.ts("Zoom in"),icon:k.IconSmallId.Plus,onRepeat:(b)=>{this.session.navigation.zoom(b,this.w(n.ZOOM_IN),!0);b=this.session.document.read((a)=>a.overview.id);g.avro.Avro.createDefaultLogger().logClickNavigationBar({navigation_bar_item:"PLUS_ZOOM",parent_type:a.currentTopicId===b?"OVERVIEW":"TOPIC"})}}))}goBack(a,d){this.session.document.read((b)=>{b=b.lookup.resolve(d.j);null!=
b&&(b.kind!==e.base.ObjectKind.overview&&g.avro.Avro.createDefaultLogger().logOpenedTopic({object_type:b.parent.kind===e.base.ObjectKind.overview?"TOPIC":"SUBTOPIC",object_id:d.j.id}),g.avro.Avro.createDefaultLogger().logNavigatePrezi({navigation_type:d.j.kind===e.base.ObjectKind.overview?"GO_TO_OVERVIEW":"GO_UP",action_index:0,step_index:0,total_step_number:0}),this.session.navigation.flyTo(a,b).then(()=>{m.isActive("js-navigation-control-bar")&&this.i(this.session.positionFinder.getCameraLayoutBox())}))})}goToOverview(a){this.session.document.read((d)=>
{g.avro.Avro.createDefaultLogger().logNavigatePrezi({navigation_type:"GO_TO_OVERVIEW",action_index:0,step_index:0,total_step_number:0});this.session.navigation.flyTo(a,d.overview).then(()=>{m.isActive("js-navigation-control-bar")&&this.i(this.session.positionFinder.getCameraLayoutBox())})})}i(a){this.session.document.read((d)=>{const b=a.withReferenceFrame(d.overview.zoomLayoutBox.asReferenceFrame).size.height,c=d.lookup.base(this.f.getState().currentTopicId);let p=0;null!=c&&(c.is(e.base.ObjectKind.overview)?
p=c.zoomLayoutBox.size.height:c.is(e.base.ObjectKind.planetTopic)?p=c.cover.zoomLayoutBox.withReferenceFrame(d.overview.zoomLayoutBox.asReferenceFrame).size.height:c.is(e.base.ObjectKind.page)&&(p=c.parent.cover.zoomLayoutBox.withReferenceFrame(d.overview.zoomLayoutBox.asReferenceFrame).size.height));0===p||0===b||isNaN(b)?this.f.setState({o:null}):(d=p/b,this.f.setState({o:.25>d?d:Math.log(d+u)+r}))})}ba(a){const d=this.session.document.read((b)=>{var c=b.lookup.pathElement(a);b=b.structuredPath.viewPathElementsInOrder;
if(null==c)return null;const d=c.is(e.base.ObjectKind.visitStack)?c.children[0]:c;if(null==b.find((a)=>a.id===d.id))return null;c=b.findIndex((a)=>!this.u(a));let f=b.length-1;for(;this.u(b[f]);)--f;return{pathElementId:d.id,aa:b[c].id!==a,$:b[f].id!==a}});null!=d&&this.f.setState(Object.assign({},d))}navigate(a,d){let b;switch(d){case l.forward:b=1;break;case l.v:b=-1;break;default:v.Utils.assertNever(d)}d=this.session.document.executeApiCommand(a,{name:"navigate-path",run:(c)=>{c=c.structuredPath.viewPathElementsInOrder;
let d=c.findIndex((a)=>a.id===this.f.getState().pathElementId)+b;for(;this.u(c[d]);)d+=b;this.session.navigation.goToPathElement(a,c[d]).then(()=>{m.isActive("js-navigation-control-bar")&&this.i(this.session.positionFinder.getCameraLayoutBox())});return c[d].id}});this.ba(d)}u(a){return a.is(e.base.ObjectKind.fadeIn)||a.is(e.base.ObjectKind.fadeOut)}w(a){const d=this.f.getState().o;return null==d?1:(Math.exp((a===n.ZOOM_OUT?.25*(Math.ceil((d-.005)/.25)-1):.25*(Math.floor((d+.005)/.25)+1))-r)-u)/(Math.exp(d-
r)-u)}};f={};Object.defineProperty(f,"__esModule",{value:!0});f.lazyModule={createPlugin(){return new t.ca}};return f});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_navigation",["require","prezi.geometry","prezi_cet_model_editor","prezi_featureswitcher","prezi_i18n","prezi_logger","prezi_plugin_api","prezi_plugin_meta","prezi_utils","prezi_widgets"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_navigation.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi.geometry"),require("prezi_cet_model_editor"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_logger"),require("prezi_plugin_api"),require("prezi_plugin_meta"),require("prezi_utils"),require("prezi_widgets"));}else{this["prezi_navigation"]=__factory(this["prezi.geometry"],this["prezi_cet_model_editor"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_logger"],this["prezi_plugin_api"],this["prezi_plugin_meta"],this["prezi_utils"],this["prezi_widgets"]);}}).call(this);