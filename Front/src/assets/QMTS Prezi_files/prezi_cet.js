;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_cet";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi.engine.dom":dependencies[0],"prezi.engine.dom.converter.xpdom2":dependencies[1],"prezi.geometry":dependencies[2],"prezi_bacon":dependencies[3],"prezi_cet_model":dependencies[4],"prezi_cet_renderer":dependencies[5],"prezi_externalserviceprovider":dependencies[6],"prezi_featureswitcher":dependencies[7],"prezi_logger":dependencies[8],"prezi_nativeapitypes":dependencies[9],"prezi_service_assetloader":dependencies[10],"prezi_service_data":dependencies[11],"prezi_service_fontcatalogue":dependencies[12],"prezi_service_media":dependencies[13],"prezi_textmodel":dependencies[14],"prezi_utils":dependencies[15],"prezi_video":dependencies[16]}};})());};})(arguments);var moduleImpl=(function(){return module(function(Q){function Y(a){const b=a?a.intent.name:"no-intent";if(null==a)return{message:b,snapshotBefore:{reset:()=>{}},snapshotAfter:{reset:()=>{}}};if(!(a instanceof da))throw Error("not a TransactionImpl "+a);return{message:b,snapshotBefore:a.snapshotBefore,snapshotAfter:a.snapshotAfter}}var Tc=null,$a=Q.dependencies.prezi_externalserviceprovider,C=Q.dependencies.prezi_nativeapitypes,E=Q.dependencies.prezi_service_data,Uc=Q.dependencies.prezi_service_fontcatalogue,ta=Q.dependencies.prezi_textmodel,
m=Q.dependencies["prezi.engine.dom"],t=Q.dependencies["prezi.geometry"],f=Q.dependencies.prezi_cet_model,h=Q.dependencies.prezi_cet_renderer,u=Q.dependencies.prezi_logger,Vc=Q.dependencies.prezi_service_assetloader,x=Q.dependencies.prezi_utils,T=Q.dependencies.prezi_video,H=Q.dependencies.prezi_featureswitcher,n=Q.dependencies.prezi_bacon,ab={};Object.defineProperty(ab,"__esModule",{value:!0});ab.el=class{constructor(){}getNavigationMode(){return e.NavigationMode.NEW_TRANSITION}reset(){}};var yb=
{};Object.defineProperty(yb,"__esModule",{value:!0});yb.hq=class{constructor(a,b){this.Ya=a;this.L=b;this.gk=n.Bacon.newBus()}start(a,b,c=!1){null==b&&(b=[0]);if(0!==b.length){var d=this.L.getLogAllFrames();this.L.getStatisticsProcessor().setAutoplaySpeedTest(a);this.L.setLogAllFrames(c);this.L.stopScheduledTest();var g=0,f=this.Ya.getPathNavigator().getNavigationStrategy();this.Ya.getPathNavigator().setNavigationStrategy(new ab.el);this.Ya.setLoop(1<b.length);this.Ya.setInterval(b[0]);this.Ya.getPathNavigator().go(this.Ya.getPathNavigator().getPath().getPathPosition(0,
0));var y=()=>{};y=this.Ya.getEventStream().onValue((a)=>{switch(a.getType()){case e.AutoPlayEventType.START:case e.AutoPlayEventType.RESTART:this.gk.push(!0);a=b[g++];g>=b.length&&this.Ya.setLoop(!1);this.Ya.setInterval(a);this.L.setExperiment(a+"_msec_delay");break;case e.AutoPlayEventType.STOP:y(),this.Ya.getPathNavigator().setNavigationStrategy(f),this.L.stop(),this.L.setLogAllFrames(d),this.L.startScheduledTest(),this.L.getStatisticsProcessor().stopAutoplaySpeedTest(),this.gk.push(!1)}});this.L.start();
this.Ya.start()}}getSpeedTestInProgressStream(){return this.gk.toProperty(!1)}};var zb={};Object.defineProperty(zb,"__esModule",{value:!0});zb.bq=class{constructor(a){this.U=a;this.mm=[];this.$f=[];this.Bd=[]}addThumbnailRenderer(a,b){this.Bd.push({dx:b,assetId:a});0<this.Wm(a).length&&this.Ap(a)}removeAssetId(a){const b=this.U.getRecentAssetId(a);this.Bd=this.Bd.filter((a)=>this.U.getRecentAssetId(a.assetId)===b);this.$f=this.$f.filter((a)=>this.U.getRecentAssetId(a.assetId)===b)}Wm(a){const b=this.U.getRecentAssetId(a);
return this.mm.map((a)=>this.i.getEntityById(a)).filter((a)=>null!=a).map((a)=>a.getWrapper(f.CetModel.ID.MEDIA_ASSET.W)).filter((a)=>this.U.getRecentAssetId(a.getOfflineAssetId())===b)}registerIMediaAssetW(a){const b=this.U.getRecentAssetId(a.getOfflineAssetId());var c=a.getEntity().get(this.getKey());if(null==c||this.U.getRecentAssetId(c.assetId)!==b)c=this.$f.find((a)=>this.U.getRecentAssetId(a.assetId)===b),a.getEntity().set(this.getKey(),null!=c?c:{assetId:b,id:null,thumbnail:null}),this.mm.push(a.getId()),
this.Ap(b)}Ap(a){const b=this.U.getRecentAssetId(a);a=this.Bd.findIndex((a)=>this.U.getRecentAssetId(a.assetId)===b);if(-1!==a){var c=this.Bd[a];c.dx().then((a)=>{const b={thumbnail:a,assetId:c.assetId};this.$f.push(b);this.i.executeNoDomBatchUpdate((a)=>{for(const c of this.Wm(b.assetId))a.getEntityById(c.getId()).set(this.getKey(),b)})}).catch(()=>{});this.Bd.splice(a,1)}}getThumbnail(a){const b=a.getEntity().get(this.getKey());return null==b||this.U.getRecentAssetId(b.assetId)!==this.U.getRecentAssetId(a.getOfflineAssetId())||
null==b.thumbnail?null:b}getKey(){return e.Cet.getAssetThumbnailKey()}};var ea={};Object.defineProperty(ea,"__esModule",{value:!0});ea.Rc=class{constructor(){}static Gu(){let a=ea.Rc.startTime;null!=window.performance&&null!=window.performance.timing&&null!=window.performance.timing.navigationStart&&(a=window.performance.timing.navigationStart);return(new ea.Rc).now()-a}now(){return(new Date).getTime()}op(a,b){return x.Utils.delay(a,b)}bx(a){null!=a&&a.stop()}};ea.Rc.startTime=(new Date).getTime();
var G={};Object.defineProperty(G,"__esModule",{value:!0});(function(a){a[a.IDLE=0]="IDLE";a[a.Zh=1]="WORKING";a[a.pe=2]="STOPPED";a[a.Eb=3]="DISPOSED"})(G.sa||(G.sa={}));var O={};Object.defineProperty(O,"__esModule",{value:!0});O.Oa=class{constructor(a,b){this.logger=u.LoggerModule.getLoggerManager().createLogger("prezi_cet.EagleTypePanning");this.camera=a;this.Ha=b;this.state=G.sa.IDLE}init(a){this.state!==G.sa.Eb&&(this.Lb=a,this.df=this.camera.getTransform(),this.state=G.sa.IDLE)}stop(){return this.state===
G.sa.Eb?this.state:this.state=this.state===G.sa.Zh?G.sa.pe:G.sa.Eb}Sn(){return this.state===G.sa.Zh}mp(a){this.state!==G.sa.Eb&&(this.Yn=this.Ha.now(),this.Rd=a,this.state=G.sa.Zh,this.update())}update(){var a=this.state;if(a===G.sa.Eb||a===G.sa.IDLE)return this.state;if(null==this.Lb||null==this.Rd)return this.logger.print("Not initialized in state: "+x.Utils.stringify(this.state)),this.state;var b=this.Ha.now();a=Math.floor(Math.max(1,Math.floor((b-this.Yn)/O.Oa.lr)));this.Yn=b;b=this.camera.getTransform();
for(let c=0;c<a&&this.state!==G.sa.Eb;c++)b=this.px(b);this.camera.nf(b);return this.state}px(a){let b=this.Ks(),c=this.Gs(b),d=this.Is(a,c);return this.kv(c,d)?(a=this.$t(a),this.dispose(),a):this.Kv(a,d,b)}Ks(){return{x:(this.Rd.x-this.Lb.x)*O.Oa.Pk,y:(this.Rd.y-this.Lb.y)*O.Oa.Pk}}Gs(a){return Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2))}Is(a,b){a=Math.log(a.getScale());b=Math.log(this.df.getScale())-b/O.Oa.fr;return Math.exp(a+(b-a)*O.Oa.Kr)}kv(a,b){b/=this.df.getScale();return a<O.Oa.Hq&&O.Oa.Iq<
b&&this.state===G.sa.pe}$t(a){var b=this.Rd.x-this.Lb.x,c=this.Rd.y-this.Lb.y;let d=a.scaleAroundPoint(this.Lb,this.df.getScale()/a.getScale());a=this.df.getScale()/a.getScale();return d.translate({x:a*b,y:a*c})}Kv(a,b,c){let d=a.scaleAroundPoint(this.Lb,b/a.getScale());a=b/a.getScale();c={x:a*c.x,y:a*c.y};this.Lb={x:c.x+this.Lb.x,y:c.y+this.Lb.y};return d.translate(c)}dispose(){this.df=this.Rd=null;this.state=G.sa.Eb}};O.Oa.Pk=.125;O.Oa.Kr=.06666666666666667;O.Oa.Hq=5E-4;O.Oa.Iq=.999;O.Oa.fr=400;
O.Oa.lr=17;var Ab={};Object.defineProperty(Ab,"__esModule",{value:!0});Ab.$q=class{constructor(a){this.camera=a;this.state=G.sa.IDLE}update(){return this.state}stop(){return this.state=G.sa.Eb}init(a){this.yp=a;this.Vw=this.camera.getTransform()}mp(a){this.camera.nf(this.Vw.translate({x:a.x-this.yp.x,y:a.y-this.yp.y}))}Sn(){return!1}dispose(){this.state=G.sa.Eb}};var bb={};Object.defineProperty(bb,"__esModule",{value:!0});bb.Ck=class{constructor(a,b,c){this.yf=a;this.Uc=b;this.Ge=c}update(a){a=Math.round(a);
return this.yf.update(a>this.Uc?this.Ge*(a-this.Uc)+this.Uc:a)}Oi(){return this.Ge}ek(){throw Error("setup should not be called on AcceleratedTransition, use new()");}$c(){return Math.round(0<this.Ge?(this.yf.$c()-this.Uc)/this.Ge+this.Uc:this.Uc+this.Uc/-this.Ge)}wg(){return this.yf.wg()}$g(a){this.yf.$g(a)}};var J={};Object.defineProperty(J,"__esModule",{value:!0});class la{static ex(a){return a*Math.PI/180}static sinh(a){return(Math.exp(a)-Math.exp(-a))/2}static cosh(a){return(Math.exp(a)+Math.exp(-a))/
2}static tanh(a){return la.sinh(a)/la.cosh(a)}static hy(a){return a*a}static min(a,b){return a<b?a:b}static max(a,b){return a<b?b:a}}J.Kk=class{constructor(){this.Bb=1.4}ek(a,b,c){this.v=J.Oc.gg(a);this.w=J.Oc.gg(b);this.Sl();this.Xf=c;this.El();isNaN(this.ob)&&(this.ob=1.2,this.Eg=!0)}$g(a){this.v=J.Oc.gg(a.concat(this.v.od()));this.w=J.Oc.gg(a.concat(this.w.od()));this.Sl();this.cj()}El(){}cj(){}Sl(){this.v.rotation%=360;this.w.rotation%=360;-180>this.v.rotation?this.v.rotation+=360:180<this.v.rotation&&
(this.v.rotation-=360);180<Math.abs(this.w.rotation-this.v.rotation)&&(0>this.w.rotation?this.w.rotation+=360:0<this.w.rotation&&(this.w.rotation-=360))}update(a){let b,c;var d=Math.round(a);let g=1E3*this.ob;if(0===g)return this.w.od();if(0>d)return this.v.od();if(d>g)return this.w.od();this.Eg?(a=this.kg(d,this.v.x,this.w.x-this.v.x,g),b=this.kg(d,this.v.y,this.w.y-this.v.y,g),c=this.kg(d,this.v.scale,this.w.scale-this.v.scale,g),d=this.im(d,this.v.rotation,this.w.rotation-this.v.rotation,g),a=
new J.Oc(a,b,c,d)):a=this.Iu(d,g);return a.od()}Iu(a,b){a=this.Hm(a,b);b=this.mu(this.S*a);return new J.Oc(this.v.x+b*this.ix,this.v.y+b*this.jx,this.Xf/this.nu(this.S*a),(this.v.rotation+a*(this.w.rotation-this.v.rotation))%360)}Hm(a,b){return this.Ot(a,this.Qt,this.Ei,b)/b}$c(){return Math.round(1E3*this.ob)}wg(){if(null==this.w)throw"getEndPosition: Transition is not initialized yet!";return this.w.od()}kg(a,b,c,d){return 1>(a/=d/2)?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b}im(a,b,c,d){return c*a/d+b}Nt(a,
b,c){a/=c;return b*a*a}Pt(a,b,c,d){a/=d;return-c*a*(a-2)+b}Ot(a,b,c,d){return a<b?this.Nt(a,c,b):a<d-b?this.im(a-b,c,d-2*c,d-2*b):this.Pt(a-d+b,d-c,c,b)}mu(a){return this.ce*la.cosh(this.Td)*la.tanh(this.Bb*a+this.Td)/(this.Bb*this.Bb)-this.ce*la.sinh(this.Td)/(this.Bb*this.Bb)+this.sk}nu(a){return this.ce*la.cosh(this.Td)/la.cosh(this.Bb*a+this.Td)}};J.Sx=class extends J.Kk{constructor(a){super();this.Eg=!0;this.ob=null==a?1.2:a}};J.Xk=class extends J.Kk{constructor(a=1){super();this.Gp=a}El(){this.Eg=
!1;var a=this.w.x-this.v.x;let b=this.w.y-this.v.y;a=Math.sqrt(a*a+b*b);Math.abs(0-a)<=Math.pow(2,-30)&&Math.abs(this.w.rotation-this.v.rotation)<=Math.pow(2,-30)&&Math.abs(1-this.v.scale/this.w.scale)<=Math.pow(2,-30)?this.ob=0:(this.Eg=.3>Math.abs(1-this.v.scale/this.w.scale)&&5>Math.abs(this.v.rotation-this.w.rotation)&&a<1.8*this.Xf/this.w.scale,this.ob=this.vv(this.cj()),this.ob*=1+1.5*Math.abs(this.w.rotation-this.v.rotation)/180,isNaN(this.ob)||(this.ob=Math.min(this.ob,5)*this.Gp,this.Hs()))}Hs(){let a=
1E3*this.ob;this.Ei=a*(.5-this.kg(Math.max(a-1500,0),0,.5-.28,3500));this.Qt=2*this.Ei*a/(a+2*this.Ei)}cj(){this.ce=this.Xf/this.v.scale;this.Ak=this.Xf/this.w.scale;this.sk=0;this.zh=Math.sqrt(Math.pow(this.w.x-this.v.x,2)+Math.pow(this.w.y-this.v.y,2));var a=this.Ak*this.Ak-this.ce*this.ce;let b=Math.pow(this.Bb,4)*Math.pow(this.zh-this.sk,2),c=2*this.Bb*this.Bb*(this.zh-this.sk),d=(a+b)/(this.ce*c);a=(a-b)/(this.Ak*c);this.Td=Math.log(-d+Math.sqrt(d*d+1));this.S=(Math.log(-a+Math.sqrt(a*a+1))-
this.Td)/this.Bb;this.ix=(this.w.x-this.v.x)/this.zh;this.jx=(this.w.y-this.v.y)/this.zh;return this.S}vv(a){var b,c;if(isNaN(a)||!isFinite(a))return NaN;null==b&&(b=1.2/1.34);null==c&&(c=3/1.34);return.3>a?b:5.3<a?c:b+(a-.3)*(c-b)/5}};J.Mq=class extends J.Xk{constructor(a=1){super();this.Bb=1.15;this.Gp=a}Hm(a,b){return this.Mt(a,b)}Mt(a,b){a/=b/4;return 1>a?.5*a:.5*(Math.pow((a-1)/3-1,3)+2)}};J.Oc=class{constructor(a,b,c,d){this.x=a;this.y=b;this.scale=c;this.rotation=d}static gg(a){var b=Math.cos(-a.getRotationRad());
let c=Math.sin(-a.getRotationRad()),d=a.getTranslation(),g=d.x/a.getScale()*b-d.y/a.getScale()*c;b=d.x/a.getScale()*c+d.y/a.getScale()*b;return new J.Oc(g,b,a.getScale(),a.getRotationDeg())}od(){let a=la.ex(this.rotation),b=Math.cos(a),c=Math.sin(a);return t.Geometry.transform2dFromRad({x:(this.x*b-this.y*c)*this.scale,y:(this.x*c+this.y*b)*this.scale},this.scale,a)}};var Bb={};Object.defineProperty(Bb,"__esModule",{value:!0});Bb.gr=class{constructor(){}ek(a,b){this.v=a;this.w=b;this.rl=this.v.getTranslation().x;
this.sl=this.v.getTranslation().y;this.pl=this.v.getScale();this.nl=this.v.getRotationRad();this.gs=this.w.getTranslation().x-this.rl;this.hs=this.w.getTranslation().y-this.sl;this.es=this.w.getScale()-this.pl;this.ds=this.w.getRotationRad()-this.nl}$g(a){this.v=a.concat(this.v);this.w=a.concat(this.w)}update(a){a=Math.round(a)/this.$c();return t.Geometry.transform2dFromRad({x:this.rl+a*this.gs,y:this.sl+a*this.hs},this.pl+a*this.es,this.nl+a*this.ds)}$c(){return 1E3}wg(){if(null==this.w)throw"getEndPosition: Transition is not initialized yet!";
return this.w}};var z={};Object.defineProperty(z,"__esModule",{value:!0});z.xd=class{constructor(a){this.delegate=a;null==z.xd.ud&&(z.xd.ud=u.LoggerModule.getLoggerManager().createLogger("prezi_cet_modelcomponent.UniverseLimitWatchingTransformWrapper"))}getEntity(){return this.delegate.getEntity()}getId(){return this.delegate.getId()}setLocalToWorld(a){if(k.j.hasPdomComponent(this.getEntity())){if(isNaN(a.getTranslation().x)||isNaN(a.getTranslation().y)||isNaN(a.getScale())||isNaN(a.getRotationRad())){a=
this.getId();h.CetRendererModule.logMonitoringOncePerSession(z.xd.ud,a,"nan_transform","transform",Error("Tried to set transform with NaN components!"),this.getEntity().tsto(),u.Level.WARN);return}if(z.ib.jv(a)){const a=this.getId();h.CetRendererModule.logMonitoringOncePerSession(z.xd.ud,a,"possible_universe_limit_violation","transform","possible_universe_limit_violation",this.getEntity().tsto(),u.Level.WARN)}}null!=this.getLocalToWorld()&&this.getLocalToWorld().equalsWithin(a,Math.pow(2,-40))||(this.delegate.setLocalToWorld(a),
h.CetRendererModule.updateWorldProperties(this.getEntity()))}getLocalToWorld(){return this.delegate.getLocalToWorld()}getWorldToLocal(){return this.delegate.getWorldToLocal()}asMutableEntity(){return this.delegate.asMutableEntity()}toIPdom(){return this.delegate.toIPdom()}};z.ib=class{static jv(a){const b=a.getScale();return b>z.ib.Uf||b<this.Vm(a.getTranslation())}static Vm(a){return Math.max(Math.abs(a.x),Math.abs(a.y))/1E6}static Pm(a){return 10*this.Vm(a)}static Ve(a){a=a.invert();const b=a.getScale();
return b>z.ib.Uf?e.ZoomingLimit.ZoomOutLimitReached:b<this.Pm(a.getTranslation())?e.ZoomingLimit.ZoomInLimitReached:e.ZoomingLimit.WithinLimits}static rw(a){a=a.invert();const b=a.getScale();let c=1;if(b>z.ib.Uf)c=z.ib.Uf/b;else{const d=this.Pm(a.getTranslation());b<d&&(c=d/b)}return a.scaleAroundPoint(a.getTranslation(),c).invert()}};z.ib.Uf=5E3;var Cb={};Object.defineProperty(Cb,"__esModule",{value:!0});Cb.Nq=class{constructor(a,b,c,d){this.target=a;this.camera=b;this.Ha=c;this.gc=d;this.startTime=
c.now();this.lj=this.kj=this.qk=this.Uj=!1;this.kk=this.Dl()}Gd(){return this.target.getScale()>this.camera.getTransform().getScale()?e.ZoomingDirection.ZOOM_IN:e.ZoomingDirection.ZOOM_OUT}Te(){return this.Uj&&this.qk}getTarget(){return this.target}updateTarget(a){this.target=a;this.kk=this.Dl()}update(){if(!this.Te()){var a=this.Ha.now(),b=a-this.startTime;this.startTime=a;a=this.camera.getTransform();b=t.Geometry.transform2dFromRad(this.dv(b),this.ev(b),a.getRotationRad());a=z.ib.Ve(b);H.isActive("js-zoom-limits")&&
this.gc&&(a===e.ZoomingLimit.ZoomInLimitReached&&this.Gd()===e.ZoomingDirection.ZOOM_IN||a===e.ZoomingLimit.ZoomOutLimitReached&&this.Gd()===e.ZoomingDirection.ZOOM_OUT)?(this.qk=this.Uj=!0,this.kj=a===e.ZoomingLimit.ZoomInLimitReached,this.lj=a===e.ZoomingLimit.ZoomOutLimitReached):this.camera.nf(b)}}Dl(){const a=this.camera.viewportInWorld(),b=this.camera.getTransform().getScale()/this.target.getScale();return{width:a.getWidth()*b,height:a.getHeight()*b}}dv(a){const b=this.target.getTranslation(),
c=this.camera.getTransform().getTranslation();if(.5>t.Geometry.distance(b,c))return this.qk=!0,this.target.getTranslation();a=1-Math.pow(.9916890167,a);return{x:c.x+(b.x-c.x)*a,y:c.y+(b.y-c.y)*a}}ev(a){const b=this.camera.viewportInWorld();let c={height:1E3/b.getHeight(),width:1E3/b.getWidth()};var d=1E3/this.kk.height-c.height,g=1E3/this.kk.width-c.width;if(d*d+g*g<5E-6*5E-6)return this.Uj=!0,this.target.getScale();a=1-Math.pow(.9916890167,a);c={height:1E3/(c.height+d*a),width:1E3/(c.width+g*a)};
return b.getHeight()/c.height*this.camera.getTransform().getScale()}};var Db={};Object.defineProperty(Db,"__esModule",{value:!0});Db.Zq=class{constructor(a,b,c){this.target=a;this.camera=b;this.gc=c;this.Ln=!1}Te(){return this.Ln}update(){if(!this.Te()){if(H.isActive("js-zoom-limits")&&this.gc){const a=z.ib.Ve(this.target);if(a===e.ZoomingLimit.ZoomInLimitReached&&this.Gd()===e.ZoomingDirection.ZOOM_IN||a===e.ZoomingLimit.ZoomOutLimitReached&&this.Gd()===e.ZoomingDirection.ZOOM_OUT){this.kj=a===e.ZoomingLimit.ZoomInLimitReached;
this.lj=a===e.ZoomingLimit.ZoomOutLimitReached;return}}this.camera.nf(this.target);this.Ln=!0}}Gd(){return this.target.getScale()>this.camera.getTransform().getScale()?e.ZoomingDirection.ZOOM_IN:e.ZoomingDirection.ZOOM_OUT}getTarget(){return this.target}updateTarget(a){this.target=a}};var Eb={};Object.defineProperty(Eb,"__esModule",{value:!0});Eb.kq=class{constructor(a){this.camera=a;this.Hh=null}zoom(a,b){null!=this.Hh&&clearTimeout(this.Hh);const c=this.camera.getOngoingZoomTarget();b.isInstant||
null==c||this.currentDirection(this.camera.getTransform(),c)!==b.direction?this.Zw(a,b):this.wx(b,c);b.direction!==e.ZoomingDirection.ZOOM_OUT||!1!==b.unlimitedZoomOut||H.isActive("js-unique-differentiation")&&b.currentTopicId===a.getPreziW().getOverview().getId()||(this.Hh=setTimeout(()=>{this.camera.isInTransition()||this.Fx();this.Hh=null},100))}Zw(a,b){this.$l=b.zoomingCenter;let c;switch(b.direction){case e.ZoomingDirection.ZOOM_IN:c=this.Es(b.zoomingCenter,b.wheelDelta,e.ZoomingDirection.ZOOM_IN,
b.boundsWithin);break;case e.ZoomingDirection.ZOOM_OUT:!0===b.unlimitedZoomOut?c=this.li(b.zoomingCenter,b.wheelDelta,e.ZoomingDirection.ZOOM_OUT):(this.Aw(a,b.currentTopicId),c=this.li(b.zoomingCenter,b.wheelDelta,e.ZoomingDirection.ZOOM_OUT),c=this.mi(c,this.un));break;default:x.Utils.assertNever(b)}this.camera.startFreeZoom(c,b.isInstant)}wx(a,b){b=b.scaleAroundPoint(a.zoomingCenter,a.direction===e.ZoomingDirection.ZOOM_IN?a.wheelDelta:1/a.wheelDelta);this.$l=a.zoomingCenter;a.direction!==e.ZoomingDirection.ZOOM_OUT||
a.unlimitedZoomOut||(b=this.mi(b,this.un));this.camera.updateFreeZoom(b)}mi(a,b){return a.getScale()<b?a.scaleAroundPoint(this.$l,b/a.getScale()):a}Fx(){const a=this.camera.getTransform(),b=this.mi(a,this.Rw);a.getScale()<b.getScale()&&this.camera.startFreeZoom(b,!1)}Aw(a,b){a=this.camera.getInteractionLimits().calcOuterZoomLimits(b,a);this.Rw=a.softLimitTransform.getScale();this.un=a.hardLimitScale}currentDirection(a,b){return b.getScale()>a.getScale()?e.ZoomingDirection.ZOOM_IN:e.ZoomingDirection.ZOOM_OUT}li(a,
b,c){b=c===e.ZoomingDirection.ZOOM_IN?b:1/b;return this.camera.getTransform().scaleAroundPoint(a,b)}Es(a,b,c,d){a=this.li(a,b,c);return null==d?a:this.rv(a,d)}rv(a,b){const c=b.setRotation(0);var d=this.camera.getTransform().invert();d=t.Geometry.obbFromRect(this.camera.getMarginCorrectedViewport().getData()).transform(d);if(!b.union(d).equalsWithin(b,1E-5))return a;var g=a.invert();d=g.getRotationRad();b=g.rotateRadAroundPoint(b.getCenter(),-d);g=t.Geometry.obbFromRect(this.camera.getMarginCorrectedViewport().getData()).transform(b);
if(c.getHeight()>g.getHeight()&&c.getWidth()>g.getWidth()){let e=a=0;const f=c.getVertices();g=g.getVertices();g[0].x<f[0].x?a=f[0].x-g[0].x:g[1].x>f[1].x&&(a=f[1].x-g[1].x);g[0].y<f[0].y?e=f[0].y-g[0].y:g[2].y>f[2].y&&(e=f[2].y-g[2].y);return b.translate({x:a,y:e}).rotateRadAroundPoint(c.getCenter(),d).invert()}return a}};var Fb={};Object.defineProperty(Fb,"__esModule",{value:!0});Fb.ar=class{constructor(a){this.camera=a}calcOuterZoomLimits(a,b){if(H.isActive("js-unique-differentiation")&&a===b.getPreziW().getOverview().getId()){a=
(()=>{const a=e.Cet.createTopicChildrenQuery(b),c=b.getPreziW().getOverview().getId();return[c,...a.getChildrenIds(c,e.TopicChildBehavior.Content)]})();var c=e.Cet.createBoundsCalculator(b),d=t.Geometry.obbFromRect(this.camera.getMarginCorrectedStageArea().getData()).transform(this.camera.getTargetTransform().invert());d=t.Geometry.transform2dFromRad({x:0,y:0},1,d.getRotationRadians());c=c.getUnionWorldBoundsAlignedToReference(d,a).getObb();a=c.setRotation(0).getBounds();c=t.Geometry.transform2dFromRad({x:-c.getCenterX(),
y:-c.getCenterY()},1,0).concat(t.Geometry.transform2dFromRad({x:0,y:0},1,c.getRotationRadians())).concat(t.Geometry.transform2dFromRad({x:c.getCenterX(),y:c.getCenterY()},1,0));a=e.Cet.getTargetTransformForBounds(a,c,this.camera.getMarginCorrectedViewport());return{softLimitTransform:a,hardLimitScale:.25*a.getScale()}}a=e.Cet.getTargetTransform(b,a,this.camera.getMarginCorrectedViewport());return{softLimitTransform:a,hardLimitScale:.8*a.getScale()}}};var fa={};Object.defineProperty(fa,"__esModule",
{value:!0});fa.Jc=class{constructor(a,b,c,d){this.Ci=e.CameraNavigationType.NONE;this.fd=this.ko=this.Jg=this.version=0;this.ho=this.qj=this.viewport=a;this.id=fa.Jc.gd++;this.pk=null!=b?b:n.Bacon.newBus();this.Ih=null!=d?d:n.Bacon.newBus();this.Af=n.Bacon.newBus();this.Qg=n.Bacon.newBus();this.xh=n.Bacon.newBus();this.Ud=t.Geometry.transform2dIdentity();this.version++;this.qd=t.Geometry.transform2dIdentity();this.oi=!0;this.Ql=n.Bacon.newBus();this.vp=n.Bacon.newBus();this.Ds=new Eb.kq(this);this.cv=
new Fb.ar(this)}Gw(a){this.Ip=a}setReferenceTransformEntity(a){if(this.kf!==a){const b=this.Ld().invert();let c=this.Ip.getLocalToWorldInRenderedScene(a);null==c&&(c=t.Geometry.transform2dIdentity());this.Ud=c.concat(this.getViewportTransform());null!=this.transition&&this.transition.$g(c.concat(b));this.kf=a;this.Fg=c}}Ld(a){if(null==this.kf)return t.Geometry.transform2dIdentity();a=(null!=a?a:this.Ip).getLocalToWorldInRenderedScene(this.kf);return null==a?(this.Ud=this.Fg.invert().concat(this.Ud),
this.Fg=t.Geometry.transform2dIdentity(),this.kf=null,this.Fg):this.Fg=a}getCameraTransformStream(){return this.Ql.toProperty(this.Tl())}getStageAreaStream(){return this.vp.toProperty(this.ph)}Tl(a,b){let c=null;null!=this.Ga&&(c=e.CameraTransitionType.Pan);null!=this.Ma&&(c=e.CameraTransitionType.Zoom);null!=this.transition&&(c=e.CameraTransitionType.Fly);const d=t.Geometry.obbFromRect(this.viewport.getData()).transform(this.getTransform(b).invert());return{isCameraOnPath:this.oi,viewportTransform:null!=
a?a:this.getViewportTransform(b),worldOBB:d,currentTransitionType:c}}Ns(){this.cancelPanning();this.ye();this.cancelZooming()}getId(){return this.id}getVersion(){return this.version}setCameraOnPath(a){this.oi=a}isCameraOnPath(){return this.oi}getViewport(){return this.viewport}getMarginCorrectedViewport(){return this.qj}getStageArea(){return this.ph}getWorldArea(){return t.Geometry.obbFromRect(this.ph.getData()).transform(this.getTransform().invert())}bk(a){this.ph=a;this.vp.push(this.ph)}lh(a){this.viewport=
a;this.version++}getTransformStream(){return this.pk.skipDuplicates()}getTargetTransform(){return null!=this.transition?this.Ld().invert().concat(this.transition.wg()).concat(this.qd):this.getTransform()}getZoomingStream(){return this.Ih.skipDuplicates()}getZoomingLimitStream(){return this.Af.skipDuplicates()}getPanningStream(){return this.Qg.skipDuplicates()}getTransitionStream(){return this.xh.skipDuplicates()}Iw(a,b){this.ho=a;let c=Math.min(a.getWidth()/this.getViewport().getWidth(),a.getHeight()/
this.getViewport().getHeight()),d=this.getViewport().getWidth()*c,g=this.getViewport().getHeight()*c,e,f;Math.ceil(d)<a.getWidth()?(e=Math.ceil(a.getTopLeft().x+(a.getWidth()-d)/2),f=a.getTopLeft().y):(f=Math.ceil(a.getTopLeft().y+(a.getHeight()-g)/2),e=a.getTopLeft().x);this.qj=t.Geometry.rectangleFromData({x:e,y:f,width:d,height:g});a=t.Geometry.transform2dFromRad({x:e-this.getViewport().getTopLeft().x*c,y:f-this.getViewport().getTopLeft().y*c},c,0);b&&this.setViewportTransform(this.getTransform().concat(a.invert()),
null,!1);this.qd=a;this.version++}getMarginCorrectedStageArea(){return this.ho}getTransform(a){return this.getViewportTransform(a).concat(this.qd)}getViewportTransform(a){return this.Ld(a).invert().concat(this.Ud)}getViewportMarginCorrectionTransform(){return this.qd}setViewportTransform(a,b,c=!0){this.ei(a,b);c&&this.ye();this.pk.push(this.getTransform(b))}nf(a){this.ei(a.concat(this.qd.invert()));this.ye();null!=this.yj&&this.yj()}ei(a,b){this.ko=(new Date).getTime();this.Ud=this.Ld(b).concat(a);
this.version++;let c=this.Tl(a,b);x.Utils.delay(()=>{this.Ql.push(c)},0);H.isActive("js-zoom-limits")&&this.gc&&(a=a.concat(this.qd),this.Af.push(z.ib.Ve(a)))}yw(a){this.yj=a}cancelZooming(){null!=this.Ma&&(this.Ma=null,this.Ih.push(e.ZoomingEvent.NoZoom))}startFreeZoom(a,b){this.Ma=b?new Db.Zq(a,this,this.gc):new Cb.Nq(a,this,new ea.Rc,this.gc);this.yj()}updateFreeZoom(a){null!=this.Ma&&this.Ma.updateTarget(a)}startBoundedZoom(a,b){return this.Ds.zoom(a,b)}getInteractionLimits(){return this.cv}getOngoingZoomTarget(){return null==
this.Ma||this.Ma.Te()?null:this.Ma.getTarget()}ox(){null!=this.Ga&&this.Ga.update()===G.sa.Eb&&(this.Qg.push(e.PanningEvent.PanningFinished),this.Ga=null)}xx(){null!=this.Ma&&(this.Ma.update(),this.Ma.kj?(this.Af.push(e.ZoomingLimit.ZoomInLimitReached),this.oj(e.ZoomingLimit.ZoomInLimitReached)):this.Ma.lj&&(this.Af.push(e.ZoomingLimit.ZoomOutLimitReached),this.oj(e.ZoomingLimit.ZoomOutLimitReached)));null==this.Ma||this.Ma.Te()?this.Ih.push(e.ZoomingEvent.NoZoom):this.Ih.push(this.Ma.Gd()===e.ZoomingDirection.ZOOM_IN?
e.ZoomingEvent.ZoomIn:e.ZoomingEvent.ZoomOut)}oj(a){a===e.ZoomingLimit.ZoomInLimitReached?u.avro.Avro.createDefaultLogger().logTriggeredUniversalLimit({universal_limit_event:"ZOOM_IN_LIMIT_REACHED"}):a===e.ZoomingLimit.ZoomOutLimitReached&&u.avro.Avro.createDefaultLogger().logTriggeredUniversalLimit({universal_limit_event:"ZOOM_OUT_LIMIT_REACHED"})}setPanningTargetPosition(a){null!=this.Ga&&(this.setCameraOnPath(!1),this.Qg.push(e.PanningEvent.PanningStarted),this.Ga.mp(a))}stopPanning(){null!=this.Ga&&
this.Ga.stop()}startPanning(a,b){null!=this.Ga&&this.Ga.dispose();this.Ga=b?new Ab.$q(this):new O.Oa(this,new ea.Rc);this.Ga.init(a)}cancelPanning(){null!=this.Ga&&(this.Ga.dispose(),this.Qg.push(e.PanningEvent.PanningFinished),this.Ga=null)}screenPointToWorld(a){let b=t.Geometry.createFromTransform(this.getTransform());b.invert();return b.transformPoint(a)}worldPointToScreen(a){return t.Geometry.createFromTransform(this.getTransform()).transformPoint(a)}viewportInWorld(){return this.screenAreaToWorld(this.viewport)}screenAreaToWorld(a){let b=
t.Geometry.createFromTransform(this.getTransform());b.invert();return b.transformToBoundingBox(a)}Je(a,b,c=1,d=e.CameraNavigationType.FLY){H.isActive("js-for-test-fast-fly")&&(c/=100);c=this.isCameraOnPath()?new J.Xk(c):new J.Mq(c);this.Jp(a,b,c);this.Ci=d}slideTo(a){let b=new Bb.gr;this.Jp(a,()=>{},b);this.mg()}invertCurrentTransition(a){this.accelerateCurrentTransition(-a)}Ju(){return this.isInAcceleratedTransition()?this.transition.yf:this.transition}Oi(){return this.isInAcceleratedTransition()?
this.transition.Oi():1}accelerateCurrentTransition(a){let b=(new Date).getTime()-this.fd,c=a*this.Oi();0>a&&(this.Ac=null);this.transition=new bb.Ck(this.Ju(),Math.round(b),c);this.xh.push(e.TransitionEvent.TransitionStarted)}Jp(a,b,c){this.Ns();let d=this.qj.getData().width;const g=this.Ud,f=this.Ld().concat(a);this.pk.push(a);c.ek(g,f,d);this.Ac=null!=b?[b]:[];this.fd=(new Date).getTime();this.transition=c;this.xh.push(e.TransitionEvent.TransitionStarted)}mg(){H.isActive("js-zoom-limits")&&this.gc&&
z.ib.Ve(this.getTargetTransform())&&this.whenTransitionFinished((a)=>{a&&(a=z.ib.rw(this.getTargetTransform()),this.nf(a))})}whenTransitionFinished(a){null==this.transition&&a(!0);null==this.Ac&&(this.Ac=[]);this.Ac.push(a)}sx(){this.Qp((new Date).getTime())}du(){null!=this.transition&&this.Qp(this.fd+this.transition.$c()+1)}Qp(a){this.Jg=a;if(null!=this.transition){var b=this.Jg-this.fd;a=this.transition.update(b);var c=this.Ld();if(b>this.transition.$c()&&(this.ym(!0),this.ye(),H.isActive("js-zoom-limits")&&
this.gc&&(b=c.invert().concat(a).concat(this.qd),b=z.ib.Ve(b),b!==e.ZoomingLimit.WithinLimits))){this.Af.push(b);this.oj(b);return}this.ei(c.invert().concat(a));null!=this.Iv&&this.Iv()}}ym(a){if(null!=this.Ac){let b=this.Ac.slice();this.Ac=null;for(let c of b)c(a)}}ye(){null!=this.transition&&(this.ym(!1),this.transition=null,this.xh.push(e.TransitionEvent.TransitionFinished),this.Ac=null,this.fd=0,this.Ci=e.CameraNavigationType.NONE)}sj(){return!this.isCameraSettledDown()||null!=this.Ga&&this.Ga.Sn()}isCameraSettledDown(){return this.Jg-
this.ko>=fa.Jc.Rk&&this.Jg-this.fd>=fa.Jc.Rk}isInTransition(){return null!=this.transition}isInAcceleratedTransition(){return this.transition instanceof bb.Ck}getRemainingTransitionTime(){if(null!=this.transition){let a=(new Date).getTime();return Math.max(this.fd+this.transition.$c()-a,0)}return 0}xw(a){this.fu=a}getFocusedEntity(){return this.fu}getCurrentCameraNavigation(){return this.Ci}getSnapshot(){const a=this.getTransform(),b=this.getMarginCorrectedViewport(),c=this.getStageArea();return{getTransform:()=>
a,getMarginCorrectedViewport:()=>b,getStageArea:()=>c}}setIsZoomLimitEnforced(a){this.gc=a}};fa.Jc.Rk=200;fa.Jc.gd=0;var cb={};Object.defineProperty(cb,"__esModule",{value:!0});cb.bl=class{constructor(a){this.Ug=!1;this.Li=a;cb.bl.Xu()}static Xu(){window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;null==window.requestAnimationFrame&&(window.requestAnimationFrame=function(){return 1})}request(){this.Ug||
(window.requestAnimationFrame(()=>this.hw()),this.Ug=!0)}hw(){this.Ug=!1;null!=this.Li&&this.Li()}reset(){this.Li=null}isAnimFramePending(){return this.Ug}};var F={};Object.defineProperty(F,"__esModule",{value:!0});F.Xq=class{constructor(a,b){this.de=a;this.hd=b}};F.la=class{constructor(a,b,c,d,g,e,f){this.ag=f;this.wj=[];this.zj=[];this.jg=new Map;this.nj=null;this.xe=!1;this.logger=u.LoggerModule.getLoggerManager().createLogger("prezi_cet.CanvasEngine");this.kb=a;this.Ii=!0;this.Gg=F.la.Nf;null!=
e&&(F.la.Nf=e.getZeroTimestamp(),this.L=e);this.ga=b;a=(a)=>{this.ga.resizeStage(a);null!=this.L&&this.L.setResolution(a.width,a.height)};a(this.kb.getSize());this.kb.getResizeStream().onValue(a);this.requestAnimationFrame=new cb.bl(()=>this.update());this.km=n.Bacon.newBus();this.Ha=new ea.Rc;this.cb={};this.Vd={};this.Uo=-1;this.wl=g;this.xl=g.toProperty("");this.ms();this.ns(d);this.ga.markViewChanged();window.addEventListener("scroll",()=>{this.nj=Date.now()},!0)}static rs(a){return a.asArray().every((a)=>
{if(!a.hasComponent(h.CetRendererModule.getDrawComponentKey()))return!0;const b=e.Cet.draw(a);return b.hasError()||b.isFullyRenderable(a)})}start(){this.Zg()}ms(){this.xl.filter((a)=>"allAssetsLoaded"===a).onValue(()=>{this.zv()})}ns(a){a.filter((a)=>a).onValue(()=>{this.Zg()})}dispose(){this.kb.setCanvas(null);this.requestAnimationFrame.reset();null!=this.getMainStage()&&this.getMainStage().dispose()}Wj(){this.ti();this.Zg()}hh(){var a=this.zu();a!==F.la.Nc&&(a===F.la.Jk?this.Wj():(a-=this.Ha.now(),
16<a?this.Zi=this.Ha.op(()=>this.Wj(),Math.floor(a)):this.Wj()))}ti(){this.Ha.bx(this.Zi);this.Zi=null}Sj(a){for(let b of a)try{b()}catch(c){u.LoggerModule.logException(this.logger,"CanvasEngine","runCallbacks",c)}a.splice(0,a.length)}mw(){var a=this.Ha.now(),b=[];for(let c in this.cb)if(this.cb.hasOwnProperty(c)){const d=this.cb[c];d.hd<=a&&b.push(d)}for(const a of b)a.hd=F.la.Nc;for(const c of b){a=null;try{const b=(new Date).getTime();a=c.de.update();const g=(new Date).getTime();null!=this.L&&
this.L.updateIdleWorkerMeasurements(c.de.getId(),g-b)}catch(d){u.LoggerModule.logException(this.logger,"worker","runIdleWorkers",d,{object_id:c.de.getId()});try{c.de.reset(),a=F.la.vq}catch(g){u.LoggerModule.logException(this.logger,"worker","exception_during_cancel",g,{object_id:c.de.getId()}),a=F.la.Nc}}a!==F.la.Nc&&(c.hd=this.Ha.now()+a)}for(const a of b)a.hd===F.la.Nc&&(b=a.de.getId(),delete this.cb[b])}nw(a){var b=a;a=this.Ha.now()+b;let c=[];for(let d in this.Vd)if(this.Vd.hasOwnProperty(d)){if(1>=
b)break;b=this.Vd[d];try{b.update()}catch(g){u.LoggerModule.logException(this.logger,"worker","runRenderWorkers",g,{object_id:b.getId()}),c.push(b.getId())}b=a-this.Ha.now()}for(let a of c)delete this.Vd[a]}zu(){if(0<this.wj.length)return F.la.Jk;if(0===Object.keys(this.cb).length)return F.la.Nc;let a=Number.POSITIVE_INFINITY;for(let b in this.cb)if(this.cb.hasOwnProperty(b)){let c=this.cb[b];c.hd<a&&(a=c.hd)}return a}addRenderWorker(a){this.Vd[a.getId()]=a}addIdleWorker(a,b){let c=this.Ha.now();
b===F.la.Nc?(a=a.getId(),delete this.cb[a]):(b=c+b,null!=this.cb[a.getId()]?this.cb[a.getId()].hd=b:this.cb[a.getId()]=new F.Xq(a,b));this.ti();this.hh()}removeRenderWorker(a){a=a.getId();delete this.Vd[a]}removeIdleWorker(a){delete this.cb[a.getId()];this.ti();this.hh()}getMainStage(){return this.ga}Cn(){return!this.ga.pj&&!this.hasPendingTweens()}hv(){return this.Cn()&&this.ro()&&this.qo()}ro(){var a,b;return(null!==(b=null===(a=this.ga.getModelScene())||void 0===a?void 0:a.getSceneHierarchy().getScenes())&&
void 0!==b?b:[]).every((a)=>!a.isInTransaction())}qo(){return null==this.nj||this.nj<Date.now()-300}update(){let a,b=this.ga.pj;if(b){this.Uo=this.Ha.now();if(null!=this.L){this.Ii&&(this.L.setFirstMainDraw(ea.Rc.Gu()),this.Ii=!1);this.L.updateCameraTransform(this.ga.getCamera().getTransform());this.L.executeWithMeasurementMergeShortFrames(()=>{a=this.ga.drawFrame()},"mainDraw");var c=this.L.getCurrentTimestamp();this.Gg!==F.la.Nf&&this.L.updateProbeWithMeasurement("userFrame",this.Gg,c);var d=this.ga.getCamera().sj()||
this.ga.tj();d||this.Gg===F.la.Nf||(this.L.addEndOfTransitionLabel(),this.L.updateProbeWithMeasurement("userFrame",c,c));this.Gg=d?c:F.la.Nf}else this.Ii=!1,a=this.ga.drawFrame();this.Sj(this.zj);c=this.Ha.now()-this.Uo;c<F.la.Qk&&this.nw(F.la.Qk-c)}else this.Sj(this.zj),this.Sj(this.wj),this.ro()&&this.qo()&&(this.mw(),null!=this.L&&this.L.incrementIdleFrames());if(!this.As)this.Hl(),this.As=!0;else if(!this.xe)for(c=(a)=>{let b=this.jg.get(a),c=!1;null==b?(b=a.startNewTracking("CanvasEngine-"+a.getName()+
"-allAssetsLoaded",[h.CetRendererModule.getDrawComponentKey(),h.CetRendererModule.getIsLoadedComponentKey()],()=>!0),this.jg.set(a,b),c=!0):a.forChangedEntities(()=>{c=!0},b);return c},d=this.ga.getRenderedScene();null!=d;){if(c(d.getEntityList())){this.Hl();if(this.xe){for(let [a,b]of this.jg.entries())a.stopTracking(b);this.jg.clear()}break}d=d.getParentScene()}c=this.ga.getNextFrameTime();0<c&&this.Ha.op(()=>{this.ga.markViewChanged()},Math.floor(c));null!=this.L&&this.L.frameEnded();null==this.Zi&&
this.hh();b&&this.ag.push(this.xe&&a);this.km.push(null)}Hl(){F.la.rs(this.getMainStage().Jd())&&(this.xe=!0,this.wl.push("allAssetsLoaded"))}Bl(){null!=this.L&&(this.L.setAllAssetsLoaded(!1),this.L.setPreprocessingDone(!1));this.xe=!1}Zg(){this.requestAnimationFrame.request()}isAnimFramePending(){return this.requestAnimationFrame.isAnimFramePending()}getEndOfFrameStream(){return this.km}Og(){this.Zg()}zv(){null!=this.L&&this.L.setAllAssetsLoaded(!0)}hasPendingTweens(){return 0<=this.ga.getNextFrameTime()}createIdleStream(a){return this.Yl(a,
!0)}createUpdateStream(a){return this.Yl(a,!1)}Yl(a,b){let c=n.Bacon.newBus(),d=[];const g=()=>{const a=d;d=[];for(let b of a)try{c.push(b)}catch(Ja){u.LoggerModule.logException(this.logger,"CanvasEngine","openValve",Ja)}};a.onValue((a)=>{0===d.length&&(b?(this.wj.push(()=>g()),this.hh()):this.zj.push(()=>g()));d.push(a)});return c}};F.la.Jk=0;F.la.Nc=-1;F.la.Qk=33;F.la.vq=100;var Qa={};Object.defineProperty(Qa,"__esModule",{value:!0});Qa.Lh=class{constructor(a,b,c){this.logger=u.LoggerModule.getLoggerManager().createLogger("DomLayerManager");
this.Ji={};this.rc=a;this.camera=b;this.video=c}removeElement(a){a=window.document.getElementById(a);null!=a&&a.parentNode.removeChild(a)}getElement(a){return window.document.getElementById(a)}createElement(a){var b=window.document.getElementById(a);null==b&&(b=window.document.createElement("div"),b.id=a,this.rc.appendChild(b),b.style.display="none");return b}createCanvasElement(a){var b=window.document.getElementById(a);null==b&&(b=window.document.createElement("canvas"),b.id=a,this.rc.appendChild(b));
return b}createIconElement(a,b,c){let d=window.document.getElementById(a);null==d&&(d=window.document.createElement("i"),d.id=a,a=$(d),a.addClass(b),a.css("font-size",c+"px"),this.rc.appendChild(d));return d}positionElementToTopLeft(a,b,c){a=window.document.getElementById(a);null!=a&&(a.style.position="absolute",a.style.left=b+"px",a.style.right="",a.style.top=c+"px")}positionElementToTopRight(a,b,c){a=window.document.getElementById(a);null!=a&&(a.style.position="absolute",a.style.left="",a.style.right=
b+"px",a.style.top=c+"px")}positionElementToCenter(a,b,c){a=window.document.getElementById(a);null!=a&&(a.style.position="absolute",a.style.right="",a.style.left=(this.getWidth()-b)/2+"px",a.style.top=(this.getHeight()-c)/2+"px")}getCameraScale(){return this.camera.getTransform().getScale()}getOffsetLeft(){return this.rc.offsetLeft}getOffsetTop(){return this.rc.offsetTop}getWidth(){return this.rc.clientWidth}getHeight(){return this.rc.clientHeight}transform(a,b,c=null){this.ii(a,b,c,(a)=>"matrix("+
a.a+","+a.b+","+a.c+","+a.d+","+a.x+","+a.y+")")}Ps(a){const b=this.getWidth()/2,c=this.getHeight()/2;return{x:b+a.x,y:c+a.y}}transformScreen(a,b,c){const d=window.document.getElementById(a);if(null==d)throw Error(`No element found in DOM with id: ${a}`);d.style.position="absolute";d.style.top="0px";d.style.left="0px";d.style.transformOrigin="0% 0%";a=t.Geometry.createFromTransform(t.Geometry.transform2dFromRad(this.Ps(b),1,0));c=t.Geometry.createFromTransform(t.Geometry.transform2dFromRad({x:0,y:0},
1,c));c.multiplyFromLeft(a);this.ys(d,c.getData())}transformWithoutScale(a,b,c=null){this.ii(a,b,c,(a)=>"matrix(1,"+a.b+","+a.c+",1,"+a.x+","+a.y+")")}transformWithoutScaleAndRotation(a,b,c=null){this.ii(a,b,c,(a)=>"matrix(1,0,0,1,"+a.x+","+a.y+")")}ys(a,b){b=`matrix3d(
			${b.a}, ${b.b}, 0, 0,
			${b.c}, ${b.d}, 0, 0,
			0, 0, 1, 0,
			${b.x}, ${b.y}, 0, 1
		)`;a.style.webkitTransform=b;a.style.transform=b}ii(a,b,c,d){a=window.document.getElementById(a);if(null!=a){var g=t.Geometry.createFromTransform(this.camera.getTransform());b.concat(g);null!=c&&b.concat(c);b=b.getData();d=d(b);a.style.webkitTransform=d;a.style.transform=d}}setElementAlpha(a,b,c=!1){let d=window.document.getElementById(a);null==d?this.logger.warn({action:"missing_element_with_id ",object:"dom_layer",trigger:"machine",payload:{$x:a}}):null!=d&&null!=d.style&&(d.style.opacity=String(b),
0>=b&&!c?(d.style.left="-9999px",d.style.position="absolute"):(d.style.removeProperty("left"),d.style.removeProperty("position")))}createIFrame(a,b,c,d,g){null==g&&(g=this.rc);let e=window.document.getElementById(a);null==e&&(e=window.document.createElement("iframe"),e.id=a,e.width=c+"px",e.height=d+"px",e.frameBorder="0",e.src=b,g.appendChild(e));return e}insertUIElement(a,b){$(b).css("pointer-events","auto");$(b).css("z-index","2901");$(a).append(b)}createUIContainer(a){a=this.createElement(a);
a.style.display="none";a.style.zIndex="2900";a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.bottom="0px";return a}createVideoPlayer(a,b,c,d,g,e){let f=this.nt(a);b=this.mt(b,d,g,e);f.appendChild(b);c=this.createVideo(c);b.appendChild(c);c=$(b);this.video.initializeFlowplayer(c);$(".fp-ui").hide();$(".fp-engine").css("z-index",1901);c=this.video.getFlowplayerInstance(b);return this.Ji[a]=c}nt(a){a=this.createElement(a);a.style.left="-9999px";a.style.position="absolute";a.style.opacity=
"0";a.style.display="block";a.style.zIndex="1900";a.style.pointerEvents="auto";return a}mt(a,b,c,d){let g=window.document.createElement("div");g.id="flowplayer_"+a;g.style.width=b+"px";g.style.height=c+"px";g.style.background="#000";a=$(g);a.css("z-index",1902);null!=d&&(a.addClass("is-splash"),this.tl(a,d));return g}updateVideoSplashImage(a,b){this.tl($("#flowplayer_"+a),b)}tl(a,b){a.css("background","#000 url("+b+") no-repeat center");a.css("background-size","contain")}createVideo(a){let b=window.document.createElement("source");
b.type=this.getVideoType(a);b.src=a;a=window.document.createElement("video");a.appendChild(b);"video/flash"!==b.type&&(a.crossOrigin="anonymous");return a}getVideoType(a){a=a.split(".");let b=a[a.length-1].split("?")[0].toLowerCase();return Qa.Lh.Rq.some((a)=>a===b)?"video/mp4":"video/flash"}getVideoElement(a){return $("#"+a+" .flowplayer video")[0]}removeVideoPlayer(a){var b=this.Ji[a];null!=b&&(delete this.Ji[a],b.unload());b=this.getVideoElement(a);null!=b&&(b.pause(0),b.src="",b.load(),$(b).remove());
this.removeElement(a)}sendPostMessageTo(a,b){let c=window.document.getElementById(b);null!=c.contentWindow?c.contentWindow.postMessage(a,"*"):this.logger.error({action:"send_message_to_not_iframe_element ",object:b,trigger:"machine"})}setElementClickable(a,b){window.document.getElementById(a).style.pointerEvents=b?"auto":"none"}};Qa.Lh.Rq=["mp4","m4v"];var R={};Object.defineProperty(R,"__esModule",{value:!0});R.Wa=class{constructor(){this.Wf=!1;this.version=0}getName(){let a=k.j.getComponentKey(this);
return null==a?"<< unnamed >>":a.getName()}getVersion(){return this.version}setVersion(a){this.version=a;null!=this.O&&this.O.componentChanged(this,this.isTracked)}incrementVersion(){this.setVersion(f.CetModel.getNextComponentVersion())}ignoreOnCommit(){return this.Wf}dispose(){}setOnEntity(a,b){this.O=a;this.isTracked=b}createChildComponent(){throw Error("not implemented");}};var S={};Object.defineProperty(S,"__esModule",{value:!0});S.Xa=class extends R.Wa{constructor(a,b,c){super();this.yg=a;this.Sg=
b;this.fg=null!=c?c:[]}static Pv(a){return new S.Xa("PersistentGroupMember",a.getId(),null)}static Nv(a){return new S.Xa("PersistentGroup",null,a)}static Ov(a){return new S.Xa("PersistentGroupClickableMember",a.getId(),null)}createChildComponent(){let a=new S.Xa(this.yg,this.Sg,this.fg.slice());a.version=this.version;return a}getGroupType(){return this.yg}getParentId(){return this.Sg}getChildIds(){let a=[];for(let b of this.fg)a.push(b);return a}withGroupType(a){return new S.Xa(a,this.Sg,this.fg)}withParentId(a){return new S.Xa(this.yg,
a,this.fg)}withChildIds(a){return new S.Xa(this.yg,this.Sg,a)}};var ua={};Object.defineProperty(ua,"__esModule",{value:!0});ua.te=class extends R.Wa{constructor(){super();this.alpha=1;this.enabled=!0}createChildComponent(){let a=new ua.te;a.alpha=this.alpha;a.enabled=this.enabled;a.version=this.version;return a}getAlpha(){return this.alpha}isVisible(){return this.enabled&&0<this.alpha}isEnabled(){return this.enabled}setEnabled(a){this.enabled!==a&&(this.enabled=a,this.incrementVersion());return this}setAlpha(a){this.alpha!==
a&&(this.alpha=a,this.incrementVersion());return this}};var l={};Object.defineProperty(l,"__esModule",{value:!0});l.f=class{static setFocusBehavior(a,b){a.setComponent(l.f.ie,b);return a}static setGroupingComp(a,b){a.setUntypedComponent(l.f.GROUPING,b);return a}static setGrouping(a,b,c,d){return l.f.setGroupingComp(a,new S.Xa(b,c,d))}static setZOrderComp(a,b){a.setUntypedComponent(h.CetRendererModule.getZOrderComponentKey(),b);return a}static setFadingComp(a,b){a.setUntypedComponent(h.CetRendererModule.getFadingComponentKey(),
b);return a}static fading(a,b=!1){a=a.getUntypedComponent(h.CetRendererModule.getFadingComponentKey(),b);return null!=a?a:null}static grouping(a,b=!1){a=a.getUntypedComponent(l.f.GROUPING,b);return null!=a?a:null}static zOrder(a){return h.CetRendererModule.zOrder(a)}static transform(a){return{getId:()=>a.getId(),getEntity:()=>a,getLocalToWorld:()=>h.CetRendererModule.getLocalToWorld(a),getWorldToLocal:()=>h.CetRendererModule.getLocalToWorld(a).invert(),toIPdom:()=>null}}static Dx(a){return l.f.world(a,
!1).getWorldBounds()}static ky(a){return l.f.world(a).getWorldBoundingShape()}static Up(a){return l.f.world(a).getWorldAxisAlignedBounds()}static setVisibility(a,b,c=1){let d=l.f.updateVisibility(a);d.setEnabled(b);d.setAlpha(c);return a}static setWorldComp(a,b){a.setUntypedComponent(h.CetRendererModule.getWorldGeometryComponentKey(),b);return a}static world(a,b=!1){a=a.getUntypedComponent(h.CetRendererModule.getWorldGeometryComponentKey(),b);return null!=a?a:null}static visibility(a,b=!1){a=a.getUntypedComponent(h.CetRendererModule.getVisibilityComponentKey(),
b);return null!=a?a:null}static updateVisibility(a){let b=a.getMutableComponent(h.CetRendererModule.getVisibilityComponentKey());null==b&&(b=new ua.te,a.setComponent(h.CetRendererModule.getVisibilityComponentKey(),b));return b}static commentVisibility(a){a=a.getUntypedComponent(h.CetRendererModule.getCommentVisibilityComponentKey());return null!=a?a:null}static updateCommentVisibility(a){let b=a.getMutableComponent(h.CetRendererModule.getCommentVisibilityComponentKey());null==b&&(b=new ua.te,a.setComponent(h.CetRendererModule.getCommentVisibilityComponentKey(),
b));return b}static getLocalBoundsComponent(a,b=!1){return h.CetRendererModule.getLocalBoundsComponent(a,b)}static getMutableLocalBoundsComponent(a){return h.CetRendererModule.getMutableLocalBoundsComponent(a)}static setLocalBounds(a,b,c){h.CetRendererModule.setLocalBounds(a,b,c);return a}};l.f.Bk=f.CetModel.createValueComponentKey("clip_aspect_ratio",!1,!1);l.f.Kh=f.CetModel.createValueComponentKey("decorator",!1,!1);l.f.ie=f.CetModel.createComponentKey("focus",!0,!1);l.f.GROUPING=f.CetModel.createComponentKey("grouping",
!1,!1);l.f.Qq=f.CetModel.createValueComponentKey("hittest-disabled",!1,!1,!1);l.f.INIT=f.CetModel.createComponentKey("init",!1,!1);l.f.MODEL=f.CetModel.MODEL();l.f.PENDING_INSERT=f.CetModel.PENDING_INSERT();l.f.Px=f.CetModel.createValueComponentKey("placeholderText",!1,!1);l.f.oe=f.CetModel.createComponentKey("session",!1,!1);l.f.ya=f.CetModel.createComponentKey("shapedtext",!1,!0);l.f.Ur=f.CetModel.createValueComponentKey("temporary-hittest-disabled",!1,!1,!1);l.f.hl=f.CetModel.createValueComponentKey("text_caret_offset",
!1,!0);l.f.Pf=f.CetModel.createValueComponentKey("text-range",!1,!0);l.f.Vh=f.CetModel.createValueComponentKey("text_selection_focused",!1,!0);l.f.VIDEO=f.CetModel.createComponentKey("video",!0,!1);l.f.Yh=f.CetModel.createComponentKey("vimeo-info",!0,!1);var Gb={};Object.defineProperty(Gb,"__esModule",{value:!0});Gb.Jq=class{constructor(a){this.nm=n.Bacon.newBus();this.camera=a}fc(){null!=this.dc&&null==this.i.getEntityById(this.dc.getId())&&(this.dc=null);return this.dc}uk(){this.fc()}setScene(a){this.i=
a}jh(a){null!=a&&this.dc!==a&&(a=a.getComponent(l.f.ie),null!=a&&a.willReceiveFocus())}ih(a){if(this.dc!==a){if(null!=this.dc){var b=this.dc.getComponent(l.f.ie);if(null!=b)b.onLostFocus()}if(null!=a&&(b=a.getComponent(l.f.ie),null!=b))b.onFocus();this.dc=a;this.camera.xw(null==a?null:a.getId());this.nm.push(this.dc)}}};var va={};Object.defineProperty(va,"__esModule",{value:!0});va.he=class{constructor(a,b){this.id=a;this.xp=this.duration=0;this.ql=!1;this.bm=!0;this.hc=0;this.Ie=!1;this.delayBeforeRecurring=
0;this.Rp=!1;this.duration=b;this.ease=(new W.Hb).createLinear()}getId(){return this.id}getDuration(){return this.duration}getStartDelay(){return this.xp}setStartDelay(a){this.xp=a}getStartUpdate(){return this.Xw}setStartUpdate(a){this.Xw=a}getEndUpdate(){return this.Tt}setEndUpdate(a){this.Tt=a}getEase(){return this.ease}setEase(a){this.ease=a}shouldFillBeforeStart(){return this.ql}setFillBeforeStart(a){this.ql=a}setUseUserStartTime(a){this.Rp=a}shouldUseUserStartTime(){return this.Rp}setDisableHittest(a){this.bm=
a}shouldDisableHittest(){return this.bm&&0!==this.duration}setRecurring(a,b,c=Infinity){this.hc=c;this.Ie=a;this.delayBeforeRecurring=b}isRecurring(){return 0<this.hc}getNumberOfRecurrings(){return this.hc}flipBeforeRecurring(){return this.Ie}getDelayBeforeRecurring(){return this.delayBeforeRecurring}getPropertyNames(){throw Error("Not implemented");}getStartValues(){throw Error("Not implemented");}getEndValues(){throw Error("Not implemented");}getOnCurrentValues(){throw Error("Not implemented");
}getTweenedComponents(){throw Error("Not implemented");}cleanupTweenedComponents(a){if(null!=a)for(let b of this.getTweenedComponents())a.discardOwnComponent(b)}getTweenedComponentsVersion(a){let b=0;this.getTweenedComponents().map((c)=>{b+=a.getUntypedComponent(c).getVersion()});return b}};var Hb={};Object.defineProperty(Hb,"__esModule",{value:!0});Hb.aq=class extends va.he{constructor(a,b,c,d,g){super(a,b);this.Uw=c;this.Rt=d;this.pa=g}getPropertyNames(){return["alpha"]}getStartValues(){return[this.Uw]}getEndValues(){return[this.Rt]}getOnCurrentValues(a,
b){return(c)=>{let d=a.getEntityById(b);null!=d&&(null!=this.pa?d.set(this.pa,{isEnabled:!0,alpha:c("alpha")}):k.j.updateVisibility(d).setAlpha(c("alpha")))}}getTweenedComponents(){return null!=this.pa?[this.pa]:[h.CetRendererModule.getVisibilityComponentKey()]}};var Ib={};Object.defineProperty(Ib,"__esModule",{value:!0});Ib.Vr=class extends va.he{constructor(a,b,c,d){super(a,b);this.Yw=c;this.Ut=d;this.ease=(new W.Hb).createLinear()}getPropertyNames(){return["wrapWidth"]}getStartValues(){return[this.Yw]}getEndValues(){return[this.Ut]}getOnCurrentValues(a,
b){return(c)=>{let d=a.getEntityById(b);if(null!=d){let b=k.j.shapedText(d);b=b.setWrapWidth(c("wrapWidth"));k.j.setText(d,b,a)}}}getTweenedComponents(){return[l.f.ya]}};var Jb={};Object.defineProperty(Jb,"__esModule",{value:!0});Jb.Yr=class extends va.he{constructor(a,b,c,d,g){super(a,b);this.qh=c;this.lg=d;this.Km=g;this.ease=(new W.Hb).createLinear()}getPropertyNames(){return["x","y","scale","rotation"]}getStartValues(){return[this.qh.getTranslation().x,this.qh.getTranslation().y,this.qh.getScale(),
this.qh.getRotationRad()]}getEndValues(){return[this.lg.getTranslation().x,this.lg.getTranslation().y,this.lg.getScale(),this.lg.getRotationRad()]}getOnCurrentValues(a,b){return(c)=>{let d=a.getEntityById(b);null!=d&&(c=t.Geometry.transform2dFromRad({x:c("x"),y:c("y")},c("scale"),c("rotation")),c=null!=this.Km?c.concat(this.Km()):c,k.j.updateTransform(d).setLocalToWorld(c))}}getTweenedComponents(){return[f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD]}cleanupTweenedComponents(a){k.j.cleanupTransformation(a)}getTweenedComponentsVersion(a){return k.j.Hu(a)}};
var Kb={};Object.defineProperty(Kb,"__esModule",{value:!0});Kb.iq=class extends va.he{constructor(a,b,c,d){super(a,b);this.Ww=c;this.St=d;this.ease=(new W.Hb).createLinear()}getPropertyNames(){return["depth"]}getStartValues(){return[this.Ww]}getEndValues(){return[this.St]}getOnCurrentValues(a,b){return(c)=>{let d=a.getEntityById(b);null!=d&&d.getMutableWrapper(f.CetModel.ID.BACKGROUND_LAYER.W).setDepth(c("depth"))}}getTweenedComponents(){return[f.CetModel.ID.BACKGROUND_LAYER.DEPTH]}};var ma={};Object.defineProperty(ma,
"__esModule",{value:!0});ma.wd=class{constructor(a,b){this.name=a;this.Lt=b}getName(){return this.name}ease(a,b,c,d){return this.Lt(a,b,c,d)}};var Lb={};Object.defineProperty(Lb,"__esModule",{value:!0});Lb.jq=class extends va.he{constructor(a,b,c,d){super(a,b);this.start=c;this.end=d;this.ease=(new W.Hb).createLinear()}getPropertyNames(){return["fadeScale"]}getStartValues(){return[this.start]}getEndValues(){return[this.end]}getOnCurrentValues(a,b){return(c)=>{let d=a.getEntityById(b);null!=d&&d.getMutableWrapper(f.CetModel.ID.BACKGROUND_LAYER.W).setFadeScale(c("fadeScale"))}}getTweenedComponents(){return[f.CetModel.ID.BACKGROUND_LAYER.FADE_SCALE]}};
var W={};Object.defineProperty(W,"__esModule",{value:!0});W.Hb=class{constructor(){}createBackgroundDepthTween(a,b,c,d){return new Kb.iq(a,b,c,d)}createBackgroundFadeScaleTween(a,b,c,d){return new Lb.jq(a,b,c,d)}createTransformTween(a,b,c,d,g){return new Jb.Yr(a,b,c,d,g)}createAlphaTween(a,b,c,d,g){return new Hb.aq(a,b,c,d,g)}createTextWrapWidthTween(a,b,c,d){return new Ib.Vr(a,b,c,d)}createLinear(){return new ma.wd("linear",(a,b,c,d)=>b+a/d*c)}createQuadInOut(){return new ma.wd("quadInOut",(a,b,
c,d)=>{a/=d/2;if(1>a)return c/2*a*a+b;a--;return-c/2*(a*(a-2)-1)+b})}createElasticOut(a,b){return new ma.wd("elasticOut",(c,d,g,e)=>{if(0===c)return d;if(1===(c/=e))return d+g;if(null==b||0===b)b=.3*e;let f;a<Math.abs(g)?(a=g,f=b/4):f=b/(2*Math.PI)*Math.asin(g/a);return a*Math.pow(2,-10*c)*Math.sin(2*(c*e-f)*Math.PI/b)+g+d})}createCubicOut(){return new ma.wd("cubicOut",(a,b,c,d)=>{a/=d;a--;return c*(a*a*a+1)+b})}createQuintOut(){return new ma.wd("quintOut",(a,b,c,d)=>{a/=d;a--;return c*(a*a*a*a*a+
1)+b})}createExpOut(a,b){return new ma.wd("expOut",(c,d,g,e)=>g*(-Math.pow(a,b*c/e)+1)+d)}};var wa={};Object.defineProperty(wa,"__esModule",{value:!0});wa.se=class{constructor(a,b,c,d,e,f,y,Ja){this.id=a;this.startTime=b;this.tc=c;this.uf=d;this.interval=e;this.hx=f;this.xj=y;this.ease=Ja;this.qb=()=>{};this.onEnd=()=>{};this.Kn=()=>!1;null==Ja&&(this.ease=(new W.Hb).createLinear());wa.se.Mc=Math.pow(2,-40);this.hc=0;this.Ie=!1;this.jf=this.delayBeforeRecurring=0}getId(){return this.id}zs(a){this.startTime=
a}Ew(a,b,c=Infinity){this.hc=c;this.Ie=a;this.delayBeforeRecurring=b;this.jf=0<this.hc?this.hc-1:0}step(a){if(a<this.startTime)return this.di(this.tc),this.tc;if(this.startTime+this.interval>a){var b={};for(let d in this.tc)if(this.tc.hasOwnProperty(d)){var c=this.tc[d];let e=this.uf[d];c=Math.abs(e-c)<wa.se.Mc?e:this.ease.ease(a-this.startTime,c,e-c,this.interval);b[d]=c}this.di(b);return b}this.di(this.uf);0<this.jf&&(this.jf--,this.Ie&&(b=this.uf,this.uf=this.tc,this.tc=b),this.startTime=a+this.delayBeforeRecurring);
return this.uf}di(a){this.js=a;this.xj(a)}En(a){return 0===this.jf&&this.startTime+this.interval<=a}jj(a){return a>=this.startTime}Ni(){return this.startTime+this.interval}getStartTime(){return this.startTime}Qe(a){return-1!==this.hx.indexOf(a)}iw(a){this.tc=a;this.startTime=Date.now();this.jf=0<this.hc?this.hc-1:0}};var ha={};Object.defineProperty(ha,"__esModule",{value:!0});ha.Qc=class{constructor(){this.Oe=x.Utils.createLinkedList();this.dd=!1}Wt(a,b){this.fadeIn((b)=>{a.set(e.Cet.getPathVisibilityKey(),
{isEnabled:!0,alpha:b})},280,b)}fadeIn(a,b,c){this.fade(a,ha.Qc.Mk,ha.Qc.Lk,b,c)}Yt(a,b){this.fadeOut((b)=>{a.set(e.Cet.getPathVisibilityKey(),{isEnabled:!0,alpha:b})},280,b)}fadeOut(a,b,c){this.fade(a,ha.Qc.Lk,ha.Qc.Mk,b,c)}fade(a,b,c,d,e){a(b);b=new wa.se(String(x.Utils.nextSerialId()),(new Date).getTime(),{alpha:b},{alpha:c},d,[],(b)=>{a(b.alpha)});null!=e&&(b.onEnd=e);this.Oe.add(b)}rk(a){this.Oe.add(a)}Qi(a,b){let c=Number.POSITIVE_INFINITY;for(let d of a)d.jj(b)?c=0:(a=d.getStartTime()-b,a<
c&&(c=a));return c}getNextFrameTime(){var a=(new Date).getTime();a=this.Qi(this.Oe,a);return this.dd?0:a===Number.POSITIVE_INFINITY?-1:a}needsFrameImmediately(){return 0===this.getNextFrameTime()}update(){let a=x.Utils.createLinkedList(),b=(new Date).getTime();this.dd=!1;for(let c of this.Oe)c.step(b),c.En(b)&&a.add(c);for(let b of a){if(null!=b.onEnd)b.onEnd();this.Oe.remove(b)}}Qe(a,b){if(null==a)return!0;for(let c of a)if(b.Qe(c))return!0;return!1}};ha.Qc.Mk=0;ha.Qc.Lk=1;var Mb={};Object.defineProperty(Mb,
"__esModule",{value:!0});Mb.Cr=class{constructor(a){this.path=a}isFirst(a){return null!=a&&0===a.getStep()&&0===a.getAction()}isLast(a){return null!=a&&this.hasStep(a.getStep())&&a.getStep()===this.path.getStepCount()-1&&a.getAction()===this.path.getActionCount(a.getStep())}has(a){return null!=a&&this.hasAction(a.getStep(),a.getAction())}hasStep(a){return 0<=a&&a<this.path.getStepCount()}hasAction(a,b){return this.hasStep(a)&&0<=b&&b<=this.path.getActionCount(a)}check(a){if(null==a)throw Error("Position was null");
this.checkAction(a.getStep(),a.getAction())}checkStep(a){if(!this.hasStep(a))throw Error("Invalid step "+a+", step should be between [0,"+this.path.getStepCount()+")");}checkAction(a,b){this.checkStep(a);if(!this.hasAction(a,b))throw Error("Invalid action "+b+" in step "+a+", action should be between [0,"+(this.path.getActionCount(a)+1)+")");}getFirst(){return 0===this.path.getStepCount()?null:this.path.getPathPosition(0,0)}getLast(){if(0===this.path.getStepCount())return null;let a=this.path.getStepCount()-
1,b=0===this.path.getActionCount(a)?0:this.path.getActionCount(a)-1;return this.path.getPathPosition(a,b)}offset(a,b,c=!1){for(;0!==b;)if(0>b){if(0<a.getAction())a=this.path.getPathPosition(a.getStep(),a.getAction()-1);else if(0<a.getStep())a=a.getStep()-1,a=this.path.getPathPosition(a,this.path.getActionCount(a));else return this.path.getPathPosition(0,0);var d=c&&this.path.isFadeAction(a);b+=d?0:1}else{d=this.path.getActionCount(a.getStep());if(0<d&&a.getAction()<d)a=this.path.getPathPosition(a.getStep(),
a.getAction()+1);else if(this.path.getStepCount()-1>a.getStep())a=this.path.getPathPosition(a.getStep()+1,0);else break;d=c&&this.path.isFadeAction(a);b+=d?0:-1}return a}canMoveBack(a,b){if(1>this.path.getStepCount()||!a)return!1;const c=a.getStep();a=a.getAction();if(0<c)return!0;if(0===a)return!1;if(!b)return!0;for(b=0;b<a;b++)if(!this.path.isFadeAction(this.path.getPathPosition(c,b)))return!0;return!1}canMoveForward(a,b){if(1>this.path.getStepCount()||!a)return!1;const c=a.getStep(),d=a.getAction();
if(c<this.path.getStepCount()-1)return!0;a=this.path.getActionCount(c);if(d===a)return!1;if(!b)return!0;for(b=d;b<a;b++)if(!this.path.isFadeAction(this.path.getPathPosition(c,b)))return!0;return!1}};var xa={};Object.defineProperty(xa,"__esModule",{value:!0});xa.me=class{constructor(a,b){this.step=a;this.action=b}getStep(){return this.step}getAction(){return this.action}compareTo(a){return null==a?1:0===this.step-a.step?this.action-a.action:this.step-a.step}isBefore(a){return 0>this.compareTo(a)}isAfter(a){return 0<
this.compareTo(a)}isSame(a){return null==a?!1:this.step===a.step&&this.action===a.action}isSameStep(a){return null==a?!1:this.step===a.step}toString(){return"("+this.step+","+this.action+")"}};var ia={};Object.defineProperty(ia,"__esModule",{value:!0});ia.Yk=class{constructor(a){this.i=a;this.Cj=new Mb.Cr(this)}getPathPosition(a,b){return new xa.me(a,b)}Gm(a){let b=0;for(const c of this.getSteps().items()){a(this.getPathPosition(b,0),c,null);let d=1;const e=this.Hd(this.i.getEntityById(c)).getActions();
for(const g of e)a(this.getPathPosition(b,d++),c,g.getId());b++}}getAllPathPositions(){let a=[];this.Gm((b)=>a.push(b));return a}getStepCount(){return this.getSteps().length()}getActionCount(a){this.Cj.checkStep(a);a=this.getSteps().getAt(a);return null==a?0:this.Hd(this.i.getEntityById(a)).getActions().length()}getPathStepEntityId(a){return this.$m(a.getStep())}$m(a){return this.getSteps().getAt(a)}getTargetForStep(a){if(!this.Cj.hasStep(a))return null;a=this.$m(a);a=this.i.getEntityById(a);return a.isDef(f.CetModel.ID.HAS_TARGET)?
a.get(f.CetModel.ID.HAS_TARGET.TARGET):this.i.getPreziW().getOverview().getId()}getTargetForPathPosition(a){let b=a.getAction()-1;var c=this.getSteps().getAt(a.getStep());for(c=this.Hd(this.i.getEntityById(c));0<=b;b--){const a=c.getActions().getAt(b);if(this.Gn(a))return a.getTarget();if(this.Hn(a))break}return this.getTargetForStep(a.getStep())}getPathCalculator(){return this.Cj}getSteps(){return this.xg()}getClosestValidPathPosition(a,b=null){const c=this.xg();if(b){let d=Infinity,e=-1;for(let g=
0;g<c.length();g++)if(this.getTargetForStep(g)===b){const b=Math.abs(g-a.getStep());b<d&&(d=b,e=g)}if(0<=e)return this.getPathPosition(e,0)}if(a.getStep()>c.length()-1)return this.getPathPosition(Math.max(c.length()-1,0),0);b=c.getAt(a.getStep());b=this.Hd(this.i.getEntityById(b));return null!=b&&(b=b.getActions(),a.getAction()>b.length())?this.getPathPosition(a.getStep(),b.length()):a}getStartPoint(){const a=this.Sm();return null!=a?a:this.getPathPosition(0,0)}hasCustomStartPoint(){return null!=
this.Sm()}getPathPositionOfStepOrAction(a){let b=null;this.Gm((c,d,e)=>{if(d===a||e===a)b=c});return b}Sm(){const a=this.xg().items();for(let c=0;c<a.length;c++){var b=this.i.getEntityById(a[c]);b=this.Hd(b);if(null!=b.getStartPointToken())return this.getPathPosition(c,0);b=b.getActions();for(let a=0;a<b.length();a++)if(null!=b.getAt(a).getStartPointToken())return this.getPathPosition(c,a+1)}return null}};ia.zq=class extends ia.Yk{xg(){return k.j.pathKludge.getEditorPathComponent(this.i)}Hd(a){return a.getWrapper(f.CetModel.ID.EDITOR_PATH_STEP.W)}Gn(a){return a.is(f.CetModel.ID.ZOOM_TO_OBJECT_EP)}Hn(a){return a.is(f.CetModel.ID.ZOOM_TO_OVERVIEW_EP)}isFadeAction(a){const b=
k.j.pathKludge.getISomeEditorPathStepW(this.i.getEntityById(this.getPathStepEntityId(a)));if(null==b)return!1;a=b.getActions().getAt(a.getAction()-1);return null==a?!1:a.is(f.CetModel.ID.FADE_IN_OBJECT_EP)||a.is(f.CetModel.ID.FADE_OUT_OBJECT_EP)||a.is(f.CetModel.ID.FADE_IN_OBJECTS_EP)||a.is(f.CetModel.ID.FADE_OUT_OBJECTS_EP)}};ia.al=class extends ia.Yk{xg(){return this.i.getPreziW().getEntity().getComponent(f.CetModel.ID.PREZI.PATH)}isFadeAction(a){var b=this.i.getEntityById(this.getPathStepEntityId(a));
b=b.isDef(f.CetModel.ID.PATH_STEP)?b.getWrapper(f.CetModel.ID.PATH_STEP.W):null;if(null==b)return!1;a=b.getActions().getAt(a.getAction()-1);return null==a?!1:a.is(f.CetModel.ID.FADE_IN_OBJECT)||a.is(f.CetModel.ID.FADE_OUT_OBJECT)||a.is(f.CetModel.ID.FADE_IN_OBJECTS)||a.is(f.CetModel.ID.FADE_OUT_OBJECTS)}Hd(a){return a.getWrapper(f.CetModel.ID.PATH_STEP.W)}Gn(a){return a.is(f.CetModel.ID.ZOOM_TO_OBJECT)}Hn(a){return a.is(f.CetModel.ID.ZOOM_TO_OVERVIEW)}getSoundForPathPosition(a){var b=this.getSteps().getAt(a.getStep());
b=this.i.getEntityById(b);if(null==b)return[];b=b.getWrapper(f.CetModel.ID.PATH_STEP.W);b=0===a.getAction()?b.getPathSounds():b.getActions().getAt(a.getAction()-1).getPathSounds();const c=(a,b)=>{const c=this.getAllPathPositions();let d;for(let b=0;b<c.length;b++)if(c[b].isSame(a)){d=b;break}return c[d+b.getPathLength()]},d=[];null!=b&&b.forEach((b)=>{d.push({audioBuffer:b.getEntity().get(k.j.Lm()),loop:b.getLoop(),startPosition:a,endPosition:c(a,b)})});return d}getPathStepPositionsForNavigation(){return this.getAllPathPositions().filter((a)=>
{if(0===a.action)return!0;const b=this.getPathStepEntityId(a);a=this.i.lookup(b,f.CetModel.ID.PATH_STEP.W).getActions().getAt(a.action-1);return a.is(f.CetModel.ID.ZOOM_TO_OBJECT)||a.is(f.CetModel.ID.ZOOM_TO_OVERVIEW)})}getPathStepPositionsWithAudio(){return this.getAllPathPositions().filter((a)=>0<this.getAllPathSoundsForPathPosition(a).length)}getAllPathSoundsForPathPosition(a){let b=[];const c=this.getAllPathPositions().filter((b)=>b.isBefore(a)).filter((a)=>null!==this.getSoundForPathPosition(a)).map((a)=>
this.getSoundForPathPosition(a));for(let d=0;d<c.length;d++)if(0<c[d].length)for(let e=0;e<c[d].length;e++)(null==c[d][e].endPosition||c[d][e].endPosition.isAfter(a))&&b.push(c[d][e]);b.push(...this.getSoundForPathPosition(a));return b}};var Nb={};Object.defineProperty(Nb,"__esModule",{value:!0});Nb.Dr=class{constructor(a,b,c,d,e,f,y,Ja){this.intent=a;this.getPath=b;this.wv=Ja;this.Ki=c;this.mk=e;this.Ab=d;this.nk=f;this.rj=y}getIntent(){return this.intent}getFromPos(){return this.Ki}getFromTargetId(){return this.Ab}getToPos(){return this.mk}getToTargetId(){return this.nk}getNavigationMode(){return this.rj}getNavOptions(){return this.wv}toString(){return"PathNavigationEvent: @"+
(null==this.Ki?"()":this.Ki.toString())+" #"+(null==this.Ab?"":this.Ab)+" ->  @"+(null==this.mk?"()":this.mk.toString())+" #"+(null==this.nk?"":this.nk)+"; mode: "+(null==this.rj?"":e.NavigationMode[this.rj])}};var db={};Object.defineProperty(db,"__esModule",{value:!0});db.$k=class{constructor(a,b,c,d){this.ff=a;this.Tu=b;this.gf=c;this.Uu=d;this.af=!0}setDirection(a,b){if(null!=a&&a.isSame(this.gf)||null!=b&&b===this.Uu)this.af=!0;else if(null!=a&&a.isSame(this.ff)||null!=b&&b===this.Tu)this.af=
!1;else throw Error("invalid direction");}gv(){return null!=this.ff&&null!=this.gf&&this.ff.isBefore(this.gf)}};var Ob={};Object.defineProperty(Ob,"__esModule",{value:!0});Ob.Fr=class{constructor(a){this.Kg=a;this.$i=!1;this.yo=n.Bacon.newBus()}getCurrentPosition(){return this.qc}getPendingNavigationTargetPosition(){const a=this.tb;return null!=a?a.af?a.gf:a.ff:null}initWithPosition(a){this.Kg.reset();let b=null==this.getCurrentPosition()||a.isSame(this.getCurrentPosition())?new xa.me(-1,-1):this.getCurrentPosition();
this.Ab=this.getPath().getTargetForStep(a.getStep());this.tb=new db.$k(b,this.Ab,a,this.Ab);this.jump(a);this.pf(a)}getPathNavigationStream(){return this.yo}getPath(){return this.path}setScene(a){this.i=a;this.path=new ia.al(a);this.tb=null}getNavigationStrategy(){return this.Kg}setNavigationStrategy(a){this.Kg=a}setAsyncCallback(a){if(this.$i)throw Error("PathNavigator is already in async mode");this.$i=!0;a.onValue((a)=>{this.pf(a.getToPos());this.Ab=a.getToTargetId();this.tb=null})}isMoving(){return null!=
this.tb}getCurrentTargetId(){return this.Ab}go(a,b){const c=null!=b?e.NavigationMode.NEW_TRANSITION:null;return this.bd(new xa.me(a.step,a.action),null,e.NavigationIntent.goto,e.NavigationChange.NEW_TARGET,c,b)}jump(a){return this.bd(a,null,e.NavigationIntent.goto,e.NavigationChange.NEW_TARGET,e.NavigationMode.JUMP)}see(a){this.bd(null,a,e.NavigationIntent.goto,e.NavigationChange.NEW_TARGET);return!0}next(a){return this.ln(e.NavigationIntent.next,a)}prev(a){return this.ln(e.NavigationIntent.prev,
a)}resume(a){let b=this.getCurrentPosition();if(null!=this.i&&null!=a&&null!=b&&a.getStep()===b.getStep()){var c=this.i.getEntityById(this.getPath().getPathStepEntityId(b)),d=c.getWrapper(f.CetModel.ID.PATH_STEP.W).getActions();a=d.getAt(b.getAction());d=d.getAt(b.getAction()-1);if(null==a||null==d)return null;c=c.getWrapper(f.CetModel.ID.FLY_TO_OBJECT.W);a.is(f.CetModel.ID.ZOOM_TO_OBJECT)&&d.is(f.CetModel.ID.ZOOM_TO_OBJECT)&&a.getTarget()===c.getTarget()&&this.pf(new xa.me(b.getStep(),b.getAction()+
1));return this.getCurrentPosition()}return this.bd(null!=a?a:this.getCurrentPosition(),null,e.NavigationIntent.goto,e.NavigationChange.NEW_TARGET)}ln(a,b){return null==this.tb?(b=null==this.getCurrentPosition()?this.getPath().getPathCalculator().getFirst():this.getPath().getPathCalculator().offset(this.getCurrentPosition(),a===e.NavigationIntent.next?1:-1,b),this.bd(b,null,a,e.NavigationChange.NEW_TARGET)):a===e.NavigationIntent.next===this.tb.gv()?this.bd(this.tb.gf,null,a,this.tb.af?e.NavigationChange.CONTINUE:
e.NavigationChange.TURN_BACK):this.bd(this.tb.ff,null,a,this.tb.af?e.NavigationChange.TURN_BACK:e.NavigationChange.CONTINUE)}bd(a,b,c,d,e,f){if(null!=a){if(!this.getPath().getPathCalculator().has(a))return null;b=this.getPath().getTargetForStep(a.getStep())}let g=this.getCurrentPosition(),r=this.Ab;this.setTarget(a,b,d);d=null!=e?e:this.Kg.getNavigationMode(d);this.yo.push(new Nb.Dr(c,()=>this.getPath(),g,r,a,b,d,f));return a}pf(a){this.qc=a;this.i.requestNoDomBatchUpdate((b)=>{b.getPrezi().set(k.j.getCurrentPathPositionKey(),
a)})}seekTo(a){this.pf(a)}setTarget(a,b,c){this.$i?c===e.NavigationChange.NEW_TARGET?this.tb=new db.$k(this.getCurrentPosition(),this.Ab,a,b):this.tb.setDirection(a,b):(this.pf(a),this.Ab=b)}};var Pb={};Object.defineProperty(Pb,"__esModule",{value:!0});Pb.nr=class{constructor(a){this.th=a;this.Vg={};this.xk={};this.th=a;this.th.beforeSync((a)=>this.xs(a))}addOfflineOnlinePatch(a){this.xk[a.oldOnlineAssetUrl]=a;this.th.requestSync()}xs(a){if(0!==Object.keys(this.Vg).length||0!==Object.keys(this.xk).length)for(const b of m.DOM.collectMediaAsset(a)){for(;;){a=
b.getOfflineAssetId();a=this.Vg[a];if(null==a)break;b.updateOfflineAssetId(a.oo);null!=a.xo&&a.xo(b)}a=b.getOnlineAssetUrl();a=this.xk[a];null!=a&&(b.updateOnlineAssetId(a.newOnlineAssetId),b.updateOnlineAssetUrl(a.newOnlineAssetUrl))}}setNewAssetId(a){const b=this.createId();a.setOfflineAssetId(b);return b}createId(){return Math.random().toString(16)}addPatch(a,b){return this.fi(a,this.createId(),b,!0)}addPatchFromTransaction(a,b){return this.fi(a,this.createId(),b,!1)}addError(a,b){return this.fi(a,
e.Cet.errorOfflineAssetId,b,!0)}fi(a,b,c,d){if(null==a||""===a)return e.Cet.getEditorApiLogger().mediaPatcherAssetIdMissing(),a;a=this.getRecentAssetId(a);if(a===e.Cet.errorOfflineAssetId)return e.Cet.getEditorApiLogger().mediaPatcherPatchingError(),a;this.Vg[a]={gy:a,oo:b,xo:c};d&&this.th.requestSync();return b}getRecentAssetId(a){for(;;){const b=this.Vg[a];if(null==b)break;a=b.oo}return a}};var Qb={};Object.defineProperty(Qb,"__esModule",{value:!0});Qb.Sq=class{constructor(a){this.name=a;this.reset()}reset(){this.Fc=
{wb:[]};this.pc=[{wb:[]}];this.Kb=0;this.log("HistoryList reset")}isUndoable(){return 0<this.Fc.wb.length||0<this.Kb}isRedoable(){return this.Kb<this.pc.length-1}undo(){if(!this.isUndoable())return!1;0<this.Fc.wb.length&&this.push();const a=this.pc[this.Kb];this.log("HistoryList undo",a);for(let b=a.wb.length-1;0<=b;b--)a.wb[b].undo();this.Kb--;return!0}redo(){if(!this.isRedoable())return!1;this.Kb++;const a=this.pc[this.Kb];this.log("HistoryList redo",a);for(let b=0;b<a.wb.length;b++)a.wb[b].redo();
return!0}Tw(a){this.isRedoable()&&(this.pc=this.pc.slice(0,this.Kb+1),this.Fc={wb:[]});this.Fc.wb.push(a)}push(){if(0!==this.Fc.wb.length){if(this.isRedoable())throw Error("assert failed: history list is in invalid state");this.log("HistoryList push",this.Fc.wb.map((a)=>a.message).join("; "));this.pc.push(this.Fc);this.Fc={wb:[]};this.Kb++}}log(){}tsto(){let a="",b=0;for(;b<this.pc.length;)a+=" ",b===this.Kb&&(a+="("),a+=this.pc[b],b===this.Kb&&(a+=")"),a+=" ",b++;return a}};var eb={};Object.defineProperty(eb,
"__esModule",{value:!0});eb.dl=class extends R.Wa{constructor(a){super();this.oh=[];this.logger=u.LoggerModule.getLoggerManager().createLogger("SessionComponent");this.na=a;this.Jb=n.Bacon.newBus();this.Qb=new Qb.Sq("historylist");this.na.Dj.merge(this.na.getNetworkEventStream().filter((a)=>a.type===e.CetNetworkEventType.ResetUndoRedo).map(()=>!0)).onValue(()=>this.Qb.reset())}createChildComponent(){let a=new eb.dl(this.na);a.Qb=this.Qb;a.Jb=this.Jb;a.version=this.version;a.oh=this.oh;return a}getSession(){return this.na.ha}lf(){this.discardEvents();
this.na.lf();this.Jb.push(e.EditKind.Local)}Zj(a,b,c){this.discardEvents();return this.na.Zj(a,b,c).then((a)=>{this.Jb.push(e.EditKind.Local);return a})}Nl(a){if(!this.hasAnyUncommitedChange())return!1;this.Qb.Tw({message:a.message,undo:()=>{this.getSession().undo();try{a.snapshotBefore.reset()}catch(b){u.LoggerModule.logException(this.logger,"commitChanges","snapshotBefore.reset",b)}},redo:()=>{this.getSession().redo();try{a.snapshotAfter.reset()}catch(b){u.LoggerModule.logException(this.logger,
"commitChanges","snapshotAfter.reset",b)}}});this.getSession().commit();this.Jb.push(e.EditKind.Local);return!0}isUndoable(){return this.Qb.isUndoable()}undo(){if(!this.Qb.undo())return!1;this.Jb.push(e.EditKind.Local);return!0}isRedoable(){return this.Qb.isRedoable()}redo(){if(!this.Qb.redo())return!1;this.Jb.push(e.EditKind.Local);return!0}discardEvents(){this.getSession().discardEvents()}sync(){this.Qb.push();let a=this.na.sync();a.wasHardReseted&&this.Qb.reset();const b=a.No||a.wasHardReseted||
a.wasAcknowledgeRequested&&a.Fj;!a.wasAcknowledgeRequested&&a.Fj&&this.Jb.push(e.EditKind.Local);b&&this.Jb.push(e.EditKind.Remote)}hasAnyUncommitedChange(){return this.getSession().hasAnyUncommitedChange()}getCetSessionEditStream(){return this.Jb}generateObjectId(){return this.getSession().generateObjectId()}useTestIdGenerator(a){this.getSession().setIdGenerator(k.j.createTestIdGenerator(a))}regenerateIDs(a){return m.DOM.regenerateIDsSeeded(a,this.getSession().getIdGenerator())}registerSnapshotCreator(a){this.oh.push(a)}createSnapshot(){const a=
[];for(let b of this.oh)try{a.push(b.createSnapshot().reset)}catch(c){u.LoggerModule.logException(this.logger,"createSnapshot","createSnapshot",c)}return{reset:()=>{for(let b of a)try{b()}catch(c){u.LoggerModule.logException(this.logger,"createSnapshot","callback",c)}}}}};var Rb={};Object.defineProperty(Rb,"__esModule",{value:!0});Rb.er=class{constructor(a,b,c){this.Ue=!1;this.name=a;this.keys=b;this.tw=c;this.Ue=-1!==b.indexOf(f.CetModel.getRemovedEntityCompKey())}getName(){return this.name}select(a){return this.tw(a)}getTriggerKeys(){return this.keys}getRequiredKeysForIndirectTrigger(){return[]}isTrackingRemovedEntity(){return this.Ue}};
var Sb={};Object.defineProperty(Sb,"__esModule",{value:!0});Sb.xq=class{static Ru(a){var b=["trackedCompMarker"];if(null==a)return!1;for(let c of b)if(null==a[c])return!1;return!0}};var Ra={};Object.defineProperty(Ra,"__esModule",{value:!0});Ra.Wh=class extends R.Wa{trackedCompMarker(){}};var na={};Object.defineProperty(na,"__esModule",{value:!0});na.yd=class extends R.Wa{constructor(a){super();this.t=a}createChildComponent(){let a=new na.yd;a.t=this.t;a.version=this.version;return a}setValue(a,b=
!1,c=!1){if(b||!this.equalsValue(a))this.t=a,this.incrementVersion();this.Wf=c}static qm(a,b){return null==a||null==b?a===b:null!=a.equalsWithin?a.equalsWithin(b,Math.pow(2,-40)):null!=a.equals?a.equals(b):a===b}equalsValue(a){return na.yd.qm(this.t,a)}equalsValueIncludingPdomInternal(a){return na.yd.pm(this.t,a)}static pm(a,b){return null==a||null==b?a===b:null!=a.equalsWithin?a.equalsWithin(b,Math.pow(2,-40)):null!=a.equals?a.equals(b):null!=a.compare?a.compare(b):a===b}getValue(){return this.t}};
var fb={};Object.defineProperty(fb,"__esModule",{value:!0});fb.il=class extends Ra.Wh{createChildComponent(){let a=new fb.il;a.t=this.t;a.version=this.version;return a}setValue(a,b=!1,c=!1){if(b||!this.equalsValue(a))this.t=a,this.incrementVersion();this.Wf=c}equalsValue(a){return na.yd.qm(this.t,a)}equalsValueIncludingPdomInternal(a){return na.yd.pm(this.t,a)}getValue(){return this.t}};var oa={};Object.defineProperty(oa,"__esModule",{value:!0});oa.vd=class extends Ra.Wh{constructor(a){super();this.oa=
null==a?f.CetModel.createUpdateableVArray():a.oa.createChildArray();this.oa.__COMPONENT__=this}items(){return this.oa.items()}get(a){return this.getAt(a)}getMaybePDOMId(){return null}createChildComponent(){let a=new oa.vd(this);a.version=this.version;return a}iterator(){let a=0;return{hasNext:()=>a<this.oa.length(),next:()=>this.oa.get(a++)}}[Symbol.iterator](){return this.oa.items()[Symbol.iterator]()}forEach(a){for(let b=0,c=this.length();b<c;b++)a(this.getAt(b))}getAt(a){return this.oa.get(a)}isEmpty(){return 0===
this.oa.length()}insert(a,b){this.insert_Internal(a,b);this.eh(a,b,!1,null,null,!1)}insert_Internal(a,b){this.oa.insert(a,b);this.incrementVersion()}move(a,b){this.oa.move(a,b);this.incrementVersion()}length(){return this.oa.length()}add(a){this.insert(this.oa.length(),a);this.incrementVersion()}removeAt(a){let b=this.getAt(a);this.removeAt_Internal(a);this.fh(a,b,!1)}removeAt_Internal(a){this.oa.removeAt(a);this.incrementVersion()}getDiff(){return this.oa.getDiff()}setCurrentVersionAsOrigin_Internal(){this.oa.setCurrentVersionAsOrigin()}resetToOrigin(){this.oa.resetToOrigin()&&
this.incrementVersion()}isInherited(){return!0}fh(){}eh(){}resolveAfterPdomEventHandling(a,b,c){if(null!=this.O.getEntityList())for(let d of this.getDiff())switch(d.getKind()){case f.ObservableArrayEventKind.Insert:this.eh(d.getPos(),d.getItem(),a,b,c,!0);break;case f.ObservableArrayEventKind.Remove:this.fh(d.getPos(),d.getItem(),!0);break;default:throw Error(`Unsupported event kind '${f.ObservableArrayEventKind[d.getKind()]}'`);}this.setCurrentVersionAsOrigin_Internal()}dispose(){this.oa.resetOnDispose()}};
var Ka={};Object.defineProperty(Ka,"__esModule",{value:!0});Ka.Mf=class extends oa.vd{constructor(a,b){super(a);this.sb=b}createChildComponent(){let a=new Ka.Mf(this,this.sb);a.version=this.version;return a}eh(a,b,c,d,e){if(ya.ke.om(this.O)&&null!=b){a=(null!=d?d.getEntityList():this.O.getEntityList()).getEntityById(b);null==a&&null!=e&&(a=e.find((a)=>a.getId()===b));if(null==a){if(c)return;throw Error("cannot resolve reference to "+b);}c=a.getComponent(this.sb);e=null!=c?c.getValue():null;null==
e?a.set(this.sb,[this.O.getId()]):(-1===e.indexOf(this.O.getId())&&e.push(this.O.getId()),c.incrementVersion())}}fh(a,b){if(Ka.Mf.qp(this.O,this,b)){a=this.O.getEntityList().getEntityById(b);b=a.getComponent(this.sb);var c=null!=b?b.getValue():null;if(null!=c){let d=c.indexOf(this.O.getId());0<=d&&(c.splice(d,1),0===c.length&&a.set(this.sb,null),b.incrementVersion())}}}static om(a){return null!=a&&null!=a.getEntityList()&&a.getEntityList().getEntityById(a.getId())===a}static qp(a,b,c){if(null==a.getEntityList().getEntityById(c))return!1;
const d=a.getEntityList().getEntityById(a.getId());if(d===a)return 0>b.items().indexOf(c);if(null==d)return!0;a=d.getUntypedComponent(k.j.getComponentKey(b));return!a||0>a.items().indexOf(c)?!0:!1}resetToOrigin(){var a=this.oa.getDiff();super.resetToOrigin();const b=this.items();for(let c of a)if(c.getKind()===f.ObservableArrayEventKind.Insert||c.getKind()===f.ObservableArrayEventKind.Remove)if(a=c.getItem(),0>b.indexOf(a)&&(a=this.O.getEntityList().getEntityById(a),null!=a)){let b=a.getComponent(this.sb),
c=null!=b?b.getValue():null;if(null!=c){let d=c.indexOf(this.O.getId());0<=d&&(c.splice(d,1),0===c.length&&a.set(this.sb,null),b.incrementVersion())}}}dispose(){if(null!=this.O&&null!=this.O.getEntityList()&&null==this.O.getEntityList().getEntityById(this.O.getId()))for(const a of this.oa.items()){const b=this.O.getEntityList().getEntityById(a);if(null!=b&&null!=b.get(this.sb)){const a=b.get(this.sb),d=b.get(this.sb).filter((a)=>a!==this.O.getId());d.length!==a.length&&b.set(this.sb,d)}}super.dispose()}};
var ya={};Object.defineProperty(ya,"__esModule",{value:!0});ya.ke=class extends Ka.Mf{constructor(a,b){super(a,b)}createChildComponent(){let a=new ya.ke(this,this.sb);a.version=this.version;return a}getValue(){return this.getAt(0)}equalsValue(a){return this.getAt(0)===a}equalsValueIncludingPdomInternal(a){return this.equalsValue(a)}setValue_Internal(a){1===this.length()&&this.equalsValue(a)||(1===this.length()&&this.removeAt_Internal(0),this.insert_Internal(0,a))}setValue(a,b,c=!1){if(c)throw Error("ignoreOnCommit is not supported for ref components");
if(b||1!==this.length()||!this.equalsValue(a))1===this.length()&&this.removeAt(0),this.insert(0,a)}};var La={};Object.defineProperty(La,"__esModule",{value:!0});La.Lf=class extends oa.vd{constructor(a){super(a);this.Sa={};if(null!=a)for(let b in a.Sa)a.Sa.hasOwnProperty(b)&&(this.Sa[b]=a.Sa[b])}createChildComponent(){let a=new La.Lf(this);for(let b in this.Sa)this.Sa.hasOwnProperty(b)&&(a.Sa[b]=this.Sa[b]);a.version=this.version;return a}fh(a,b,c){if(ya.ke.qp(this.O,this,b)){let a=this.O.getEntityList().getEntityById(b),
e=a.get(f.CetModel.ENTITY_OWNER_ID());if(null!=e&&e!==this.O.getId())throw Error(`entity is not a child of ${this.O.tsto()}`);a.set(f.CetModel.ENTITY_OWNER_ID(),null);c?a.Cc=!0:this.O.getEntityList().getScene().deleteEntitiesById([b])}for(delete this.Sa[b];a<this.oa.length();a++)this.Sa[this.getAt(a)]=a}eh(a,b,c,d,e,r){if(ya.ke.om(this.O)&&null!=b&&(b=this.O.getEntityList().getEntityById(b),null!=b||!c)){c=b.get(f.CetModel.ENTITY_OWNER_ID());if(null!=c&&c!==this.O.getId())throw Error("entity is already a child of "+
c);r&&(b.Cc=!1);b.set(f.CetModel.ENTITY_OWNER_ID(),this.O.getId());for(let b=a,c=this.oa.length();b<c;b++)a=this.getAt(b),this.Sa[a]=b}}move(a,b){super.move(a,b);var c=b>=a?a:b;for(a=Math.floor(Math.min((b>=a?b:a)+1,this.oa.length()));c<a;c++)b=this.getAt(c),this.Sa[b]=c}indexOf(a){let b=this.Sa[a];null==b&&(b=-1);return-1!==b&&this.getAt(b)===a?b:-1}resetToOrigin(){super.resetToOrigin();for(let a=0,b=this.length();a<b;a++){let b=this.getAt(a);this.Sa[b]=a}}};var Sa={};Object.defineProperty(Sa,"__esModule",
{value:!0});Sa.Nh=class extends La.Lf{constructor(a){super(a)}createChildComponent(){let a=new Sa.Nh(this);a.version=this.version;return a}getValue(){return this.getAt(0)}equalsValue(a){return 1===this.length()&&this.getValue()===a}equalsValueIncludingPdomInternal(a){return this.equalsValue(a)}setValue_Internal(a){1===this.length()&&this.equalsValue(a)||(1===this.length()&&this.removeAt_Internal(0),this.insert_Internal(0,a))}setValue(a,b){if(this.Wf)throw Error("ignoreOnCommit is not supported for child components");
if(b||1!==this.length()||!this.equalsValue(a))1===this.length()&&this.removeAt(0),this.insert(0,a)}};var K={};Object.defineProperty(K,"__esModule",{value:!0});K.Ja=class{constructor(a,b){this.Eh=new Map;this.Un=new Map;this.id=a;this.Pb=[];this.Yc=!1;K.Ja.logger||(K.Ja.logger=u.LoggerModule.getLoggerManager().createLogger("ViewEntity"));null!=b&&(this.Rg=b.getEntityById(a))}static Vt(a,b){let c=a.getUntypedComponent(b);null!=c&&a.hasComponent(b,!0)||(c=(b.isTracked(),new Sa.Nh(c)),a.setUntypedComponent(b,
c));return c}static ng(a,b){let c=a.getUntypedComponent(b);null!=c&&a.hasComponent(b,!0)||(c=new La.Lf(c),a.setUntypedComponent(b,c));return c}asMutableEntity(){return this}attachToEntityList(a){this.nb=a}getOwner(){const a=this.get(f.CetModel.ENTITY_OWNER_ID());return null==a?null:this.getEntityList().getEntityById(a)}getParentEntity(){return this.Rg}getEntityList(){return this.nb}getId(){return this.id}setComponent(a,b){return this.setUntypedComponent(a,b)}getDef(){let a=this.get(f.CetModel.DEF());
return null==a?f.CetModel.nilDef():a}isDef(a){let b=this.get(f.CetModel.DEF());return null!=b&&b.isDef(a)}isLike(a){if(this.isDef(a))return!0;for(let b of a.getFields())if(!this.hasComponent(b))return!1;return!0}tsto(a=!0){const b=null!=this.getParentEntity()&&this.getParentEntity().getId()!==this.getId()?"(ghost)":"";return(a&&null!=this.nb?this.nb.getName()+"/":"")+this.getDef().getName()+"#"+this.getId()+b}tstoDeep(){const a=(a)=>a.split("\n").map((a)=>"    "+a).join("\n"),b=(a)=>"-> "+a+(null==
this.nb.getEntityById(a)?" broken!":""),c=(d)=>{if(null==d)return"null";const e=this.nb.getEntityById(d);if(null==e)return d+" broken!";let r=e.tsto();e.getDef().getFieldDescriptors().forEach((d)=>{var g="";try{if(e.hasComponent(d.fieldKey))if(d.kind===f.FieldDescriptorKind.ChildList||d.kind===f.FieldDescriptorKind.ScalarList||d.kind===f.FieldDescriptorKind.ReferenceList){var y=e.getComponent(d.fieldKey);for(const a of y.items())g=d.kind===f.FieldDescriptorKind.ReferenceList?g+b(a):d.kind===f.FieldDescriptorKind.ChildList?
g+c(a):g+a,g="\n"!==g[g.length-1]?g+"\n":g}else{const a=e.get(d.fieldKey);g=d.kind===f.FieldDescriptorKind.Reference?g+b(a):d.kind===f.FieldDescriptorKind.Child?g+c(a):g+a}else g+="null"}catch(Nc){g=""+Nc}y=r;d=d.fieldKey.getName();d=`\n  ${d}:`;g=0<=g.indexOf("\n")||30<g.length?`${d}\n${a(g)}`:`${d} ${g}`;r=y+g});return r};return c(this.getId())}tstoJson(a=!0){const b=(a)=>null==a?null:"-> "+a+(null==this.nb.getEntityById(a)?" broken!":""),c=(a)=>({ASSET_SOURCE_FILENAME:a.getAssetSourceFilename(),
HEIGHT:a.getHeight(),IMAGE_SCALE_X:a.getImageScaleX(),IMAGE_SCALE_Y:a.getImageScaleY(),IS_FLIPPED:a.getIsFlipped(),MASK:a.getMask(),OFFLINE_ASSET_ID:a.getOfflineAssetId(),ONLINE_ASSET_ID:a.getOnlineAssetId(),ONLINE_ASSET_URL:a.getOnlineAssetUrl(),PAGE_NUMBER:a.getPageNumber(),PDF_BOUNDS_LEFT:a.getPdfBoundsLeft(),PDF_BOUNDS_TOP:a.getPdfBoundsTop(),TRANSPARENT:a.getTransparent(),WIDTH:a.getWidth()}),d=(a,d)=>a.kind===f.FieldDescriptorKind.ReferenceList||a.kind===f.FieldDescriptorKind.Reference?b(d):
a.kind===f.FieldDescriptorKind.ChildList||a.kind===f.FieldDescriptorKind.Child?e(d):null==d?d:a.fieldKey===f.CetModel.ID.STYLE_DECLARATION.STYLE_SELECTOR?d.toString():a.fieldKey===f.CetModel.ID.Z_SLIDE.IMPORTED_ASSET?{Kx:d.getImportJobId(),Lx:c(d.getNoBackgroundPdfAsset()),Mx:c(d.getOriginalPdfAsset()),Rx:d.getSourcePageNumber()}:a.fieldKey===f.CetModel.ID.Z_TEXT.TEXT?{paragraphs:d.getParagraphs().map((a)=>{const b=a.getAllCharacterStyles().map((a)=>{let b=!1;const c={};a.isColorSet()&&(b=!0,c.color=
a.getColor().asHexString());a.isFontSizeSet()&&(b=!0,c.fontSize=a.getFontSize());a.isUnderlineSet()&&(b=!0,c.jy=a.getUnderline());a.isFontFamilySet()&&(b=!0,c.fontFamily=a.getFontFamily());a.isFontWeightSet()&&(b=!0,c.fontWeight=a.getFontWeight());a.isFontStyleSet()&&(b=!0,c.fontStyle=a.getFontStyle());return b?c:null}).reduce((a,b,c)=>{null!=b&&(a[c]=b);return a},{});return{text:a.getText(),Xx:a.getAlignment(),dy:a.getIndent(),listType:a.getListType(),Zx:b}}),ly:d.getWrapWidth()}:null!=d.getRGBData&&
null!=d.getAlpha?(a=d.getRGBData(),Object.assign(Object.assign({},a),{a:d.getAlpha()})):a.fieldKey===f.CetModel.ID.HAS_COLOR_FILTER.COLOR_FILTER?d.getObjectType()===m.ColorFilterType.NO_COLOR_FILTER?null:d.getObjectType()===m.ColorFilterType.SOLID_COLOR_BLEND?(a=d.getBlendColor().getRGBData(),Object.assign(Object.assign({},a),{a:d.getBlendAlpha()})):d:a.fieldKey===f.CetModel.ID.OVERVIEW.OVERVIEW_BOUNDS?null:d,e=(b)=>{if(null==b)return null;const c=this.nb.getEntityById(b);if(null==c)return b+" broken!";
const e={};a&&c.getId().startsWith("genid_")||(e.Wx=c.getId());e.Ux=c.getDef().getName();null!=this.getParentEntity()&&this.getParentEntity().getId()!==this.getId()&&(e.Vx=this.getParentEntity().getId());c.getDef().getFieldDescriptors().forEach((a)=>{let b;try{if(c.hasComponent(a.fieldKey))if(a.kind===f.FieldDescriptorKind.ChildList||a.kind===f.FieldDescriptorKind.ScalarList||a.kind===f.FieldDescriptorKind.ReferenceList){const e=c.getComponent(a.fieldKey);b=[];for(const c of e.items())b.push(d(a,
c))}else{const e=c.get(a.fieldKey);b=d(a,e)}else b=void 0}catch(Tb){b=Tb}e[a.fieldKey.getName()]=b});return e};return e(this.getId())}setUntypedComponent(a,b){let c=this.getUntypedComponent(a),d=this.hasComponent(a,!0);if(d&&c===b)return this;if(null!=c&&d)try{c.dispose()}catch(g){u.LoggerModule.logException(K.Ja.logger,`${this.tsto()}/${a.getName()}`,"setUntypedComponent/dispose",g)}null!=b?(this.Pb[a._compKeyId]=b,b._compkey_=a,a=this.fk(b,a),b.setOnEntity(this,a),0===b.getVersion()?b.incrementVersion():
b.setVersion(b.getVersion())):delete this.Pb[a._compKeyId];return this}fk(a,b){let c=null==this.get(l.f.Kh)?!1:this.get(l.f.Kh),d=this.isDef(f.CetModel.ID.EDITOR_PATH_STEP);return Sb.xq.Ru(a)&&(!c&&this.hasComponent(l.f.MODEL)||d)||b.isTracked()}hasComponent(a,b=!1){return null!=this.getUntypedComponent(a,b)}getUntypedComponent(a,b=!1){let c=this.Pb[a._compKeyId];if(b)return c;null==c&&null!=this.Rg&&(c=this.Rg.getUntypedComponent(a));return c}getComponent(a,b=!1){return this.getUntypedComponent(a,
b)}getComponentVersion(a,b){a=this.getComponent(a,b);return null==a?0:a.getVersion()}getMutableComponent(a){let b=this.getUntypedComponent(a,!0);if(null!=b)return b;b=this.getUntypedComponent(a,!1);if(null==b)return null;b=b.createChildComponent();this.setUntypedComponent(a,b);return b}getOwnComponentKeyIds(){return Object.keys(this.Pb)}Ne(a){return this.Pb[a]._compkey_}discardOwnComponent(a){if(null!=this.getUntypedComponent(a,!0)){delete this.Pb[a._compKeyId];let b=this.fk(this.getUntypedComponent(a),
a);this.vi(a,f.ChangeType.RemoveComponent,b)}}vi(a,b,c){if(null!=this.nb){var d=this.nb.getScene().getSceneHierarchy();const e=0<d.Qd;d=0<d.uj.length;if(a.isDom&&(e||d)&&(this.hasComponent(l.f.PENDING_INSERT)||this.hasComponent(l.f.MODEL))&&this.getDef().getFieldDescriptors().some((b)=>b.fieldKey===a))throw b=e?"PdomUpdateOutsideCommand":"PdomUpdateFromSystem",c=`Not allowed to modify a persisted entity's persisted field ${this.tsto()}/${a.getName()}`,K.Ja.logger.error({trigger:"machine",action:b,
object:"ViewEntity",payload:{message:c}}),Error(c);this.nb.entityChanged(this,a,b,c)}}componentChanged(a,b){this.vi(a._compkey_,f.ChangeType.ModifyComponent,b)}dispose(a=!1){this.Yc=!0;if(!a){for(const b of Object.keys(this.Pb))if(null!=b){a=this.Pb[b];try{a.dispose()}catch(c){u.LoggerModule.logException(K.Ja.logger,`${this.tsto()}/${k.j.getComponentKey(a).getName()}`,"dispose component",c)}}this.vi(f.CetModel.getRemovedEntityCompKey(),f.ChangeType.RemoveEntity,!1)}}isDisposed(){return this.Yc}getLastEntityVersion(a){return this.Un.get(a)}setLastEntityVersion(a,
b){this.Un.set(a,b)}get(a,b=!1){a=this.getComponent(a,b);return null==a?null:a.getValue()}set(a,b,c=!1){var d=this.getComponent(a);null!=d&&d.equalsValue(b)&&c===d.ignoreOnCommit()||(d=this.getMutableComponent(a),null==d&&(d=a.isTracked()?new fb.il:new na.yd,this.setComponent(a,d)),d.setValue(b,!0,c));return this}forEach(a,b){a=this.getComponent(a);if(null!=a)for(const c of a.items())b(this.getEntityList().getEntityById(c))}forEachChild(a,b){this.forEach(a,b)}forEachRef(a,b){this.forEach(a,b)}getChildAt(a,
b){if(!this.hasComponent(a,!1))return null;a=this.getComponent(a,!1).getAt(b);return this.getEntityList().getEntityById(a)}getChild(a){if(!this.hasComponent(a,!1))return null;a=this.getComponent(a,!1);return this.getEntityList().getEntityById(a.getValue())}moveChild(a,b,c){K.Ja.ng(this,a).move(b,c);return this}insertChild(a,b,c){null==this.getEntityList().getEntityById(c.getId())&&this.getEntityList().addEntity(c);K.Ja.ng(this,a).insert(b,c.getId());return this}addChild(a,b){null==this.getEntityList().getEntityById(b.getId())&&
this.getEntityList().addEntity(b);K.Ja.ng(this,a).add(b.getId());return this}removeChildAt(a,b){K.Ja.ng(this,a).removeAt(b);return this}setChild(a,b){a=K.Ja.Vt(this,a);let c=null==b?null:b.getId();null!=b&&null==this.nb.getEntityById(c)&&this.nb.addEntity(b);a.setValue(c);return this}getWrapperChecked(a){return this.getMutableWrapperChecked(a)}getMutableWrapperChecked(a){if(!this.isDef(a.getDef()))throw`cannot get '${a.getDef().getName()}' for '${this.getDef().getName()}' `;return this.getMutableWrapper(a)}getMutableWrapper(a){let b=
a.getDef(),c=this.Eh.get(b);if(null==c){let a=this.get(f.CetModel.DEF());null!=a&&a.isDef(b)&&null!=a.W&&this.hasComponent(l.f.MODEL)&&(c=this.Eh.get(a),null==c&&(c=a.W.create(this),this.Eh.set(a,c)))}null==c&&(c=a.create(this));this.Eh.set(b,c);return c}getWrapper(a){return this.getMutableWrapper(a)}Cw(a){this.Rg=a}createChild(a){a=new K.Ja(a);a.Cw(this);return a}$w(){const a=this.id,b=[];for(let a of this.getOwnComponentKeyIds()){let c=this.Ne(a);const e=this.getUntypedComponent(c);c.isInherited()||
(b.push({key:c,Vs:e}),e.setOnEntity(null,!1),delete this.Pb[a])}return 0<b.length?(c)=>{c=c.getEntityById(a);for(const {key:a,Vs:e}of b)null!=c?(e.setOnEntity(c,c.fk(e,a)),c.Pb[a._compKeyId]=e):e.dispose()}:null}};var Ma={};Object.defineProperty(Ma,"__esModule",{value:!0});Ma.Hf=class{constructor(a,b,c,d){this.Qj=!1;this.Le=0;this.Fa=null;this.pb=new Map;this.entities=[];this.Bc=a;this.N=c;this.name=d;this.Fa=b;this.Fa.Bw(this);this.Ah=[];this.clear()}getName(){return this.name}getScene(){return this.Bc}lookup(a,
b){a=this.getEntityById(a);return null!=a&&a.isDef(b.getDef())?a.getMutableWrapper(b):null}getEntityById(a){let b=this.pb.get(a);null==b&&this.Qj&&(b=this.Bc.ub.get(a));return b}getEntitiesById(a){let b=[];for(let c of a)null!=this.getEntityById(c)&&b.push(this.pb.get(c));return b}getMutableEntitiesById(a){let b=[];for(let c of a)null!=this.getEntityById(c)&&b.push(this.pb.get(c));return b}asArray(){return this.entities}forEach(a){for(let b of this.entities)a(b)}forEachMutable(a,b){var c;try{if(null!=
b){if(!this.Fa.hj(b))throw Error("Trying to pull changes for uninitialized entity change tracker: "+b.getName()+" list: "+this.getName());for(let c of this.Fa.Qm(b))(null===c.getEntityList()||c.getEntityList()===this)&&b.select(c)&&a(c)}else for(let b of this.entities)a(b)}catch(d){u.LoggerModule.logException(this.Bc.logger,null!==(c=null===b||void 0===b?void 0:b.getName())&&void 0!==c?c:"","forEachMutable",d)}finally{null!=b&&this.Fa.wk(b)}}forChangedEntities(a,b){this.forChangedMutableEntities(a,
b)}forChangedMutableEntities(a,b){let c=[];if(!this.Fa.hj(b))throw Error("Trying to pull changes for uninitialized entity change tracker: "+b.getName()+" list: "+this.getName());for(let a of this.Fa.Qm(b))(null===a.getEntityList()||a.getEntityList()===this)&&b.select(a)&&c.push(a);try{0<c.length&&a(c)}catch(d){u.LoggerModule.logException(this.Bc.logger,b.getName(),"forEachColoredMutable",d)}finally{this.Fa.wk(b)}}getNumberOfEntities(){return this.entities.length}setEntityById(a,b){let c=null==this.pb.get(a);
if(c)this.pb.set(a,b),this.entities.push(b);else{this.pb.get(a).dispose();this.pb.set(a,b);for(let c=0,e=this.entities.length;c<e;c++)if(this.entities[c].getId()===a){this.entities[c]=b;break}}b.attachToEntityList(this);b.hasComponent(f.CetModel.PENDING_INSERT())||this.entityChanged(b,f.CetModel.getNewEntityCompKey(),f.ChangeType.AddEntity,c)}removeAt(a,b){let c=this.entities[a];this.pb.delete(c.getId());if(null!=this.Bc&&b.mc){const a=c.isDef(f.CetModel.ID.Z_OBJECT)||c.isDef(f.CetModel.ID.EDITOR_PATH_STEP)||
c.isDef(f.CetModel.ID.PATH_ACTION)||c.isDef(f.CetModel.ID.GROUP)||c.isDef(f.CetModel.ID.TEMPLATE_INFO);this.Bc.entityChanged(c,null,f.ChangeType.RemoveEntity,a)}this.entityChanged(c,f.CetModel.getRemovedEntityCompKey(),f.ChangeType.RemoveEntity,!1);this.entities.splice(a,1);b.dispose&&c.dispose()}addEntity(a){if(null!=this.pb.get(a.getId()))throw Error(`entity with id '${a.getId()}' already exists`);this.setEntityById(a.getId(),a)}deleteEntityDontDisposeInternal(a){this.hg(a,{dispose:!1,mc:!0})}deleteEntity(a){return this.hg(this.pb.get(a),
{dispose:!0,mc:!0})}hg(a,b){if(null!=a){let c=this.entities.indexOf(a);if(0<=c)return this.removeAt(c,b),a}return null}createEntity(a){let b=new K.Ja(a,null);this.setEntityById(a,b);return b}clear(){for(let a of this.entities.map((a)=>a.getId()))this.hg(this.pb.get(a),{dispose:!0,mc:!0});this.pb=new Map;this.entities=[];this.Ah=[];this.Fa.clearPendingChanges()}update(a){if(null!=this.N){var b=this.N.getEntityList();b.Le!==this.Le&&(this.clear(),this.Le=b.Le);b.forEach((b)=>{b=b.getId();if(!a.has(b)){var c=
this.getEntityById(b);null!=c&&c.getParentEntity()===this.N.getEntityById(b)||this.setEntityById(b,new K.Ja(b,this.N))}});this.Ah.forEach((a)=>a(this));this.Ah=[];for(var c=0;c<this.entities.length;){let a=this.entities[c];null!=a.getParentEntity()&&null==b.getEntityById(a.getParentEntity().getId())?this.removeAt(c,{dispose:!0,mc:!0}):c++}}}rollback(){for(let a=this.entities.length-1;0<=a;a--){const b=this.entities[a];b.Cc&&(b.Cc=!1);(b.hasComponent(l.f.PENDING_INSERT)||b.getDef()===f.CetModel.nilDef())&&
this.removeAt(a,{dispose:!0,mc:!1})}}commit(){let a=null==this.N?null:this.N.getEntityList();var b=!1;let c=[];for(let a=0,b=this.entities.length;a<b;a++){var d=this.entities[a];this.Lw(d)&&c.push(a);for(var e of d.getOwnComponentKeyIds()){var f=d.Ne(e);d.getUntypedComponent(f).ignoreOnCommit()&&d.discardOwnComponent(f)}}for(d=c.length-1;0<=d;){f=c[d];e=this.entities[f];let g=e.getParentEntity();null!=g?(g.Cc=e.Cc,this.removeAt(f,{dispose:!0,mc:!0})):(this.removeAt(f,{dispose:!1,mc:!0}),null!=a&&
(b=e.$w(),null!=b&&this.Ah.push(b),e.attachToEntityList(null),a.addEntity(e),b=!0));d--}return b}ew(){let a=[];for(let b=0,d=this.entities.length;b<d;b++)this.entities[b].Cc&&a.push(b);let b=a.length-1;for(;0<=b;){let c=a[b],d=this.entities[c];this.removeAt(c,{dispose:!0,mc:!0});d.attachToEntityList(null);b--}}Lw(a){return a.Cc?null!=this.N:a.hasComponent(l.f.PENDING_INSERT)?a.getDef()===f.CetModel.nilDef()?!0:this.pp(a):!1}pp(a){if(null==a)return!1;if(a.getDef()===f.CetModel.ID.PREZI||a.Cc)return!0;
a=a.get(f.CetModel.ENTITY_OWNER_ID());return null==a?!1:this.pp(this.getEntityById(a))}Mo(a){if(null!=a.getParentEntity())throw Error("entity cannot have parent");if(null!=this.getEntityById(a.getId()))throw Error("entity with id already exists");a.getEntityList().hg(a,{dispose:!1,mc:!1});a.attachToEntityList(null);this.addEntity(a)}tsto(){return"entity count: "+this.entities.length}entityChanged(a,b,c,d){b.shouldTriggerSystems()&&this.Fa.entityChanged(a,b._compKeyId);null!=this.Bc&&this.Bc.entityChanged(a,
b,c,d)}getAt(a){return this.entities[a]}startNewTracking(a,b,c){a=new Rb.er(a,b,c);this.Bp(a);return a}Bp(a){this.Fa.wk(a)}stopTracking(a){this.Fa.remove(a)}contains(a){return null!=a&&this.getEntityById(a.getId())===a}Dw(a){this.Fo=a}getPrezi(){if(null==this.N)return this.getEntityById(this.Fo);var a=this.N.getPrezi();if(null==a)return null;a=a.getId();let b=this.getEntityById(a);null==b&&(b=new K.Ja(a,this.N),this.addEntity(b),this.Fo=a);return b}getPreziW(){const a=this.getPrezi();return null!=
a?a.getMutableWrapper(f.CetModel.ID.PREZI.W):null}};Ma.Hf.fy=0;var gb={};Object.defineProperty(gb,"__esModule",{value:!0});gb.Sk=class{constructor(){this.ze=[];this.Zd=[];this.Mb=new Map}Bw(a){this.Jv=a}clearPendingChanges(){for(const a of this.Mb.keys())this.Mb.set(a,[])}addChildMonitor(a){-1===this.ze.indexOf(a)&&this.ze.push(a)}removeChildMonitor(a){a=this.ze.indexOf(a);-1!==a&&this.ze.splice(a,1)}hj(a){return this.Mb.has(a)}remove(a){this.Mb.delete(a);for(const b in this.Zd)if(this.Zd.hasOwnProperty(b)){let c=
this.Zd[b];for(let b=0;b<c.length;b++)if(c[b]===a){c.splice(b,1);break}}}Qm(a){if(!this.hj(a))throw Error("tracker not known by monitor!");return this.Tv(a)}wk(a){if(!this.Mb.has(a)){var b=a.getTriggerKeys().map((a)=>a._compKeyId);for(let c of b)b=this.Zd[c],null==b&&(b=[],this.Zd[c]=b),b.push(a);this.Mb.set(a,[])}}entityIdChanged(a,b,c=!0){a=this.Jv.getEntityById(a);null!=a&&this.entityChanged(a,b,c)}entityChanged(a,b,c=!0){this.lm(a,b,c);if(b===f.CetModel.getNewEntityCompKey()._compKeyId)for(b=
a,c=!0;null!=a;){for(let d of a.getOwnComponentKeyIds())this.lm(b,d,c);a=a.getParentEntity();c=!1}}lm(a,b,c=!0){var d=this.Zd[b];if(null!=d)for(let b of d)if(d=b.getRequiredKeysForIndirectTrigger(),c||0===d.length)this.Mb.get(b).push(a);else for(let c of d)a.hasComponent(c,!0)&&this.Mb.get(b).push(a);for(let c of this.ze)c.entityIdChanged(a.getId(),b,!1)}Tv(a){let b=this.Mb.get(a);const c=[];if(0===b.length)return c;for(let d of b)d.isDisposed()&&!a.isTrackingRemovedEntity()||d.__seen__||(c.push(d),
d.__seen__=!0);for(let a of b)a.__seen__=null;this.Mb.set(a,[]);return c}};var Ub={};Object.defineProperty(Ub,"__esModule",{value:!0});Ub.Hr=class{constructor(a){this.logger=u.LoggerModule.getLoggerManager().createLogger("PreziDiffer");this.ka=a;this.Mc=Math.pow(2,-40)}updatePrezi(a,b){var c=(a)=>a.getId();this.ka.getZObjectType()===e.MergeType.REPLACE?b.updateZObjects(a.getZObjects()):(this.ka.getZObjectType()===e.MergeType.REPLACE_DIFFED||this.ka.getZObjectType()===e.MergeType.REPLACE_DIFFED_CUSTOM)&&
this.ae(a.getZObjects(),b.getTypedZObjects(),c,this.ka.getZObjectStrategy(),(a,b)=>this.ux(a,b));c=(a)=>a.getStyleSelector().toString();this.ka.getStyleType()===e.MergeType.REPLACE?b.getTypedDocumentStyle().updateStyleDeclarations(a.getDocumentStyle().getStyleDeclarations()):(this.ka.getStyleType()===e.MergeType.REPLACE_DIFFED||this.ka.getStyleType()===e.MergeType.REPLACE_DIFFED_CUSTOM)&&this.ae(a.getDocumentStyle().getStyleDeclarations(),b.getTypedDocumentStyle().getTypedStyleDeclarations(),c,this.ka.getStyleStrategy(),
(a,b)=>this.qx(a,b));c=(a)=>a.getName();this.ka.getFontFamilyType()===e.MergeType.REPLACE?b.getTypedDocumentStyle().updateFontFamilies(a.getDocumentStyle().getFontFamilies()):(this.ka.getFontFamilyType()===e.MergeType.REPLACE_DIFFED||this.ka.getFontFamilyType()===e.MergeType.REPLACE_DIFFED_CUSTOM)&&this.ae(a.getDocumentStyle().getFontFamilies(),b.getTypedDocumentStyle().getTypedFontFamilies(),c,this.ka.getFontFamilyStrategy(),(a,b)=>this.updateFontFamily(a,b));c=(a)=>a.getName();this.ka.getFontClassType()===
e.MergeType.REPLACE?b.getTypedDocumentStyle().updateFontClasses(a.getDocumentStyle().getFontClasses()):(this.ka.getFontClassType()===e.MergeType.REPLACE_DIFFED||this.ka.getFontClassType()===e.MergeType.REPLACE_DIFFED_CUSTOM)&&this.ae(a.getDocumentStyle().getFontClasses(),b.getTypedDocumentStyle().getTypedFontClasses(),c,this.ka.getFontClassStrategy(),(a,b)=>this.updateFontClass(a,b));c=(a)=>a.getOnlineAssetUrl();a.getBackground().getLayerType()!==b.getBackground().getLayerType()&&b.getTypedBackground().updateLayerType(a.getBackground().getLayerType());
this.ka.getBackgroundType()===e.MergeType.REPLACE?b.getTypedBackground().updateLayers(a.getBackground().getLayers()):(this.ka.getBackgroundType()===e.MergeType.REPLACE_DIFFED||this.ka.getBackgroundType()===e.MergeType.REPLACE_DIFFED_CUSTOM)&&this.ae(a.getBackground().getLayers(),b.getTypedBackground().getTypedLayers(),c,this.ka.getBackgroundStrategy(),(a,b)=>this.lx(a,b))}ae(a,b,c,d,e){for(var g={},f=0;f<a.length();){var h=a.get(f);null!=d&&d.shouldIgnoreSourceObject(h)||(g[c(a.get(f))]=!0);f++}for(f=
h=0;h<b.length();){var k=b.get(h);null!=d&&d.shouldRetainDestObject(k)?(h++,f=h):null!=g[c(k)]?h++:b.remove(h)}for(g=0;g<a.length();)if(h=a.get(g),null!=d&&d.shouldIgnoreSourceObject(h))g++;else{k=this.bu(b,c(h),c);if(-1===k)b.insert(f,h),null!=d&&d.handleNewObject(h),f++;else{let a=b.getTyped(k);if(k!==f){let c=a.freeze(),e=a.getPDOMId();b.remove(k);k<f&&f--;b.insert(f,c);a=b.getTyped(f);null!=d&&d.handleMovedObject(c,e,a.getPDOMId())}f++;null!=d&&d.handleUpdatedObject(a,h);e(h,a)}g++}}bu(a,b,c){let d=
0;for(;d<a.length();){if(c(a.get(d))===b)return d;d++}return-1}ux(a,b){if(a.getObjectType()!==b.getObjectType())throw Error("Objects with the same id in source and target document must be of same object type!");this.Op(a,b);switch(a.getObjectType()){case m.ZObjectType.Z_TEXT:this.vx(a,b);break;case m.ZObjectType.Z_CIRCLE:this.nx(a,b);break;case m.ZObjectType.Z_IMAGE:this.Np(a,b)}}Op(a,b){a.getLocalToWorld().equalsWithin(b.getLocalToWorld(),this.Mc)||b.updateLocalToWorld(a.getLocalToWorld())}nx(a,
b){Math.abs(a.getRadius()-b.getRadius())>this.Mc&&b.updateRadius(a.getRadius())}Np(a,b){a.getOnlineAssetUrl()!==b.getOnlineAssetUrl()&&b.updateOnlineAssetUrl(a.getOnlineAssetUrl());a.getOnlineAssetId()!==b.getOnlineAssetId()&&b.updateOnlineAssetId(a.getOnlineAssetId());a.getAssetSourceFilename()!==b.getAssetSourceFilename()&&b.updateAssetSourceFilename(a.getAssetSourceFilename());a.getOfflineAssetId()!==b.getOfflineAssetId()&&b.updateOfflineAssetId(a.getOfflineAssetId())}vx(a,b){a.getText().equals(b.getText())||
b.updateText(a.getText())}qx(a,b){this.logger.info({action:"update",object:"style_declartion",trigger:"machine",payload:{selector:a.getStyleSelector().toString()}});a=a.getStyleBlock();b=b.getTypedStyleBlock();!a.hasAlpha()||b.hasAlpha()&&a.getAlpha()===b.getAlpha()||b.updateAlpha(a.getAlpha());!a.hasAlpha()&&b.hasAlpha()&&b.clearAlpha();!a.hasAttachPadding()||b.hasAttachPadding()&&a.getAttachPadding()===b.getAttachPadding()||b.updateAttachPadding(a.getAttachPadding());!a.hasAttachPadding()&&b.hasAttachPadding()&&
b.clearAttachPadding();!a.hasBackgroundAlpha()||b.hasBackgroundAlpha()&&a.getBackgroundAlpha()===b.getBackgroundAlpha()||b.updateBackgroundAlpha(a.getBackgroundAlpha());!a.hasBackgroundAlpha()&&b.hasBackgroundAlpha()&&b.clearBackgroundAlpha();!a.hasBackgroundColor()||b.hasBackgroundColor()&&a.getBackgroundColor().equals(b.getBackgroundColor())||b.updateBackgroundColor(a.getBackgroundColor());!a.hasBackgroundColor()&&b.hasBackgroundColor()&&b.clearBackgroundColor();!a.hasBackgroundPadding()||b.hasBackgroundPadding()&&
a.getBackgroundPadding()===b.getBackgroundPadding()||b.updateBackgroundPadding(a.getBackgroundPadding());!a.hasBackgroundPadding()&&b.hasBackgroundPadding()&&b.clearBackgroundPadding();!a.hasBorderAlpha()||b.hasBorderAlpha()&&a.getBorderAlpha()===b.getBorderAlpha()||b.updateBorderAlpha(a.getBorderAlpha());!a.hasBorderAlpha()&&b.hasBorderAlpha()&&b.clearBorderAlpha();!a.hasBorderColor()||b.hasBorderColor()&&a.getBorderColor()===b.getBorderColor()||b.updateBorderColor(a.getBorderColor());!a.hasBorderColor()&&
b.hasBorderColor()&&b.clearBorderColor();!a.hasBorderThickness()||b.hasBorderThickness()&&a.getBorderThickness()===b.getBorderThickness()||b.updateBorderThickness(a.getBorderThickness());!a.hasBorderThickness()&&b.hasBorderThickness()&&b.clearBorderThickness();!a.hasColor()||b.hasColor()&&a.getColor().equals(b.getColor())||b.updateColor(a.getColor());!a.hasColor()&&b.hasColor()&&b.clearColor();!a.hasDisplayBackground()||b.hasDisplayBackground()&&a.getDisplayBackground()===b.getDisplayBackground()||
b.updateDisplayBackground(a.getDisplayBackground());!a.hasDisplayBackground()&&b.hasDisplayBackground()&&b.clearDisplayBackground();!a.hasFontClass()||b.hasFontClass()&&a.getFontClass()===b.getFontClass()||b.updateFontClass(a.getFontClass());!a.hasFontClass()&&b.hasFontClass()&&b.clearFontClass();!a.hasGradEndAlpha()||b.hasGradEndAlpha()&&a.getGradEndAlpha()===b.getGradEndAlpha()||b.updateGradEndAlpha(a.getGradEndAlpha());!a.hasGradEndAlpha()&&b.hasGradEndAlpha()&&b.clearGradEndAlpha();!a.hasGradEndColor()||
b.hasGradEndColor()&&a.getGradEndColor().equals(b.getGradEndColor())||b.updateGradEndColor(a.getGradEndColor());!a.hasGradEndColor()&&b.hasGradEndColor()&&b.clearGradEndColor();!a.hasGradStartAlpha()||b.hasGradStartAlpha()&&a.getGradStartAlpha()===b.getGradStartAlpha()||b.updateGradStartAlpha(a.getGradStartAlpha());!a.hasGradStartAlpha()&&b.hasGradStartAlpha()&&b.clearGradStartAlpha();!a.hasGradStartColor()||b.hasGradStartColor()&&a.getGradStartColor().equals(b.getGradStartColor())||b.updateGradStartColor(a.getGradStartColor());
!a.hasGradStartColor()&&b.hasGradStartColor()&&b.clearGradStartColor();!a.hasFillType()||b.hasFillType()&&a.getFillType()===b.getFillType()||b.updateFillType(a.getFillType());!a.hasFillType()&&b.hasFillType()&&b.clearFillType();!a.hasPadding()||b.hasPadding()&&a.getPadding()===b.getPadding()||b.updatePadding(a.getPadding());!a.hasPadding()&&b.hasPadding()&&b.clearPadding();!a.hasRadius()||b.hasRadius()&&a.getRadius()===b.getRadius()||b.updateRadius(a.getRadius());!a.hasRadius()&&b.hasRadius()&&b.clearRadius();
!a.hasThickness()||b.hasThickness()&&a.getThickness()===b.getThickness()||b.updateThickness(a.getThickness());!a.hasThickness()&&b.hasThickness()&&b.clearThickness()}lx(a,b){this.logger.info({action:"update",object:"background_layer",trigger:"machine",payload:{url:a.getOnlineAssetUrl().toString()}});this.Op(a,b);this.Np(a,b);Math.abs(a.getDepth()-b.getDepth())>this.Mc&&b.updateDepth(a.getDepth());Math.abs(a.getFadeScale()-b.getFadeScale())>this.Mc&&b.updateFadeScale(a.getFadeScale())}updateFontFamily(a,
b){this.logger.info({action:"update",object:"font_family",trigger:"machine",payload:{name:a.getName().toString()}});let c=(a)=>a.getFontSrc();this.ka.getFontFaceType()===e.MergeType.REPLACE?b.updateFontFaces(a.getFontFaces()):(this.ka.getFontFaceType()===e.MergeType.REPLACE_DIFFED||this.ka.getFontFaceType()===e.MergeType.REPLACE_DIFFED_CUSTOM)&&this.ae(a.getFontFaces(),b.getTypedFontFaces(),c,this.ka.getFontFaceStrategy(),(a,b)=>this.mx(a,b))}mx(a,b){this.logger.info({action:"update",object:"font_face",
trigger:"machine",payload:{font_src:a.getFontSrc().toString()}});a.getFontStyle()!==b.getFontStyle()&&b.updateFontStyle(a.getFontStyle());a.getFontWeight()!==b.getFontWeight()&&b.updateFontWeight(a.getFontWeight())}updateFontClass(a,b){this.logger.info({action:"update",object:"font_class",trigger:"machine",payload:{name:a.getName().toString()}});a.getFontStyle()!==b.getFontStyle()&&b.updateFontStyle(a.getFontStyle());a.getFontWeight()!==b.getFontWeight()&&b.updateFontWeight(a.getFontWeight());a.getFontFamily()!==
b.getFontFamily()&&b.updateFontFamily(a.getFontFamily())}};var za={};Object.defineProperty(za,"__esModule",{value:!0});var Z;(function(a){a[a.Oh=0]="No";a[a.Tf=1]="Yes";a[a.jl=2]="Unknown"})(Z=za.cr||(za.cr={}));class Wc{constructor(){this.cd=Z.Oh;this.version=0}getVersion(){return this.version}vf(a,b,c){this.commit(a,b,L.td.ge);b=b.getParentScene();b.Ba.vf(a,b,c)}getUncommitedChanges(a){let b=[];this.gn(a,b);return b}Wi(a){this.cd===Z.jl&&(this.cd=this.gn(a,null)?Z.Tf:Z.Oh);return this.cd===Z.Tf}entityChanged(a,
b,c,d){d===f.ChangeType.ModifyComponent?this.cd!==Z.Tf&&(a=a.getParentScene(),null!=a&&null!=a.getEntityById(b.getId())&&this.Rl(b,c)&&(this.cd=Z.Tf)):this.cd=Z.jl}Rl(a,b){return b.isInherited()&&a.getDef().hasField(b)}gn(a,b){var c=a.getParentScene();if(null==c)return!1;let d=!1;for(let e of c.getEntityList().asArray())if(c=a.getEntityById(e.getId()),null!=c)for(let a of c.getOwnComponentKeyIds()){let e=c.Ne(a);if(this.Rl(c,e))if(d=!0,null!=b)b.push(""+c.tsto()+", "+e.getName());else return d}return d}undo(a){this.version++;
a=a.getParentScene();return a.Ba.undo(a)}rollback(a){a.getEntityList().rollback();a.getEntityList().forEachMutable((a)=>{if(e.Cet.hasPdomComponent(a))for(let b of a.getOwnComponentKeyIds()){let c=a.Ne(b),e=a.getUntypedComponent(c);if(e.ignoreOnCommit()||c.isInherited())a.discardOwnComponent(c),e.dispose()}})}commit(a,b){this.version++;let c=!1;a=b.getParentScene();null!=a&&a.getEntityList().forEachMutable((a)=>{let d=b.getEntityById(a.getId());if(null!=d){let b={},e={};for(let a of d.getOwnComponentKeyIds()){let g=
d.Ne(a),f=d.getUntypedComponent(g);f.ignoreOnCommit()?(d.discardOwnComponent(g),c=!0):g.isInherited()&&(b[a]=g,e[a]=f,d.discardOwnComponent(g),c=!0)}for(let c in b)b.hasOwnProperty(c)&&a.setUntypedComponent(b[c],e[c])}});this.cd=Z.Oh;a=b.getEntityList().commit();return c||a}redo(a){this.version++;a=a.getParentScene();return a.Ba.redo(a)}}za.Pr=Wc;class Xc{constructor(){}getVersion(){return 0}vf(){}getUncommitedChanges(){return[]}Wi(){return!1}entityChanged(){}commit(a,b){b.getEntityList().forEachMutable((a)=>
{a.hasComponent(f.CetModel.PENDING_INSERT())&&(a.discardOwnComponent(f.CetModel.PENDING_INSERT()),b.getEntityList().entityChanged(a,f.CetModel.getNewEntityCompKey(),f.ChangeType.AddEntity,!0))});return!1}undo(){return!1}redo(){return!1}rollback(){}}za.sr=Xc;var Vb={};Object.defineProperty(Vb,"__esModule",{value:!0});Vb.Qr=class{constructor(a){this.we=-1;this.ab={};this.kc=[];this.dd=!1;this.fw=a.getEntityList().startNewTracking("tweener:"+a.getName(),[f.CetModel.getRemovedEntityCompKey()],()=>!0)}gw(a){this.kc=
this.kc.filter((b)=>b.Zc!==a.entity.getId()||b.Kp!==a.Gi.getId());const b=this.hm(a.entity,a.Gi,a.ta,a.Pn);this.kc.push({Kp:b.getId(),Zc:a.entity.getId(),rk:b})}fadeIn(a,b,c,d){this.fade(a,b,0,1,c,d)}fadeOut(a,b,c,d){this.fade(a,b,1,0,c,d)}fade(a,b,c,d,e,f){b(c);c=new wa.se(String(x.Utils.nextSerialId()),(new Date).getTime(),{alpha:c},{alpha:d},e,[],(a)=>{b(a.alpha)});null!=f&&(c.onEnd=f);this.hi(a.getId(),c,!1)}Qi(a,b){let c=Number.POSITIVE_INFINITY;for(let d of a)d.jj(b)?c=0:(a=d.getStartTime()-
b,a<c&&(c=a));return c}getNextFrameTime(){if(this.dd)return 0;let a=(new Date).getTime(),b=0<=this.we?this.we:Number.POSITIVE_INFINITY;for(let c of Object.keys(this.ab)){let d=this.ab[c];null!=d&&(b=Math.min(b,this.Qi(d,a)))}return b===Number.POSITIVE_INFINITY?-1:b}needsFrameImmediately(){return 0===this.getNextFrameTime()}update(a){a.getEntityList().forChangedMutableEntities((b)=>{for(let c of b)b=c.getId(),null==a.getEntityById(b)&&delete this.ab[b]},this.fw);var b=x.Utils.createLinkedList(),c=
(new Date).getTime();this.dd=!1;for(var d of Object.keys(this.ab))for(var e=this.ab[d],f=0;f<e.length;){let a=e[f];a.Kn()?(null!=a.qb&&(a.qb(),a.qb=null),a.step(a.Ni()),b.add(a),e.splice(f,1)):(a.jj(c)&&(null!=a.qb&&(a.qb(),a.qb=null),a.step(c),this.dd=!0),a.En(c)?(b.add(a),e.splice(f,1)):f++)}for(let a of b)if(null!=a.onEnd)a.onEnd();for(b=0;b<this.kc.length;b++)if(c=this.kc[b],d=this.ab[c.Zc],null!=d)for(e=0;e<d.length;)if(f=d[e],f.getId()===c.Kp){c.rk.iw(f.js);d.splice(e,1);break}else e++;for(b=
0;b<this.kc.length;b++)c=this.kc[b],this.hi(c.Zc,c.rk,!1);this.kc=[]}reset(){this.ab={};this.dd=!1;this.kc=[]}qv(a,b){b=this.ab[b];return null!=b?null!=b.find((b)=>b.getId()===a):!1}dn(a){a=this.ab[a.getId()];return null!=a?a.length:0}addEntityTween(a){const b=this.hm(a.entity,a.Gi,a.ta,a.Pn);this.hi(a.entity.getId(),b,a.ta.getTweenMode()===e.TweenMode.IMMEDIATE)}hm(a,b,c,d){const e=a.getEntityList();let f=a.getId(),y=b.getPropertyNames(),h=b.getStartValues(),k=b.getEndValues(),l={},m={};for(let a=
0,b=y.length;a<b;a++)l[y[a]]=h[a],m[y[a]]=k[a];let n=b.getOnCurrentValues(c,f),p=new wa.se(b.getId(),b.shouldUseUserStartTime()?Number.MAX_SAFE_INTEGER:(new Date).getTime()+b.getStartDelay(),l,m,b.getDuration(),b.getTweenedComponents(),(a)=>{n((b)=>a[b])},b.getEase());b.shouldUseUserStartTime()&&(this.we=0,setTimeout(()=>{p.zs((new Date).getTime()+b.getStartDelay());this.we=-1},this.we));null!=b.getStartUpdate()&&(p.qb=()=>{b.getStartUpdate()(c)});p.onEnd=()=>{null!=b.getEndUpdate()&&b.getEndUpdate()(c);
if(d){const a=c.getEntityById(f);null!=a&&b.cleanupTweenedComponents(a)}};if(d){let c=b.getTweenedComponentsVersion(a);p.Kn=()=>{const a=e.getEntityById(f);return null==a||c!==b.getTweenedComponentsVersion(a)}}b.shouldFillBeforeStart()&&p.step(p.getStartTime()-1);b.isRecurring()&&p.Ew(b.flipBeforeRecurring(),b.getDelayBeforeRecurring(),b.getNumberOfRecurrings());return p}hi(a,b,c){if(c){if(null!=b.qb&&b.qb(),b.step(b.Ni()),null!=b.onEnd)b.onEnd()}else c=this.ab[a],null==c&&(c=[],this.ab[a]=c),c.push(b)}So(a,
b=null,c=null){let d=this.ab[a.getId()];if(null!=d){var e=[];for(let a of d)if(this.Qe(b,a)&&(null==c||c===a.getId())){null!=a.qb&&(a.qb(),a.qb=null);a.step(a.Ni());if(null!=a.onEnd)a.onEnd();e.push(a)}b=d.filter((a)=>-1===e.indexOf(a));this.ab[a.getId()]=b}}Qe(a,b){if(null==a)return!0;for(let c of a)if(b.Qe(c))return!0;return!1}};var Na={};Object.defineProperty(Na,"__esModule",{value:!0});Na.Sf=class{constructor(a,b,c){this.i=a;this.pa=b;this.ed=c}isInstant(a){return 0===a.duration&&0===a.delay}isVisible(a){a=
a.get(this.pa);return null!=a&&a.isEnabled&&0<a.alpha}getAlpha(a){return a.get(this.pa).alpha}hasVisibilityKey(a){return null!=a.get(this.pa)}discardVisibilitykey(a){a.discardOwnComponent(this.pa)}setVisibility(a,b,c){this.ig(a,c,c,b,k.j.getAnimationData(e.AnimationType.INSTANT));a.set(this.ed,{visibility:{isEnabled:b,alpha:c},animation:{duration:0,delay:0}})}hide(a){let b=a.get(this.ed);if(null==b||b.visibility.isEnabled||!this.isInstant(b.animation))this.ig(a,1,0,!1,k.j.getAnimationData(e.AnimationType.INSTANT)),
a.set(this.ed,{visibility:{isEnabled:!1,alpha:0},animation:{duration:0,delay:0}})}show(a){let b=a.get(this.ed);null!=b&&b.visibility.isEnabled&&this.isInstant(b.animation)||(this.ig(a,0,1,!0,k.j.getAnimationData(e.AnimationType.INSTANT)),a.set(this.ed,{visibility:{isEnabled:!0,alpha:1},animation:{duration:0,delay:0}}))}fade(a,b,c,d){var e,f,y=a.get(this.ed);if(null==y||y.visibility.isEnabled!==b||this.isInstant(c)&&!this.isInstant(y.animation))y=null!==(f=null===(e=a.get(this.pa))||void 0===e?void 0:
e.alpha)&&void 0!==f?f:1,this.ig(a,y,b?1:0,b,c,d),a.set(this.ed,{visibility:{isEnabled:b,alpha:1},animation:c})}fadeOut(a,b,c){this.fade(a,!1,b,c)}fadeIn(a,b,c){this.fade(a,!0,b,c)}blinking(a,b){a.set(this.pa,{isEnabled:!0,alpha:1});let c=null!=b.delayBeforeRecurring?b.delayBeforeRecurring:Na.Sf.uq,d=this.i.getTweener();d.removeTweens(a.getId(),[this.pa]);let e=k.j.createAlphaTween("blinking-"+this.pa.getName(),b.duration,1,0,this.pa);e.setStartDelay(b.delay);e.setFillBeforeStart(!0);e.setRecurring(!0,
c);d.addTween(a.getId(),e)}removeVisibilityTweens(a){this.i.getTweener().removeTweens(a.getId(),[this.pa])}ig(a,b,c,d,e,f){let g=e.duration,r=null==e.delay?0:e.delay,h=this.i.getTweener();if(0===r&&0===g)h.removeTweens(a.getId(),[this.pa]),a.set(this.pa,{isEnabled:d,alpha:c}),null!=f&&f(this.i);else{h.removeTweens(a.getId(),[this.pa]);let y=h.getTweenedValue(a.getId(),this.pa);a.set(this.pa,{isEnabled:d,alpha:c});null==y||0===e.duration&&0===r||(b=y.alpha);1E-8<Math.abs(b-c)&&(c=k.j.createAlphaTween("alpha-"+
this.pa.getName(),g,b,c,this.pa),c.setStartDelay(r),c.setFillBeforeStart(!0),null!=f&&c.setEndUpdate(f),h.addTween(a.getId(),c))}}};Na.Sf.uq=450;var Wb={};Object.defineProperty(Wb,"__esModule",{value:!0});Wb.Cq=class{constructor(a,b,c){this.Zn={};this.Ic={};this.ta=a;this.Tb=b;this.La=c}setAnimationScene(a){this.ta=a}Qv(a,b,c){let d=this.Tb.getEntityById(a);if(b.shouldDisableHittest()&&this.ta.getTweenMode()!==e.TweenMode.IMMEDIATE){let e=d.get(k.j.getTemporaryEntityHittestDisabledKey());null==e&&
(e=0);c||++e;d.set(k.j.getTemporaryEntityHittestDisabledKey(),e,!0);let f=b.getEndUpdate();b.setEndUpdate((b)=>{null!=f&&f(b);b=this.Tb.getEntityById(a);if(null!=b){let a=b.get(k.j.getTemporaryEntityHittestDisabledKey())-1;b.set(k.j.getTemporaryEntityHittestDisabledKey(),a,!0)}})}return{entity:d,Gi:b,ta:this.ta,Pn:this.Tb!==this.ta}}addTween(a,b,c=!1){var d=this.Tb.getEntityById(a);null!=d&&(d=this.La.qv(b.getId(),d.getId()),a=this.Qv(a,b,d&&c),d?c?this.La.gw(a):(this.La.So(a.entity,null,b.getId()),
this.La.addEntityTween(a)):this.La.addEntityTween(a))}removeTweens(a,b){let c=this.Tb.getEntityById(a);null!=c&&this.La.So(c,b);if(null!=b&&(a=this.ta.getEntityById(a),null!=a))for(let c of b)a.discardOwnComponent(c)}getTweenCount(a){a=this.Tb.getEntityById(a);return null!=a?this.La.dn(a):0}getTweenedValue(a,b){a=this.ta.getEntityById(a);return null!=a?a.get(b,!0):null}getTweenedComponent(a,b){a=this.ta.getEntityById(a);return null!=a?a.getComponent(b,!0):null}createVisibilityAnimationHelper(a){let b=
this.Mi(a);a=a+"-"+this.Tb.getName()+"-LastVisibilityKey";if(null!=this.Ic[b])return new Na.Sf(this.Tb,this.Ic[b],this.Zn[a]);let c=f.CetModel.createValueComponentKey(b,!1,!1),d=f.CetModel.createValueComponentKey(a,!1,!1);this.Ic[b]=c;this.Zn[a]=d;return new Na.Sf(this.Tb,c,d)}Mi(a){return a+"-"+this.Tb.getName()+"-VisibilityKey"}getVisibilityKeys(){let a=[];for(let b in this.Ic)this.Ic.hasOwnProperty(b)&&a.push(this.Ic[b]);return a}hasVisibilityKey(a,b){b=this.Mi(b);a=this.ta.getEntityById(a);b=
this.Ic[b];return null!=a&&null!=b?a.hasComponent(b):!1}getVisibilityKey(a){a=this.Mi(a);return this.Ic[a]}getTweenMode(){return this.ta.getTweenMode()}getNextFrameTime(){return this.La.getNextFrameTime()}needsFrameImmediately(){return this.La.needsFrameImmediately()}};var L={};Object.defineProperty(L,"__esModule",{value:!0});var pa;(function(a){a[a.ge=0]="Commit";a[a.Uh=1]="Sync";a[a.Qf=2]="UntrackedCommitAndSync"})(pa=L.td||(L.td={}));var aa;(function(a){a[a.None=0]="None";a[a.Of=1]="System";a[a.Ef=
2]="Cmd"})(aa=L.dr||(L.dr={}));class Pc{constructor(a,b){this.jw=a;this.changes=b}Ym(){return"Uncommitted changes after sync, retry: "+this.jw+", changes:\n"+this.changes.join("\n")}}L.Tx=Pc;class Ta{constructor(a,b){this.delegate=a;this.onEnd=b}}L.Ef=Ta;class da{constructor(a,b=da.At){this.intent=a;this.Av=b;this.snapshotAfter=this.snapshotBefore=da.am;this.id=da.gd++}static At(){}finish(a){this.Av(a)}toString(){return`Transaction#${this.id}'${this.intent.name}'`}}da.gd=0;da.am={reset:()=>{}};class Zc{constructor(a,
b,c,d,f=!1){this.Jl=[];this.ca=null;this.Se=n.Bacon.newBus();this.In=this.Se.toProperty(!1);this.In.onValue(()=>{});this.Ag=!1;this.Fe=null;this.Pe=!1;this.Ch=[];this.ub=new Map;this.Sd=[];this.yc=aa.None;this.wf=!1;this.logger=u.LoggerModule.getLoggerManager().createLogger("UpdateableSceneImpl");this.gb=a;this.name=b;c=c||{updateList:[]};this.ra={initList:c.initList||[],inflateList:c.inflateList||[],updateList:c.updateList||[],updateOnceList:c.updateOnceList||[],preRenderList:c.preRenderList||[],
fixerList:c.fixerList||[],geometryUpdateList:null!=c.geometryUpdateList?c.geometryUpdateList:(c.updateList||[]).concat(c.updateOnceList||[])};this.N=d;null!=this.N&&this.N.cw(this);f&&d.setAnimationScene(this);this.Ec=[];this.Vj=n.Bacon.newBus();this.Lp=e.TweenMode.ANIMATION;null!=d?(d.onViewChange(()=>this.markViewChanged()),this.entities=new Ma.Hf(this,this.Ri(),this.N,this.name+"-entitylist"),d.getImmediateChangeStream(null).onValue((a)=>{this.Ec=this.Ec.concat(a)})):this.entities=new Ma.Hf(this,
this.Ri(),null,this.name+"-entitylist");this.La=new Vb.Qr(this);this.ak(new za.Pr);this.Zo();this.wp()}tsto(){const a=(a)=>(null==a?[]:a).map((a)=>a.getName());return{name:this.getName(),ra:{initList:a(this.ra.initList),inflateList:a(this.ra.inflateList),updateList:a(this.ra.updateList),updateOnceList:a(this.ra.updateOnceList),preRenderList:a(this.ra.preRenderList),fixerList:a(this.ra.fixerList)},children:this.Jl.map((a)=>a.tsto())}}getSceneHierarchy(){return this.gb}getRootScene(){return this.gb.getRootScene()}entityChanged(a,
b,c,d){d&&this.Ec.push({kind:e.ChangeEventKind.Entity,selector:null,def:a.getDef(),type:c,entity:a,componentKey:b});this.Ba.entityChanged(this,a,b,c)}getParentScene(){return this.N}ak(a){this.Ba=a}getUncommitedChanges(){return this.Ba.getUncommitedChanges(this)}hasAnyUncommitedChange(){return this.Ba.Wi(this)}onViewChange(a){this.Ch.push(a);return()=>{let b=this.Ch.indexOf(a);-1<b&&this.Ch.splice(b,1)}}markViewChanged(){for(let a of this.Ch)a()}getName(){return this.name}getEntityList(){return this.entities}getEntityById(a){return this.entities.getEntityById(a)}forEachEntities(a){this.getEntityList().forEach(a)}lookup(a,
b){return this.entities.lookup(a,b)}runSystems(a){this.Ag=!0;let b=this.hasAnyUncommitedChange(),c=[];switch(a){case e.UpdatePhase.GEOMETRY:c=this.ra.geometryUpdateList;break;case e.UpdatePhase.DOCUMENT:c=[...this.ra.updateList,...this.ra.updateOnceList];break;case e.UpdatePhase.UPDATE:c=this.ra.updateList;break;case e.UpdatePhase.UPDATE_ONCE:c=this.ra.updateOnceList;break;case e.UpdatePhase.FIXER:c=this.ra.fixerList;break;case e.UpdatePhase.PRE_RENDER:c=this.ra.preRenderList}for(let b of c||[])b.changesPdomComponents(a)||
this.getSceneHierarchy().uj.push(b),this.um(b,"update",()=>{b.update(this,a)}),b.changesPdomComponents(a)||this.getSceneHierarchy().uj.pop();!b&&this.hasAnyUncommitedChange()&&this.yc!==aa.Ef&&(this.yc=aa.Of);this.Ag=!1}executeNoDomBatchUpdate(a){this.markViewChanged();this.Gc(e.UpdatePhase.UPDATE_ONCE,!1,[this.po(a)])}requestNoDomBatchUpdate(a,b){this.Sd.push(this.po(a,b));this.markViewChanged()}po(a,b){return new Ta(()=>{try{this.getSceneHierarchy().Qd++,a(this),this.getSceneHierarchy().Qd--}catch(c){throw this.getSceneHierarchy().Qd--,
this.reset(!0),c;}},b)}rbuForTest(a,b){return this.Lj((b)=>{a(b,this)},b)}Lj(a,b){this.Sd.push(new Ta(()=>{a(this,this.ca)},b));this.markViewChanged()}documentMerge(a,b,c){this.Lj(()=>{this.Ba.vf(Y(a,"documentMerge"),this,(a)=>{(new Ub.Hr(c)).updatePrezi(b,a)});this.update()});this.update()}triggerSync(){this.rc_DONT_USE_THIS_METHOD_DISCUSS_WITH_API_TEAM(Y(this.ca,"triggerSync"))}requestCommitForTest(){return this.Po(Y(this.ca,"requestCommitForTest"))}rc_DONT_USE_THIS_METHOD_DISCUSS_WITH_API_TEAM(a){this.Il(a.message);
return this.Po(a)}Po(a){return new Promise((b)=>{this.Sd.push(this.Ol(a,b));this.markViewChanged()})}Ol(a,b){if(this.Ag)throw Error("cannot requestCommit from a system");return new Ta(()=>{this.Pl(a,pa.ge);null!=this.ta&&(this.updateEntitiesFromParentScene(),this.ta.updateEntitiesFromParentScene())},b)}Pl(a,b){const c=this.Ba.commit(a,this,b);null==this.N||b===pa.ge&&!c||(x.Utils.assert(0===this.N.ub.size,"pendingRemoves on parent scene should be empty"),this.ub.forEach((a)=>a.attachToEntityList(this.N.getEntityList())),
this.N.ub=new Map(this.ub),this.N.$d(a,b),this.N.ub.clear(),this.ub.forEach((a)=>a.attachToEntityList(this.getEntityList())));this.ub.clear();this.wf=this.wf||this.yc===aa.Ef;this.yc=aa.None}$d(a,b){this.Pl(a,b);this.tk()}sm(){this.commit(new da({name:"commit for test",userIntentId:"",trigger:"machine"}))}commit(a){if(this.Ag)throw Error("cannot commit from a system");this.$d(Y(a,"commit"),pa.ge)}update(a=e.UpdatePhase.UPDATE,b=!0){a===e.UpdatePhase.UPDATE&&this.Gc(e.UpdatePhase.UPDATE_ONCE,b);a===
e.UpdatePhase.FIXER?this.Gc(e.UpdatePhase.FIXER,b):(null!=this.N&&this.N.update(a),a===e.UpdatePhase.TWEEN?this.La.update(this):(a===e.UpdatePhase.PRE_RENDER||a===e.UpdatePhase.UPDATE_ONCE)&&this.runSystems(a))}Gc(a,b,c=null){null==c&&(c=this.Sd);null!=this.N&&this.N.Gc(a,!1);let d=this.Ba.getVersion();for(;;){this.Io(b,c);this.runSystems(a);if(d!==this.Ba.getVersion()||this.gb.Bs===this&&this.yc===aa.Of)this.yc===aa.Of&&this.wf?this.$d(Y(this.ca,"system updates after command"),pa.Uh):this.yc!==aa.Of||
this.wf?this.$d(Y(this.ca,"command"),pa.Uh):this.$d(Y(this.ca,"system updates without command"),pa.Qf),this.Qs(b);d=this.Ba.getVersion();this.wf=!1;if(0===c.length)break}}Qs(a){for(let b=0;1E3>b;b++)if(0<this.Sd.length&&this.Io(a,this.Sd),this.hasAnyUncommitedChange()){let a=new Pc(b+1,this.Ba.getUncommitedChanges(this)),d={action:"cleanupUncommittedChangesAfterSync",object:"UpdateableSceneImpl",trigger:"machine",payload:{message:a.Ym()}};if(999===b)throw a;0===b?this.logger.warn(d):this.logger.error(d);
this.$d(Y(this.ca,"cleanupUncommittedChangesAfterSync"),pa.Qf)}}Ij(){null!=this.N&&this.N.Ij();this.$v()}$v(){var a={},b={};let c={},d=[];for(let e=0;e<this.Ec.length;e++){let g=this.Ec[e],r=null==g.entity?null:g.entity.getId();if(null!=r)if(g.type===f.ChangeType.RemoveEntity){if(null!=this.entities.getEntityById(r)){a[r]=g;continue}}else if(g.type===f.ChangeType.AddEntity){if(null!=a[r]){b[r]=a[r];delete a[r];continue}}else if(g.type===f.ChangeType.ModifyComponent||g.type===f.ChangeType.RemoveComponent){let a=
c[r];null==a&&(a={});a[g.componentKey.getName()]=g;c[r]=a;continue}d.push(g)}this.Ec=[];for(let b in a)a.hasOwnProperty(b)&&d.push(a[b]);for(let c in b)b.hasOwnProperty(c)&&(a=b[c],a={kind:e.ChangeEventKind.Entity,type:f.ChangeType.ArrayPositionChange,entity:a.entity,selector:null,def:null==a.entity?null:a.entity.getDef(),componentKey:a.componentKey},d.push(a));for(var g in c)if(c.hasOwnProperty(g)){b=c[g];for(var r in b)b.hasOwnProperty(r)&&d.push(b[r])}g=[];for(let a in c)c.hasOwnProperty(a)&&(r=
this.getEntityById(a),null!=r&&g.push(r));0<g.length&&d.push({kind:e.ChangeEventKind.EntitiesModified,type:f.ChangeType.ModifyEntity,entity:null,entities:g,selector:null,def:null,componentKey:null});0<d.length&&this.Vj.push(d)}Io(a,b){let c=[];for(;;){for(this.tk();0<b.length;){let a=b[0];b.shift();let e=this.hasAnyUncommitedChange();try{a.delegate()}catch(r){if(u.LoggerModule.logException(this.logger,this.name,"processPendingCommands",r),this.Fd)throw r;}!e&&this.hasAnyUncommitedChange()&&(this.yc=
aa.Ef);null!=a.onEnd&&c.push(a.onEnd);this.tk()}a&&this.Ij();this.Uv(c);if(0===b.length)break}}tk(){this.updateEntitiesFromParentScene();this.runSystems(e.UpdatePhase.UPDATE)}Uv(a){for(;0<a.length;){let b=a[0];a.shift();b()}}updateEntitiesFromParentScene(){this.entities.update(this.ub)}withPendingRemove(a,b){try{this.entities.Qj=!0;const c=this.ub.get(a);null!=c&&b(c)}finally{this.entities.Qj=!1}}reset(a=!0){this.Ll(a);for(const a of this.vg())a.reset(this);this.Zo();this.wp();this.Pe=!1;this.updateEntitiesFromParentScene();
this.runSystems(e.UpdatePhase.UPDATE);this.runSystems(e.UpdatePhase.UPDATE_ONCE);this.La.reset()}kill(){this.Ll(!0)}Ll(a){if(null!=this.ca){const a=this.ca;this.ca=null;try{a.finish({reason:e.FinishEventKind.AbortTransaction})}catch(c){u.LoggerModule.logException(this.logger,"reset.abortTransaction","UpdateableSceneImpl",c)}}a&&this.entities.clear();this.Se.push(!1)}plugChangeStream(a){a.onValue((a)=>{this.Ec=this.Ec.concat(a)})}setIdleChangeStream(a){this.Yi=a}getIdleChangeStream(a){if(null==this.Yi)throw Error("Idle stream is not available for Scene: "+
this.name);return null==a?this.Yi:this.Ul(this.Yi,a)}getImmediateChangeStream(a){return null==a?this.Vj:this.Ul(this.Vj,a)}Ul(a,b){return a.map((a)=>a.filter((a)=>a.kind===b)).filter((a)=>0<a.length)}deleteEntitiesById(a){for(var b=0;b<a.length;b++){const c=this.getEntityById(a[b]);null!=c&&c.getDef().getFieldDescriptors().forEach((b)=>{switch(b.kind){case f.FieldDescriptorKind.Child:var d=c.getUntypedComponent(b.fieldKey);null!=d&&a.push(d.getValue());break;case f.FieldDescriptorKind.ChildList:b=
c.getUntypedComponent(b.fieldKey);if(null!=b)for(d of b.items())a.push(d);break;case f.FieldDescriptorKind.Reference:case f.FieldDescriptorKind.ReferenceList:case f.FieldDescriptorKind.ScalarList:case f.FieldDescriptorKind.Scalar:break;default:x.Utils.assertNever(b.kind)}})}for(let c of a)b=this.getEntityList().deleteEntity(c),null!=b&&this.ub.set(c,b)}ad(){let a=this.getPrezi();return null==a?null:a.getMutableComponent(l.f.oe)}executeRedo(a){this.execute(this.createIntent(Object.assign({name:"redo"},
a)),()=>{this.Ba.redo(this)&&null!=this.N&&this.N.Gc(e.UpdatePhase.UPDATE_ONCE,!1)})}Il(a){this.hasAnyUncommitedChange()&&this.logger.error({action:"checkNoUncommittedChange",object:"UpdateableSceneImpl",trigger:"machine",payload:{uncommitted:this.getUncommitedChanges().join("\n"),label:a}})}executeUndo(a){const b=this.createIntent(Object.assign({name:"undo"},a));this.execute(b,()=>{this.Il(b.name);this.Ba.undo(this)&&null!=this.N&&this.N.Gc(e.UpdatePhase.UPDATE_ONCE,!1)})}isUndoable(){return this.ad().isUndoable()}isRedoable(){return this.ad().isRedoable()}generateEntityId(){return this.ad().generateObjectId()}regenerateIDs(a){return this.ad().regenerateIDs(a)}useTestIdGenerator(a){this.ad().useTestIdGenerator(a)}getPrezi(){return this.entities.getPrezi()}getPreziW(){return this.getPrezi().getMutableWrapper(f.CetModel.ID.PREZI.W)}setPrezi(a){if(null!=
this.N)throw Error("cannot set prezi entity on a child scene");if(a.getEntityList()!==this.entities)throw Error("entity is not in the entitylist");this.entities.Dw(a.getId())}getPreziXml(){return m.DOM.saveXml(this.an())}an(){return this.getPrezi().getComponent(l.f.MODEL).getPdomObject()}getStyleDefinition(){return m.DOM.getStyleAsSource(this.an().getDocumentStyle())}applyStyleDefinition(a,b){let c=m.DOM.parseStyleFromSource(b);this.Lj(()=>{this.Ba.vf(Y(a,"applyStyleDefinition"),this,(a)=>{a.updateDocumentStyle(c)});
this.update()})}setAnimationScene(a){this.ta=a;null!=this.Fe&&this.Fe.setAnimationScene(this.ta)}getAnimationScene(){return this.ta}getTweener(){return this.N.getAnimationScene()===this?this.N.getTweener():null!=this.La?(null==this.Fe&&(this.Fe=new Wb.Cq(null!=this.ta?this.ta:this,this,this.La)),this.Fe):null}getEntityTweenNumber(a){return this.La.dn(a)}addEntityTween(a,b){let c=this.getTweener();null!=c&&c.addTween(a.getId(),b)}removeTweensOnEntity(a){let b=this.getTweener();null!=b&&b.removeTweens(a.getId())}setTweenMode(a){this.Lp=
a}getTweenMode(){return this.Lp}inflate(a,b,c){return this.bj(a,[b],this,c)[0]}inflateAll(a,b,c){return this.bj(a,b,this,c)}bj(a,b,c,d){null==d&&(d=()=>{});if(null!=this.N){a=this.N.bj(a,b,c,d);for(let b of a)this.entities.Mo(b)}else a=this.Ba.inflateAll(this,a,b,c);c===this&&d(a);this.Yo(a);return a}dup(a){return this.gm(a,this)}gm(a,b){const c=this.N;if(null!=c){a=c.gm(a,b);for(let b of a)this.entities.Mo(b)}else a=this.Ba.dup(this,a.map((a)=>a.asMutableEntity()),b);this.Yo(a);return a}Yo(a){for(let b of this.ra.inflateList)this.um(b,
"initializeEntities",()=>{b.initializeEntities(this,a)})}um(a,b,c){a=""+this.getName()+"/"+a.getName();try{c()}catch(d){u.LoggerModule.logException(this.logger,"scene",b,d,{system:a})}}vg(){return(this.ra.initList||[]).concat(this.ra.inflateList||[]).concat(this.ra.updateList||[]).concat(this.ra.updateOnceList||[]).concat(this.ra.preRenderList||[]).concat(this.ra.fixerList||[])}Zo(){for(const a of this.vg())a.init(this)}wp(){for(const a of this.vg())null!=a.getTriggerKeys&&this.entities.Bp(a)}getMonitor(){return this.Ri()}Ri(){null==
this.Fa&&(this.Fa=new gb.Sk,null!=this.N&&this.N.getMonitor().addChildMonitor(this.Fa));return this.Fa}beginTransaction(a,b){return this.Cl(a,!0,b)}Cl(a,b,c){if(this.Fd)throw k.j.getEditorApiLogger().cannotStartTransactionBecauseAnOtherIsBeingExecuted(a.name,this.ca),new k.Jh(`Cannot start transaction with intent '${a.name}', because ${this.ca} is being executed.`);if(null!=this.ca)try{this.Fi(this.ca,{reason:e.FinishEventKind.BeginOtherTransaction},b,[])}catch(d){k.j.getEditorApiLogger().exceptionInTransactionEndWhenBeginOtherTransaction(d,
this.ca)}x.Utils.assert(null==this.ca,"transaction should be null");this.ca=new da(a,c);this.Se.push(!0);c=this.ad();if(null!=c)try{this.ca.snapshotBefore=c.createSnapshot()}catch(d){u.LoggerModule.logException(this.logger,"UpdateableSceneImpl","snapshotBefore",d)}b&&this.logger.info({action:"beginTransaction",object:"UpdateableSceneImpl",trigger:a.trigger,payload:{transaction:this.ca.toString()}});return this.ca}endTransaction(a){this.Fi(a,{reason:e.FinishEventKind.EndTransaction},!0,[])}rollbackTransaction(a){if(this.ca!==
a)throw new k.Cf(`Cannot stop transaction ${a}, because an other transaction is in progress: ${this.ca}`);try{this.ca.finish({reason:e.FinishEventKind.RollbackTransaction})}catch(b){u.LoggerModule.logException(this.logger,"reset.abortTransaction","UpdateableSceneImpl",b)}this.ca=null;this.Ba.rollback(this);this.ub.clear();this.updateEntitiesFromParentScene();this.runSystems(e.UpdatePhase.UPDATE);this.runSystems(e.UpdatePhase.UPDATE_ONCE);this.Se.push(!1)}Fi(a,b,c,d){if(this.ca!==a)throw new k.Cf(`Cannot stop transaction ${a}, because an other transaction is in progress: ${this.ca}`);
const f=Date.now();try{try{this.ca.finish(b)}catch(y){throw this.reset(!0),y;}const g=this.ad();if(null!=g)try{this.ca.snapshotAfter=g.createSnapshot()}catch(y){u.LoggerModule.logException(this.logger,"UpdateableSceneImpl","snapshotAfter",y)}try{const b=this.Ol(Y(this.ca),null);this.markViewChanged();this.Gc(e.UpdatePhase.UPDATE_ONCE,!1,[...d,b]);c&&this.logger.info({action:"endTransaction",object:"UpdateableSceneImpl",trigger:a.intent.trigger,payload:{intent:a.intent.name,transaction:a.toString(),
success:!0,elapsed_time_ms:Date.now()-f}})}catch(y){throw this.reset(!0),y;}}finally{this.ca=null,this.Se.push(!1)}}isInTransaction(){return null!=this.ca}isInTransactionStream(){return this.In}createIntent(a){null==a&&(a={});return{name:a.name,trigger:a.trigger||"machine",userIntentId:null==a.userIntentId?u.LoggerModule.getLoggerManager().generateUserIntentId():a.userIntentId}}execute(a,b){const c=Date.now();a=this.Cl(a,!1);this.tm(a,b,!0);this.logger.info({action:"execute",object:"UpdateableSceneImpl",
trigger:a.intent.trigger,payload:{intent:a.intent.name,elapsed_time_ms:Date.now()-c}})}executeInTransaction(a,b){this.tm(a,b,!1)}tm(a,b,c){if(this.ca!==a)throw new k.Xh("Transaction is not in progress");try{this.Fd=!0;const d=new Ta(()=>{b(this,this.ca)},null);this.markViewChanged();c?this.Fi(a,{reason:e.FinishEventKind.EndTransaction},!1,[d]):this.Gc(e.UpdatePhase.UPDATE_ONCE,!1,[d]);try{this.Ij()}catch(g){this.logger.error({action:"pushChanges",object:"UpdateableSceneImpl",trigger:"machine",payload:{message:g.Ym()}})}}catch(d){throw this.reset(!0),
d;}finally{this.Fd=!1}}read(a){if(this.Fd)throw Error("can't read while an other command is executed");try{this.Fd=!0,this.getSceneHierarchy().Qd++,a(this,new da(this.createIntent({name:"read"}),()=>{}))}finally{this.getSceneHierarchy().Qd--,this.Fd=!1}}cw(a){this.Jl.push(a)}}L.Rf=Zc;var hb={};Object.defineProperty(hb,"__esModule",{value:!0});hb.Tk=class extends oa.vd{constructor(a,b){super(a);this.Pj=b}createChildComponent(){let a=new hb.Tk(this,this.Pj);a.version=this.version;return a}insert_Internal(a,
b){super.insert_Internal(a,b);this.Pj(this.O);this.incrementVersion()}removeAt_Internal(a){super.removeAt_Internal(a);this.Pj(this.O);this.incrementVersion()}};var Aa={};Object.defineProperty(Aa,"__esModule",{value:!0});Aa.ne=class extends R.Wa{constructor(a){super();this.Bo=a;null!=a&&(this.pdomId=a.getPDOMId())}createChildComponent(){return new Aa.ne(this.Bo)}getPdomId(){return this.pdomId}getPdomObject(){return this.Bo}withPdomObject(a){return new Aa.ne(a)}};var Xb={};Object.defineProperty(Xb,
"__esModule",{value:!0});Xb.rq=class{constructor(){}createViewEntity(a){return new K.Ja(a)}createPdomComponent(a){return new Aa.ne(a)}createVArrayComponent(){return new oa.vd(null)}createChildComponent(){return new Sa.Nh(null)}createChildrenComponent(){return new La.Lf(null)}createRefListComponent(a){return new Ka.Mf(null,a)}createRefComponent(a){return new ya.ke(null,a)}createStyleClassesComponent(a){return new hb.Tk(null,a)}};var Yb={};Object.defineProperty(Yb,"__esModule",{value:!0});Yb.Br=class{constructor(a,
b){this.em=0;this.rf=!1;this.gh=0;this.na=a;this.Va=b;this.lc=new eb.dl(a);a.Dj.onValue(()=>{this.Pe=!1;b.markViewChanged()});this.hp=n.Bacon.newBus();this.kd=f.CetModel.createPdomEventHandler(new Xb.rq)}changesPdomComponents(){return!0}getDocument(){return this.na.getPrezi()}Fu(){return this.kd.getStyleChangedEventStream().filter((a)=>a.componentKey!==f.CetModel.ID.STYLED.STYLE_CLASSES).map((a)=>[{kind:e.ChangeEventKind.StyleSheet,def:a.def,componentKey:a.componentKey,selector:a.selector,entity:null,
entities:null,type:f.ChangeType.ModifyComponent}])}getName(){return"PDOMObjectFactory"}getDocumentVersionInfoStream(){return this.kd.getDocumentVersionInfoStream()}Xg(a){try{this.em++;const b=this.kd.handlePdomEvent(this.na.getPrezi(),this.na.ha,a);a.getEntityList().ew();b&&this.to(a)}catch(b){this.na.An(b)}}to(a){a=a.getPrezi();a.setComponent(l.f.oe,this.lc);this.hp.push([{kind:e.ChangeEventKind.Document,def:null,componentKey:null,selector:null,entity:a,type:null}])}update(a){if(!this.Pe){let b=
a.getEntityList();b.clear();b.Le++;this.lc.discardEvents();this.kd.initFromDocument(this.na.getPrezi(),a);this.Pe=!0;this.to(a)}this.rf&&(this.rf=!1,this.Xg(a))}lf(){this.lc.lf();this.rf=!0;this.Va.markViewChanged()}tx(a,b,c){return this.lc.Zj(a,b,c).then((a)=>{this.rf=!0;this.Va.markViewChanged();return a})}vf(a,b,c){this.update(b);this.commit(a,b,L.td.ge);c(this.na.getPrezi());this.lc.Nl(a);this.Xg(b)}undo(a){return this.lc.undo()?(this.Xg(a),this.gh++,!0):!1}redo(a){return this.lc.redo()?(this.Xg(a),
this.gh++,!0):!1}Wi(){return!1}getUncommitedChanges(){return[]}entityChanged(){}rollback(){}commit(a,b,c){try{let d=()=>{this.kd.toPdom(b,b.getPrezi(),this.na.getPrezi())};c===L.td.Qf?this.na.ha.updateAndCommitWithoutHistoryTracking(d):d();this.lc.Nl(a)&&this.gh++;this.rf=!0;b.getEntityList().commit();c!==L.td.Uh&&c!==L.td.Qf||this.lc.sync()}catch(d){this.na.An(d)}return!0}getVersion(){return this.gh}init(){}reset(){this.Pe=!1}getDocumentStamp(){return this.em}inflateAll(a,b,c,d){return this.kd.inflateAll(b,
c,this.na.ha,a,d)}dup(a,b,c){return this.kd.dup(b,this.na.ha,a,c)}};var Ba={};Object.defineProperty(Ba,"__esModule",{value:!0});Ba.ee=class{constructor(){null==Ba.ee.ud&&(Ba.ee.ud=u.LoggerModule.getLoggerManager().createLogger("BoundCalculationSystem"))}initializeEntities(a,b){for(let c of b)this.select(c,a)&&h.CetRendererModule.updateBounds(c)}getName(){return"BoundsCalculationSystem"}select(a){return a.hasComponent(h.CetRendererModule.getDrawComponentKey())}getTriggerKeys(){return[...h.CetRendererModule.getBoundsComponentKeys(),
l.f.ya,h.CetRendererModule.getDrawComponentKey(),h.CetRendererModule.getInEditFontSizeComponentKey(),h.CetRendererModule.getHidePlaceHolderTextKey()]}process(a){for(let b of a)try{h.CetRendererModule.updateBounds(b)}catch(c){h.CetRendererModule.logMonitoringOncePerSession(Ba.ee.ud,b.getId(),"invalid_local_bounds","transform",c),b.dispose()}}reset(){}changesPdomComponents(){return!1}getRequiredKeysForIndirectTrigger(){return[h.CetRendererModule.getLocalBoundsComponentKey()]}};var Zb={};Object.defineProperty(Zb,
"__esModule",{value:!0});Zb.Bq=class{constructor(a){this.sc=a}getName(){return this.sc.getName()}update(a){this.i=a;a.getEntityList().forEachMutable((a)=>this.process(a),this);this.i=null}select(a){return this.sc.select(a)}process(a){this.sc.process(a,this.i)}getTriggerKeys(){return[f.CetModel.getNewEntityCompKey()]}getRequiredKeysForIndirectTrigger(){return[]}isTrackingRemovedEntity(){return!1}reset(){}initializeEntities(a,b){e.Cet.isInflator(this.sc)&&this.sc.initializeEntities(a,b)}init(a){e.Cet.isSystemInit(this.sc)&&
this.sc.init(a)}changesPdomComponents(){return this.sc.changesPdomComponents()}};var ba={};Object.defineProperty(ba,"__esModule",{value:!0});ba.nc=class{constructor(a){this.Ue=!1;this.Ob=a;e.Cet.hasIndirectTriggerConfig(this.Ob)?this.Lo=this.Ob.getRequiredKeysForIndirectTrigger():this.Lo=[]}getName(){return this.Ob.getName()}update(a,b){if(null!=this.i&&this.i!==a)throw Error("EntityShaperSystem updates on different scene than original!");this.i=a;a.getEntityList().forChangedMutableEntities((a)=>
this.process(a,b),this)}process(a,b){this.Ob.process(a,this.i,b)}select(a){return this.Ob.select(a,this.i)}getTriggerKeys(){let a=this.Ob.getTriggerKeys();this.Ue=-1!==a.indexOf(f.CetModel.getRemovedEntityCompKey());return a}getRequiredKeysForIndirectTrigger(){return this.Lo}isTrackingRemovedEntity(){return this.Ue}reset(){}initializeEntities(a,b){this.Ob.initializeEntities(a,b.filter((a)=>this.select(a)))}init(a){this.i=a;e.Cet.isSystemInit(this.Ob)&&this.Ob.init(a)}changesPdomComponents(a){return this.Ob.changesPdomComponents(a)}};
var q={};Object.defineProperty(q,"__esModule",{value:!0});q.m=class{constructor(a){this.aa=a;this.Rb=!1;this.Cd=this.qc=0;this.Cg=this.gj=this.isVisible=this.Bg=this.Nn=!1}static resize(a){null!=q.m.ba&&(q.m.ba.setWidth(a.M.getWidth()-50),q.m.ba.updateProgressBarWidth());null!=q.m.va&&(q.m.va.getElement().css("top",Math.floor((a.M.getHeight()-q.m.va.getElement().height())/2)+"px"),q.m.va.getElement().css("left",Math.floor((a.M.getWidth()-q.m.va.getElement().width())/2)+"px"))}static zg(a){a.preventDefault();
a.stopPropagation()}Gv(a){this.Hp=a}Fv(a){this.seek=a}Hv(a){this.uh=a}setIsPlaying(a){this.Nd=a;this.Hc()}setIsMuted(a){this.Rb=a;this.Hc()}ip(a){this.wh=a;this.Hc()}jp(){this.Nn=!0}setVideoType(a){this.videoType=a}Zu(){q.m.pd=this.aa.M.createUIContainer("videoControls");this.$u();this.av();q.m.resize(this.aa)}$u(){q.m.ba=this.aa.video.getVideoControlUI();this.aa.M.insertUIElement(q.m.pd,q.m.ba.getElement());q.m.ba.getElement().css("bottom","30px");q.m.ba.getElement().css("left","25px")}av(){q.m.va=
this.aa.video.getPlayButtonUI();this.aa.M.insertUIElement(q.m.pd,q.m.va.getElement())}propagateEvent(){this.aa.video.propagateEvent({videoType:this.videoType,videoTotalDuration:this.wh,eventType:this.Nd?T.VideoEventType.Play:T.VideoEventType.Pause,videoPlayPosition:this.qc})}Hc(){null!=q.m.ba&&this.isVisible&&(q.m.ba.getLength()!==this.wh&&q.m.ba.setLength(this.wh),q.m.ba.getIsMuted()!==this.Rb&&q.m.ba.setIsMuted(this.Rb),q.m.ba.getPlaybackPosition()!==this.qc&&(2<Math.abs(q.m.ba.getPlaybackPosition()-
this.qc)&&this.propagateEvent(),q.m.ba.animatePlaybackPosition(this.qc)),q.m.ba.getBufferPosition()!==this.Cd&&q.m.ba.setBufferPosition(this.Cd),q.m.ba.getIsPlaying()!==this.Nd&&(this.propagateEvent(),null!=q.m.va&&(this.Nd?q.m.va.getElement().fadeOut(100):q.m.va.getElement().show().fadeTo(100,.9)),q.m.ba.setIsPlaying(this.Nd)));null!=q.m.va&&q.m.va.getIsHighlight()!==this.Bg&&q.m.va.setIsHighlight(this.Bg)}show(){null==window.document.getElementById("videoControls")&&this.Zu();this.dk(!0);$(q.m.pd).on("mousemove",
()=>this.Ow());q.m.ba.getElement().on("mouseup mousedown mousemove",q.m.zg);q.m.ba.getPlayButton().on("click",this.uh);q.m.ba.getVolumeButton().on("click",this.Hp);q.m.ba.getProgressBar().on("click",(a)=>this.tn(a));q.m.ba.getElement().on("mouseenter",()=>this.qn());q.m.ba.getElement().on("mouseleave",()=>this.rn());q.m.va.getElement().on("mouseenter",()=>this.mn());q.m.va.getElement().on("mouseleave",()=>this.nn());q.m.va.getElement().on("mouseup mousedown mousemove",q.m.zg);q.m.va.getPlayButton().on("click",
this.uh);this.Hc()}dk(a){this.isVisible=a}qn(){this.gj=!0}rn(){this.gj=!1}Ow(){null!=this.vn&&this.vn.stop();this.vn=x.Utils.delay(()=>this.Nu(),3E3);this.isVisible&&!this.Cg&&(q.m.ba.setPlaybackPosition(this.qc),q.m.ba.setBufferPosition(this.Cd),$(q.m.pd).fadeIn(100),this.Cg=!0)}Nu(){this.Nd&&!this.gj&&($(q.m.pd).fadeOut(400),this.Cg=!1)}mn(){this.Bg=!0;this.Hc()}nn(){this.Bg=!1;this.Hc()}vk(a){null!=a&&(this.qc=a);this.Hc()}tn(a){this.Nn&&(a=(a.pageX-q.m.ba.getProgressBar().offset().left)/q.m.ba.getProgressBar().width()*
this.wh,this.Cd>a&&this.seek(a))}Mp(a){this.Cd=null!=this.Cd?a:0;this.Hc()}hide(){null!=q.m.pd&&($(q.m.pd).fadeOut(300),this.isVisible=this.Cg=!1,q.m.ba.getElement().off("mouseup mousedown mousemove",q.m.zg),q.m.ba.getPlayButton().off("click",this.uh),q.m.ba.getVolumeButton().off("click",this.Hp),q.m.ba.getProgressBar().off("click",(a)=>this.tn(a)),q.m.ba.getElement().off("mouseenter",()=>this.qn()),q.m.ba.getElement().off("mouseleave",()=>this.rn()),q.m.va.getElement().off("mouseenter",()=>this.mn()),
q.m.va.getElement().off("mouseleave",()=>this.nn()),q.m.va.getElement().off("mouseup mousedown mousemove",q.m.zg),q.m.va.getPlayButton().off("click",this.uh))}};var P={};Object.defineProperty(P,"__esModule",{value:!0});var $b;(function(a){a[a.Tq=0]="INITIALIZING";a[a.pe=1]="STOPPED";a[a.BUFFERING=2]="BUFFERING";a[a.PAUSED=3]="PAUSED";a[a.PLAYING=4]="PLAYING"})($b=P.VideoState||(P.VideoState={}));class Ca extends R.Wa{constructor(a,b,c){super();a.getEntity().setComponent(l.f.VIDEO,this);this.Zc=a.getId();
this.onlineAssetId=a.getOnlineAssetId();this.onlineAssetUrl=a.getOnlineAssetUrl();this.offlineAssetId=a.getOfflineAssetId();this.status=$b.Tq;this.He=this.Yc=this.Yd=!1;this.fa=new q.m(b);this.fa.Hv(()=>this.Qu());this.fa.Fv((a)=>this.Ou(a));this.fa.Gv(()=>this.Pu());this.aa=b;this.Va=c;this.aa.editorModeChanged.onValue(()=>{this.Ao();this.fadeOut()})}init(){}dispose(){this.Yc||(this.aa.M.removeElement(this.Ub),this.aa.M.removeElement(this.Ub+"_info"),this.Yc=!0)}Qu(){this.fa.Nd?this.pauseVideo():
this.playVideo()}Pu(){this.fa.Rb?(this.fa.setIsMuted(!1),this.setMute(!1)):(this.fa.setIsMuted(!0),this.setMute(!0))}Ou(a){this.seekTo(a)}onFocus(){this.Yd=!0;this.fa.show();this.playVideo();this.fadeIn()}onLostFocus(){this.Ao();this.fadeOut()}Ao(){this.Yd=!1;this.pauseVideo();this.fa.hide();this.aa.M.setElementAlpha(this.Ub,0)}getStatusName(){return $b[this.status]}fadeIn(){this.He=!0;this.aa.xc.fadeIn((a)=>{!this.Yc&&this.He&&this.aa.M.setElementAlpha(this.Ub,a,!0)},Ca.Eq)}fadeOut(){this.He=!1;
this.aa.xc.fadeOut((a)=>{this.Yc||this.He||this.aa.M.setElementAlpha(this.Ub,a)},Ca.Fq)}getCurrentTime(){throw Error("Not implemented");}cf(){q.m.resize(this.aa)}refresh(){!this.He||this.aa.M.getWidth()===this.Xe&&this.aa.M.getHeight()===this.We||(this.Xe=this.aa.M.getWidth(),this.We=this.aa.M.getHeight(),this.cf())}playVideo(){throw Error("Not implemented");}pauseVideo(){throw Error("Not implemented");}setMute(){throw Error("Not implemented");}seekTo(){throw Error("Not implemented");}getWidth(){return this.width}setWidth(a){this.width=
a}getHeight(){return this.height}setHeight(a){this.height=a}willReceiveFocus(){}}P.ue=Ca;Ca.Eq=600;Ca.Fq=300;Ca.Gf=320;Ca.Ff=240;var qa={hn:function(a,b){return $c(this,void 0,void 0,function*(){b.getEntity().hasComponent(l.f.Yh)||b.getEntity().setComponent(l.f.Yh,new Promise((c)=>{var d="//vimeo.com/api/v2/video/"+b.getOnlineAssetId()+".json";d=a.createJSONFetcher(d).fetch();d.onValue((a)=>{c({duration:a[0].duration,thumbnailUrl:a[0].thumbnail_large})});d.onError(()=>c(null))}));return b.getEntity().getComponent(l.f.Yh)})}},
$c=this&&qa.Vf||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,f){function g(a){try{h(d.next(a))}catch(I){f(I)}}function r(a){try{h(d["throw"](a))}catch(I){f(I)}}function h(a){a.done?c(a.value):e(a.value).then(g,r)}h((d=d.apply(a,b||[])).next())})};Object.defineProperty(qa,"__esModule",{value:!0});qa.ai=class extends P.ue{constructor(a,b,c){super(a,b,c);c=a.getId();this.logger=u.LoggerModule.getLoggerManager().createLogger("prezi_cet.ZVideoVimeoPeer");
this.setWidth(qa.ai.Gf);this.setHeight(qa.ai.Ff);this.Ub="video_vimeo_"+c;this.xf="vimeo_"+c;(0,qa.hn)(b.assetManager,a).then((a)=>{null!=a?(this.Fl=!0,this.fa.ip(a.duration)):this.Fl=!1})}getCurrentTime(){return this.currentTime}Ai(){this.zf=this.aa.M.createElement(this.Ub);this.zf.style.left="-9999px";this.zf.style.position="absolute";this.zf.style.display="block";this.zf.style.background="black";this.aa.M.createIFrame(this.xf,"//player.vimeo.com/video/"+this.onlineAssetId+"?api=1&player_id="+this.xf+
"&portrait=0&title=0",this.aa.M.getWidth()-120,this.aa.M.getHeight()-100,this.zf);let a=window.document.getElementById(this.xf);a.style.zIndex="100";a.style.position="relative";a.style.top="65px";a.style.left="60px";this.ej()}onReady(){this.status=P.VideoState.pe;this.currentTime=0;this.ea.addEvent("play",()=>this.Ev());this.ea.addEvent("pause",()=>this.Dv());this.ea.addEvent("finish",()=>this.Cv());this.ea.addEvent("playProgress",(a)=>this.Ng(a));this.ea.addEvent("loadProgress",(a)=>this.vj(a));
this.fa.setIsMuted(!1);this.fa.jp();this.playVideo()}playVideo(){this.Fl||this.fa.dk(!1);if(this.Yd)if(null==this.ea)this.Ai();else try{this.ea.playVideo()}catch(a){this.logger.error({action:"play_error",object:"vimeo_player",trigger:"machine",payload:{error:a.toString()}})}}pauseVideo(){if(null!=this.ea)try{this.ea.pauseVideo()}catch(a){this.logger.error({action:"pause_error",object:"vimeo_player",trigger:"machine",payload:{error:a.toString()}})}}seekTo(a){null!=this.ea&&this.ea.seekTo(a)}Ng(a){this.currentTime=
a=a.seconds;this.fa.vk(a)}vj(a){this.fa.Mp(a.duration*a.percent);1===a.percent&&this.ea.removeEvent("loadProgress")}Cv(){this.fa.setIsPlaying(!1,this.getCurrentTime())}cf(){super.cf();$("#"+this.Ub).width(this.Xe).height(this.We);$("#"+this.xf).width(this.Xe-120).height(this.We-100)}Dv(){this.fa.setIsPlaying(!1,this.getCurrentTime());this.status=P.VideoState.PAUSED}setMute(a){try{!0===a?this.ea.setVolume(0):this.ea.setVolume(1)}catch(b){this.logger.error({action:"mute_error",object:"vimeo_player",
trigger:"machine",payload:{error:b.toString()}})}}Ev(){this.fa.setIsPlaying(!0,this.getCurrentTime());this.status=P.VideoState.BUFFERING}ej(){this.ea=this.aa.video.initializeVimeoPlayer(this.xf,(a)=>this.onReady(a))}};var Ua={},ad=this&&Ua.Vf||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,f){function g(a){try{h(d.next(a))}catch(I){f(I)}}function r(a){try{h(d["throw"](a))}catch(I){f(I)}}function h(a){a.done?c(a.value):e(a.value).then(g,
r)}h((d=d.apply(a,b||[])).next())})};Object.defineProperty(Ua,"__esModule",{value:!0});Ua.Ok=class{constructor(a,b,c,d,g){this.fb=a;this.M=b;this.Ad=d;this.assetManager=g;this.uo={componentKey:f.CetModel.ID.MEDIA_ASSET.ONLINE_ASSET_URL,zk:{}};this.Fp={componentKey:this.Ad.getKey(),zk:{}};this.Vu=e.Cet.createImagePatcher(c);this.Mv=e.Cet.createPdfPatcher(c);a=document.createElement("img");a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAYAAACLz2ctAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQ0SURBVHgB7d2PcdMwFMfxZyboCCkTNBPQMAHZIJ2g9BiAZAKSCQgbdIMGBoAyQTwCG5ins0pDLv+cWHq29P3c6VK41DTld3qSLcsiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEIrJJKqqq705V7brW/onmdt86IovkkkUQKo4Rvoy5O2gaAPSm0jDWIpgcUK4FoIX9+U2oYawj8S0BsJTMM3EcLXRwNtHyWw4AGUetyHfnongQUvwdoDVoLe0hIcNCMxekBgLwIIUwQQpgggTBFAmCKAMEUAYYoAwhQBhCkCCFME0I5bZTKTetlT4S95DbVFW4vXBVwLtlHKgfV2XVo/GfpaMAG0cX1ssacP4S9tV2KIxQjpWZ6y0ti/ZyGJI4DxNQnVShJHCY6saUmz/v1RgpE0AhiZdmi3Dd57I4kjgPHdNnhv8JuCrDEGjM+dgB6eeBpmLcYYA6bHndd78gHbaeNEdPIIoI2BtrUG7evmOM+ND7V9lvoE9EAyQAnebSl1T/VBMseluPhKbSOpx2rZ9ET7MAaMb+omCH5PlDtBUATwf4vNrcn065VkcD3WEiX4VSk7doPy+xpmW4opwfGMdm1FRikOiwDWZodODFOKw6EEa+nVgF2f8kb9KK4UJ399dhMlOLxRg/dSiluWewBnTfZB1ve6TbwfBK3JuQSfXHq36Udy12lvJQOU4DDczLZJ6d1254+BC+UawEald5v/3plcbiGZz65zLMHurrRWJhMXluJn/TmG/jidnV1TgttVSjs914tzS3Gpbbzx57H/u+zkFsBp0eLTf/yxzulNx5s/h/96LBnKKYDLEM9A02M+6stjg2958Kdzto/DKZ4Qqm5YVweWwLfwGa/8v3HM/IRjzasOkcBymYRMisBPgKzq2y0P3cfxb9JxwrE6MylhEnK5RRHh8aNHFiyU0myMl82kJPUesJQIT3x8Ue1fOzjcNe47cqwbfyxT9ICXGcUKn7Nn7eBD0/D5YzEpaUNlZypGqteJxNFJR4NjmZDAUi3BZy80aIt+bHfaZyItqAwnJdyWeZ7rNk84W6sMt+xlDNjcLKXwOSlfKUmtBzQvvSHpr9LtlvVFIqIHPN2la/w6T7PgJjVJLd9KKYDJld5d9DO6XrDxaZ2uSiWAS9875CKZKyUpjAFLOfDQl1RV9ZWSnxL4/5Ax4HHT3MLn/db2SXqOG9NxED0gkkYAYYoAwhQBhCkCCFMEEKYIIEwRQJgigDBFAGGKAMIUAYQpAghTBBCmYgRwJeir4FuDxAjgd0FfBb8BKsaC1Kwf9tdj66Io3kpgwXtAv2GPu12yFPTFWtt7iSB4D7hJe8OJvtxLZs9b8/pwa8JK2w9t85i7igEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI6y8DFXvE/fvsgQAAAABJRU5ErkJggg==";
this.fm=this.fb.imageAssetFromImage(a,"placeholderImageAssetId")}getName(){return"ImageInitSystem"}Jt(a,b){for(let c of a)c.isDef(f.CetModel.ID.Z_ANIMATED_IMAGE)?this.Et(c,b):(c.isDef(f.CetModel.ID.IMAGE)||c.isDef(f.CetModel.ID.SWF_GRAPHICS)||c.isDef(f.CetModel.ID.PDF)||c.isDef(f.CetModel.ID.Z_VIDEO))&&this.It(c.getId(),b)}process(a,b){this.Jt(a,b)}select(a,b){return null!=b.getEntityById(a.getId())&&null==a.getParentEntity()&&!a.isDisposed()&&(a.isDef(f.CetModel.ID.IMAGE)||a.isDef(f.CetModel.ID.Z_ANIMATED_IMAGE)||
a.isDef(f.CetModel.ID.PDF)||a.isDef(f.CetModel.ID.SWF_GRAPHICS)||a.isDef(f.CetModel.ID.Z_VIDEO))}getTriggerKeys(){return[this.uo.componentKey,f.CetModel.ID.MEDIA_ASSET.OFFLINE_ASSET_ID,this.Fp.componentKey,f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID]}reset(){}changesPdomComponents(){return!1}Et(a,b){const c=a.getId(),d=a.getComponentVersion(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID),g=(a)=>{b.requestNoDomBatchUpdate((b)=>{b=b.getEntityById(c);if(null!=b&&!b.isDisposed()&&b.getComponentVersion(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID)===
d){var g=e.Cet.mutableDraw(b);g.kind!==h.DrawComponentKind.animatedImage||g.isErrorDraw()||a(b,g)}})};e.Cet.draw(a).kind===h.DrawComponentKind.animatedImage&&(e.Cet.addSpinner(this.M,a),this.fb.animatedImageAssetFromMaid(a.get(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID)).then((b)=>{e.Cet.removeSpinner(a);g((a,c)=>{c.setAsset(b)})}).catch(()=>{e.Cet.removeSpinner(a);g((a,b)=>{b.setError()})}))}pn(a,b){e.Cet.removeSpinner(a);b.setError()}ri(a,b){a=a.getEntityById(b);if(null==a||a.isDisposed())return{entity:null,
$e:null,Ee:null,Re:null};b=a.getMutableWrapper(f.CetModel.ID.MEDIA_ASSET.W);const c=e.Cet.errorOfflineAssetId===b.getOfflineAssetId(),d=e.Cet.mutableDraw(a);return d.kind!==h.DrawComponentKind.image&&d.kind!==h.DrawComponentKind.xvg&&d.kind!==h.DrawComponentKind.onCanvasVideo&&d.kind!==h.DrawComponentKind.videoThumbnail?{entity:a,$e:b,Ee:null,Re:c}:{entity:a,$e:b,Ee:d,Re:c}}It(a,b){const {entity:c,$e:d,Ee:e,Re:f}=this.ri(b,a);if(null!=e)if(e.kind===h.DrawComponentKind.videoThumbnail&&null==e.getPlayButton()&&
this.fb.getVideoPlayerPlayButtonImageAsset().then((a)=>{null==e.getPlayButton()&&e.setupPlayButton(a)}),f)this.pn(c,e);else{e.incrementVersion();var y=(a)=>{const b=(b)=>{var c,d;return null!==(d=null===(c=b.getEntity().getUntypedComponent(a.componentKey))||void 0===c?void 0:c.getVersion())&&void 0!==d?d:0},e=b(d),f=c.getLastEntityVersion(a.zk);c.setLastEntityVersion(a.zk,e);return{pi:e!==f,Rn:(a)=>e===b(a)}};a=y(this.uo);a.pi&&this.kx(b,d,e,a);y=y(this.Fp);y.pi&&this.rx(b,d,e,y,!a.pi)}}rx(a,b,c,
d,e){const f=b.getEntity().getId();b=this.Ad.getThumbnail(b);!e||c.kind!==h.DrawComponentKind.image&&c.kind!==h.DrawComponentKind.xvg||c.setThumbnailImageAsset(null);null!=b&&(c=b.thumbnail,H.isActive("js-sad-thumbnail-for-test")&&(c.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAM0lEQVQYlWNgQAX/0TBW8P//f1SMTTGGImyKUQRxsfGahlchzCN4FRKymmjPkBQ8BAMcAEawp1mqrGwMAAAAAElFTkSuQmCC"),Promise.all([this.fb.imageAssetFromImage(c,f),this.fm]).catch(()=>null).then((b)=>a.requestNoDomBatchUpdate((a)=>
{const {$e:c,Ee:e,Re:g}=this.ri(a,f);if(null==c||null==e||g||!d.Rn(c))null!=b&&h.CetRendererModule.freeAsset(b[0]);else if(null!=b){var [a,r]=b;e.kind===h.DrawComponentKind.image&&e.setPlaceholderImageAsset(r);e.kind!==h.DrawComponentKind.image&&e.kind!==h.DrawComponentKind.xvg||e.setThumbnailImageAsset(a)}})))}Ft(a){return ad(this,void 0,void 0,function*(){var b=a.get(f.CetModel.ID.MEDIA_ASSET.ONLINE_ASSET_URL);if(a.isDef(f.CetModel.ID.PDF))return this.fb.xvgAssetFromPdfUrl(b,a.get(f.CetModel.ID.PDF.PAGE_NUMBER),
a.getId());if(a.isDef(f.CetModel.ID.SWF_GRAPHICS))return this.fb.xvgAssetFromSwfUrl(b,a.getId());if(a.isDef(f.CetModel.ID.Z_IMAGE)||a.isDef(f.CetModel.ID.BACKGROUND_IMAGE))return this.fb.imageAssetFromUrl(b,a.getId());if(a.isDef(f.CetModel.ID.Z_VIDEO)){const c=a.getMutableWrapper(f.CetModel.ID.Z_VIDEO.W),d=c.getVideoType();switch(d){case "video":return this.fb.thumbnailImageAssetFromVideoUrl(b,a.getId());case "youtube":return b=c.getLetterboxYoutubeThumbnail()?"0":"mqdefault",b=`https://yt.preziusercontent.com/${c.getOnlineAssetId()}/${b}.jpg`,
this.fb.imageAssetFromUrl(b,c.getId());case "vimeo":return b=yield qa.hn(this.assetManager,c),null==b?null:this.fb.imageAssetFromUrl(b.thumbnailUrl,c.getId());default:x.Utils.fail(`Unknown videoType: ${d}`)}}return x.Utils.fail("")})}kx(a,b,c,d){const f=b.getEntity(),r=f.getId();this.Ad.registerIMediaAssetW(b);c.setAsset(null);null==b.getOnlineAssetUrl()&&c.kind!==h.DrawComponentKind.videoThumbnail?(f.get(e.Cet.getDisableSpinnerKey())||e.Cet.addSpinner(this.M,f),h.CetRendererModule.setLoaded(f,!0)):
Promise.all([this.Ft(f),this.fm]).catch(()=>null).then((b)=>a.requestNoDomBatchUpdate((a)=>{const {entity:c,$e:f,Ee:g,Re:y}=this.ri(a,r);if(null==f||null==g||y||!d.Rn(f))null!=b&&h.CetRendererModule.freeAsset(b[0]);else if(null==b)this.pn(c,g);else{var [a,k]=b;e.Cet.removeSpinner(c);a.kind===h.AssetKind.Xvg&&g.kind===h.DrawComponentKind.xvg?g.setAsset(a):a.kind!==h.AssetKind.Image||g.kind!==h.DrawComponentKind.image&&g.kind!==h.DrawComponentKind.onCanvasVideo&&g.kind!==h.DrawComponentKind.videoThumbnail?
x.Utils.fail("assetkind mismatch"):g.setAsset(a);g.kind===h.DrawComponentKind.image&&g.setPlaceholderImageAsset(k);h.CetRendererModule.setLoaded(c,!0);this.Lv(f,a)}}))}Lv(a,b){const c=a.getEntity(),d=c.isDef(f.CetModel.ID.IMAGE)?c.getWrapper(f.CetModel.ID.IMAGE.W):c.isDef(f.CetModel.ID.PDF)?c.getWrapper(f.CetModel.ID.PDF.W):null;a=a.getOfflineAssetId();null==d||null==a||b.width===d.getWidth()&&b.height===d.getHeight()||(!isFinite(b.width)||0>=b.width||!isFinite(b.height)||0>=b.height?e.Cet.getEditorApiLogger().overrideSizeSkipped(c.getDef(),
c.getId(),d.getWidth(),d.getHeight(),b.width,b.height):(e.Cet.getEditorApiLogger().overrideSize(c.getDef(),c.getId(),d.getWidth(),d.getHeight(),b.width,b.height),c.isDef(f.CetModel.ID.IMAGE)?this.Vu.patchSizeAndScale(a,b.width,b.height):this.Mv.patchSizeAndScale(a,b.width,b.height)))}};var ac={};Object.defineProperty(ac,"__esModule",{value:!0});ac.br=class{constructor(a){this.xi=a}getName(){return"InvisibleFrameSystem"}process(a){a.setComponent(h.CetRendererModule.getDrawComponentKey(),this.xi())}select(a){return a.getDef()===
f.CetModel.ID.Z_INVISIBLE_FRAME?!a.getWrapper(f.CetModel.ID.Z_INVISIBLE_FRAME.W).getIsPage():!1}reset(){}changesPdomComponents(){return!1}};var bc={};Object.defineProperty(bc,"__esModule",{value:!0});bc.wr=class{constructor(a){this.camera=a;f.CetModel.createValueComponentKey("OverviewFrameSystem.isOnEdgeKey",!1,!1,!1)}getName(){return"OverviewFrameSystem"}process(a,b){a=b.getPreziW().getMutableOverview();if(null!=a){var c=e.Cet.mutableDraw(a.getEntity());if(c.kind===h.DrawComponentKind.overviewFrame){const d=
k.j.parseAspectRatio(b.getPreziW().getAspectRatio());c.setAspectRatio(d.width,d.height,d.letterBoxing)&&(h.CetRendererModule.updateBounds(a.getEntity()),h.CetRendererModule.updateWorldProperties(a.getEntity()))}switch(this.Cu(b)){case m.OverviewBoundsType.AUTOMATIC_OVERVIEW_BOUNDS:c=e.Cet.calcOverviewBoundsData(b,!1).documentWithMinimumSizeAABB;break;case m.OverviewBoundsType.FIXED_OVERVIEW_BOUNDS:c=a.getOverviewBounds().getBoundsInWorld();break;case m.OverviewBoundsType.XCONSTRUCTOR:throw Error();
default:throw Error();}c=e.Cet.calcOverviewLocalToWorld(a.getEntity(),c);this.Jw(b,a.getEntity(),c)}}Jw(a,b,c){var d=b.get(f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD);if(null==d||!d.equalsWithin(c,1E-9)){d={getLocalToWorldInRenderedScene:(b)=>{b=a.getEntityById(b);return null!=b?h.CetRendererModule.getLocalToWorld(b):null}};const e=null!=this.camera?this.camera.getViewportTransform(d):null;k.j.setWorld(b,c);h.CetRendererModule.updateWorldProperties(b);null!=e&&this.camera.setViewportTransform(e,d)}}select(a){return a.isDef(f.CetModel.ID.PREZI)||
a.isDef(f.CetModel.ID.OVERVIEW)}getTriggerKeys(){return[f.CetModel.ID.OVERVIEW.OVERVIEW_BOUNDS,f.CetModel.ID.PREZI.ASPECT_RATIO]}Mw(a){return a===e.UpdatePhase.GEOMETRY||a===e.UpdatePhase.DOCUMENT}changesPdomComponents(a){return this.Mw(a)}Cu(a){a=a.getPreziW().getOverview();return null==a?null:a.getOverviewBounds().getObjectType()}};var cc={};Object.defineProperty(cc,"__esModule",{value:!0});cc.Ir=class{constructor(a){this.aw=a}getName(){return"QuadtreeSystem"}process(a,b){this.aw.update(b.getPreziW(),
b,a)}getVersion(a){return l.f.world(a).getVersion()}reset(){}select(a){return a.hasComponent(h.CetRendererModule.getZOrderComponentKey())}getTriggerKeys(){return[h.CetRendererModule.getWorldGeometryComponentKey(),f.CetModel.getRemovedEntityCompKey()]}changesPdomComponents(){return!1}};var dc={};Object.defineProperty(dc,"__esModule",{value:!0});dc.Jr=class{constructor(a,b){this.channel=a;this.To=b}getName(){return"WebGlInvalidatorSystem"}select(a){return a.isDef(f.CetModel.ID.BACKGROUND)||a.hasComponent(h.CetRendererModule.getDrawComponentKey())}getTriggerKeys(){return this.To.getTriggerKeys()}process(a){for(let b of a)this.To.invalidate(this.channel,
b.getId())}reset(){}changesPdomComponents(){return!1}};var ib={};Object.defineProperty(ib,"__esModule",{value:!0});ib.Wk=class extends R.Wa{constructor(){super()}onFocus(){}onLostFocus(){}willReceiveFocus(){}};var ec={};Object.defineProperty(ec,"__esModule",{value:!0});ec.rr=class extends R.Wa{constructor(){super()}refresh(){}};var fc={};Object.defineProperty(fc,"__esModule",{value:!0});fc.Wr=class{process(a){for(let b of a)b.setComponent(l.f.ie,new ib.Wk),b.setComponent(k.j.getLegacyOverlayComponentKey(),
k.j.createOverlayComponent(new ec.rr))}select(a){const b=a.getComponent(k.j.getLegacyOverlayComponentKey());return a.hasComponent(h.CetRendererModule.getZOrderComponentKey())&&null!=b&&b.getOverlay()instanceof P.ue}getTriggerKeys(){return[h.CetRendererModule.getDrawComponentKey()]}getName(){return"ThumbnailOnlyVideoSystem"}reset(){}changesPdomComponents(){return!1}};var jb={};Object.defineProperty(jb,"__esModule",{value:!0});jb.ll=class{constructor(){}getName(){return"WorldGeometrySystem"}initializeEntities(a,
b){for(let c of b)null!=this.select(c,a)&&h.CetRendererModule.updateWorldProperties(c)}process(a,b){const c=[];for(let d of a)d.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?c.push(d):d.isDef(f.CetModel.ID.ABSOLUTE)?(a=b.getEntityById(d.get(f.CetModel.ENTITY_OWNER_ID())),a=b.getEntityById(a.get(f.CetModel.ENTITY_OWNER_ID())),a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)&&c.push(a)):h.CetRendererModule.updateWorldProperties(d);for(let a of c)h.CetRendererModule.updateWorldProperties(a)}select(a){return!a.isDef(f.CetModel.ID.LOGO)&&
!a.isDef(f.CetModel.ID.NEXT_LOGO_V1)}getTriggerKeys(){return[...f.CetModel.ID.TRANSFORMED.getFields(),f.CetModel.ID.ABSOLUTE.LOCAL_TO_WORLD,h.CetRendererModule.getLocalBoundsComponentKey(),f.CetModel.ID.TOPIC_CHILD.CHILD_PARENT]}reset(){}changesPdomComponents(){return!1}getRequiredKeysForIndirectTrigger(){return[h.CetRendererModule.getWorldGeometryComponentKey()]}};var Da={};Object.defineProperty(Da,"__esModule",{value:!0});Da.le=class extends Ra.Wh{constructor(a,b){super();this.dh=b;null!=a&&(this.wn(a),
this.setVersion(f.CetModel.textKludge.getTextComponent(a).getVersion()))}qf(a){null!=this.Tc&&this.Tc.detachedFromComponent();this.Tc=null!=a?a.attachToComponent():null}static create(a,b){return new Da.le(a,b)}static createDefaultBaseStyle(){return ta.TextModel.createCharacterStyleContainer(ta.TextModel.createColor(0),"default",24,"normal","normal",0,null)}getShapedText(){let a=f.CetModel.textKludge.getTextComponent(this.O).getVersion();super.getVersion()<a&&(this.setVersion(a),this.wn(this.O));return this.Tc}lp(a,
b,c){H.FeatureSwitcher.isActive("js-disable-auto-urls")||(b=f.CetModel.urlMarker.markUrlsInText(b));this.qf(b);f.CetModel.textKludge.setTextModel(a,b.getText(),c);this.setVersion(f.CetModel.textKludge.getTextComponent(a).getVersion())}dispose(){this.qf(null)}getVersion(){return Math.floor(Math.max(super.getVersion(),f.CetModel.textKludge.getTextComponent(this.O).getVersion()))}isInherited(){return!0}setBaseStyle(a,b){this.Tc.getBaseStyle().equals(b)||(a=this.Tc.setBaseStyle(b),this.qf(a),this.incrementVersion())}wn(a){const b=
Da.le.createDefaultBaseStyle();this.qf(this.dh.update(f.CetModel.textKludge.getTextModel(a),b,this.Tc,!H.FeatureSwitcher.isActive("js-disable-auto-urls")))}createChildComponent(){let a=new Da.le(null,this.dh);a.qf(this.Tc);a.setVersion(this.getVersion());return a}};var M={};Object.defineProperty(M,"__esModule",{value:!0});M.Kq=class{constructor(){}};M.$h=class{constructor(a,b){this.fontsLoadedStateHolder=a;this.Vn=-1;this.logger=u.LoggerModule.getLoggerManager().createLogger("prezi_cet.ZTextInitSystem");
this.Va=b}getName(){return"ZTextInitSystem"}getZTextFixer(a){return new M.Sc(a,this.fontsLoadedStateHolder)}initializeEntities(a,b){for(let c of b)if(f.CetModel.textKludge.isEntityText(c)){this.update(a);break}}update(a){this.Ht(a);let b=this.tu(a),c=b!==a.getPrezi().getLastEntityVersion(this.fontsLoadedStateHolder.Bm),d=!1;this.Vn!==this.fontsLoadedStateHolder.getVersion()&&(d=!0,this.Vn=this.fontsLoadedStateHolder.getVersion());this.Bt(a)&&(d=!0);c&&(d=!0);if(d){var e=this.getZTextFixer(a);a.getEntityList().forEachMutable((a)=>
{e.fix(a)&&(h.CetRendererModule.setLoaded(a,!0),this.Va.markViewChanged())});a.getPrezi().setLastEntityVersion(this.fontsLoadedStateHolder.Bm,b)}}Ht(a){let b=this.vu(a),c=a.getPrezi().getLastEntityVersion(this);if(b!==c)this.fontsLoadedStateHolder.Gt(a).onValue(()=>{this.Va.markViewChanged()});a.getPrezi().setLastEntityVersion(this,b)}vu(a){let b=0;a=a.getPreziW().getDocumentStyle();for(let c of a.getFontFamilies())for(let a of c.getFontFaces())b+=f.CetModel.ID.FONT_FACE.getVersion(a.getEntity());
return b}tu(a){let b=0;a=a.getPreziW().getDocumentStyle();for(let c of a.getFontClasses())b+=f.CetModel.ID.FONT_CLASS.getVersion(c.getEntity());return b}select(a){return f.CetModel.textKludge.isEntityText(a)}getTriggerKeys(){return[...f.CetModel.ID.HAS_FONT.getFields(),k.j.getShapedTextKey(),...f.CetModel.textKludge.getTextComponentKeys()]}getRequiredKeysForIndirectTrigger(){return[]}isTrackingRemovedEntity(){return!1}Bt(a){let b=!1;a.getEntityList().forEachMutable(()=>{b=!0},this);return b}init(){}reset(){}changesPdomComponents(){return!1}};
M.Sc=class{constructor(a,b){this.lo=a;this.fontsLoadedStateHolder=b;this.tg={};this.Ts();null==M.Sc.logger&&(M.Sc.logger=u.LoggerModule.getLoggerManager().createLogger("prezi_cet.ZTextInitSystem"))}cn(a){return a.hasComponent(l.f.ya)?f.CetModel.ID.HAS_FONT.getVersion(a)+a.getComponent(l.f.ya).getVersion()+f.CetModel.ID.POSSIBLY_PLACEHOLDER.getVersion(a):null}Fs(a){let b=Da.le.createDefaultBaseStyle();null==a||null==a.getFamily()?M.Sc.fo||(M.Sc.logger.print("fallback to default font due to missing font family"),
M.Sc.fo=!0):b=b.setFontFamily(a.getFamily()).setFontStyle(a.getStyle()).setFontWeight(a.getWeight());return b}Ts(){this.tg={};for(let b of this.lo.getPreziW().getDocumentStyle().getFontClasses()){let c=b.getFontFamily();var a=b.getFontWeight();let d=b.getFontStyle();this.tg[b.getName()]=ta.TextModel.getFontFaceId("default",f.FontWeight.Normal,f.FontStyle.Normal);for(let e of this.lo.getPreziW().getDocumentStyle().getFontFamilies())if(c===e.getName()){a=k.j.selectBestMatchingFontFace({fontStyle:d,
fontWeight:a},[...e.getFontFaces()].map((a)=>({fontWeight:a.getFontWeight(),fontStyle:a.getFontStyle()})));null!=a&&(this.tg[b.getName()]=ta.TextModel.getFontFaceId(c,a.fontWeight,a.fontStyle));break}}}uu(a){return this.tg[a.getWrapper(f.CetModel.ID.HAS_FONT.W).getFontClass()]}fix(a){if(!a.hasComponent(l.f.ya)||e.Cet.draw(a).isDisposed())return!1;var b=this.uu(a);b=this.Fs(b);b=b.setColor(ta.TextModel.createColor(a.get(f.CetModel.ID.HAS_COLOR.COLOR).getRGBInt()));const c=!a.getComponent(l.f.ya).getShapedText().getBaseStyle().equals(b);
if(!c&&this.cn(a)===a.getLastEntityVersion(this))return!1;if(!this.fontsLoadedStateHolder.ss(b.getFontFamily()))return h.CetRendererModule.setLoaded(a,!1),!1;c&&a.getMutableComponent(l.f.ya).setBaseStyle(a,b);h.CetRendererModule.setLoaded(a,!0);a.setLastEntityVersion(this,this.cn(a));return!0}};M.Sc.fo=!1;M.Lq=class{constructor(a,b){this.assetManager=a;this.ju=b;this.Ke=this.version=0;this.Em=n.Bacon.newBus();this.Fm=this.Em.toProperty(!1);this.Fm.onValue(()=>{});this.Cm=n.Bacon.newBus();this.Dm=
this.Cm.toProperty(null);this.Dm.onValue(()=>{});this.ec={};this.Bm=new M.Kq}getVersion(){return this.version}getFontLoadErrorPropery(){return this.Dm}ss(a){if("default"===a)return!0;let b=!1;for(let c in this.ec)if(0===c.indexOf(a)&&(b=!0,!this.ec[c]))return!1;return b}addDownloadedFont(a){let b=a.fontFamily;for(const c of Uc.getFontFaces(a))a=ta.TextModel.getFontFaceId(b,c.weight,c.style),null==this.ec[a.getId()]&&(this.ec[a.getId()]=!0)}vl(){return 0===this.Ke}Gt(a){const b=n.Bacon.newBus();this.version++;
this.ec={};this.Ke=0;for(let b of a.getPreziW().getDocumentStyle().getFontFamilies()){let a=b.getName();for(let d of b.getFontFaces()){var c=d.getFontWeight();let b=d.getFontStyle();c=ta.TextModel.getFontFaceId(a,c,b);null==this.ec[c.getId()]&&(this.ec[c.getId()]=!1,this.Ke++)}}const d=()=>{b.end();this.Em.push(!0)};0<this.Ke?(a=a.getPrezi().getComponent(l.f.MODEL).getPdomObject(),this.assetManager.createFontSetFetcher(a,this.ju).fetch().onValue((a)=>{this.version++;const c=a.fontFaceId.getId();!1===
this.ec[c]&&(this.ec[c]=!0,b.push(c),this.Ke--);null!=a.error?(this.Cm.push(a),this.vl()&&setTimeout(()=>{d()},0)):this.vl()&&d()})):setTimeout(()=>{d()},0);return b}};var Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});Ea.ve=class extends P.ue{constructor(a,b,c){var d;super(a,b,c);this.Rb=!1;this.Do=T.YoutubePlayerState.UNSTARTED;this.ef=this.yh=!1;this.logger=u.LoggerModule.getLoggerManager().createLogger("prezi_cet.ZVideoYoutubePeer");this.setWidth(Ea.ve.Gf);this.setHeight(Ea.ve.Ff);this.Ub=
"video_youtube_"+this.Zc;this.Fh="youtube_"+this.Zc;this.Sp=null!==(d=a.getStartTime())&&void 0!==d?d:0;this.cg=this.Gj=0}getCurrentTime(){try{return this.ea.getCurrentTime()}catch(a){return 0}}Ai(){let a=this.aa.M.createElement(this.Ub);a.style.display="block";a.style.left="-9999px";a.style.position="absolute";a.style.background="black";let b=window.document.createElement("div");b.id=this.Fh;b.style.zIndex="100";b.style.position="relative";b.style.top="65px";b.style.left="60px";a.appendChild(b);
this.ej()}onReady(){this.ef=!0;this.status=P.VideoState.pe;this.setMute(this.Rb);this.fa.setIsMuted(this.Rb);this.fa.jp();this.Yd&&this.playVideo()}playVideo(){if(this.Yd)if(null==this.ea)this.Ai();else{try{this.ef&&(u.avro.Avro.createDefaultLogger().logNavigatePrezi({navigation_type:"START_VIDEO",action_index:-1,step_index:-1,total_step_number:-1}),this.ea.playVideo(),this.yh=0===this.Sp)}catch(a){this.logger.error({action:"play_error",object:"youtube_player",trigger:"machine",payload:{error:a.toString()}});
return}this.status=P.VideoState.BUFFERING}}pauseVideo(){if(null!=this.ea){try{this.ef&&this.ea.pauseVideo()}catch(a){this.logger.error({action:"pause_error",object:"youtube_player",trigger:"machine",payload:{error:a.toString()}});return}this.fa.setIsPlaying(!1,this.getCurrentTime());this.status=P.VideoState.PAUSED}}onStateChange(){let a=this.ea.getPlayerState();if(T.YoutubePlayerState.PLAYING===a){let a=this.ea.getDuration();this.fa.ip(a);this.Gj=this.np(()=>this.Ng(),400);this.cg=this.np(()=>this.vj(),
600);this.status=P.VideoState.PLAYING;this.fa.setIsPlaying(!0,this.getCurrentTime())}else T.YoutubePlayerState.ENDED===a?(this.Ng(),this.Ae(this.Gj),this.Ae(this.cg),this.fa.setIsPlaying(!1,this.getCurrentTime()),this.ea.clearVideo(),window.focus()):T.YoutubePlayerState.PLAYING!==a&&(this.fa.setIsPlaying(!1,this.getCurrentTime()),this.Ae(this.Gj),this.Ae(this.cg));a===T.YoutubePlayerState.UNSTARTED&&this.Do===T.YoutubePlayerState.BUFFERING&&this.yh&&(this.Yd&&!this.Rb&&(this.setMute(!0),this.ea.playVideo()),
this.yh=!1);if(a===T.YoutubePlayerState.PLAYING||a===T.YoutubePlayerState.PAUSED||a===T.YoutubePlayerState.ENDED)this.yh=!1;this.Do=a}setMute(a){try{!0===a?(this.Rb=!0,this.ef&&this.ea.mute()):(this.Rb=!1,this.ef&&this.ea.unMute())}catch(b){this.logger.error({action:"mute_error",object:"youtube_player",trigger:"machine",payload:{error:b.toString()}})}}Ng(){this.fa.vk(this.ea.getCurrentTime())}vj(){let a=this.ea.getDuration()*this.ea.getVideoLoadedFraction();this.fa.Mp(a);.99<this.ea.getVideoLoadedFraction()&&
this.Ae(this.cg)}cf(){super.cf();$("#"+this.Ub).width(this.Xe).height(this.We);$("#"+this.Fh).width(this.Xe-120).height(this.We-100)}onError(a){this.logger.error({action:"youtube_error",object:"youtube_player",trigger:"machine",payload:{ay:a.data}});this.fa.dk(!1)}seekTo(a){null!=this.ea&&(this.ea.seekTo(a,!0),this.fa.vk(a))}ej(){var a=this.aa.M.getWidth();let b=this.aa.M.getHeight();a={width:a,height:b,videoId:this.onlineAssetId,playerVars:{controls:this.aa.video.getControlVisibility()?1:0,fs:0,
modestbranding:1,showinfo:0,html5:1,iv_load_policy:3,rel:0,start:this.Sp},events:{onReady:(a)=>this.onReady(a),onStateChange:(a)=>this.onStateChange(a),onError:(a)=>this.onError(a)}};this.ea=this.aa.video.initializeYoutubePlayer(this.Fh,a);document.body.tabIndex=-1;$(document.body).focusout(()=>{setTimeout(()=>{document.activeElement.id===this.Fh&&$(document.body).focus()},0)})}np(a,b){return setInterval(a,b)}Ae(a){0!==a&&clearInterval(a)}};Ea.ve.Gf=320;Ea.ve.Ff=240;var gc={};Object.defineProperty(gc,
"__esModule",{value:!0});class bd extends R.Wa{constructor(a,b){super();this.i=a;this.Dh=b}willReceiveFocus(){const a=this.O;null!=a&&this.i.getEntityList().forEach((b)=>{b.getId()!==a.getId()&&this.Dh.fadeOut(b,e.Cet.getAnimationData(e.AnimationType.CONTENT_FADE_OUT))})}onFocus(){const a=this.O;null!=a&&k.j.Yj(a,{kind:h.DrawComponentFocusEventKind.Received})}onLostFocus(){k.j.Yj(this.O,{kind:h.DrawComponentFocusEventKind.Lost});this.i.getEntityList().forEach((a)=>{this.Dh.fadeIn(a,e.Cet.getAnimationData(e.AnimationType.CONTENT_FADE_IN))})}}
gc.bs=class{constructor(a,b){this.aa=a;this.Va=b}init(a){this.i=a;this.Dh=a.getTweener().createVisibilityAnimationHelper("VideoVisibilitySystem")}process(a){var b=a.getComponent(h.CetRendererModule.getDrawComponentKey());if(b.kind===h.DrawComponentKind.videoThumbnail){b=a.getMutableWrapper(f.CetModel.ID.Z_VIDEO.W);var c=this.aa,d=this.Va;switch(b.getVideoType()){case "youtube":c=new Ea.ve(b,c,d);break;case "vimeo":c=new qa.ai(b,c,d);break;case "video":throw Error("Video type video should not require ZVideoPeer");
default:u.LoggerModule.getLoggerManager().log("ZVideoPeer",u.Level.ERROR,{action:"unknown_video_type ",object:"video",trigger:"machine",payload:{video_type:b.getVideoType()}}),c=null}c.fa.setVideoType(b.getVideoType());b=c;k.j.setFocusBehavior(a,b);a.setComponent(k.j.getLegacyOverlayComponentKey(),k.j.createOverlayComponent(b,b))}else b.kind===h.DrawComponentKind.onCanvasVideo&&k.j.setFocusBehavior(a,new bd(this.i,this.Dh))}select(a){return a.isDef(f.CetModel.ID.Z_VIDEO)}getName(){return"VideoPlaybackSystem"}reset(){}changesPdomComponents(){return!1}};
var kb={};Object.defineProperty(kb,"__esModule",{value:!0});kb.gl=class{constructor(a,b,c){this.fontsLoadedStateHolder=a;this.Va=b;this.Ua=c}createVideoPlaybackSystem(){return this.createInitializerSystem(new gc.bs(this.Ua,this.Va))}createWorldGeometrySystem(){return this.createShaperInflatorSystem(new jb.ll)}createThumbnailOnlyVideoSystem(){return this.createShaperSystem(new fc.Wr)}createQuadTreeSystem(a){return this.createShaperSystem(new cc.Ir(a))}createBoundCalculationSystem(){return this.createShaperInflatorSystem(new Ba.ee)}createRenderingInvalidatorSystem(a,
b){return this.createShaperSystem(new dc.Jr(a,b))}createOverviewFrameSystem(a){return this.createShaperSystem(new bc.wr(a))}createShaperSystem(a){return new ba.nc(a)}createShaperInflatorSystem(a){return new ba.nc(a)}createInitializerSystem(a){return new Zb.Bq(a)}createInvisibleFrameSystem(a){return new ac.br(a)}createImageInitSystem(a,b,c,d,e){return this.createShaperSystem(new Ua.Ok(a,b,c,d,e))}createZTextInitSystem(){null==this.Xp&&(this.Xp=new M.$h(this.fontsLoadedStateHolder,this.Va));return this.Xp}isInflator(a){return"initializeEntities"in
a}pv(a){return"update"in a}mapToPhases(a){let b=[],c=[];for(let d of a)this.isInflator(d)&&b.push(d),this.pv(d)&&c.push(d);return{initList:[],inflateList:b,updateList:c,updateOnceList:[],preRenderList:[],fixerList:[]}}};var Va={};Object.defineProperty(Va,"__esModule",{value:!0});Va.Rh=class{constructor(a,b,c,d){this.gb=a;this.ku=b;this.Va=c;this.Ua=d}getSceneHierarchy(){return this.gb}createRootScene(a,b){return this.gb.createRootScene(a,b)}createChildScene(a,b,c,d=!0){a=this.gb.createChildScene(b,
a,c);d||a.ak(new za.sr);a.updateEntitiesFromParentScene();return a}createAnimScene(a,b,c){a=this.gb.createAnimScene(b,a,c);a.updateEntitiesFromParentScene();return a}getSystemFactory(){return new kb.gl(this.ku,this.Va,this.Ua)}};var Wa={};Object.defineProperty(Wa,"__esModule",{value:!0});Wa.Sh=class{constructor(){this.Qd=0;this.uj=[];this.fp=[]}getScenes(){return[...this.fp]}createRootScene(a,b){if(null!=this.Rj)throw Error("root scene is already set");return this.Rj=this.gi(new L.Rf(this,a,b,null,
!1))}createChildScene(a,b,c){this.si(a);return this.gi(new L.Rf(this,b,c,a,!1))}createAnimScene(a,b,c){this.si(a);return this.gi(new L.Rf(this,b,c,a,!0))}setAutoCommitScene(a){this.si(a);this.Bs=a}getRootScene(){return this.Rj}si(a){if(a.getSceneHierarchy()!==this)throw Error("scene is not attached to the sceneHierarchy");}gi(a){this.fp.push(a);return a}};var hc={};Object.defineProperty(hc,"__esModule",{value:!0});hc.lq=class{constructor(){this.Ej=[];this.bc=n.Bacon.newBus()}trigger(a){this.ci=!0;
this.Ej.push(a)}dispose(){this.bi=!0}isDisposed(){return this.bi}execute(){if(this.ci&&!this.bi){let a=this.Ej.slice();this.Ej=[];for(let b of a)this.bc.push(b);this.bc.end();this.bi=!0}}};var ra={};Object.defineProperty(ra,"__esModule",{value:!0});ra.sd=class{constructor(a,b,c){this.be=a;this.J=b;this.viewport=c}static Be(a,b,c,d){return{id:a,targetType:b,animationType:c,phase:d}}lh(a){this.viewport=a}focusToOverview(a){a.setViewportTransform(this.Zm());return n.Bacon.once(ra.sd.Be(null,e.NavigationActionTargetType.ToOverview,
e.NavigationActionAnimationType.Focus,e.NavigationActionAnimationPhase.End))}flyToOverview(a){return this.wi(null,e.NavigationActionTargetType.ToOverview,e.NavigationActionAnimationType.Fly,(b)=>{a.Je(this.Zm(),b);a.mg()})}Am(a,b,c,d,g=e.CameraNavigationType.FLY){const r=a.kf!==b.getId()?this.be:this.J,h=k.j.Ui(r,b.getId(),this.viewport,a,c);return this.wi(b.getId(),e.NavigationActionTargetType.ToId,e.NavigationActionAnimationType.Fly,(c)=>{a.Je(h,c,d,g);b.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)||
a.mg()})}flyToRectangle(a,b,c,d,f,r){null==r&&(r=a.getMarginCorrectedViewport());r=a.getViewportMarginCorrectionTransform().invert().transformRectangle(r);let g=k.j.getTargetTransformForBounds(b,c,r);return this.wi(f,e.NavigationActionTargetType.ToRectangle,e.NavigationActionAnimationType.Fly,(b)=>{a.Je(g,b,d);a.mg()})}eu(a,b,c){b=this.be.getEntityById(b.getId());c=k.j.Ui(this.be,b.getId(),this.viewport,a,c);a.setViewportTransform(c);return n.Bacon.once(ra.sd.Be(b.getId(),e.NavigationActionTargetType.ToId,
e.NavigationActionAnimationType.Focus,e.NavigationActionAnimationPhase.End))}focusToRectangle(a,b,c){a.setViewportTransform(k.j.getTargetTransformForBounds(b,c,this.viewport));return n.Bacon.once(ra.sd.Be(null,e.NavigationActionTargetType.ToRectangle,e.NavigationActionAnimationType.Focus,e.NavigationActionAnimationPhase.End))}snapToId(a,b,c,d,f){return this.Am(a,b,c,f,d).filter((a)=>a.phase===e.NavigationActionAnimationPhase.End||a.phase===e.NavigationActionAnimationPhase.Cancel).map((a)=>ra.sd.Be(a.id,
a.targetType,e.NavigationActionAnimationType.Snap,a.phase))}Zm(){let a=this.be.getPrezi().getChild(f.CetModel.ID.PREZI.OVERVIEW);return k.j.getTargetTransform(this.be,a.getId(),this.viewport)}getWorldBounds(){return this.Ku(this.be.getEntityList())}Ku(a){let b=null;a.forEach((a)=>{a.hasComponent(h.CetRendererModule.getZOrderComponentKey())&&(a=l.f.Up(a),b=null==b?a:b.union(a))});null==b&&(b=t.Geometry.rectangleFromData({x:0,y:0,width:.01,height:.01}));return b}wi(a,b,c,d){let f=n.Bacon.newBus();d((d)=>
{f.push(ra.sd.Be(a,b,c,d?e.NavigationActionAnimationPhase.End:e.NavigationActionAnimationPhase.Cancel));f.end()});return f}};var A={};Object.defineProperty(A,"__esModule",{value:!0});A.da=class{static toggleDebugFlag(a){return a===e.DebugFlag.RENDER_ZOOMED_OUT_TO_SHOW_SURROUNDINGS?(A.da.bh=!A.da.bh,A.da.bh):a===e.DebugFlag.USE_PARTITION_RENDERER?(A.da.yk=!A.da.yk,A.da.yk):a===e.DebugFlag.DRAW_PARTITION_BORDERS?(A.da.Di=!A.da.Di,A.da.Di):a===e.DebugFlag.RENDER_PARTITIONS_ON_DEMAND?(A.da.Nj=!A.da.Nj,
A.da.Nj):a===e.DebugFlag.SHOW_OBJECT_IDS?(A.da.showObjectIds=!A.da.showObjectIds,A.da.showObjectIds):a===e.DebugFlag.QUADTREE_BOUNDS?(A.da.Yg=!A.da.Yg,A.da.Yg):a===e.DebugFlag.CAMERA_AREA?(A.da.ni=!A.da.ni,A.da.ni):!1}};A.da.Di=!1;A.da.Nj=!1;A.da.bh=!1;A.da.yk=!0;A.da.showObjectIds=!1;A.da.Yg=!1;A.da.ni=!1;var ic={};Object.defineProperty(ic,"__esModule",{value:!0});ic.ur=class extends R.Wa{constructor(a,b){super();this.Aj=a;this.data=b}refresh(a,b){this.Aj.refresh(a,b,this.Dn)}getOverlay(){return this.Aj}getData(){return this.data}dispose(){super.dispose();
this.Aj.dispose()}setClickable(a){this.Dn=a}getClickable(){return this.Dn}};var N={};Object.defineProperty(N,"__esModule",{value:!0});N.Ia=class{static by(){return N.Ia.Xc}static Si(){const a=N.Ia.Xc;return Object.keys(a).map((b)=>a[b])}static createOverlayComponentKey(a,b){if(N.Ia.Xc[a])return N.Ia.Xc[a];b=f.CetModel.createComponentKey(a,!1,!1,b);return N.Ia.Xc[a]=b}static createOverlayComponent(a,b){return new ic.ur(a,b)}static getLegacyOverlayComponentKey(){null==N.Ia.Xc.overlay&&N.Ia.createOverlayComponentKey("overlay",
!1);return N.Ia.Xc.overlay}};N.Ia.Xc={};var jc={};Object.defineProperty(jc,"__esModule",{value:!0});jc.vr=class{constructor(a){this.Ed={};this.i=a;this.Wo()}Wo(){this.Ed={};this.Pg=N.Ia.Si();this.i.getEntityList().forEach((a)=>{this.Pg.map((b)=>a.getComponent(b)).filter((a)=>null!=a).length&&(this.Ed[a.getId()]=!0)});null!=this.Bj&&this.i.getEntityList().stopTracking(this.Bj);this.Bj=this.i.getEntityList().startNewTracking("Stage-OverlayTarcker",[f.CetModel.getNewEntityCompKey(),f.CetModel.getRemovedEntityCompKey()].concat(this.Pg),
()=>!0)}update(){if(null!=this.i){let a=N.Ia.Si();x.Utils.arrayEquals(a,this.Pg)||this.Wo();this.i.getEntityList().forChangedEntities((a)=>{for(let b of a){a=!1;if(null!=b)for(let c of this.Pg)if(b.hasComponent(c)){a=!0;break}a?this.Ed[b.getId()]=!0:delete this.Ed[b.getId()]}},this.Bj)}}su(){return Object.keys(this.Ed)}lu(a){let b=N.Ia.Si();const c=[];for(let d of this.su()){const e=this.i.getEntityById(d);if(null!=e){let c=b.map((a)=>e.getComponent(a)).filter((a)=>null!=a);0<c.length&&a(e,c)}else c.push(d)}for(let a of c)delete this.Ed[a]}};
var sa={},Qc=this&&sa.Vf||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,f){function g(a){try{h(d.next(a))}catch(I){f(I)}}function r(a){try{h(d["throw"](a))}catch(I){f(I)}}function h(a){a.done?c(a.value):e(a.value).then(g,r)}h((d=d.apply(a,b||[])).next())})};Object.defineProperty(sa,"__esModule",{value:!0});sa.re=class{constructor(a,b,c,d,g,r,h,k){this.iv=k;this.Vc={onlyEditMode:!0,source:null,live:!0,top:0,left:0,width:1600,
height:900,texOffsetX:0,texOffsetY:0,texScaleX:1,texScaleY:1};this.uw=x.Utils.createSequencer();this.eo=!1;this.jk=e.StageTweenMode.ANIMATE_ONLY_CURRENT;this.marginTop=this.marginRight=this.marginBottom=this.marginLeft=0;this.Bh=null;this.ic=r;this.jb=n.Bacon.newBus();this.camera=b;this.video=h;this.Gl=new Map;b.yw(()=>this.Mu());this.Dc=c;this.ww(a);this.sf={x:a.width/2,y:a.height/2};a=t.Geometry.rectangleFromData({x:-this.sf.x,y:-this.sf.y,width:a.width,height:a.height});this.camera.lh(a);this.camera.bk(a);
this.camera.Gw(this);this.xc=d;this.aspectRatio=e.Cet.parseAspectRatio(f.AspectRatio.Off);this.ji=f.AspectRatio.Off;this.wa=g;this.dg=x.Utils.createLinkedList();this.ep=n.Bacon.newBus();this.cp=n.Bacon.newBus();this.io=n.Bacon.newBus();this.logger=u.LoggerModule.getLoggerManager().createLogger("prezi_cet.StageImpl");if(null!=this.video)this.video.getVideoEventStream().onValue((a)=>{this.Bx=a.eventType})}registerScene(a,b){this.Gl.set(b,a)}updateBackgroundVideoParams(a){this.Vc=Object.assign(Object.assign({},
this.Vc),a);this.markViewChanged()}getBackgroundVideoParams(){return this.Vc}setScene(a,b){var c,d;if(this.Pd!==a||this.J!==b)this.cu(),null!=this.J&&this.J.setTweenMode(e.TweenMode.IMMEDIATE),this.jk===e.StageTweenMode.ANIMATE_ONLY_CURRENT?b.setTweenMode(e.TweenMode.ANIMATION):this.jk===e.StageTweenMode.NEVER_ANIMATE&&b.setTweenMode(e.TweenMode.IMMEDIATE),null!=this.J&&(this.J.update(),this.J.update(e.UpdatePhase.PRE_RENDER),null===(c=this.Ti())||void 0===c?void 0:c.setInteractive(!1)),this.Pd=a,
this.J=b,null!=this.J&&(null===(d=this.Ti())||void 0===d?void 0:d.setInteractive(!0)),this.ic.setScene(b),this.uk(),this.mh(!0),null!=this.Bh&&(this.Bh(),this.Bh=null),this.Bh=b.onViewChange(()=>this.markViewChanged()),this.hitTest=this.Dc.getHitTest(),this.cc=new ra.sd(a,b,this.camera.getViewport()),b.update(),this.resizeStage(this.ia),this.vo=new jc.vr(this.J),this.markViewChanged(),this.cp.push(null)}setStageTweenMode(a){this.jk=a}cu(){if(null!=this.J){var a=this.J.getTweener();null!=a&&this.J.getEntityList().forEachMutable((b)=>
{a.removeTweens(b.getId())})}}getRenderedScene(){return this.J}getModelScene(){return this.Pd}getPathNavigator(){return this.ic}ww(a){let b=this.ia;this.ia=a;this.markViewChanged();null==b||b.width===this.ia.width&&b.height===this.ia.height||this.resizeStage(this.ia)}getHitTest(){return this.hitTest}resetForTest(){this.wa.ih(null)}dispose(){this.Jd().forEachMutable((a)=>{a.dispose()})}forEachEntities(a){return this.Jd().forEach(a)}Jd(){return this.J.getEntityList()}getEntityById(a){return this.Jd().getEntityById(a)}resizeStage(a){this.ia=
a;this.sf={x:a.width/2,y:a.height/2};var b=this.camera.getStageArea().getData(),c=a.width;a=a.height;this.Pp();this.camera.du();this.mh(!0);let d=this.wa.fc();null!=d?(b=k.j.Ui(this.J,d.getId(),this.camera.getViewport(),this.camera,e.CameraNavigationTrigger.free),this.camera.setViewportTransform(b)):(b=Math.min(c/b.width,a/b.height),this.camera.setViewportTransform(this.camera.getViewportTransform().scaleAroundPoint({x:0,y:0},b)));this.markViewChanged()}mh(a){let b,c,d,e;null!=this.J&&null!=this.J.getPrezi()&&
this.J.getPrezi().get(k.j.getAspectRatioClipComponentKey())?(b=Math.max(-this.ia.width/2+this.marginLeft,this.camera.getViewport().getTopLeft().x),c=Math.max(-this.ia.height/2+this.marginTop,this.camera.getViewport().getTopLeft().y),d=Math.min(this.ia.width/2-this.marginRight,this.camera.getViewport().getBottomRight().x),e=Math.min(this.ia.height/2-this.marginBottom,this.camera.getViewport().getBottomRight().y)):(b=-this.ia.width/2+this.marginLeft,c=-this.ia.height/2+this.marginTop,d=this.ia.width/
2-this.marginRight,e=this.ia.height/2-this.marginBottom);this.camera.Iw(t.Geometry.rectangleFromData({x:b,y:c,width:Math.abs(d-b),height:Math.abs(e-c)}),a)}setMargins(a,b,c,d,e,f=!0){null!=this.J&&null!=this.J.getPrezi()&&this.J.getPrezi().set(k.j.getAspectRatioClipComponentKey(),e);this.marginTop=a;this.marginRight=b;this.marginBottom=c;this.marginLeft=d;this.io.push({left:d,right:b,top:a,bottom:c});this.mh(f);this.markViewChanged()}getMarginsProperty(){return this.io.toProperty({left:this.marginLeft,
right:this.marginRight,top:this.marginTop,bottom:this.marginBottom})}zw(a){this.Og=a}markViewChanged(){this.pj=!0;null!=this.Og&&this.Og()}isInAnimation(){return this.camera.sj()||this.tj()}update(){this.pj=!1;(()=>{this.camera.sx();this.camera.ox();this.camera.xx()})();this.Pd.update(e.UpdatePhase.UPDATE);this.Pd.update(e.UpdatePhase.TWEEN);this.Pd.update(e.UpdatePhase.PRE_RENDER);this.J.updateEntitiesFromParentScene();this.setAspectRatio(this.J.getPreziW().getAspectRatio());this.J.update(e.UpdatePhase.UPDATE_ONCE);
this.xc.update(this.J);this.J.update(e.UpdatePhase.TWEEN);this.J.update(e.UpdatePhase.PRE_RENDER)}drawFrame(){this.update();const a=this.draw();(this.camera.sj()||this.tj())&&this.markViewChanged();this.fv();this.ep.push(this.J);return a}forceDraw(){this.markViewChanged();this.drawFrame()}md(a){let b=new hc.lq;this.dg.push(b);a.onValue((a)=>{b.trigger(a);this.markViewChanged()});return b.bc}fv(){let a=this.dg.filter((a)=>a.ci);this.dg=this.dg.filter((a)=>!a.ci);for(let b of a)b.execute()}getScreenBounds(a){return a.getComponent(h.CetRendererModule.getWorldGeometryComponentKey()).getWorldBounds().transform(this.camera.getTargetTransform())}isEntityInCamera(a){return this.camera.getWorldArea().intersects(l.f.Dx(a))}isEntityContainedInCamera(a,
b=1){a=t.Geometry.obbFromRect(l.f.Up(a).getData());const c=(a.getWidth()/b-a.getWidth())/2;b=(a.getHeight()/b-a.getHeight())/2;a=a.inflateXY(c,b).union(this.camera.getWorldArea());return this.camera.getWorldArea().equalsWithin(a,Math.pow(2,-44))}Mu(){this.camera.ye();this.Cb(null);this.markViewChanged()}getStageArea(){return this.camera.getStageArea()}getCamera(){return this.camera}getAspectRatio(){return this.ji}setAspectRatio(a){if(a!==this.ji){let b=k.j.parseAspectRatio(a);if(b.width!==this.aspectRatio.width||
b.height!==this.aspectRatio.height||b.letterBoxing!==this.aspectRatio.letterBoxing)this.aspectRatio=b,this.Pp();this.ji=a}}Pp(){let a=t.Geometry.rectangleFromData({x:-this.sf.x,y:-this.sf.y,width:this.ia.width,height:this.ia.height});this.Hw();this.camera.bk(a);null!=this.cc&&this.cc.lh(this.camera.getViewport())}Hw(){this.camera.lh(this.Ls());this.mh(!0)}Ls(){var a=this.ia.width,b=this.ia.height;this.aspectRatio.letterBoxing&&(b=this.aspectRatio.width/this.aspectRatio.height,a=Math.round(this.ia.height*
b),b=Math.round(this.ia.width/b),b<this.ia.height?a=this.ia.width:b=this.ia.height);return t.Geometry.rectangleFromData({x:-(a/2),y:-(b/2),width:a,height:b})}setBottomPadding(){}getBackgroundsInDepthOrder(){return h.CetRendererModule.getBackgroundsInDepthOrder(this.J.getPreziW())}draw(){if(!this.iv)return!1;var a=this.J.getName();const b="edit-animation"===a;null!=this.Vc&&this.Vc.onlyEditMode&&!b&&(this.Vc.source=null);var c={showObjectIds:A.da.showObjectIds,showQuadtreeBounds:A.da.Yg,showSurroundings:A.da.bh,
camera:this.camera,aspectRatioClip:this.J.getPrezi().get(l.f.Bk),backgroundVideo:this.Vc,showBackground:!0,showDecoration:!0,showGrid:b};this.logger.time("draw_entities");const d=this.Ti();c=this.Dc.drawEntities(d,this.J.getPreziW(),this,c);this.eo||"playback"!==a&&!b||(a="playback"===a?"playback":"edit",u.LoggerModule.createLogHelper().loadTimerEnd(this.logger,u.LoadEvent.FirstValidFrame,a,h.RendererKind[h.RendererKind.WebGl]),this.eo=!0);this.bw(this.J.getEntityList());return c}Ti(){return this.Gl.get(this.J)}tj(){return this.xc.needsFrameImmediately()||
this.J.getTweener().needsFrameImmediately()}getNextFrameTime(){let a=-1,b=this.xc.getNextFrameTime(),c=this.J.getTweener().getNextFrameTime();0<=b&&(a=b);0<=c&&(a=Math.min(c,0<=a?a:c));return a}bw(){this.vo.update();this.vo.lu((a,b)=>{b.forEach((b)=>b.refresh(this,a))})}fadeOutPeerById(a){var b=this.Jd().getEntityById(a);if(null!=b){let c=n.Bacon.newBus();this.xc.Yt(b,()=>{c.push({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.FadeOut,phase:e.NavigationActionAnimationPhase.End});
c.end()});this.markViewChanged();b=c;this.jb.push({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.FadeOut,phase:e.NavigationActionAnimationPhase.Start})}else b=n.Bacon.once({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.FadeOut,phase:e.NavigationActionAnimationPhase.Cancel});return this.md(b)}fadeInPeerById(a){var b=this.Jd().getEntityById(a);if(null!=b){let c=n.Bacon.newBus();e.Cet.updateVisibility(b).setEnabled(!0);
this.xc.Wt(b,()=>{c.push({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.FadeIn,phase:e.NavigationActionAnimationPhase.End});c.end()});this.markViewChanged();b=c;this.jb.push({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.FadeIn,phase:e.NavigationActionAnimationPhase.Start})}else b=n.Bacon.once({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.FadeIn,phase:e.NavigationActionAnimationPhase.Cancel});
return this.md(b)}uk(){this.wa.setScene(this.Pd);this.wa.uk()}Cb(a){this.wa.ih(a)}getImageDataForTest(a,b){let c=this.camera.getStageArea().getData();return this.Dc.getImageDataForTest(a+c.width/2,b+c.height/2,1,1)}createCopiedCanvasForTest(){return Qc(this,void 0,void 0,function*(){const a=Math.floor(this.ia.width),b=Math.floor(this.ia.height),c=yield this.Dc.getImageDataForTest(0,0,a,b),d=h.CetRendererModule.createCanvas(a,b);d.getContext("2d").fillStyle="transparent";d.getContext("2d").fillRect(0,
0,a,b);d.getContext("2d").putImageData(c,0,0);return d})}createSnapshotCanvas(a,b,c,d,e,f){return!isFinite(b.width)||!isFinite(b.height)||0>=b.width||0>=b.height||b.width!==Math.floor(b.width)||b.height!==Math.floor(b.height)?Promise.reject("image size width and height should be a positive integer"):this.uw.addNext(()=>Qc(this,void 0,void 0,function*(){null==this.sp&&(this.sp=this.Dc.createChannel("SnapShot",!1));var g=new fa.Jc(t.Geometry.rectangleFromData(Object.assign({x:-b.width/2,y:-b.height/
2},b)));g.bk(g.getViewport());var h=g.getWorldArea();h=t.Geometry.getFitTransform(a,h,!0);g.setViewportTransform(h);h={showObjectIds:!1,showQuadtreeBounds:!1,showSurroundings:!1,camera:g,aspectRatioClip:!1,backgroundVideo:null,showBackground:c,showDecoration:!1,showGrid:!1};this.forceDraw();var {canvas:r,wasCancelled:k}=yield this.Dc.getSnapshotImageData(Object.assign(Object.assign({},g.getStageArea().getData()),{x:0,y:0}),this.sp,this.J.getPreziW(),this,d,e,h,f);e&&H.isActive("js-for-test-slow-hq-snapshot")&&
(yield x.Utils.sleep(1E4));!e&&H.isActive("js-for-test-green-lq-snapshot")&&(g=document.createElement("canvas"),g.id=r.id,g.width=r.width,g.height=r.height,h=g.getContext("2d"),h.fillStyle="#00ff00",h.fillRect(0,0,g.width,g.height),r=g);return{canvas:r,wasCancelled:k}}))}flyToId(a,b,c){let d=this.getEntityById(a);return null!=d?this.Je(d,b,c):n.Bacon.once({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Fly,phase:e.NavigationActionAnimationPhase.Cancel})}flyToRectangle(a,
b,c,d,f){this.jb.push({id:d,targetType:e.NavigationActionTargetType.ToRectangle,animationType:e.NavigationActionAnimationType.Fly,phase:e.NavigationActionAnimationPhase.Start});a=this.cc.flyToRectangle(this.camera,a,b,c,d,f);this.markViewChanged();return a}Je(a,b,c){this.jb.push({id:a.getId(),targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Fly,phase:e.NavigationActionAnimationPhase.Start});a=this.getEntityById(a.getId());a!==this.wa.fc()&&(this.Cb(null),
this.wa.jh(a));this.zm=a;let d=n.Bacon.newBus();b=this.cc.Am(this.camera,this.zm,b,c);b.onValue((b)=>{a=this.getEntityById(a.getId());b.phase===e.NavigationActionAnimationPhase.End&&this.Cb(a);this.markViewChanged()});this.md(b).onValue((a)=>{d.push(a);d.end()});this.markViewChanged();return d}inverseFlight(a,b){let c=this.getEntityById(a);if(null!=c){this.jb.push({id:c.getId(),targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Fly,phase:e.NavigationActionAnimationPhase.Start});
let d=n.Bacon.newBus();this.getCamera().invertCurrentTransition(b);this.getCamera().whenTransitionFinished((b)=>{d.push({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Fly,phase:b?e.NavigationActionAnimationPhase.End:e.NavigationActionAnimationPhase.Cancel});d.end()});this.zm=c;return d}return n.Bacon.once({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Fly,phase:e.NavigationActionAnimationPhase.Cancel})}getNavigationActions(){return this.jb}focusToOverview(a){var b=
this.J.getPreziW().getOverview().getId();this.jb.push({id:b,targetType:e.NavigationActionTargetType.ToOverview,animationType:e.NavigationActionAnimationType.Focus,phase:e.NavigationActionAnimationPhase.Start});b=this.cc.focusToOverview(this.camera);this.Cb(this.J.getPreziW().getOverview().getEntity());this.markViewChanged();return a?this.md(b):b}flyToOverview(){const a=this.J.getPreziW().getOverview();var b=a.getId();this.jb.push({id:b,targetType:e.NavigationActionTargetType.ToOverview,animationType:e.NavigationActionAnimationType.Fly,
phase:e.NavigationActionAnimationPhase.Start});b=this.cc.flyToOverview(this.camera);b.onValue((a)=>{a.phase===e.NavigationActionAnimationPhase.End&&this.Cb(this.J.getPreziW().getOverview().getEntity())});this.Cb(null);this.wa.jh(a.getEntity());this.markViewChanged();return this.md(b)}focusTo(a,b,c){this.jb.push({id:a.getId(),targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Focus,phase:e.NavigationActionAnimationPhase.Start});c=this.cc.eu(this.camera,a,c);
a!==this.wa.fc()&&(this.Cb(null),this.wa.jh(a));this.Cb(a);this.markViewChanged();this.jb.push({id:a.getId(),targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Focus,phase:e.NavigationActionAnimationPhase.End});return b?this.md(c):c}focusToRectangle(a,b,c){c&&this.Cb(null);this.jb.push({id:null,targetType:e.NavigationActionTargetType.ToRectangle,animationType:e.NavigationActionAnimationType.Focus,phase:e.NavigationActionAnimationPhase.Start,withoutCurrentTopicUpdate:c});
a=this.cc.focusToRectangle(this.camera,a,b);this.markViewChanged();return a}focusToId(a,b,c){let d=this.getEntityById(a);return null!=d?this.focusTo(d,b,c):n.Bacon.once({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Focus,phase:e.NavigationActionAnimationPhase.Cancel})}getEntityIdInFocusStream(){return this.wa.nm.map((a)=>null!=a?a.getId():null).skipDuplicates()}getEntityIdInFocus(){let a=this.wa.fc();return null!=a?a.getId():null}getEntityIds(){let a=
[];this.forEachEntities((b)=>{a.push(b.getId())});return a}getStageCamera(){return this.camera}getSceneUpdateStream(){return this.ep}getSceneReplacedStream(){return this.cp}getCurrentCameraNavigation(){return this.camera.getCurrentCameraNavigation()}snapToId(a,b,c,d,f){this.jb.push({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Snap,phase:e.NavigationActionAnimationPhase.Start});let g=this.getEntityById(a);this.Cb(null);this.wa.jh(g);let h=n.Bacon.newBus();
a=this.cc.snapToId(this.camera,g,b,c,d);a.onValue((a)=>{g=this.getEntityById(g.getId());a.phase===e.NavigationActionAnimationPhase.End&&this.Cb(g);this.markViewChanged();null!=f&&f(a.phase)});this.md(a).onValue((a)=>{h.push(a);h.end()});this.markViewChanged();return h}slideTo(a){this.camera.slideTo(a);this.markViewChanged();return n.Bacon.once({id:null,targetType:e.NavigationActionTargetType.ToRectangle,animationType:e.NavigationActionAnimationType.Slide,phase:e.NavigationActionAnimationPhase.Start})}slideToRect(a,
b){a=k.j.getTargetTransformForBounds(a,b,this.camera.getViewport()).scaleAroundPoint({x:0,y:0},1);this.camera.slideTo(a);this.markViewChanged();return n.Bacon.once({id:null,targetType:e.NavigationActionTargetType.ToRectangle,animationType:e.NavigationActionAnimationType.Slide,phase:e.NavigationActionAnimationPhase.Start})}getVideoEventStream(){return this.video.getVideoEventStream()}play(a){var b=this.wa.fc();null!=b&&(b=b.getComponent(l.f.VIDEO),null!=b&&(null!=a&&b.seekTo(a),b.playVideo()))}seekTo(a){var b=
this.wa.fc();null!=b&&(b=b.getComponent(l.f.VIDEO),null!=b&&b.seekTo(a))}pause(){var a=this.wa.fc();null!=a&&(a=a.getComponent(l.f.VIDEO),null!=a&&a.pauseVideo())}getCurrentTime(){var a=this.wa.fc();return null!=a&&(a=a.getComponent(l.f.VIDEO),null!=a)?a.getCurrentTime():0}setVideoControlVisibility(a){null!=this.video&&this.video.setControlVisibility(a)}resetVideos(){this.forEachEntities((a)=>{a=a.getComponent(l.f.VIDEO);null!=a&&a.seekTo(0)})}toggleVideoPlay(){switch(this.Bx){case T.VideoEventType.Play:this.pause();
break;case T.VideoEventType.Pause:this.play()}}getRenderer(){return this.Dc}getRenderingTextFactory(){return this.Dc.getRenderingTextFactory()}getLocalToWorldInRenderedScene(a){let b=this.getRenderedScene().getEntityById(a);if(null==this.getRenderedScene().getRootScene().getEntityById(a))return null;if(null!=b)try{return h.CetRendererModule.getLocalToWorld(b)}catch(c){}return null}};sa.re.wq=!1;sa.re.Hx=768;sa.re.Jx=.9;var lb={};Object.defineProperty(lb,"__esModule",{value:!0});lb.FadingComponent=
class extends R.Wa{constructor(a,b){super();this.Hi=0;this.fj=a;this.Hi=b}createChildComponent(){let a=new lb.FadingComponent(this.fj,this.Hi);a.version=this.version;return a}getFadingId(){return this.Hi}setIsFadingFlag(a){this.fj=a}getIsFadingFlag(){return this.fj}};var kc={};Object.defineProperty(kc,"__esModule",{value:!0});kc.Vq=class{constructor(a,b,c){this.M=a;this.Su=b;this.Xj=c}refresh(a,b){null==this.Md&&(this.Md=this.M.createIconElement(b.getId(),this.Su,this.Xj),this.M.setElementClickable(this.Md.id,
!1));this.M.positionElementToCenter(this.Md.id,this.Xj,this.Xj);this.M.transform(this.Md.id,t.Geometry.createFromTransform(l.f.transform(b).getLocalToWorld()))}dispose(){if(null!=this.Md){let a=window.document.getElementById(this.Md.id);a.parentElement.removeChild(a)}}};var mb={};Object.defineProperty(mb,"__esModule",{value:!0});mb.Hk=class{constructor(a){this.M=a}createNoFocusBehaviorComponent(){return new ib.Wk}createFadingComponent(a,b){return new lb.FadingComponent(a,b)}createWorldGeometryComponent(){return h.CetRendererModule.createWorldGeometryComponent()}createPdomComponent(a){return new Aa.ne(a)}createMutableVarrayComponent(){return new oa.vd(null)}setIconOverlay(a,
b,c=24){b=new kc.Vq(this.M,b,c);a.setComponent(k.j.getLegacyOverlayComponentKey(),k.j.createOverlayComponent(b))}};var lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.Dq=class{constructor(a){this.assetManager=a}process(a){for(let b of a)if(b.get(f.CetModel.ID.MEDIA_ASSET.OFFLINE_ASSET_ID)!==e.Cet.errorOfflineAssetId||e.Cet.draw(b).isErrorDraw()||(e.Cet.mutableDraw(b).setError(),e.Cet.removeSpinner(b)),e.Cet.draw(b).hasError()){a=null;try{a=e.Cet.draw(b).calculateGraphicsBounds(b)}catch(c){a=
t.Geometry.rectangleFromData({x:0,y:0,width:100,height:100})}b.setComponent(h.CetRendererModule.getDrawComponentKey(),h.CetRendererModule.createErrorDrawComponent(a))}}select(a){return null!=e.Cet.draw(a)}getTriggerKeys(){return[h.CetRendererModule.getDrawComponentKey(),f.CetModel.ID.MEDIA_ASSET.OFFLINE_ASSET_ID]}getName(){return"ErrorDrawSystem"}reset(){}changesPdomComponents(){return!1}};var mc={};Object.defineProperty(mc,"__esModule",{value:!0});mc.tr=class{constructor(a){this.Bn=this.Jn=!1;a.take(1).onValue(()=>
{this.Bn=!0})}update(a){this.Bn&&!this.Jn&&(h.CetRendererModule.collectStatistics(a.getEntityList().asArray()),this.Jn=!0)}getName(){return"OnLoadedAssetsStatisticsSystem"}init(){}reset(){}changesPdomComponents(){return!1}};var ca={};Object.defineProperty(ca,"__esModule",{value:!0});ca.cs=class{getShapedText(a){return k.j.shapedText(a)}getSelectedRange(a){return a.get(l.f.Pf)}getTextSelectionFocused(a){return a.get(l.f.Vh)}selectionRangeComponentVersion(a){a=a.getComponent(l.f.Pf);return null==a?
0:a.getVersion()}getShapedTextComponentVersion(a){return a.getComponent(l.f.ya).getVersion()}hasCaret(a){return null!=a.get(l.f.hl)}};ca.zd=class{constructor(a,b,c){this.aa=a;this.logger=u.LoggerModule.getLoggerManager().createLogger("ZObjectInitSystem");this.Kl();this.wl=b;this.Va=c;this.Gx=new ca.cs}getName(){return"ZObjectInitSystem"}initializeEntities(a,b){let c=0;for(var d of a.getEntityList().asArray()){var e=k.j.zOrder(d);null!=e&&e.getZIndex()>c&&(c=e.getZIndex())}d=[];e=[];for(let g of b)g.isDef(f.CetModel.ID.Z_OBJECT)&&
this.zn(g,++c,d,e),g.isDef(f.CetModel.ID.FLY_TO_OVERVIEW_EP)&&this.dj(g,a),g.isDef(f.CetModel.ID.OVERVIEW)&&this.yn(a,g),g.isDef(f.CetModel.ID.BACKGROUND_LAYER)&&this.Ho(g),g.isDef(f.CetModel.ID.BACKGROUND)&&this.Go(g);this.Jo(d,e)}update(a){var b=a.getPrezi();this.Yv(b);this.Go(b.getChild(f.CetModel.ID.PREZI.BACKGROUND));this.Sv(b);this.Nw(a)&&(b=a.getPrezi().getChild(f.CetModel.ID.PREZI.OVERVIEW),this.yn(a,b))}Nw(a){let b=a.getPrezi().getComponent(f.CetModel.ID.PREZI.OVERVIEW);if(null==b)return!1;
a=k.j.pathKludge.getEditorPathComponent(a).getVersion();if(b.getVersion()===this.Wn&&this.Xn===a)return!1;this.Wn=b.getVersion();this.Xn=a;return!0}yn(a,b){if(null!=b){if(null==k.j.draw(b)){var c=h.CetRendererModule.createOverViewFrameDrawComponent();b.setComponent(h.CetRendererModule.getDrawComponentKey(),c);b.set(f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD,t.Geometry.transform2dIdentity());const d=k.j.parseAspectRatio(a.getPreziW().getAspectRatio());c.setAspectRatio(d.width,d.height,d.letterBoxing)}null==
k.j.visibility(b,!0)&&(c=new ua.te,c.setAlpha(0),c.setEnabled(!1),b.setUntypedComponent(h.CetRendererModule.getVisibilityComponentKey(),c));a.getPreziW().getMutablePath().forEachMutable((b)=>{b=b.getEntity();b.hasComponent(f.CetModel.ID.HAS_TARGET.TARGET)||this.dj(b,a)});b=a.getPreziW();e.Cet.pathKludge.assertEditorPathV2(b);b.getMutableEditorPath().getMutableSteps().forEachMutable((b)=>{b=b.getEntity();b.hasComponent(f.CetModel.ID.HAS_TARGET.TARGET)||this.dj(b,a)})}}Sv(a){a=a.getChild(f.CetModel.ID.PREZI.BACKGROUND);
let b=a.getComponent(f.CetModel.ID.BACKGROUND.LAYERS);b.getVersion()!==this.Tn&&(this.Tn=b.getVersion(),a.forEachChild(f.CetModel.ID.BACKGROUND.LAYERS,(a)=>{this.Ho(a)}))}Ho(a){let b;a.hasComponent(h.CetRendererModule.getDrawComponentKey())||(b=a.isDef(f.CetModel.ID.BACKGROUND_IMAGE)?h.CetRendererModule.createImageDrawComponent():h.CetRendererModule.createXvgDrawComponent(),l.f.setGroupingComp(a,ca.zd.Uk).setComponent(h.CetRendererModule.getDrawComponentKey(),b))}Yv(a){let b=a.getComponent(f.CetModel.ID.PREZI.Z_OBJECTS);
if(b.getVersion()!==this.$n){this.$n=b.getVersion();var c=0,d=[],e=[];a.forEachChild(f.CetModel.ID.PREZI.Z_OBJECTS,(a)=>{this.zn(a,c,d,e);c++});this.Jo(d,e)}}Jo(a,b){for(let a of b)a.setComponent(l.f.GROUPING,this.ct(a));for(let b of a)this.ps(b)}dj(a,b){a.set(f.CetModel.ID.HAS_TARGET.TARGET,b.getPreziW().getOverview().getId())}zn(a,b,c,d){null==l.f.visibility(a,!0)&&l.f.setVisibility(a,!0,1);f.CetModel.textKludge.isEntityText(a)&&!a.hasComponent(l.f.ya)&&a.setComponent(l.f.ya,Da.le.create(a,this.aa.dh));
a.hasComponent(h.CetRendererModule.getDrawComponentKey())||a.setComponent(h.CetRendererModule.getDrawComponentKey(),this.xi(a));if(!a.hasComponent(h.CetRendererModule.getIsStackComponentKey())&&a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)){const b=a.getChild(f.CetModel.ID.Z_TOPIC_CONTAINER.TOPIC);null!=b&&b.isDef(f.CetModel.ID.STACK_CHAPTER)&&a.set(h.CetRendererModule.getIsStackComponentKey(),!0)}a.hasComponent(l.f.GROUPING)||(a.getDef()===f.CetModel.ID.Z_GROUP?c.push(a):d.push(a));c=k.j.zOrder(a);d=
a.isDef(f.CetModel.ID.Z_ZOOM_AREA)?h.LayerType.StoryLayer:null!=c?c.getZLayer():h.LayerType.PdomLayer;null!=c&&c.getZLayer()===d&&c.getZIndex()===b||a.setUntypedComponent(h.CetRendererModule.getZOrderComponentKey(),h.CetRendererModule.createZOrderComponent(b,d))}init(){}Kl(){this.Xn=this.Wn=this.Tn=this.$n=-1}reset(){this.Kl()}ps(a){let b=[];var c=a.getComponent(l.f.MODEL).getPdomObject();for(c=c.getChildren().iterator();c.hasNext();){let a=c.next();b.push(a)}a.setComponent(l.f.GROUPING,S.Xa.Nv(b));
for(let c of b)a.getEntityList().getEntityById(c).setComponent(l.f.GROUPING,a.getDef()===f.CetModel.ID.Z_VIDEO?S.Xa.Ov(a):S.Xa.Pv(a))}ct(a){a=a.getDef();return a===f.CetModel.ID.Z_CIRCLE||a===f.CetModel.ID.Z_CIRCLE_FRAME||a===f.CetModel.ID.Z_RECTANGLE_FRAME||a===f.CetModel.ID.Z_SQUARE||a===f.CetModel.ID.Z_INVISIBLE_FRAME||a===f.CetModel.ID.Z_BRACKET_FRAME||a===f.CetModel.ID.Z_TRIANGLE?ca.zd.$p:ca.zd.Uk}getChildIds(a){return l.f.grouping(a).getChildIds()}xi(a){let b=a.getDef();if(b===f.CetModel.ID.Z_GROUP)return h.CetRendererModule.createZPersistentGroupDrawComponent((a)=>
this.getChildIds(a));if(b===f.CetModel.ID.Z_ARROW)return h.CetRendererModule.createZArrowDrawComponent();if(b===f.CetModel.ID.Z_BRACKET_FRAME)return h.CetRendererModule.createZBracketFrameDrawComponent();if(b===f.CetModel.ID.Z_CIRCLE)return h.CetRendererModule.createZCircleDrawComponent();if(b===f.CetModel.ID.Z_CIRCLE_FRAME)return h.CetRendererModule.createZCircleFrameDrawComponent();if(b===f.CetModel.ID.Z_IMAGE)return h.CetRendererModule.createImageDrawComponent();if(b===f.CetModel.ID.Z_INVISIBLE_FRAME)return h.CetRendererModule.createZInvisibleFrameDrawComponent();
if(b===f.CetModel.ID.Z_TOPIC_CONTAINER)return h.CetRendererModule.createZTopicContainerDrawComponent();if(b===f.CetModel.ID.Z_ZOOM_AREA)return h.CetRendererModule.createZZoomAreaDrawComponent();if(b===f.CetModel.ID.Z_LINE)return h.CetRendererModule.createZLineDrawComponent();if(b===f.CetModel.ID.Z_PLACEHOLDER)return h.CetRendererModule.createZPlaceHolderDrawComponent();if(b===f.CetModel.ID.Z_RECTANGLE_FRAME)return h.CetRendererModule.createZRectangleFrameDrawComponent();if(b===f.CetModel.ID.Z_SQUARE)return h.CetRendererModule.createZRectangleDrawComponent();
if(b===f.CetModel.ID.Z_PDF||b===f.CetModel.ID.Z_CHART_PDF||b===f.CetModel.ID.Z_SWF_GRAPHICS||b===f.CetModel.ID.Z_SLIDE)return h.CetRendererModule.createXvgDrawComponent();if(f.CetModel.textKludge.isDefText(b))return h.CetRendererModule.createZTextDrawComponent(this.Gx);if(b===f.CetModel.ID.Z_TRIANGLE)return h.CetRendererModule.createZTriangleDrawComponent();if(b===f.CetModel.ID.Z_VIDEO)switch(a.get(f.CetModel.ID.Z_VIDEO.VIDEO_TYPE)){case "video":return h.CetRendererModule.createOnCanvasVideoDrawComponent();
default:return h.CetRendererModule.createVideoThumbnailDrawComponent(P.ue.Gf,P.ue.Ff)}return b===f.CetModel.ID.Z_MARKER||b===f.CetModel.ID.Z_PENCIL?h.CetRendererModule.createZMarkerPencilDrawComponent():b===f.CetModel.ID.Z_SHAPE?(a=a.getWrapper(f.CetModel.ID.Z_SHAPE.W),a.getShapeType()===f.ShapeType.Oval?h.CetRendererModule.createZOvalDrawComponent():a.getShapeType()===f.ShapeType.Rectangle?h.CetRendererModule.createZRectangleDrawComponent():a.getShapeType()===f.ShapeType.Triangle?h.CetRendererModule.createZTriangleDrawComponent():
h.CetRendererModule.createZRectangleDrawComponent()):b===f.CetModel.ID.Z_ANIMATED_IMAGE?h.CetRendererModule.createAnimatedImageDrawComponent():null}changesPdomComponents(){return!1}Go(a){if(null==k.j.visibility(a,!0)){let b=new ua.te;b.setAlpha(1);b.setEnabled(!0);a.setUntypedComponent(h.CetRendererModule.getVisibilityComponentKey(),b)}}};ca.zd.Uk=new S.Xa("NotGroup",null,null);ca.zd.$p=new S.Xa("AutoGroup",null,null);var nc={};Object.defineProperty(nc,"__esModule",{value:!0});nc.Sr=class{constructor(a){this.Cp=
a}getId(){return"SpeedMeasurementProcessor"}update(){if(this.Cp.isAutoplaySpeedTestInProgress())return 5E3;this.Cp.processStatistics();return 5E3}reset(){}};var U={};Object.defineProperty(U,"__esModule",{value:!0});U.hb=class{constructor(a=!1,b=!1){this.tryRetainMainCanvas=a;this.highDPICanvas=b;this.size={width:640,height:480};this.Oj=n.Bacon.newBus();this.wm=n.Bacon.newBus();this.rp=n.Bacon.mergeAll([this.getResizeStream(),this.wm]).toProperty(this.size);this.rp.onValue(()=>{});this.zt()}static Im(){return`prezi_cet.CetUIImpl.id${U.hb.gd++}`}zt(){let a=
window.document;this.Dd=a.createElement("div");this.Dd.className="renderContainer";this.Wd(this.Dd,this.size);this.oc=a.createElement("div");this.oc.id=U.hb.Im();this.oc.className="playerLayer canvasContainer";this.Wd(this.oc,this.size);let b=a.createElement("canvas");b.id=U.hb.Im();b.style.width="100%";b.style.height="100%";this.setCanvas(b);this.De=a.createElement("div");this.De.className="domLayer playerLayer";this.Wd(this.De,this.size);this.Dd.appendChild(this.oc);this.Dd.appendChild(this.De)}getCetContainer(){return this.Dd}getDomLayer(){return this.De}getCanvasContainer(){return this.oc}getCanvas(){return this.canvas}setCanvas(a){null!=
this.canvas&&this.oc.removeChild(a);this.canvas=a;null!=this.canvas&&(this.ws(a),this.oc.appendChild(a))}ws(a){a.style.background="#000";a.style.top="0";a.style.left="0";a.style.position="absolute";a.style.zIndex="100";this.Vo(a,this.getSize());this.Oj.push(this.size)}resize(a){this.size=a;this.Wd(this.Dd,a);this.Wd(this.oc,a);this.Wd(this.De,a);this.Vo(this.canvas,a);this.Oj.push(a)}static Um(){return window.devicePixelRatio||1}Vo(a,b){var c=b.width,d=b.height;this.tryRetainMainCanvas&&(c=b.width>
U.hb.Kf?b.width:U.hb.Kf,d=b.height>U.hb.Kf?b.height:U.hb.Kf);this.highDPICanvas?(a.width=c*U.hb.Um(),a.height=d*U.hb.Um(),a.style.width=c+"px",a.style.height=d+"px"):(a.width=c,a.height=d)}Wd(a,b){a.width=b.width;a.height=b.height;a.style.width=b.width+"px";a.style.height=b.height+"px"}setFakeSizeForIntegrationTest(a){this.wm.push(a)}getSize(){return this.size}getResizeStream(){return this.Oj.skipDuplicates((a,b)=>a.width===b.width&&a.height===b.height)}getSizeProperty(){return this.rp}};U.hb.Kf=
2048;U.hb.gd=0;var oc={};Object.defineProperty(oc,"__esModule",{value:!0});oc.Zr=class{constructor(a){this.Dt=a}getName(){return"VideoInitSystem"}process(a){for(let b of a)null!=b.getMutableWrapper(f.CetModel.ID.Z_VIDEO.W).getOnlineAssetUrl()?e.Cet.removeSpinner(b):e.Cet.addSpinner(this.Dt,b)}select(a){return a.isDef(f.CetModel.ID.Z_VIDEO)&&"video"===a.get(f.CetModel.ID.Z_VIDEO.VIDEO_TYPE)}getTriggerKeys(){return[f.CetModel.ID.MEDIA_ASSET.ONLINE_ASSET_URL]}changesPdomComponents(){return!1}};var pc=
{};Object.defineProperty(pc,"__esModule",{value:!0});pc.Rr=class{constructor(a,b){this.assetManager=a;this.Sw=b;this.logger=u.LoggerModule.getLoggerManager().createLogger("SoundInitSystem")}Kt(a,b){for(let c of a){const d=this.version(c,b);a=c.getMutableWrapper(f.CetModel.ID.MEDIA_ASSET.W);const g=a.getOnlineAssetUrl();a=a.getOfflineAssetId();const h=c.getId(),y=(a)=>{b.requestNoDomBatchUpdate((c)=>{c=c.getEntityById(h);null==c||c.isDisposed()||this.version(c,b)!==d||(c.set(k.j.Lm(),a),this.Sw(c.getOwner().getId()))})},
l=(a)=>{this.logger.error({object:"pathSoundDownloadError",action:"SoundInitSystem",trigger:"machine",payload:{message:a,Yx:g}})};e.Cet.errorOfflineAssetId===a?l("Asset has errorOfflineAssetId"):null!=g&&(a=this.assetManager.createBinaryFetcher(g).fetch(),a.onValue((a)=>{try{x.AudioUtils.readAsAudioBuffer(a,(a)=>{y(a)},()=>{l("Error decoding audio")})}catch(Nc){l("Error caught")}}),a.onError(()=>l("Fetch error")))}}changesPdomComponents(){return!1}getName(){return"SoundInitSystem"}getTriggerKeys(){return[f.CetModel.ID.MEDIA_ASSET.ONLINE_ASSET_URL,
f.CetModel.ID.MEDIA_ASSET.OFFLINE_ASSET_ID]}process(a,b){this.Kt(a,b)}select(a,b){return null!=b.getEntityById(a.getId())&&!a.isDisposed()&&a.isDef(f.CetModel.ID.PATH_SOUND)}version(a){return a.getComponentVersion(f.CetModel.ID.MEDIA_ASSET.ONLINE_ASSET_URL)+a.getComponentVersion(f.CetModel.ID.MEDIA_ASSET.OFFLINE_ASSET_ID)}};var nb={},cd=this&&nb.Vf||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,f){function g(a){try{r(d.next(a))}catch(I){f(I)}}
function h(a){try{r(d["throw"](a))}catch(I){f(I)}}function r(a){a.done?c(a.value):e(a.value).then(g,h)}r((d=d.apply(a,b||[])).next())})};Object.defineProperty(nb,"__esModule",{value:!0});nb.mr=class{constructor(a){this.fb=a;this.Kj=0;this.jo=n.Bacon.newBus()}init(){}getMediaAssetInfoStatusProperty(){const a=this.jo.skipDuplicates().toProperty(!1);a.onValue(()=>{});return a}getName(){return"MasatInitSystem"}update(a){return cd(this,void 0,void 0,function*(){const b=[],c=[];a.getEntityList().forEachMutable((a)=>
{const d=null==a?null:e.Cet.mutableDraw(a);if(!a.isDisposed()&&null!=d&&d.kind===h.DrawComponentKind.animatedImage&&!d.isErrorDraw()){const e=a.get(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID),g=this.fb.getCachedMediaAssetDimensions(e);null!=g?d.setAssetSize(g):(b.push(a.getId()),c.push(e))}},this);if(0<c.length){this.Kj++;this.Jj();try{const d=yield this.fb.queryMediaAssetDimensions([...c]);a.requestNoDomBatchUpdate((a)=>{for(let c of b){const b=a.getEntityById(c),g=null==b?null:e.Cet.mutableDraw(b);
null==b||b.isDisposed()||!d.has(b.get(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID))||null==g||g.kind!==h.DrawComponentKind.animatedImage||g.isErrorDraw()||g.setAssetSize(d.get(b.get(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID)))}})}finally{this.Kj--,this.Jj()}}else this.Jj()})}select(a){return null==a.getParentEntity()&&!a.isDisposed()&&a.isDef(f.CetModel.ID.Z_ANIMATED_IMAGE)}getTriggerKeys(){return[f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID]}getVersion(a){return a.getComponentVersion(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID)}reset(){}changesPdomComponents(){return!1}Jj(){this.jo.push(0===
this.Kj)}isTrackingRemovedEntity(){return!1}getRequiredKeysForIndirectTrigger(){return[]}};var ob={};Object.defineProperty(ob,"__esModule",{value:!0});ob.Ek=class{constructor(a,b,c,d,e,f,l,m,p){this.assetManager=b;this.Cx=e;this.lv=m;this.editorModeChanged=p;this.ag=n.Bacon.newBus();this.zl=this.ag.skipDuplicates().toProperty(!1);this.zl.onValue(()=>{});var g=e();sa.re.wq=!0;this.options=a;this.kb=new U.hb(a.tryRetainMainCanvas,a.highDPICanvas);this.options.speedMeasurementOptions.measureSpeed&&(this.L=
h.CetRendererModule.createSpeedMeter(!H.isActive("js-dev-no-speed-logging-to-console")),this.L.setSpeedMeasurementMode(this.options.speedMeasurementOptions.speedMeasurementMode),this.up=new nc.Sr(this.L.getStatisticsProcessor()));var r=new ha.Qc;e=new fa.Jc(t.Geometry.rectangleFromData({x:0,y:0,width:this.kb.getSize().width,height:this.kb.getSize().height}));const y=new Gb.Jq(e);this.Zf=n.Bacon.newBus();f=null==f?h.CetRendererModule.createRenderer(a.rendererKind,this.kb.getCanvas(),b,k.j.Du(),a.isDesktop,
()=>{var a,b;return null!==(b=null===(a=this.qa)||void 0===a?void 0:a.Cn())&&void 0!==b?b:!0},()=>{var a,b;return null!==(b=null===(a=this.qa)||void 0===a?void 0:a.hv())&&void 0!==b?b:!0},m,this.Zf):f.getMainStage().getRenderer().createSubRenderer(l?this.kb.getCanvas():null);this.ga=this.ht(f,r,y,e,g,l);l=new Qa.Lh(this.kb.getDomLayer(),this.ga.getCamera(),g);this.Ua={assetManager:b,M:l,xc:r,video:g,dh:f.getRenderingTextFactory(),editorModeChanged:p};this.tp=n.Bacon.newBus();this.ao=n.Bacon.newBus();
this.bo=this.ao.toProperty("");this.bo.onValue(()=>{});this.gp=n.Bacon.newBus();this.jc=new Yb.Br(d,this.ga);this.U=new Pb.nr(d);this.Ad=new zb.bq(this.U);this.fontsLoadedStateHolder=new M.Lq(this.Ua.assetManager,this.getMainStage().getRenderer().getAssetManager());p=new M.$h(this.fontsLoadedStateHolder,this.ga);l=new ca.zd(this.Ua,this.Zf,this.ga);g=new ba.nc(new Ba.ee);r=new ba.nc(new jb.ll);this.gb=new Wa.Sh;e=(new Va.Rh(this.gb,this.fontsLoadedStateHolder,this.getMainStage(),this.Ua)).getSystemFactory().createOverviewFrameSystem(e);
m=new nb.mr(f.getAssetManager());this.sv=m.getMediaAssetInfoStatusProperty();a=[this.jc,l,m,a.headless?null:new ba.nc(new Ua.Ok(f.getAssetManager(),this.Ua.M,this.getMediaAssetPatcher(),this.getAssetThumbnailAnnouncer(),this.getAssetManager())),a.headless?null:new ba.nc(new pc.Rr(b,(a)=>{this.tp.push({stepOrActionId:a,path:this.ga.getPathNavigator().getPath()})})),a.headless?null:new ba.nc(new oc.Zr(this.Ua.M)),p,a.headless?null:new ba.nc(new lc.Dq(this.Ua.assetManager)),g,r,a.headless?null:new mc.tr(this.Zf.filter((a)=>
"allAssetsLoaded"===a)),e].filter((a)=>null!=a);this.Za=this.gb.createRootScene("BaseModel",{inflateList:[l,p,g,r].concat(null!=c?c.inflateList||[]:[]),updateList:a.concat(null!=c?c.updateList||[]:[])});this.Ad.i=this.Za;this.Za.plugChangeStream(this.jc.Fu());this.Za.plugChangeStream(this.jc.hp);this.Za.ak(this.jc);d.vw(this.Za);this.ga.markViewChanged()}createSubCetApplication(a,b,c,d){return new ob.Ek({headless:this.options.headless,speedMeasurementOptions:a.speedMeasurementOptions,rendererKind:this.options.rendererKind,
isDesktop:this.options.isDesktop},this.assetManager,d,b,this.Cx,this,c,this.lv,this.editorModeChanged)}ht(a,b,c,d,e,f){return new sa.re(this.kb.getSize(),d,a,b,c,new Ob.Fr(k.j.createFastForwardNavigationStrategy(d)),e,f)}getCetUI(){return this.kb}setSpeedMeasurementMode(a){null!=this.L&&this.L.setSpeedMeasurementMode(a)}getSpeedMeasurementMode(){return this.L?this.L.getSpeedMeasurementMode():""}getSceneBuilder(){return new Va.Rh(this.gb,this.fontsLoadedStateHolder,this.getMainStage(),this.Ua)}initializeLoop(a){this.qa=
new F.la(this.kb,this.ga,this.Za,a,this.Zf,this.L,this.ag);this.ao.plug(this.qa.xl);this.Za.setIdleChangeStream(this.createIdleStream(this.Za.getImmediateChangeStream(null)));a=this.Za.getPrezi().getComponent(l.f.oe);this.gp.plug(this.sw(a.getCetSessionEditStream()));null!=this.up&&this.qa.addIdleWorker(this.up,2E3)}getDomLayerManager(){return this.Ua.M}startLoop(){this.ga.zw(()=>this.qa.Og());this.qa.start()}getSceneHierarchy(){return this.gb}getBaseScene(){return this.Za}getSpeedMeter(){return this.L}getDocument(){return this.jc.getDocument()}updateWithTemplate(a){return this.updateWithIPrezi(a)}updateWithIPrezi(a){return this.jc.tx(this,
a,()=>{null!=this.qa&&this.qa.Bl()}).then((a)=>{this.ga.wa.ih(null);this.getBaseScene().update();return a})}registerSnapshotCreator(a){this.Za.getPrezi().getComponent(l.f.oe).registerSnapshotCreator(a)}resetToEmptyPrezi(){null!=this.qa&&this.qa.Bl();this.jc.lf();this.ga.wa.ih(null);this.getBaseScene().update()}getAssetFetchingErrorObservable(){return this.Ua.assetManager.getAssetFetchingErrorObservable()}getAssetLoadingProperty(){return this.bo}getAssetsReadyProperty(){return this.zl}getFontsLoadedProperty(){return this.fontsLoadedStateHolder.Fm}getFontLoadErrorPropery(){return this.fontsLoadedStateHolder.getFontLoadErrorPropery()}getMediaAssetInfoStatusProperty(){return this.sv}getSoundDownloadedObservable(){return this.tp}kill(){this.getBaseScene().kill()}getMainStage(){return this.ga}getDocumentVersionInfoStream(){return this.jc.getDocumentVersionInfoStream()}getSceneRender(){return this.ga}createIdleStream(a){a=
this.qa.createIdleStream(a);this.ga.markViewChanged();return a}sw(a){return this.qa.createUpdateStream(a)}getCetSessionEditStream(){return this.gp}createComponentFactory(){return new mb.Hk(this.Ua.M)}getDocumentStamp(){return this.jc.getDocumentStamp()}isAnimFramePending(){return null!=this.qa?this.qa.isAnimFramePending():!1}getEndOfFrameStream(){return null!=this.qa?this.qa.getEndOfFrameStream():null}getAssetThumbnailAnnouncer(){return this.Ad}getMediaAssetPatcher(){return this.U}hasPendingTweens(){return this.qa.hasPendingTweens()}getAssetManager(){return this.assetManager}addIdleWorker(a,
b){if(null==this.qa)throw Error("Application not initialized");this.qa.addIdleWorker(a,b)}};var qc={};Object.defineProperty(qc,"__esModule",{value:!0});qc.yq=class{constructor(){this.logger=u.LoggerModule.getLoggerManager().createLogger("editorapi")}cannotStartTransactionBecauseAnOtherIsBeingExecuted(a,b){this.logger.error({action:"cannotStartTransactionBecauseAnOtherIsBeingExecuted",object:"transaction",trigger:"machine",payload:{message:`Cannot start transaction with intent '${a}', because ${b} is being executed.`}})}exceptionInTransactionEndWhenBeginOtherTransaction(a){u.LoggerModule.logException(this.logger,
"transaction","exceptionInTransactionEndWhenBeginOtherTransaction",a)}mediaPatcherAssetIdMissing(){this.logger.error({action:"mediaPatcherAssetIdMissing",object:"MediaAssetPatcher",trigger:"machine",payload:{message:"Cannot patch because old assetId is missing"}})}mediaPatcherPatchingError(){this.logger.error({object:"mediaPatcherPatchingError",action:"MediaAssetPatcher",trigger:"machine",payload:{message:"Cannot patch because old assetId is the error id"}})}overrideSize(a,b,c,d,e,h){this.logger.warn({object:a===
f.CetModel.ID.Z_IMAGE?"ImageInitSystem":"XvgInitSystem",action:"patchSize",trigger:"machine",payload:{message:"Override size",objectId:b,oldWidth:c,oldHeight:d,newWidth:e,newHeight:h}})}overrideSizeSkipped(a,b,c,d,e,h){this.logger.warn({object:a===f.CetModel.ID.Z_IMAGE?"ImageInitSystem":"XvgInitSystem",action:"patchSize",trigger:"machine",payload:{message:"Override size - skipped",objectId:b,oldWidth:c,oldHeight:d,newWidth:e,newHeight:h}})}};var rc={};Object.defineProperty(rc,"__esModule",{value:!0});
rc.Aq=class{constructor(a,b){this.i=a;this.parent=b}getParent(){return this.parent}getMutableParent(a){return a.getEntityById(this.parent.getId())}getType(){return null==k.j.grouping(this.parent)?null:k.j.grouping(this.parent).getGroupType()}getChildIds(){switch(this.getType()){case "PersistentGroup":return k.j.grouping(this.parent).getChildIds();default:return[]}}getMemberIds(){let a=this.getChildIds();a.unshift(this.parent.getId());return a}getChildren(){return this.getChildIds().map((a)=>this.i.getEntityById(a))}getMembers(){return this.getMemberIds().map((a)=>
this.i.getEntityById(a))}getMutableChildren(a){return this.getChildIds().map((b)=>a.getEntityById(b))}getMutableMembers(a){return this.getMemberIds().map((b)=>a.getEntityById(b))}};var sc={};Object.defineProperty(sc,"__esModule",{value:!0});sc.Wq=class{constructor(a,b){this.data=a;this.id=b}getId(){return this.id}getData(){return this.data}};var pb={};Object.defineProperty(pb,"__esModule",{value:!0});pb.Nk=class{constructor(a){this.i=a}getParentOrOverview(a){a=this.getParentId(a);null==a&&(a=this.i.getPrezi().getChild(f.CetModel.ID.PREZI.OVERVIEW).getId());
return a}getDescendantEntitiesInZOrder(a){return e.Cet.sortInZOrder(this.i.getEntityList().getEntitiesById(a.concat(this.getDescendantEntities(a))))}getEntityDistance(a,b){let c=0,d=this.i.getPrezi().getChild(f.CetModel.ID.PREZI.OVERVIEW).getId(),e=[a];for(;a!==b&&a!==d;)++c,a=this.i.getEntityById(a),a=this.getParentOrOverview(a),e.push(a);if(a===b)return c;c=0;for(a=e.indexOf(b);-1===a&&b!==d;)++c,b=this.i.getEntityById(b),b=this.getParentOrOverview(b),a=e.indexOf(b);return-1!==a?a+c:e.length-1+
c}getSmartStructureIdOfEntity(a){if(null!=a){a=this.i.getEntityById(a);if(null==a)return null;if(a.isDef(f.CetModel.ID.OVERVIEW))return this.i.getPreziW().getOverview().getSmartStructure().getId();a=a.getChild(f.CetModel.ID.Z_TOPIC_CONTAINER.TOPIC);return null==a?null:a.isDef(f.CetModel.ID.PLANET_CHAPTER)?a.getWrapper(f.CetModel.ID.PLANET_CHAPTER.W).getSmartStructure().getId():null}a=this.i.getPreziW().getOverview().getSmartStructure();return null!=a?a.getId():null}isChapterWithSmartStructure(a){a=
this.i.getEntityById(a);return null!=a&&a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?a.getWrapper(f.CetModel.ID.Z_TOPIC_CONTAINER.W).getTopic().is(f.CetModel.ID.PLANET_CHAPTER):!1}getDescendantEntities(a){var b=1<a.length;a=this.Tm(a);if(b){a.sort((a,b)=>{a=a.toLowerCase();b=b.toLowerCase();return a<b?-1:a>b?1:0});b=[];for(let c=0,d=a.length;c<d;c++)(0===c||0<c&&a[c]!==a[c-1])&&b.push(a[c]);a=b}return a}Tm(a){let b=[];for(let c of a)a=this.i.getEntityById(c),null!=a&&this.isZTopicContainer(c)&&(a=this.getChildrenIds(a),
0!==a.length&&(b=[...b,...a,...this.Tm(a)]));return b}isZTopicContainer(a){a=this.i.getEntityById(a);return null!=a?a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER):!1}getChildrenIds(a){var b=a.getWrapper(f.CetModel.ID.Z_TOPIC_CONTAINER.W).getTopic();if(null==b)return[];b=b.getEntity();if(b.isDef(f.CetModel.ID.HAS_TOPIC_CHILDREN)){let a=[];b.getWrapper(f.CetModel.ID.HAS_TOPIC_CHILDREN.W).getTopicChildren().forEach((b)=>{null!=b&&a.push(b.getChild())});return a}if(b.isDef(f.CetModel.ID.HAS_CHILDREN))return b.getWrapper(f.CetModel.ID.HAS_CHILDREN.W).getChildren().items();
throw Error("Invalid topic entity "+a.getId());}getParentId(a){if(null==a)return null;var b=a.get(f.CetModel.ID.TOPIC_CHILD.CHILD_PARENT),c=null;null!=b&&0<b.length?(b=a.getEntityList().getEntityById(b[0]),null!=b&&(c=b.get(f.CetModel.ENTITY_OWNER_ID()))):(b=a.get(f.CetModel.ID.HAS_CHILDREN.CHILDREN_PARENT),null!=b&&0<b.length&&(c=b[0]));if(null!=c&&(c=a.getEntityList().getEntityById(c),null!=c)){c=c.get(f.CetModel.ENTITY_OWNER_ID());if(!a.getEntityList().getEntityById(c).isDef(f.CetModel.ID.Z_TOPIC_CONTAINER))throw Error(`Entity with id: ${c} is not a Z_TOPIC_CONTAINER`);
return c}return null}getSubTrees(a){return this.getDescendantEntities(a).concat(a)}getTopLevelEntities(){return x.Utils.Lambda().filter(this.i.getPreziW().getZObjects(),(a)=>null==this.getParentId(a.getEntity())).map((a)=>a.getId())}getChildrenIdsWithOverviewFallback(a){const b=this.i.getEntityById(a);return null==b?[]:this.i.getPrezi().getChild(f.CetModel.ID.PREZI.OVERVIEW).getId()===a?this.getTopLevelEntities():b.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?this.getChildrenIds(b):[]}getChildrenEntities(a){let b=
[];a.forEach((a)=>{b=[...b,...this.getChildrenIdsWithOverviewFallback(a)]});return b}getAncestorEntities(a){return null==this.i.getEntityById(a)?[]:this.Jm(a,[])}Jm(a,b){a=this.i.getEntityById(a);a=this.getParentOrOverview(a);if(null==a||0<=b.indexOf(a))return b;b.push(a);return this.Jm(a,b)}getLowestCommonAncestor(a,b=!1){if(0===a.length)return null;let c=this.getAncestorEntities(a[0]);b&&(c=[a[0]].concat(c));for(let d=1;d<a.length;++d){let e=this.getAncestorEntities(a[d]);b&&(e=[a[d]].concat(e));
c=this.qu(c,e);if(0===c.length)break}return 0===c.length?null:c[0]}qu(a,b){a=a.slice(0);a.reverse();b=b.slice(0);b.reverse();let c=0;for(;c<a.length&&c<b.length&&a[c]===b[c];)++c;if(0===c)return[];a=a.slice(0,c);a.reverse();return a}getDepthOfEntity(a){let b=0;if(a!==this.i.getPreziW().getOverview().getId())for(;null!=a;)b++,a=this.i.getEntityById(a),a=this.getParentId(a);return b}getChildParentDistance(a,b){let c=0;for(;a!==b;){if(null==a&&null!=b)throw Error(`Can't calculate distance between childId: ${a} and parentId: ${b}`);
++c;a=this.i.getEntityById(a);a=this.getParentId(a)}return c}getTopicLocalZoomBounds_killme(a){return h.CetRendererModule.calculateWorldZoomObb_killme(a).transform(l.f.transform(a).getLocalToWorld().invert()).getBounds()}getReachableEntities(a,b=e.VisualBackgroundReachLevel.ALL_VISUALS){let c=[];if(null==this.i.getEntityById(a))return c;c.push(a);const d=e.Cet.createTopicChildrenQuery(this.i),f=e.Cet.createHierarchyQuery(this.i),h=d.getChildrenIds(a,e.TopicChildBehavior.Content);c=c.concat(h);b>=
e.VisualBackgroundReachLevel.OWN_VISUAL&&(c=[...c,...d.getChildrenIds(a,e.TopicChildBehavior.Visual),...d.getChildrenIds(a,e.TopicChildBehavior.Surface),...d.getChildrenIds(a,e.TopicChildBehavior.Master)]);h.forEach((a)=>{c=[...c,...d.getChildrenIdsVisibleOutside(a)]});b>=e.VisualBackgroundReachLevel.ALL_VISUALS&&f.getAncestorEntities(a).forEach((a)=>{c=[...c,...d.getChildrenIdsVisibleBelow(a)]});b===e.VisualBackgroundReachLevel.ALL_VISUALS_AND_BACKGROUND&&this.i.getPreziW().getBackground().getLayers().forEach((a)=>
{a=a.getEntity();c.push(a.getId())});return c}};var tc={};Object.defineProperty(tc,"__esModule",{value:!0});tc.fq=class{constructor(a,b){this.type=a;this.Ya=b}getType(){return this.type}getAutoPlayer(){return this.Ya}};var uc={};Object.defineProperty(uc,"__esModule",{value:!0});uc.gq=class{constructor(a,b){this.enabled=!1;this.interval=-1;this.loop=!1;this.ic=a;b.onValue(()=>this.Bv());this.rm=n.Bacon.newBus()}Bv(){this.enabled&&this.next()}next(){this.mv()?this.loop?this.dm(()=>{this.sendEvent(e.AutoPlayEventType.RESTART);
this.ic.go(this.ic.getPath().getPathPosition(0,0))}):this.stop():this.dm(()=>{this.sendEvent(e.AutoPlayEventType.NEXT);this.ic.next()})}mv(){return this.ic.getPath().getPathCalculator().isLast(this.ic.getCurrentPosition())}Os(){null!=this.lk&&(this.lk.stop(),this.lk=null)}dm(a){this.sendEvent(e.AutoPlayEventType.WAIT);0>=this.interval?a():this.lk=x.Utils.delay(a,this.interval)}start(){this.enabled||(this.enabled=!0,this.sendEvent(e.AutoPlayEventType.START),this.next())}stop(){this.enabled&&(this.Os(),
this.enabled=!1,this.sendEvent(e.AutoPlayEventType.STOP))}toggle(){this.enabled?this.stop():this.start();return this.enabled}isEnabled(){return this.enabled}getInterval(){return this.interval}setInterval(a){this.interval=a}isLoop(){return this.loop}setLoop(a){this.loop=a}sendEvent(a){this.rm.push(new tc.fq(a,this))}getPathNavigator(){return this.ic}getEventStream(){return this.rm}};var Fa={};Object.defineProperty(Fa,"__esModule",{value:!0});Fa.je=class{constructor(a){this.camera=a;this.mj=0}getNavigationMode(a){let b=
this.getCurrentTime(),c=this.nv(b);this.mj=b;this.camera.isInTransition()||(a=e.NavigationChange.NEW_TARGET);switch(a){case e.NavigationChange.NEW_TARGET:a=c?e.NavigationMode.JUMP:e.NavigationMode.NEW_TRANSITION;break;case e.NavigationChange.CONTINUE:a=this.camera.isInAcceleratedTransition()||this.vs()?e.NavigationMode.JUMP:e.NavigationMode.ACCELERATE;break;case e.NavigationChange.TURN_BACK:a=this.camera.isInAcceleratedTransition()?e.NavigationMode.JUMP:e.NavigationMode.INVERSE_ACCELERATE;break;default:throw Error("unkown NavigationIntent "+
a);}return a}getCurrentTime(){return(new Date).getTime()}reset(){this.mj=0}nv(a){return a-this.mj<Fa.je.Gq}vs(){return this.camera.getRemainingTransitionTime()<Fa.je.Yp}};Fa.je.Gq=300;Fa.je.Yp=600;var vc={};Object.defineProperty(vc,"__esModule",{value:!0});vc.Yq=class{constructor(){}getNavigationMode(){return e.NavigationMode.JUMP}reset(){}};var Ga={};Object.defineProperty(Ga,"__esModule",{value:!0});Ga.qe=class{constructor(a){this.M=a;this.hk="spinner"+Ga.qe.gd++;this.Fn=this.visible=!1}static qs(a,
b){b=new Ga.qe(b);a.setComponent(k.j.ik,k.j.createOverlayComponent(b,b))}static dw(a){for(;null!=a;){const b=a.getComponent(k.j.ik,!0);null!=b&&(b.dispose(),a.discardOwnComponent(k.j.ik));a=a.getParentEntity()}}refresh(a,b){null==this.Vb&&this.vt();this.setVisibility(b);this.visible?(this.M.positionElementToCenter(this.hk,36,36),a=b.get(f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD),a=t.Geometry.createFromTransform(a),this.M.transformWithoutScale(this.hk,a),this.Fn?this.Vb.style.display="block":this.Xt()):
this.Vb.style.display="none"}dispose(){null!=this.Vb&&(null!=this.Vb.parentElement&&this.Vb.parentElement.removeChild(this.Vb),this.Vb=null)}vt(){let a=this.M.createElement(this.hk),b=window.document.createElement("div");a.appendChild(b);a.style.width="36px";a.style.height="36px";a.style.padding="9px";a.style.border="1px solid rgba(255, 255, 255, .7)";a.style.borderRadius="4px";a.style.background="#152235";a.style.opacity="0.8";a.style.boxSizing="border-box";b.style.height="18px";b.style.width="18px";
b.style.animation="rotating 1s linear infinite";b.style["-webkit-animation"]="rotating 1s linear infinite";b.style["-moz-animation"]="rotating 1s linear infinite";b.style.background="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAfRJREFUOBGFlD9Pk1EUh/vS8kckjRKCMjE4KAkJJsrgxgcgMPIJcHDQRGDzGzi4+QGcXdwKqwsOhISBydCkA2EglIZAii3U53m9t7m2Ddzkec+95573955z72mzwoDR6XRe4l4C7VMYhjocwE6WZbvY/0aWrhCYYf0OFqAECoz0WH378AnBKjYfXSFEnuPZhEeQioyyViyikFzCOmK/sIUhH4g8wXyAMWjDDdxCJ4DJY40vBiax33j3GbaQZ8TCTF6AQTGbI+Y/4DcYNw9v4Q3ErIzfJavlLJT0Hkf8mkIV+E6AWXUHscZswQbEj+pb8eHBtgJ/sIfQJ4KvEIQ/M92D9BLWFJoFhRS5hkpvJvi6I+x9xTEBD8CyFy1jHBSJN1hjft/4ScAXqMM5nClkNop4Q45o/60GPxtk9jHdUkjVx6CAh2srXMBdo8jBe0bxnfwWqjjiGVniAkGxzD6xsOf5pI2aedjeUnprU6xfDRILPjv/IcRbs6duS9RaI8ADtiQ72s6egzJ+P2LpluCl2M32TzxXE2mi0cpL4AW/shqCFIql2g7SDNa55btvnJwg1FbRRvMKt+EK3DSz9PfmB401m7SjTxXB1+0d5/54y5jX4C3Gc4vZpesG+8eImF0+Bt4OgtPszoDCZmB2/m14XmbR1x5/Ab/LqfQjXlacAAAAAElFTkSuQmCC)";
a.style.display="none";this.Vb=a}Xt(){let a=$(this.Vb);a.delay(500);a.fadeIn(500);this.Fn=!0}setVisibility(a){let b=this.isVisible(a);b!==this.visible&&(this.visible=b);a=k.j.visibility(a).getAlpha();this.Vb.style.opacity=.8>a?String(a):"0.8"}isVisible(a){return null!=k.j.visibility(a)&&k.j.visibility(a).isVisible()&&!a.get(h.CetRendererModule.getHideDomComponentKey())}};Ga.qe.gd=0;var wc={};Object.defineProperty(wc,"__esModule",{value:!0});wc.cq=class{constructor(a){this.U=a}createAssetId(){return this.U.createId()}patchUrl(a,
b,c,d,e,f){this.U.addPatch(a,(a)=>{a.updateAudioType(e);a.updateMediaLength(f);a.updateOnlineAssetUrl(d);a.updateOnlineAssetId(c);a.updateAssetSourceFilename(b)})}};var Xa={};Object.defineProperty(Xa,"__esModule",{value:!0});Xa.Ph=class{static aj(a){a=a.getEntity();const b=new Set(f.CetModel.ID.STYLE_BLOCK.getFields());for(const c of a.getDef().getFieldDescriptors())if(c.kind===f.FieldDescriptorKind.Scalar&&!b.has(c.fieldKey)){const b=a.getUntypedComponent(c.fieldKey);null!=b&&b.incrementVersion()}}};
var xc={};Object.defineProperty(xc,"__esModule",{value:!0});xc.oq=class{constructor(a){this.U=a}createAssetId(){return this.U.createId()}patchBack(a){Xa.Ph.aj(a)}patchUrl(a,b,c,d,e){this.U.addPatch(a,(a)=>{a.updateChartId(e);a.updateOnlineAssetUrl(d);a.updateOnlineAssetId(c);a.updateAssetSourceFilename(b)})}error(a){this.U.addError(a,(a)=>{a.updateChartId("");a.updateOnlineAssetUrl(null);a.updateOnlineAssetId(null);a.updateAssetSourceFilename(null)})}};var Oa={};Object.defineProperty(Oa,"__esModule",
{value:!0});Oa.If=class{constructor(a){this.U=a}canPatch(a){return null!=a.getOfflineAssetId()&&""!==a.getOfflineAssetId()}createAssetId(){return this.U.createId()}patchBack(a){Xa.Ph.aj(a)}patchSizeAndScale(a,b,c){return this.U.addPatch(a,(a)=>{if(null==this.Eu().safeCastToLogo(a)){var d=a.getWidth(),e=a.getHeight(),f=b,k=c,l=d,m=e,n=a.getMask();null!=n&&(l=n.getWidth(),m=n.getHeight(),a.updateMask(h.CetRendererModule.tranformMaskRectangle(n,{width:d,height:e},{width:b,height:c})),f=a.getMask().getWidth(),
k=a.getMask().getHeight());a.updateLocalToWorld(this.getLocalToWorld(a,l,m,f,k));a.updateWidth(b);a.updateHeight(c)}})}Eu(){null==Oa.If.Xo&&(Oa.If.Xo=m.DOM.RuntimeTypeInfo());return Oa.If.Xo}getLocalToWorld(a,b,c,d,e){b=Math.max(b,c)/Math.max(d,e);a=a.getLocalToWorld();return a.scaleAroundPoint(a.getTranslation(),b)}patchUrl(a,b,c,d){return this.U.addPatch(a,(a)=>{a.updateOnlineAssetUrl(d);a.updateOnlineAssetId(c);a.updateAssetSourceFilename(b)})}error(a){this.U.addError(a,(a)=>{a.updateOnlineAssetUrl(null);
a.updateOnlineAssetId(null)})}};var yc={};Object.defineProperty(yc,"__esModule",{value:!0});yc.Er=class{constructor(a){this.U=a}createAssetId(){return this.U.createId()}patchBack(a){Xa.Ph.aj(a)}patchSizeAndScale(a,b,c){this.U.addPatch(a,(a)=>{var d=a.getWidth()/b,e=a.getHeight()/c;d=Math.min(d,e);a.updateWidth(b);a.updateHeight(c);e=a.getLocalToWorld();a.updateLocalToWorld(e.scaleAroundPoint(e.getTranslation(),d));a.getDomType()===m.DomType.Z_SLIDE&&(d=a.getImportedAsset(),null!=d&&a.updateImportedAsset(m.DOM.createImmutableImportedPdfAsset(d.getImportJobId(),
this.wo(d.getNoBackgroundPdfAsset(),a.getOnlineAssetUrl(),b,c),this.wo(d.getOriginalPdfAsset(),a.getOnlineAssetUrl(),b,c),d.getSourcePageNumber())))})}wo(a,b,c,d){return m.DOM.createImmutablePdfAsset(a.getAssetSourceFilename(),a.getOnlineAssetUrl()===b?d:a.getHeight(),a.getImageScaleX(),a.getImageScaleY(),a.getIsFlipped(),a.getMask(),a.getOfflineAssetId(),a.getOnlineAssetId(),a.getOnlineAssetUrl(),a.getPageNumber(),a.getPdfBoundsLeft(),a.getPdfBoundsTop(),a.getTransparent(),a.getOnlineAssetUrl()===
b?c:a.getWidth())}patchUrl(a,b,c,d,e){this.U.addPatch(a,(a)=>{a.updateOnlineAssetUrl(d);a.updateOnlineAssetId(c);a.updateAssetSourceFilename(b);a.updatePageNumber(e)})}error(a){this.U.addError(a,(a)=>{a.updateOnlineAssetUrl(null);a.updateOnlineAssetId(null)})}};var zc={};Object.defineProperty(zc,"__esModule",{value:!0});zc.$r=class{constructor(a){this.U=a}createAssetId(){return this.U.createId()}patchUrl(a,b,c,d){this.U.addPatch(a,(a)=>{a.updateOnlineAssetUrl(d);a.updateOnlineAssetId(c);a.updateAssetSourceFilename(b)})}error(a){this.U.addError(a,
(a)=>{a.updateOnlineAssetUrl(null);a.updateOnlineAssetId(null)})}};var Ya={};Object.defineProperty(Ya,"__esModule",{value:!0});Ya.Mh=class{constructor(){}getZObjectType(){return this.Gh}setZObjectType(a){this.Gh=a}getZObjectStrategy(){return this.Ex}setZObjectStrategy(a){this.setZObjectType(e.MergeType.REPLACE_DIFFED_CUSTOM);this.Ex=a}getStyleType(){return this.sh}setStyleType(a){this.sh=a}getStyleStrategy(){return this.cx}setStyleStrategy(a){this.setStyleType(e.MergeType.REPLACE_DIFFED_CUSTOM);this.cx=
a}getFontFamilyType(){return this.sg}setFontFamilyType(a){this.sg=a}getFontFamilyStrategy(){return this.iu}setFontFamilyStrategy(a){this.setFontFamilyType(e.MergeType.REPLACE_DIFFED_CUSTOM);this.iu=a}getFontFaceType(){return this.rg}setFontFaceType(a){this.rg=a}getFontFaceStrategy(){return this.hu}setFontFaceStrategy(a){this.setFontFaceType(e.MergeType.REPLACE_DIFFED_CUSTOM);this.hu=a}getFontClassType(){return this.qg}setFontClassType(a){this.qg=a}getFontClassStrategy(){return this.gu}setFontClassStrategy(a){this.setFontClassType(e.MergeType.REPLACE_DIFFED_CUSTOM);
this.gu=a}getBackgroundType(){return this.bg}setBackgroundType(a){this.bg=a}getBackgroundStrategy(){return this.Cs}setBackgroundStrategy(a){this.setBackgroundType(e.MergeType.REPLACE_DIFFED_CUSTOM);this.Cs=a}};var Ac={};Object.defineProperty(Ac,"__esModule",{value:!0});class dd{constructor(){this.rd={};this.vh=[];this.contentChildren={};this.coverChildren={};this.visualChildren={};this.parents={}}getChildren(a,b){switch(a){case m.TopicChildBehaviourType.VISUAL:return this.visualChildren[b];case m.TopicChildBehaviourType.COVER:return this.coverChildren[b];
default:return this.contentChildren[b]}}}Ac.Gr=class{constructor(a){this.jd=a;this.Mc=Math.pow(2,-40);this.Ta=this.yi(a)}withOtherPrezi(a){this.jd=a;this.Ta=this.yi(a)}withRefPrezi(a){this.ld=a;this.ah=this.yi(a)}yi(a){const b=new dd;for(a=a.getZObjects().iterator();a.hasNext();){const e=a.next();b.rd[e.getId()]=e;if(this.isZTopicContainer(e)){var c=e.getTopic();if(this.Dg(c)){b.coverChildren[e.getId()]=[];b.visualChildren[e.getId()]=[];var d=[];for(c=c.getChildren().iterator();c.hasNext();){const a=
c.next();d.push(a);b.parents[a]=e.getId()}b.contentChildren[e.getId()]=d}else if(this.Qn(c)||this.Mn(c))for(b.vh.push(e.getId()),b.coverChildren[e.getId()]=[],b.visualChildren[e.getId()]=[],b.contentChildren[e.getId()]=[],d=c.getTopicChildren().iterator();d.hasNext();)c=d.next(),b.parents[c.getChild()]=e.getId(),c.getBehaviour().getObjectType()===m.TopicChildBehaviourType.VISUAL?b.visualChildren[e.getId()].push(c.getChild()):c.getBehaviour().getObjectType()===m.TopicChildBehaviourType.COVER?b.coverChildren[e.getId()].push(c.getChild()):
c.getBehaviour().getObjectType()===m.TopicChildBehaviourType.CONTENT&&b.contentChildren[e.getId()].push(c.getChild())}}return b}isZTopicContainer(a){return a.getObjectType()===m.ZObjectType.Z_TOPIC_CONTAINER}Dg(a){return a.getObjectType()===m.TopicType.PAGE}Mn(a){return a.getObjectType()===m.TopicType.PLANET_CHAPTER}Qn(a){return a.getObjectType()===m.TopicType.STACK_CHAPTER}ov(a){return a.getObjectType()===m.ZObjectType.Z_SHAPE}getDepth(a,b){let c=0;for(b=a.parents[b];null!=b;)c++,b=a.parents[b];
return c}getBackgroundAssetDistance(){if(null==this.ld)throw"No reference Prezi defined!";return m.DOM.compareBackground(this.ld.getBackground(),this.jd.getBackground())?0:1}en(a){return null!=a.getOnlineAssetUrl?null!=a.getOnlineAssetUrl()?a.getOnlineAssetUrl():a.getAssetSourceFilename():this.ov(a)?a.getShapeType():m.ZObjectType[a.getObjectType()]}uc(a,b){var c=[];c[a]=0;c.fill(0);if(0===this.Ta.vh.length)return c.slice(0);let d=c.slice(0),e=c.slice(0);for(const f of this.Ta.vh)c=Math.min(a,this.getDepth(this.Ta,
f)),e[c]+=1,d[c]+=b(f);return d.map((a,b)=>0<e[b]?a/e[b]:0)}getAvgTopicCoverStructureDistance(a){if(null==this.ld)throw"No reference Prezi defined!";return this.uc(a,(a)=>this.ru(a))}getAvgTopicVisualStructureDistance(a){if(null==this.ld)throw"No reference Prezi defined!";return this.uc(a,(a)=>this.Lu(a))}Rm(a,b){const c=this.Ta.rd[a];let d=[];a=this.Ta.getChildren(b,a);for(var e of a)d.push(this.en(this.Ta.rd[e]));d=d.sort();for(const f of this.ah.vh)if(this.ah.rd[f].getTopic().getObjectType()===
c.getTopic().getObjectType()){e=this.ah.getChildren(b,f);a=[];for(const b of e)a.push(this.en(this.ah.rd[b]));a=a.sort();if(x.Utils.arrayEquals(a,d))return 0}return 1}Lu(a){if(null==this.ld)throw"No reference Prezi defined!";return this.Rm(a,m.TopicChildBehaviourType.VISUAL)}ru(a){return this.Rm(a,m.TopicChildBehaviourType.COVER)}getAvgCoverTypeCountsPerLevel(a){return this.Mm(a,m.TopicChildBehaviourType.COVER)}getAvgVisualTypeCountsPerLevel(a){return this.Mm(a,m.TopicChildBehaviourType.VISUAL)}Mm(a,
b){const c=new Map;c.set(e.PreziDOMStatElementType.SHAPE,this.uc(a,(a)=>this.Kd(a,b,(a)=>a.getObjectType()===m.ZObjectType.Z_SHAPE)));c.set(e.PreziDOMStatElementType.IMAGE,this.uc(a,(a)=>this.Kd(a,b,(a)=>a.getObjectType()===m.ZObjectType.Z_IMAGE)));c.set(e.PreziDOMStatElementType.PDF,this.uc(a,(a)=>this.Kd(a,b,(a)=>a.getObjectType()===m.ZObjectType.Z_PDF)));c.set(e.PreziDOMStatElementType.TEXT,this.uc(a,(a)=>this.Kd(a,b,(a)=>f.CetModel.textKludge.isIZObjectText(a))));c.set(e.PreziDOMStatElementType.LINE,
this.uc(a,(a)=>this.Kd(a,b,(a)=>a.getObjectType()===m.ZObjectType.Z_LINE)));c.set(e.PreziDOMStatElementType.ARROW,this.uc(a,(a)=>this.Kd(a,b,(a)=>a.getObjectType()===m.ZObjectType.Z_ARROW)));return c}Kd(a,b,c){a=this.Ta.getChildren(b,a);b=0;for(const d of a)c(this.Ta.rd[d])&&b++;return b}getBackgroundStyleDistance(){if(null==this.ld)throw"No reference Prezi defined!";const a=this.xm(this.ld),b=this.xm(this.jd);return null==a&&null==b?0:null!=a&&null==b||null==a&&null!=b?1:m.DOM.compareStyleDeclaration(a,
b)?0:1}xm(a){let b=null;for(a=a.getDocumentStyle().getStyleDeclarations().iterator();a.hasNext();){const c=a.next();if("background"===c.getStyleSelector().toString()){b=c;break}}return b}collectBasicStats(){var a=this.jd.getZObjects();let b=a.length(),c=0,d=0,e=0,h=0,k=0,l=0,n=0,p=0,q=0,t=0,u=0,v=0,w=0,x=0,A=0,B=0,C=0,D=0,F=0,H=0;var G=a.iterator();for(a=[];G.hasNext();){var z=G.next(),E=z.getId();f.CetModel.textKludge.isIZObjectText(z)&&(z.getIsPlaceholder()?++w:(++v,A+=this.Au(f.CetModel.textKludge.getTextModelFromIZObject(z))));
switch(z.getObjectType()){case m.ZObjectType.Z_ARROW:++h;break;case m.ZObjectType.Z_LINE:++e;break;case m.ZObjectType.Z_SHAPE:++d;break;case m.ZObjectType.Z_GROUP:++c;break;case m.ZObjectType.Z_IMAGE:E=z;B+=Math.floor(E.getWidth()*E.getHeight());++k;break;case m.ZObjectType.Z_PDF:++l;break;case m.ZObjectType.Z_PLACEHOLDER:++u;break;case m.ZObjectType.Z_SWF_GRAPHICS:++n;break;case m.ZObjectType.Z_VIDEO:++p;switch(z.getVideoType()){case "youtube":++q;break;case "vimeo":++t}break;case m.ZObjectType.Z_CHART_PDF:++F;
break;case m.ZObjectType.Z_TOPIC_CONTAINER:z=z.getTopic(),this.Qn(z)?(a.push(E),++D):this.Mn(z)?(a.push(E),++C):this.Dg(z)&&++x,1<[...this.Ta.getChildren(m.TopicChildBehaviourType.CONTENT,E),...this.Ta.getChildren(m.TopicChildBehaviourType.COVER,E),...this.Ta.getChildren(m.TopicChildBehaviourType.VISUAL,E)].map((a)=>this.Ta.rd[a]).filter((a)=>a.getObjectType()===m.ZObjectType.Z_VIDEO).length&&++H}}E=G=0;for(z=this.jd.getPath().iterator();z.hasNext();){const a=z.next();G+=a.getActions().length();null!=
a.getSound()&&++E}return{num_objects:b,num_groups:c,num_shapes:d,num_lines:e,num_arrows:h,num_images:k,num_pdfs:l,num_swfs:n,num_videos:p,num_youtube_videos:q,num_vimeo_videos:t,num_placeholders:u,num_texts:v+w,num_real_texts:v,num_placeholder_texts:w,num_pages:x,num_characters:A,num_pixel_count:B,num_steps:this.jd.getPath().length(),num_animations:G,num_audios:E,num_topics:D+C,num_planet_topics:C,num_stack_topics:D,num_charts:F,num_of_topics_with_more_than_one_video:H,deepest_structure:this.xu(a),
aspect_ratio:this.jd.getAspectRatio()}}Au(a){if(null==a||null==a.getParagraphs())return 0;a=a.getParagraphs();let b=0,c=0;for(;c<a.length;){let d=a[c++];null!=d&&(b+=d.getLength())}return b}xu(a){return 0===a.length?0:Math.max(...a.map((a)=>this.getDepth(this.Ta,a)))}};var qb={};Object.defineProperty(qb,"__esModule",{value:!0});qb.Zk=class{constructor(a){this.Ig=a;this.logger=u.LoggerModule.getLoggerManager().createLogger("DOM")}static Kw(a){a=new qb.Zk(a);m.DOM.setLogger(a)}logError(a){this.logger.error({object:"PDOM",
action:"PDOM",trigger:"machine",payload:a})}logWarn(a){this.logger.warn({object:"PDOM",action:"PDOM",trigger:"machine",payload:a})}logInfo(a){this.logger.info({object:"PDOM",action:"PDOM",trigger:"machine",payload:a})}logDebug(a){this.logger.debug({object:"PDOM",action:"PDOM",trigger:"machine",payload:a})}isErrorEnabled(){return this.Ig>=u.Level.ERROR}isWarnEnabled(){return this.Ig>=u.Level.WARN}isInfoEnabled(){return this.Ig>=u.Level.INFO}isDebugEnabled(){return this.Ig>=u.Level.DEBUG}};var Bc={};
Object.defineProperty(Bc,"__esModule",{value:!0});Bc.mq=class{constructor(){this.Rs=H.isActive("js-coedit-multi");this.Ss=H.isActive("js-coedit-single-client-load-patches-save");this.Ax=H.isActive("js-use-preprod-coedit-service");this.yx=H.isActive("js-use-local-coedit-service");this.zx=H.isActive("js-use-local-coedit-with-native-client");this.reconnectSyncEnabled=H.isActive("js-reconnect-sync-enabled")}};var w={};Object.defineProperty(w,"__esModule",{value:!0});w.K=class{static Ra(a,b){return{type:a,
preziId:b}}static Ce(a,b,c){return{type:a,preziId:b,errorMessage:c}}static et(a){return w.K.Ra(e.CetNetworkEventType.InitialConnectionFailure,a)}static Zs(a,b){return w.K.Ce(e.CetNetworkEventType.AccessDeniedError,a,b)}static jt(a,b){return w.K.Ce(e.CetNetworkEventType.MultiUserLockError,a,b)}static yt(a,b){return w.K.Ce(e.CetNetworkEventType.TransportError,a,b)}static at(a){return w.K.Ra(e.CetNetworkEventType.ConnectionLost,a)}static ot(a){return w.K.Ra(e.CetNetworkEventType.Reconnected,a)}static dt(a,
b,c){return{type:e.CetNetworkEventType.HardResetedPreziIsAvailable,preziId:a,preziXml:b,sessionState:c}}static st(a){return w.K.Ra(e.CetNetworkEventType.RoomInfoChanged,a)}static Xl(a){return w.K.Ra(e.CetNetworkEventType.RequestSync,a)}static qt(a){return w.K.Ra(e.CetNetworkEventType.RemoteChangesAvailable,a)}static tt(a){return w.K.Ra(e.CetNetworkEventType.RoomKeyValueStoreChanged,a)}static lt(a){return w.K.Ra(e.CetNetworkEventType.PeerKeyValueStoreChanged,a)}static gt(a){return w.K.Ra(e.CetNetworkEventType.KeyValueStoresReset,
a)}static bt(a){return w.K.Ra(e.CetNetworkEventType.Finished,a)}static ft(a){return w.K.Ce(e.CetNetworkEventType.InvalidDocumentStateError,a,"invalid document state")}static Vl(a,b){return w.K.Ce(e.CetNetworkEventType.IllegalStateError,a,b)}static ut(a){return w.K.Ra(e.CetNetworkEventType.SessionReady,a)}static kt(a){return w.K.Ra(e.CetNetworkEventType.OfflineTimerTriggered,a)}static pt(a){return w.K.Ra(e.CetNetworkEventType.ReconnectingFromFinished,a)}static rt(a){return w.K.Ra(e.CetNetworkEventType.ResetUndoRedo,
a)}};var rb={};Object.defineProperty(rb,"__esModule",{value:!0});rb.Gk=class{constructor(a,b,c,d){this.yb=a;this.hf=b;this.Rv=c;this.lb=d;this.nh=!0;this.Mj=[];this.ki=[];this.ul=[];this.logger=u.LoggerModule.getLoggerManager().createLogger("prezi_cet.CetSessionImpl");this.Ze=n.Bacon.newBus();this.bf=n.Bacon.newBus();this.Ep=n.Bacon.newBus();null!=a&&this.Yu();this.Dj=n.Bacon.newBus()}setIPrezi(a){this.$j(m.DOM.createLocalSessionWithCorrection(a,()=>{}))}setSessionMode(a){this.yb.kp(a)}getLoaderStream(){return this.Ze}loadPrezi(a,
b){this.yb.loadPrezi(a,b)}getIPrezi(){return this.ha.getPrezi()}getPrezi(){return this.ha.getPrezi()}createPrezi(a,b,c,d,f,h){let g=n.Bacon.newBus();a=this.yb.createPrezi(a,b,c,d,f,h);a.onValue((a)=>{a.result===C.SaveResult.Success?(g.push({kind:e.CetPreziCreatorResultKind.success,metadata:a.metadata}),this.$j(a.session),null!=this.eg&&this.eg.push(e.EditKind.Local)):g.push({kind:a.creationLimitReached?e.CetPreziCreatorResultKind.creationLimitReached:e.CetPreziCreatorResultKind.generalFailure,metadata:a.metadata})});
a.onError((a)=>{g.error(a)});return g}Yu(){this.yb.getLoaderStream().onValue((a)=>{switch(a.type){case E.PreziLoaderEventType.PdomSessionCreated:this.$j(a.payload);break;default:this.Ze.push(a)}});this.yb.getLoaderStream().onError((a)=>{this.Ze.error(a)});this.yb.getNetworkEventStream().onValue((a)=>{a.type===e.CetNetworkEventType.RemoteChangesAvailable&&(this.Qo=!0);this.nh||this.Mj.push(a)});this.bf.plug(this.yb.getNetworkEventStream().filter((a)=>a.type!==e.CetNetworkEventType.RemoteChangesAvailable||
this.nh))}getNetworkUserList(){return this.ha.getNetworkUserList().slice()}savePreziTitle(a){return this.yb.savePreziTitle(a)}savePreziLogoType(a){return this.yb.savePreziLogoType(a)}getPreziSaver(a,b,c){null==a&&(a=this.Za.getPrezi().getComponent(l.f.oe).getCetSessionEditStream());this.eg=n.Bacon.newBus();this.eg.plug(a);return this.Rv.create(this,this.eg,b,c)}getPreziLoader(){return this}getMetadataSaver(){return this}getPreziCreator(){return this}getNetworkEventStream(){return this.bf}vw(a){this.Za=
a;a.getImmediateChangeStream(e.ChangeEventKind.Document).onValue(()=>{this.Ze.push({type:E.PreziLoaderEventType.PreziLoaded,payload:this.ha.getPrezi()})})}Pw(){this.Ze.push({type:E.PreziLoaderEventType.CetSessionCreated})}$j(a){this.ha=a;this.hf.fixPrezi(a.getPrezi());this.sync();this.Dj.push(!0);this.Pw()}requestSync(){this.bf.push(w.K.Xl(this.ha.getNetworkSessionPreziOid()))}lf(){this.ha.updateAndCommitWithoutHistoryTracking(()=>{this.ha.updatePrezi(f.CetModel.EMPTY_PREZI())});this.sync()}Zj(a,
b,c){return this.Ys(a,b).then((a)=>{c(a);this.ha.updateAndCommitWithoutHistoryTracking(()=>{this.ha.updatePrezi(this.hf.fixIPrezi(a))});this.sync();return a})}Ys(a,b){return new Promise((c)=>{const d=this.lb;if(null==d)c(b);else{const e=()=>{const a=f.CetModel.EMPTY_PREZI();c(a)};try{const f=m.DOM.createLocalSession(b,()=>{});d.convert(f,a).then(()=>{c(f.getPrezi())}).catch(e)}catch(r){e(r)}}})}sync(){var a=this.lw();try{this.Ep.push(null)}catch(c){u.LoggerModule.logException(this.logger,"CetSessionImpl",
"sync",c)}if(this.nh){var b=this.Qo;this.Qo=!1;const c=this.ha.sync();a={wasHardReseted:c.wasHardReseted,wasAcknowledgeRequested:c.wasAcknowledgeRequested,No:b,Fj:a}}else b=this.ha.syncWithoutPull(),a={wasHardReseted:b.wasHardReseted,wasAcknowledgeRequested:b.wasAcknowledgeRequested,No:!1,Fj:a};this.kw();return a}getSyncTriggeredStream(){return this.Ep}An(a){u.LoggerModule.logException(this.logger,"CetSessionImpl","invalidDocumentState",a);this.bf.push(w.K.ft(this.ha.getNetworkSessionPreziOid()))}getPeerKeyValueStores(){return this.ha?
this.ha.getPeerKeyValueStores():null}getOwnKeyValueStore(){return null!=this.ha?this.ha.getOwnKeyValueStore():null}forwardRemoteEditingEvents(a){this.nh=a;this.logger.info({action:"forwardRemoteEditingEvents",object:"CetSessionImpl",trigger:"machine",payload:{flag:a}});a&&(a=this.Mj,this.Mj=[],a.forEach((a)=>this.bf.push(a)))}getIMediaAssets(){return m.DOM.collectMediaAsset(this.getPrezi())}goOnline(){this.ha.goOnline()}lw(){if(this.ha.hasAnyUncommitedChange())throw Error("cannot run sync hook if there are uncommitted changes");
if(0===this.ki.length)return!1;let a=!1;this.ha.updateAndCommitWithoutHistoryTracking(()=>{for(let a of this.ki)a(this.getPrezi());this.ha.hasAnyUncommitedChange()&&(a=!0)});return a}kw(){for(let a of this.ul)a(this.getPrezi())}beforeSync(a){this.ki.push(a)}afterSync(a){this.ul.push(a)}};var Cc={};Object.defineProperty(Cc,"__esModule",{value:!0});Cc.sq=class{constructor(a,b,c,d,e,f,h){this.zb=n.Bacon.newBus();this.xa=n.Bacon.newBus();this.Aa=n.Bacon.newBus();const g=f.createPrezi(a,b,c,d,e).onValue((a)=>
{if(a.result===C.SaveResult.Success){const {no:b,mo:c}=h(a.metadata.oid,(b)=>this.zb.push({result:C.SaveResult.Success,session:b,metadata:a.metadata}),()=>this.zb.push({result:C.SaveResult.Error,session:null,metadata:a.metadata}));this.xa.plug(b);this.Aa.plug(c)}else null!=this.zb&&this.zb.push(a)});this.Wc=()=>{this.zb.end();this.xa.end();this.Aa.end();g()}}wc(){return this.xa}vc(){return this.Aa}cancel(){null!=this.Wc&&(this.Wc(),this.Wc=null)}};var sb={};Object.defineProperty(sb,"__esModule",{value:!0});
sb.Ik=class{constructor(a,b,c,d,e,f){this.zb=n.Bacon.newBus();this.zb.plug(this.Wl(f)(a,b,c,d,e))}Wl(a){return a.createPrezi.bind(a)}wc(){return n.Bacon.never()}vc(){return n.Bacon.never()}cancel(){null!=this.zb&&(this.zb.end(),this.zb=null)}};var Dc={};Object.defineProperty(Dc,"__esModule",{value:!0});Dc.tq=class extends sb.Ik{constructor(a,b,c,d,e){super(a,b,c,d,null,e)}Wl(a){return a.createPreziInLocalStore.bind(a)}};var tb={},ed=this&&tb.Vf||function(a,b,c,d){function e(a){return a instanceof
c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,f){function g(a){try{k(d.next(a))}catch(I){f(I)}}function h(a){try{k(d["throw"](a))}catch(I){f(I)}}function k(a){a.done?c(a.value):e(a.value).then(g,h)}k((d=d.apply(a,b||[])).next())})};Object.defineProperty(tb,"__esModule",{value:!0});tb.hr=class{constructor(a,b,c){this.Ye=a;this.lb=b;this.Ea=c;this.Sb=new Ec;this.xa=new Ec;this.Aa=new Ec;a.vc().onValue((a)=>{this.Aa.push(a)});a.wc().onValue((a)=>{this.xa.push(a)});a.Id().onValue((a)=>
{a.type===E.PreziLoaderEventType.PdomSessionCreated?this.Xs(a.payload):this.Sb.push(a)})}Id(){return this.Sb.bc}wc(){return this.xa.bc}vc(){return this.Aa.bc}cancel(){this.Ye.cancel()}pause(){this.Sb.pause();this.xa.pause();this.Aa.pause()}Zv(){this.Sb.Hj();this.xa.Hj();this.Aa.Hj()}mf(){this.Sb.mf();this.xa.mf();this.Aa.mf()}Xs(a){ed(this,void 0,void 0,function*(){this.Sb.push({type:E.PreziLoaderEventType.ConversionStarted});this.pause();this.Sb.push({type:E.PreziLoaderEventType.PdomSessionCreated,
payload:a});try{yield this.lb.convert(a,this.Ea)}catch(c){this.Zv();var b=f.CetModel.EMPTY_PREZI();b=m.DOM.createLocalSession(b,()=>{});this.Sb.push({type:E.PreziLoaderEventType.PdomSessionCreated,payload:b});null!=c.type&&null!=c.errorMessage?this.Sb.push({type:E.PreziLoaderEventType.PreziConversionFailedError,payload:c}):this.Sb.push({type:E.PreziLoaderEventType.PreziConversionFailedError,payload:null})}this.mf()})}};class Ec{constructor(){this.bc=n.Bacon.newBus();this.paused=!1;this.og=[]}pause(){this.paused=
!0}mf(){this.paused=!1;this.og.forEach((a)=>this.bc.push(a));this.og=[]}Hj(){this.og=[]}push(a){this.paused?this.og.push(a):this.bc.push(a)}}var Fc={};Object.defineProperty(Fc,"__esModule",{value:!0});Fc.jr=class{constructor(a,b,c){this.ua=n.Bacon.newBus();this.xa=n.Bacon.newBus();this.Aa=n.Bacon.newBus();b=a.loadPreziMetaData(b);this.ua.plug(b);let d=b.filter((a)=>a.type===E.PreziLoaderEventType.MetaDataLoaded).take(1).onValue(()=>{a.getPreziProvider().loadPreziXmlForCoeditInit((a)=>{const {no:b,
mo:d}=c(a,(a)=>this.ua.push({type:E.PreziLoaderEventType.PdomSessionCreated,payload:a}),()=>this.ua.push({type:E.PreziLoaderEventType.PdomSessionCreationError}));this.xa.plug(b);this.Aa.plug(d)},()=>{this.ua.push({type:E.PreziLoaderEventType.PdomSessionCreationError})})});this.Wc=()=>{this.xa.end();this.Aa.end();this.ua.end();d()}}Id(){return this.ua}wc(){return this.xa}vc(){return this.Aa}cancel(){null!=this.Wc&&(this.Wc(),this.Wc=null)}};var Gc={};Object.defineProperty(Gc,"__esModule",{value:!0});
Gc.kr=class{constructor(a,b){this.ua=n.Bacon.newBus();this.ua.plug(a.loadPrezi(b))}Id(){return this.ua}wc(){return n.Bacon.never()}vc(){return n.Bacon.never()}cancel(){null!=this.ua&&(this.ua.end(),this.ua=null)}};var Hc={};Object.defineProperty(Hc,"__esModule",{value:!0});Hc.ir=class{constructor(a,b){this.ua=n.Bacon.newBus();a.Id().onValue((c)=>{c.type===E.PreziLoaderEventType.PdomSessionCreated?(a.cancel(),this.ua.push({type:E.PreziLoaderEventType.PdomSessionCreated,payload:m.DOM.createLocalSessionWithCorrection(c.payload.getPrezi(),
()=>{})}),this.ua.push({type:E.PreziLoaderEventType.FeaturePreviewModeWithSaveDisabled,payload:b})):this.ua.push(c)})}Id(){return this.ua}wc(){return n.Bacon.never()}vc(){return n.Bacon.never()}cancel(){null!=this.ua&&(this.ua.end(),this.ua=null)}};var X={};Object.defineProperty(X,"__esModule",{value:!0});var Rc=H.FeatureSwitcher.getFeaturePreviewFlags,B;(function(a){a[a.Wb=0]="CoeditMulti";a[a.Kc=1]="CoeditSingle";a[a.Pc=2]="Fallback";a[a.FallbackLocalSave=3]="FallbackLocalSave";a[a.Lc=4]="Disabled"})(B=
X.Jf||(X.Jf={}));class Sc{constructor(a){this.Ms=a}onAcknowledgeResult(a,b,c){this.Ms(a,b,c)}}X.Ix=Sc;class fd{constructor(a,b,c){this.oid=a;this.Lg=b;this.errorMessage=c}}X.qr=fd;class gd{constructor(a,b,c,d,e){this.lb=e;this.Aa=n.Bacon.newBus();this.xa=n.Bacon.newBus();this.Hg=n.Bacon.newBus();this.$a=a;this.Tg=b;this.xn=c;this.Ml=d;this.kp($a.CetSessionMode.Initial);this.bv();this.Ct();this.logger=u.LoggerModule.getLoggerManager().createLogger("prezi_cet.CoeditPreziLoader")}getLoaderStream(){return this.Hg}getNetworkEventStream(){return this.xa}kp(a){switch(a){case $a.CetSessionMode.Initial:this.vb=
this.zc=this.xn;break;case $a.CetSessionMode.FallbackReadOnly:this.zc=B.Pc;this.vb=B.Lc;break;case $a.CetSessionMode.FallbackLocalSave:this.zc=B.Pc,this.vb=B.FallbackLocalSave}}Ct(){this.Aa.filter((a)=>a.Lg===m.NetworkError.ACCESS_DENIED_NO_EDIT_RIGHTS||a.Lg===m.NetworkError.ACCESS_DENIED_SINGLE_CLIENT_MODE).onValue(()=>{this.vb=B.Lc})}bv(){let a=this.Aa.filter((a)=>this.zc===B.Wb||this.zc===B.Kc||this.vb===B.Wb||this.vb===B.Kc||a.Lg===m.NetworkError.ACCESS_DENIED_SINGLE_CLIENT_MODE);this.xa.plug(a.map((a)=>
{switch(a.Lg){case m.NetworkError.SESSION_INIT_ERROR:case m.NetworkError.ESR_SESSION_CREATE_FAILED:case m.NetworkError.COEDIT_CONNECT_FAILED:return w.K.et(a.oid);case m.NetworkError.ACCESS_DENIED_NO_EDIT_RIGHTS:return w.K.Zs(a.oid,a.errorMessage);case m.NetworkError.ACCESS_DENIED_SINGLE_CLIENT_MODE:return w.K.jt(a.oid,a.errorMessage);default:return w.K.yt(a.oid,a.errorMessage)}}))}saveSession(a){switch(this.vb){case B.Wb:case B.Kc:let b=n.Bacon.newBus();a.acknowledgeOnNextSync(new Sc((c,d,e)=>{let f;
d=(a,b)=>({action:"acknowledgeOnNextSync",object:"CoeditPreziLoader",trigger:"machine",payload:{acknowledge_result:m.AcknowledgeResult[b],save_result:C.SaveResult[a]}});switch(c){case m.AcknowledgeResult.SUCCESS:case m.AcknowledgeResult.HARD_RESET:case m.AcknowledgeResult.SUCCESS_DIRTY:f={saveResult:C.SaveResult.Success,storageRevision:e};this.logger.info(d(f.saveResult,c));break;case m.AcknowledgeResult.TIMEOUT:f={saveResult:C.SaveResult.Error,storageRevision:null};this.logger.warn(d(f.saveResult,
c));break;case m.AcknowledgeResult.TIMEOUT_NO_SYNC_CALLED:f={saveResult:C.SaveResult.Error,storageRevision:null};this.logger.error(d(f.saveResult,c));break;default:f={saveResult:C.SaveResult.Error,storageRevision:null},this.logger.error(d(f.saveResult,c))}this.saveSessionToLocalStore(a).onValue(()=>{b.push(f)})}));this.xa.push(w.K.Xl(a.getNetworkSessionPreziOid()));return b;case B.Pc:return this.$a.saveSession(a);case B.FallbackLocalSave:return this.$a.saveSessionToLocalStore(a).map((a)=>({saveResult:a,
storageRevision:null}));case B.Lc:return n.Bacon.once({saveResult:C.SaveResult.Error,storageRevision:null});default:throw Error(`Unexpected LoadAndSaveMode ${this.vb}`);}}savePreview(a){switch(this.vb){case B.Wb:case B.Kc:case B.Pc:return this.$a.savePreview(a);case B.FallbackLocalSave:return this.$a.savePreviewToLocalStore(a);case B.Lc:return n.Bacon.once(C.SaveResult.Error);default:throw Error(`Unexpected LoadAndSaveMode ${this.vb}`);}}savePreviewToLocalStore(a){return this.$a.savePreviewToLocalStore(a)}saveSessionToLocalStore(a){return this.$a.saveSessionToLocalStore(a)}savePreziTitle(a){a=
this.$a.savePreziTitle(a);this.Oo(a);return a.finished}savePreziLogoType(a){a=this.$a.savePreziLogoType(a);this.Oo(a);return a.finished}Oo(a){this.Hg.push({type:E.PreziLoaderEventType.MetaDataUpdated,payload:a.metadata});a.finished.then((a)=>{this.Hg.push({type:E.PreziLoaderEventType.MetaDataUpdated,payload:a})})}loadPrezi(a,b){null!=this.Ye&&(this.Ye.cancel(),this.Ye=null);switch(this.zc){case B.Wb:case B.Kc:let c=this.zc===B.Wb?m.NetworkSessionMode.MULTI:m.NetworkSessionMode.LOAD_SAVE,d=new Fc.jr(this.$a,
b,(a,d,e)=>this.Tg.createNetworkSession(b,a.preziXml,a.locallyStoredSessionState,c,this.Ml,d,e));this.Co(this.Vp(this.Wp(d),a));break;case B.Pc:this.Co(this.Vp(this.Wp(new Gc.kr(this.$a,b)),a));break;case B.Lc:this.logger.info({action:"loadDisabled",object:"CoeditPreziLoader",trigger:"machine"});break;default:throw Error(`Unexpected load mode ${B[this.zc]}`);}}Co(a){this.Hg.plug(a.Id());this.xa.plug(a.wc());this.Aa.plug(a.vc());this.Ye=a}Vp(a,b){return null==this.lb?a:new tb.hr(a,this.lb,b)}createPrezi(a,
b,c,d,e,h){null!=this.Bi&&(this.Bi.cancel(),this.Bi=null);const g=n.Bacon.newBus(),k=(a)=>{this.xa.plug(a.wc());this.Aa.plug(a.vc());g.plug(a.zb);this.Bi=a},l=(a)=>{switch(this.vb){case B.Wb:case B.Kc:{let d=this.zc===B.Wb?m.NetworkSessionMode.MULTI:m.NetworkSessionMode.LOAD_SAVE;a=new Cc.sq(b,c,a,e,h,this.$a,(a,b,c)=>this.Tg.createNetworkSession(a,null,null,d,this.Ml,b,c));k(a);break}case B.FallbackLocalSave:a=new Dc.tq(b,c,a,e,this.$a);k(a);break;case B.Pc:a=new sb.Ik(b,c,a,e,h,this.$a);k(a);break;
case B.Lc:g.plug(n.Bacon.later(0,{result:C.SaveResult.Error,session:null,metadata:null}));break;default:throw Error(`Unexpected LoadAndSaveMode ${this.vb}`);}};if(null!=this.lb){const b=m.DOM.createLocalSession(d,()=>{});d=()=>{var a=f.CetModel.EMPTY_PREZI();a=m.DOM.createLocalSession(a,()=>{});this.vb=B.Lc;l(a.getPrezi())};try{this.lb.convert(b,a).then(()=>{l(b.getPrezi())}).catch(d)}catch(Tb){d(Tb)}}else l(d);return g}Wp(a){return 0<Rc().size?new Hc.ir(a,Rc()):a}}X.qq=gd;var Za={};Object.defineProperty(Za,
"__esModule",{value:!0});Za.Qh=class{constructor(a,b){this.Tg=a;this.coeditExternalServiceProviders=b;this.logger=u.LoggerModule.getLoggerManager().createLogger("prezi_cet.PdomNetworkSessionFactory")}createNetworkSession(a,b,c,d,e,f,h){let g=!1,k=null;const l=n.Bacon.newBus(),r=n.Bacon.newBus();let p=(b,c)=>{try{return c()}catch(Yc){return b="Caught exception while tranforming PDOM event ("+m.NetworkEvent[b]+") to Cet event!\n"+x.Utils.stringify(Yc),this.logger.error({action:"networkEvent",object:"coeditpreziloader",
trigger:"machine",payload:{message:b}}),w.K.Vl(a,b)}};this.Tg({offlineTimerInSeconds:e.offlineTimerInSeconds,keepReconnectingAfterOfflineTimerTriggered:e.keepReconnectingAfterOfflineTimerTriggered,networkSessionMode:d,locallySavedXml:b,locallySavedSessionState:c,oid:a,coeditExternalServiceProviders:this.coeditExternalServiceProviders,acknowledgeTimeout:Za.Qh.pr,reconnectSyncEnabled:e.reconnectSyncEnabled,onNetworkEventCallback:(b)=>{switch(b){case m.NetworkEvent.CONNECTION_LOST:b=w.K.at(a);break;
case m.NetworkEvent.RECONNECTED:b=w.K.ot(a);break;case m.NetworkEvent.HARD_RESETED_PREZI_IS_AVAILABLE:b=p(b,()=>{const b=k.popHardResetedPreziInfo();return w.K.dt(a,m.DOM.saveXml(b.prezi),b.sessionState)});break;case m.NetworkEvent.ROOM_INFO_CHANGED:b=w.K.st(a);break;case m.NetworkEvent.REMOTE_CHANGES_AVAILABLE:b=w.K.qt(a);break;case m.NetworkEvent.ROOM_KEY_VALUE_STORE_CHANGED:b=w.K.tt(a);break;case m.NetworkEvent.PEER_KEY_VALUE_STORE_CHANGED:b=w.K.lt(a);break;case m.NetworkEvent.KEY_VALUE_STORES_RESET:b=
w.K.gt(a);break;case m.NetworkEvent.ACKNOWLEDGE_HARD_RESET:b=null;break;case m.NetworkEvent.ACKNOWLEDGE_SUCCESS:b=null;break;case m.NetworkEvent.ACKNOWLEDGE_SUCCESS_DIRTY:b=null;break;case m.NetworkEvent.ACKNOWLEDGE_TIMEOUT:b=null;break;case m.NetworkEvent.ACKNOWLEDGE_TIMEOUT_NO_SYNC_CALLED:b=null;break;case m.NetworkEvent.FINISHED:b=w.K.bt(a);break;case m.NetworkEvent.OFFLINE_TIMER_TRIGGERED:b=w.K.kt(a);break;case m.NetworkEvent.RECONNECTING_FROM_FINISHED:b=w.K.pt(a);break;case m.NetworkEvent.RESET_UNDO_REDO:b=
w.K.rt(a);break;default:b="unkown network event"+m.NetworkEvent[b],this.logger.error({action:"networkEvent",object:"coeditpreziloader",trigger:"machine",payload:{message:b}}),b=w.K.Vl(a,b)}null!=b&&l.push(b)},onNetworkErrorCallback:(b,c)=>{g||h();r.push(new X.qr(a,b,c))},onEventCallback:(()=>()=>{})(),onSessionReadyCallback:(b)=>{g=!0;k=b;try{f(b),l.push(w.K.ut(a))}catch(Oc){throw window.console.error("Error in createNetworkSession's success handler:",Oc),Oc;}}});return{no:l,mo:r}}};Za.Qh.pr=2;var ub=
{};Object.defineProperty(ub,"__esModule",{value:!0});ub.fl=class{constructor(a,b){this.rules={};this.state=a;this.xj=b}u(a,b,c){null==this.rules[+a]&&(this.rules[+a]={});this.rules[+a][+b]=c;return this}step(a){let b=this.state;this.state=this.rules[+this.state][+a];this.state!==b&&this.xj(this.state)}getState(){return this.state}};var Ha={};Object.defineProperty(Ha,"__esModule",{value:!0});var Ic;(function(a){a[a.Local=0]="Local";a[a.Remote=1]="Remote"})(Ic=Ha.Th||(Ha.Th={}));class hd{constructor(a,
b,c,d){this.Eo=a;this.Wg=b;this.na=c;this.ug=d;this.logger=u.LoggerModule.getLoggerManager().createLogger("SaverBase")}bp(a,b){const c=()=>({saveResult:C.SaveResult.Error,storageRevision:null});try{const d=this.saveXml(a);d.onValue((d)=>{if(d.saveResult!==C.SaveResult.Success)this.logSaveError("save error"),b(d);else{const e=this.savePreview(a);e.onValue((a)=>{a!==C.SaveResult.Success?b(c()):b(d)});e.onError((a)=>{this.logSaveError(a);b(c())})}});d.onError((a)=>{this.logSaveError(a);b(c())})}catch(d){this.logSaveError(d),
b(c())}}saveXml(a){null!=this.ug&&this.ug.forceCommitEvenIfBreaksUndoHistoryAndSceneConsistency();a=a===Ic.Local?this.Wg.saveSessionToLocalStore(this.na.ha).map((a)=>({saveResult:a,storageRevision:null})):this.Wg.saveSession(this.na.ha);null!=this.ug&&this.ug.updateEditSceneEvenIfNotActive();return a}savePreview(a){return null==this.Eo?n.Bacon.once(C.SaveResult.Success):n.Bacon.fromPromise(this.Eo.generatePreviewData()).flatMap(a===Ic.Local?(a)=>this.Wg.savePreviewToLocalStore(a):(a)=>this.Wg.savePreview(a)).mapError((a)=>
{this.co(a);return C.SaveResult.Success}).map((a)=>{a!==C.SaveResult.Success&&this.co(a);return C.SaveResult.Success})}logSaveError(a){this.logger.error({action:"save_error",object:"save_watchdog",trigger:"machine",payload:{message:a}})}co(a){this.logger.warn({action:"preview_save_error",object:"save_watchdog",trigger:"machine",payload:{message:a}})}}Ha.Tr=hd;var ja={};Object.defineProperty(ja,"__esModule",{value:!0});var p;(function(a){a[a.ja=0]="Saved";a[a.Da=1]="DirtyLocal";a[a.Na=2]="DirtyRemote";
a[a.Zb=3]="SavingLocal";a[a.$b=4]="SavingRemote";a[a.za=5]="Terminated"})(p=ja.Nr||(ja.Nr={}));var D;(function(a){a[a.Pa=0]="NoError";a[a.Error=1]="Error"})(D=ja.Lr||(ja.Lr={}));var v;(function(a){a[a.Gb=0]="StartSave";a[a.Fb=1]="LocalEdit";a[a.Xb=2]="RemoteEdit";a[a.ja=3]="Saved";a[a.Yb=4]="SaveError";a[a.ac=5]="Terminate"})(v=ja.Mr||(ja.Mr={}));class vb{constructor(a,b){this.Dp=a;this.ap=(new ub.fl(p.ja,(a)=>this.Xv(a))).u(p.ja,v.Gb,p.ja).u(p.ja,v.Fb,p.Da).u(p.ja,v.Xb,p.Na).u(p.ja,v.ja,p.ja).u(p.ja,
v.Yb,p.ja).u(p.ja,v.ac,p.za).u(p.Zb,v.Gb,p.Zb).u(p.Zb,v.Fb,p.Da).u(p.Zb,v.Xb,p.Na).u(p.Zb,v.ja,p.ja).u(p.Zb,v.Yb,p.Na).u(p.Zb,v.ac,p.za).u(p.$b,v.Gb,p.$b).u(p.$b,v.Fb,p.Da).u(p.$b,v.Xb,p.Na).u(p.$b,v.ja,p.ja).u(p.$b,v.Yb,p.Da).u(p.$b,v.ac,p.za).u(p.Da,v.Gb,p.$b).u(p.Da,v.Fb,p.Da).u(p.Da,v.Xb,p.Da).u(p.Da,v.ja,p.Da).u(p.Da,v.Yb,p.Da).u(p.Da,v.ac,p.za).u(p.Na,v.Gb,p.Zb).u(p.Na,v.Fb,p.Da).u(p.Na,v.Xb,p.Na).u(p.Na,v.ja,p.Na).u(p.Na,v.Yb,p.Na).u(p.Na,v.ac,p.za).u(p.za,v.Gb,p.za).u(p.za,v.Fb,p.za).u(p.za,
v.Xb,p.za).u(p.za,v.ja,p.za).u(p.za,v.Yb,p.za).u(p.za,v.ac,p.za);this.ow=(new ub.fl(D.Pa,(a)=>this.Wv(a))).u(D.Pa,v.Gb,D.Pa).u(D.Pa,v.Fb,D.Pa).u(D.Pa,v.Xb,D.Pa).u(D.Pa,v.ja,D.Pa).u(D.Pa,v.Yb,D.Error).u(D.Pa,v.ac,D.Pa).u(D.Error,v.Gb,D.Error).u(D.Error,v.Fb,D.Error).u(D.Error,v.Xb,D.Error).u(D.Error,v.ja,D.Pa).u(D.Error,v.Yb,D.Error).u(D.Error,v.ac,D.Error);this.Xd=n.Bacon.newBus();this.$o=n.Bacon.newBus();this.Tj=n.Bacon.newBus();this.pw=this.Tj.map((a)=>a.saveResult);this.qw=n.Bacon.combineWith((a,
b)=>b===D.Error&&a!==C.SaveState.saving?C.SaveState.errorSaving:a,this.Xd.toProperty(C.SaveState.saved),this.$o.toProperty(D.Pa)).skipDuplicates();b.onValue((a)=>this.Vv(a))}step(a){this.ow.step(a);this.ap.step(a)}save(){if(this.ap.getState()===p.ja)return n.Bacon.once(C.SaveResult.Success);{const a=this.pw.take(1);this.step(v.Gb);return a}}forceSaveAndGetStorageProperties(){const a=this.Tj.take(1);this.step(v.Fb);this.step(v.Gb);return a}getSaveStateStream(){return this.qw}Vv(a){switch(a){case e.EditKind.Local:this.step(v.Fb);
break;case e.EditKind.Remote:this.step(v.Xb);break;default:throw Error("unkown EditKind "+a);}}Wv(a){this.$o.push(a)}Xv(a){switch(a){case p.Zb:this.Xd.push(C.SaveState.saving);this.Dp.bp(Ha.Th.Local,(a)=>this.Ko(a));break;case p.$b:this.Xd.push(C.SaveState.saving);this.Dp.bp(Ha.Th.Remote,(a)=>this.Ko(a));break;case p.ja:this.Xd.push(C.SaveState.saved);break;case p.Da:case p.Na:this.Xd.push(C.SaveState.dirty);break;case p.za:this.Xd.push(C.SaveState.errorExternalEdit)}}Ko(a){const b=a.saveResult;switch(b){case C.SaveResult.Success:this.step(v.ja);
break;case C.SaveResult.Error:this.step(v.Yb);n.Bacon.later(vb.Zp,!0).onValue(()=>{this.save()});break;case C.SaveResult.ErrorExternalEdit:this.step(v.ac);break;default:throw Error("unknown saveResult: "+b);}this.Tj.push(a)}}ja.Or=vb;vb.Qx=1E4;vb.Zp=1E4;var wb={};Object.defineProperty(wb,"__esModule",{value:!0});wb.Fk=class{constructor(a){this.yb=a}create(a,b,c,d){return new ja.Or(new Ha.Tr(c,this.yb,a,d),b)}};var Jc={};Object.defineProperty(Jc,"__esModule",{value:!0});Jc.nq=class{constructor(a,b,
c){this.hf=a;this.lb=b;this.fs=c}createCetSession(a,b,c){a=E.DataServiceModule.createPreziLoader(a,b);b=c.coeditExternalServiceProviders?c.coeditExternalServiceProviders:this.pu();c.reconnectSyncEnabled=this.fs.reconnectSyncEnabled;b=new Za.Qh((a)=>{m.DOM.createNetworkSession(a)},b);c=new X.qq(a,b,this.wu(),c,this.lb);return new rb.Gk(c,this.hf,new wb.Fk(c),this.lb)}pu(){if(this.fs.zx)return m.DOM.getLocalNativeCoeditExternalServiceProviders(18888,!1);if(this.fs.yx){let a=x.Utils.createUrlUtils().parseQueryString(window.location.search);
return m.DOM.getLocalTestCoeditExternalServiceProviders(Number(a.esrPort)||18E3,Number(a.coeditPort)||8888)}return this.fs.Ax?m.DOM.getPreProdCoeditExternalServiceProviders():m.DOM.getProductionCoeditExternalServiceProviders()}wu(){return this.fs.Rs?X.Jf.Wb:this.fs.Ss?X.Jf.Kc:X.Jf.Pc}createCetSessionWithIPrezi(a){const b=this.createHeadlessCetSession();b.setIPrezi(a);return b}createHeadlessCetSession(){return new rb.Gk(null,this.hf,new wb.Fk(null),this.lb)}};var Kc={};Object.defineProperty(Kc,"__esModule",
{value:!0});Kc.pq=class{constructor(a,b){this.o=a({initialBehaviour:this.Tp(b.startedInOffline,b.isPresenting)});this.uv=this.it(this.o);this.o.info("started")}tell(){return this.uv}get currentBehaviourName(){return this.o.same().name}Tp(a,b){return{name:"waitForActions",handler:(c)=>{switch(c.kind){case "ActionsWired":if(a)return this.o.info("wired-started-offline"),this.rh({actions:c.actions,mb:!1,isPresenting:b,Ka:!1});this.o.info("wired-started-online");c.actions.setSwitchingUiStateToNoSyncInProgress();
return this.Db({actions:c.actions,mb:!0,coeditFinishedAndWaitingForGoOnline:!1,Mg:!1,Ca:null,isPresenting:b,Ka:!1});case "EditorModeChanged":return this.Tp(a,c.isPresenting);default:return this.bb(c.kind)}}}}rh(a){return{name:"startedOffline",handler:(b)=>{switch(b.kind){case "ActionsWired":return this.bb(b.kind);case "DesktopNetworkOnlineStatusUpdate":this.o.info(b.kind,{rb:b.rb});if(!a.mb&&b.rb){if(a.isPresenting)return this.rh(Object.assign(Object.assign({},a),{Ka:!0}));this.o.info("reloading");
a.actions.reloadEditor();return this.o.stopped()}return this.o.same();case "CoeditInitialConnectionFailure":return this.bb(b.kind);case "CoeditFinishedAndWaitingForGoOnline":return this.bb(b.kind);case "CoeditReconnected":return this.bb(b.kind);case "MediaAssetSyncSuccess":return this.bb(b.kind);case "MediaAssetSyncNonRetryableFailure":return this.bb(b.kind);case "MediaAssetSyncRetryableFailure":return this.bb(b.kind);case "CetSyncFinished":return this.o.same();case "ConnectionLost":return this.o.same();
case "EditorModeChanged":return a.Ka&&!b.isPresenting?(this.o.info("reloading"),a.actions.reloadEditor(),this.o.stopped()):this.rh(Object.assign(Object.assign({},a),{isPresenting:b.isPresenting}));default:return x.Utils.assertNever(b)}}}}Db(a){return{name:"startedOnline",handler:(b)=>{switch(b.kind){case "ActionsWired":return this.bb(b.kind);case "DesktopNetworkOnlineStatusUpdate":this.o.info(b.kind,{rb:b.rb});const c=a.coeditFinishedAndWaitingForGoOnline&&!a.mb&&b.rb;this.o.info("sync-decision-inputs",
{coeditFinishedAndWaitingForGoOnline:a.coeditFinishedAndWaitingForGoOnline,currentDesktopOnline:a.mb,newDesktopOnline:b.rb,startSync:c});return c?(this.o.info("start-sync-desktop-is-back-online"),this.zp(a)):this.Db(Object.assign(Object.assign({},a),{mb:b.rb}));case "CoeditInitialConnectionFailure":return this.o.info(b.kind),this.rh({actions:a.actions,mb:a.mb,isPresenting:a.isPresenting,Ka:!1});case "CoeditFinishedAndWaitingForGoOnline":return this.o.info(b.kind),a.mb?(this.o.info("start-sync-desktop-is-still-online"),
this.zp(a)):this.Db(Object.assign(Object.assign({},a),{coeditFinishedAndWaitingForGoOnline:!0}));case "CoeditReconnected":return this.o.info(b.kind),a.actions.setSwitchingUiStateToNoSyncInProgress(),this.Db(Object.assign(Object.assign({},a),{Ca:null}));case "MediaAssetSyncSuccess":return this.o.info(b.kind,{onlineAssetUrl:b.eb}),a.actions.addMediaAssetPatch(this.zi(b.eb,b.Yf.onlineAssetId,b.Yf.onlineAssetUrl)),this.o.same();case "MediaAssetSyncNonRetryableFailure":return this.o.warn(b.kind,{onlineAssetUrl:b.eb,
errorMessage:b.errorMessage}),this.sn(b.eb,a.actions),this.o.same();case "MediaAssetSyncRetryableFailure":return this.o.warn(b.kind,{onlineAssetUrl:b.eb,errorMessage:b.errorMessage}),this.o.same();case "CetSyncFinished":return a.coeditFinishedAndWaitingForGoOnline?((b=this.Vi(a.actions.getIMediaAssets()))?a.actions.setSwitchingUiStateToOfflineMediaInserted():a.actions.setSwitchingUiStateToNoSyncInProgress(),this.Db(Object.assign(Object.assign({},a),{Mg:b}))):this.o.same();case "ConnectionLost":return this.Db(Object.assign(Object.assign({},
a),{Ca:a.Ca||Date.now()}));case "EditorModeChanged":return a.Ka&&!b.isPresenting?(this.o.info("reloading"),a.actions.reloadEditor(),this.o.stopped()):this.Db(Object.assign(Object.assign({},a),{isPresenting:b.isPresenting}));default:return x.Utils.assertNever(b)}}}}tf(a){return{name:"syncingOfflineMedia",handler:(b)=>{switch(b.kind){case "ActionsWired":return this.bb(b.kind);case "DesktopNetworkOnlineStatusUpdate":this.o.info(b.kind,{rb:b.rb});if(b.rb)return this.o.same();var c=this.Vi(a.actions.getIMediaAssets());
c?a.actions.setSwitchingUiStateToOfflineMediaInserted():a.actions.setSwitchingUiStateToNoSyncInProgress();a.actions.disableOnlineMediaInsert();return this.Db({actions:a.actions,coeditFinishedAndWaitingForGoOnline:!0,mb:b.rb,Mg:c,Ca:a.Ca,isPresenting:a.isPresenting,Ka:a.Ka});case "CoeditInitialConnectionFailure":return this.bb(b.kind);case "CoeditFinishedAndWaitingForGoOnline":return this.bb(b.kind);case "CoeditReconnected":return this.bb(b.kind);case "MediaAssetSyncSuccess":this.o.info(b.kind,{onlineAssetUrl:b.eb});
a.actions.addMediaAssetPatch(this.zi(b.eb,b.Yf.onlineAssetId,b.Yf.onlineAssetUrl));if(b=this.Pi(a.Od))return this.o.info("sync-next-media",{onlineAssetUrl:b.getOnlineAssetUrl()}),a.actions.syncMediaAsset(this.Xi(b)),this.tf(Object.assign(Object.assign({},a),{Od:this.kh(a.Od,b.getOnlineAssetUrl(),"RequestedSync")}));this.o.info("no-media-left");return this.o.same();case "MediaAssetSyncNonRetryableFailure":this.o.warn(b.kind,{onlineAssetUrl:b.eb,errorMessage:b.errorMessage});this.sn(b.eb,a.actions);
b=this.kh(a.Od,b.eb,"Failed");if(c=this.Pi(b))return this.o.info("sync-next-media",{onlineAssetUrl:c.getOnlineAssetUrl()}),a.actions.syncMediaAsset(this.Xi(c)),this.ck(this.kh(b,c.getOnlineAssetUrl(),"RequestedSync"),a);this.o.info("no-media-left");return this.ck(b,a);case "MediaAssetSyncRetryableFailure":return this.o.warn(b.kind,{onlineAssetUrl:b.eb,errorMessage:b.errorMessage}),(b=this.Vi(a.actions.getIMediaAssets()))?a.actions.setSwitchingUiStateToOfflineMediaInserted():a.actions.setSwitchingUiStateToNoSyncInProgress(),
a.actions.disableOnlineMediaInsert(),this.Db({actions:a.actions,coeditFinishedAndWaitingForGoOnline:!0,mb:!0,Mg:b,Ca:a.Ca,isPresenting:a.isPresenting,Ka:a.Ka});case "CetSyncFinished":return b=this.tv(a.Od,a.actions.getIMediaAssets()),this.ck(b,a);case "ConnectionLost":return this.tf(Object.assign(Object.assign({},a),{Ca:a.Ca||Date.now()}));case "EditorModeChanged":return this.tf(Object.assign(Object.assign({},a),{isPresenting:b.isPresenting}));default:return x.Utils.assertNever(b)}}}}zp(a){const {yv:b,
xv:c}=this.Us(a.actions.getIMediaAssets());a.actions.enableOnlineMediaInsert();if(0===c){this.o.info("no-sync-go-online");var d=this.kn(a);return this.Db(Object.assign(Object.assign({},a),{coeditFinishedAndWaitingForGoOnline:!1,mb:!0,Ka:d}))}d=this.Pi(b);if(!d)return this.vm("Expected a next mediaAsset to sync!");this.o.info("start-syncing",{onlineAssetUrl:d.getOnlineAssetUrl()});a.actions.setSwitchingUiStateToSyncing(c,0);a.actions.syncMediaAsset(this.Xi(d));return this.tf({actions:a.actions,Od:this.kh(b,
d.getOnlineAssetUrl(),"RequestedSync"),Ca:a.Ca,isPresenting:a.isPresenting,Ka:a.Ka})}ij(a){return a.getMaybePDOMId()&&a.getOnlineAssetUrl()&&0===a.getOnlineAssetUrl().indexOf("//prezi-local/")}Vi(a){return a.find(this.ij)&&!0}yu(a){return Object.keys(a).reduce((b,c)=>{c=a[c];switch(c.nd){case "Deleted":return Object.assign(Object.assign({},b),{Qa:b.Qa+1,Nb:b.Nb+1});case "Failed":return Object.assign(Object.assign({},b),{Qa:b.Qa+1,Nb:b.Nb+1,pg:b.pg+1});case "Offline":return Object.assign(Object.assign({},
b),{Qa:b.Qa+1});case "Online":return Object.assign(Object.assign({},b),{Qa:b.Qa+1,Nb:b.Nb+1});case "RequestedSync":return Object.assign(Object.assign({},b),{Qa:b.Qa+1});default:x.Utils.assertNever(c.nd,"Invalid sync status")}},{Qa:0,Nb:0,pg:0})}ck(a,b){const c=this.yu(a);this.o.info("switching-ui-by-counts",{all:c.Qa,done:c.Nb,Zt:c.pg});if(c.Qa===c.Nb)return this.o.info("all-done",{all:c.Qa,done:c.Nb,Zt:c.pg}),a=this.kn(b),b.actions.setSwitchingUiStateToNoSyncInProgress(),this.Db({actions:b.actions,
coeditFinishedAndWaitingForGoOnline:!1,mb:!0,Mg:!1,Ca:b.Ca,isPresenting:b.isPresenting,Ka:a});b.actions.setSwitchingUiStateToSyncing(c.Qa,c.Nb);return this.tf({actions:b.actions,Od:a,Ca:b.Ca,isPresenting:b.isPresenting,Ka:b.Ka})}Pi(a){const b=Object.keys(a).find((b)=>"Offline"===a[b].nd);return b?a[b].mediaAsset:null}Us(a){a=a.filter(this.ij).reduce((a,b)=>{a[b.getMaybePDOMId()]={nd:"Offline",mediaAsset:b};return a},{});const b=this.Qw(a);return{yv:a,xv:b}}tv(a,b){const c=new Set(Object.keys(a));
b=b.filter((a)=>a.getMaybePDOMId());const d=new Set(b.map((a)=>a.getMaybePDOMId()));x.Utils.Lambda().filter(c,(a)=>!d.has(a)).map((b)=>a[b].nd="Deleted");b.map((b)=>{const c=a[b.getMaybePDOMId()],d=this.ij(b);c&&!d?c.nd="Online":!c&&d&&(a[b.getMaybePDOMId()]={nd:"Offline",mediaAsset:b})});return a}kh(a,b,c){return Object.keys(a).reduce((a,e)=>{e=a[e];e.mediaAsset.getOnlineAssetUrl()===b&&(e.nd=c);return a},a)}Qw(a){return Object.keys(a).length}bb(a){return this.vm(`Received "${a}" message in "${this.o.same().name}" behaviour.`)}Xi(a){return{onlineAssetId:a.getOnlineAssetId(),
onlineAssetUrl:a.getOnlineAssetUrl()}}kn(a){const b=Date.now()-a.Ca;if(a.Ca&&54E4<b){if(a.isPresenting)return!0;this.o.info("long-offline-reload");a.actions.reloadEditor();return!1}this.o.info("clean-coedit-go-online");a.actions.coeditGoOnline();return!1}vm(a){this.o.error("fail-with-message",{ey:a});return this.o.stopped()}it(a){return{actionsWired(b){a.tell({kind:"ActionsWired",actions:b})},desktopNetworkOnlineStatusUpdate(b){a.tell({kind:"DesktopNetworkOnlineStatusUpdate",rb:b})},coeditInitialConnectionFailure(){a.tell({kind:"CoeditInitialConnectionFailure"})},
coeditFinishedAndWaitingForGoOnline(){a.tell({kind:"CoeditFinishedAndWaitingForGoOnline"})},coeditReconnected(){a.tell({kind:"CoeditReconnected"})},mediaAssetSyncSuccess(b,c){a.tell({kind:"MediaAssetSyncSuccess",eb:b,Yf:c})},mediaAssetSyncNonRetryableFailure(b,c){a.tell({kind:"MediaAssetSyncNonRetryableFailure",eb:b,errorMessage:c})},mediaAssetSyncRetryableFailure(b,c){a.tell({kind:"MediaAssetSyncRetryableFailure",eb:b,errorMessage:c})},cetSyncFinished(b){a.tell({kind:"CetSyncFinished",cy:b})},connectionLost(){a.tell({kind:"ConnectionLost"})},
editorModeChanged(b){a.tell({kind:"EditorModeChanged",isPresenting:b})}}}zi(a,b,c){return{oldOnlineAssetUrl:a,newOnlineAssetId:b,newOnlineAssetUrl:c}}sn(a,b){b.addMediaAssetPatch(this.zi(a,null,`${a}_unknown_asset_failure`))}};var Lc={};Object.defineProperty(Lc,"__esModule",{value:!0});Lc.Pq=class{constructor(a,b,c){this.ls=a;this.ol=c;this.ks=b}update(a){this.ls(a)}getName(){return this.ks}init(){}reset(a){null!=this.ol&&this.ol(a)}changesPdomComponents(){return!1}};var ka={};Object.defineProperty(ka,
"__esModule",{value:!0});ka.Bf=class{constructor(){}fetch(){return n.Bacon.never()}};ka.Dk=class{constructor(){}createBinaryFetcher(){return new ka.Bf}createJSONFetcher(){return new ka.Bf}createImageFetcher(){return new ka.Bf}createFontSetFetcher(){return new ka.Bf}getAssetFetchingErrorObservable(){return n.Bacon.never()}getUrlRewriter(){return{rewriteVideoUrl(a){return a},rewriteUrl(a){return a}}}addImageDownloadTask(){return n.Bacon.never()}setUrgentIdLister(){}downloadInitialBatch(){}};var Pa=
{iy:function(a){let b={};for(let c in a)b[c]="function"===typeof a[c]?function(){}:null;return b}};Object.defineProperty(Pa,"__esModule",{value:!0});Pa.Df=class{constructor(){}static createCetApplication(a,b){null==b&&(b=new ka.Dk);a=k.j.createCetApplication({headless:!1,speedMeasurementOptions:{measureSpeed:!1},rendererKind:h.RendererKind.Mock,isDesktop:!1},a,b,{updateList:[]},n.Bacon.newBus().toProperty(!1),n.Bacon.newVoidBus());a.getBaseScene().update();return a}static wt(a){let b=new kb.gl(null,
null,null),c=a.createComponentFactory();return a.getSceneHierarchy().createChildScene(a.getBaseScene(),"CetTestScene",{updateList:[b.createBoundCalculationSystem(),b.createWorldGeometrySystem(),Pa.Df.visibility(c),b.createQuadTreeSystem(a.getMainStage().getRenderer().getQuadTreeUpdater())]})}static visibility(){return new Lc.Pq((a)=>{a.getEntityList().forEachMutable((a)=>{k.j.hasZOrder(a)&&null==k.j.visibility(a,!0)&&k.j.setVisibility(a,!0,1)})},"CetHelperVisibilitySystem")}app(){return this.Ea}build(a){this.$s(k.j.cetSessionFactoryInternal(null).createCetSessionWithIPrezi(null!=
this.Ib?m.DOM.loadXml(this.Ib):f.CetModel.EMPTY_PREZI()),null==this.ml?new ka.Dk:this.ml,a);null!=a&&this.Ea.getCetUI().resize(a);return this}xml(a){this.Ib=a;return this}withStrategy(a){switch(a){case 0:this.Ib=m.DOM.saveXml(f.CetModel.EMPTY_PREZI());break;case 1:this.Ib='<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2"><xFields>  <xField name="topicType">\t<xEnum type="TopicType" value="WrappedInTopicContainer"/>  </xField></xFields><aspectRatio>  <aspectRatio value="16:9"/></aspectRatio><overview>  <overview>\t<xFields>\t  <xField name="usesChapters">\t\t<xBool value="true"/>\t  </xField>\t</xFields>\t<minimumScale>\t  <transform2D x="0" y="0" scale="2000" rotation="0"/>\t</minimumScale>\t<smartStructure>\t  <xConstructor name="chainSmartStructure" type="smartStructure">\t\t<xField name="chainLinks">\t\t  <xArray>\t\t\t<xRef value="2A0E77648806349B576D024EB4E19981"/>\t\t\t<xRef value="D0751634BAA946C09638E927774F1E12"/>\t\t  </xArray>\t\t</xField>\t\t<xField name="children">\t\t  <xArray>\t\t\t<xRef value="r2d2"/>\t\t\t<xRef value="shmi"/>\t\t\t<xRef value="leia"/>\t\t  </xArray>\t\t</xField>\t\t<xField name="id">\t\t  <xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\t\t</xField>\t  </xConstructor>\t</smartStructure>  </overview></overview><path>  <array>\t<flyToOverview/>\t<flyToObject>\t  <target>\t\t<ref value="r2d2"/>\t  </target>\t</flyToObject>\t<flyToOverview/>\t<flyToObject>\t  <target>\t\t<ref value="shmi"/>\t  </target>\t</flyToObject>\t<flyToObject>\t  <sound>\t\t<sound>\t\t  <assetSourceFilename>\t\t\t<string value="hello.mp3"/>\t\t  </assetSourceFilename>\t\t  <mediaLength>\t\t\t<int value="10000"/>\t\t  </mediaLength>\t\t  <onlineAssetId>\t\t\t<string value="sound_1_online_id"/>\t\t  </onlineAssetId>\t\t  <onlineAssetUrl>\t\t\t<string value="http://example.com/sample.mp3"/>\t\t  </onlineAssetUrl>\t\t</sound>\t  </sound>\t  <target>\t\t<ref value="anakin"/>\t  </target>\t</flyToObject>\t<flyToObject>\t  <target>\t\t<ref value="luke"/>\t  </target>\t</flyToObject>\t<flyToObject>\t  <target>\t\t<ref value="ben"/>\t  </target>\t</flyToObject>\t<flyToOverview/>\t<flyToObject>\t  <target>\t\t<ref value="leia"/>\t  </target>\t</flyToObject>\t<flyToOverview/>  </array></path><templateInfo>  <templateInfo>\t<baseId>\t  <string value="marketing_strategy_-_flow"/>\t</baseId>\t<themeId>\t  <string value="marketing_strategy_-_flow_default"/>\t</themeId>  </templateInfo></templateInfo><zObjects>  <array>\t<zLine>\t  <connectorHead>\t\t<connectorEnd>\t\t  <target>\t\t\t<ref value="shmi"/>\t\t  </target>\t\t</connectorEnd>\t  </connectorHead>\t  <connectorTail>\t\t<connectorEnd>\t\t  <target>\t\t\t<ref value="r2d2"/>\t\t  </target>\t\t</connectorEnd>\t  </connectorTail>\t  <id>\t\t<string value="2A0E77648806349B576D024EB4E19981"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="2700" y="0" scale="139.0430292598968" rotation="0"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="4.9456327985739685"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="chainLink"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<zLine>\t  <connectorHead>\t\t<connectorEnd>\t\t  <target>\t\t\t<ref value="leia"/>\t\t  </target>\t\t</connectorEnd>\t  </connectorHead>\t  <connectorTail>\t\t<connectorEnd>\t\t  <target>\t\t\t<ref value="shmi"/>\t\t  </target>\t\t</connectorEnd>\t  </connectorTail>\t  <id>\t\t<string value="D0751634BAA946C09638E927774F1E12"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="8100" y="0" scale="139.0430292598968" rotation="0"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="4.945632798573976"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="chainLink"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="r2d2"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="planetChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="0" y="0" scale="400" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="smartStructure">\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\t\t\t  <xField name="baseline">\t\t\t\t<xJust>\t\t\t\t  <xRef value="573638EFAADD4695D9BA08BF1E703D96"/>\t\t\t\t</xJust>\t\t\t  </xField>\t\t\t  <xField name="children">\t\t\t\t<xArray/>\t\t\t  </xField>\t\t\t  <xField name="id">\t\t\t\t<xString value="F06AF3081FD109B9AE1F927BDAD451C6"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="573638EFAADD4695D9BA08BF1E703D96"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="05EC3723EE44BB3FC935532A7A6B8A79"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="05EC3723EE44BB3FC935532A7A6B8A79"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="0" y="0" scale="6" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<zLine>\t  <arcHeight>\t\t<double value="-141.4561065641304"/>\t  </arcHeight>\t  <id>\t\t<string value="573638EFAADD4695D9BA08BF1E703D96"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="1951.6316803076086" y="-2.5985065218541377e-14" scale="6" rotation="1.5707963267948966"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="606.7071989502306"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="baseLine"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="shmi"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="planetChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="5400" y="0" scale="400" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="smartStructure">\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\t\t\t  <xField name="baseline">\t\t\t\t<xJust>\t\t\t\t  <xRef value="399B9AB737A32E7050E1369C88386E64"/>\t\t\t\t</xJust>\t\t\t  </xField>\t\t\t  <xField name="children">\t\t\t\t<xArray>\t\t\t\t  <xRef value="anakin"/>\t\t\t\t</xArray>\t\t\t  </xField>\t\t\t  <xField name="id">\t\t\t\t<xString value="6A515996BF6FA2315E5971FE8C221829"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="399B9AB737A32E7050E1369C88386E64"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="37847690C395F3B0849DBF5E944EF3C6"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="anakin"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="37847690C395F3B0849DBF5E944EF3C6"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="5400" y="0" scale="6" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<zLine>\t  <arcHeight>\t\t<double value="-141.4561065641304"/>\t  </arcHeight>\t  <id>\t\t<string value="399B9AB737A32E7050E1369C88386E64"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="7351.631680307609" y="-2.5985065218541377e-14" scale="6" rotation="1.5707963267948966"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="606.7071989502306"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="baseLine"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="leia"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="planetChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="10800" y="0" scale="400" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="smartStructure">\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\t\t\t  <xField name="baseline">\t\t\t\t<xJust>\t\t\t\t  <xRef value="1B7E4AA35EAEA474D4D13F163FEBE428"/>\t\t\t\t</xJust>\t\t\t  </xField>\t\t\t  <xField name="children">\t\t\t\t<xArray/>\t\t\t  </xField>\t\t\t  <xField name="id">\t\t\t\t<xString value="49397B61B809EE9C8EC9072661315412"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="1B7E4AA35EAEA474D4D13F163FEBE428"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="123BCB9E3375CF7E5005E2350E4F1E08"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="123BCB9E3375CF7E5005E2350E4F1E08"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="10800" y="0" scale="6" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<zLine>\t  <arcHeight>\t\t<double value="-141.4561065641304"/>\t  </arcHeight>\t  <id>\t\t<string value="1B7E4AA35EAEA474D4D13F163FEBE428"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="12751.631680307608" y="-2.5985065218541377e-14" scale="6" rotation="1.5707963267948966"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="606.7071989502306"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="baseLine"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="anakin"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame2"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="planetChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="7776" y="-5.115907697472721e-13" scale="108.1547985616654" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="smartStructure">\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\t\t\t  <xField name="baseline">\t\t\t\t<xJust>\t\t\t\t  <xRef value="AF1C4C53B582EDD999FEC5577D2D4F36"/>\t\t\t\t</xJust>\t\t\t  </xField>\t\t\t  <xField name="children">\t\t\t\t<xArray>\t\t\t\t  <xRef value="luke"/>\t\t\t\t</xArray>\t\t\t  </xField>\t\t\t  <xField name="id">\t\t\t\t<xString value="542E908474EC23EF459173C77AB901E9"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="AF1C4C53B582EDD999FEC5577D2D4F36"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="448DDACC611014ABE7154912D0908AE2"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="luke"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="448DDACC611014ABE7154912D0908AE2"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="7776" y="-5.115907697472721e-13" scale="1.622321978424981" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<zLine>\t  <arcHeight>\t\t<double value="-141.4561065641304"/>\t  </arcHeight>\t  <id>\t\t<string value="AF1C4C53B582EDD999FEC5577D2D4F36"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="8303.695828125585" y="-5.186167934830798e-13" scale="1.622321978424981" rotation="1.5707963267948966"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="606.7071989502306"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="baseLine"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="luke"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame2"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="planetChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="8418.439503456293" y="-6.536993168992922e-13" scale="29.24365112978603" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="smartStructure">\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\t\t\t  <xField name="baseline">\t\t\t\t<xJust>\t\t\t\t  <xRef value="1B87E7F6B3B214F9350354648CAFF224"/>\t\t\t\t</xJust>\t\t\t  </xField>\t\t\t  <xField name="children">\t\t\t\t<xArray>\t\t\t\t  <xRef value="ben"/>\t\t\t\t</xArray>\t\t\t  </xField>\t\t\t  <xField name="id">\t\t\t\t<xString value="946898C0180D667E2B1F702AC993B25F"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="1B87E7F6B3B214F9350354648CAFF224"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="E4AC6DB1D8BA0861606CF792B4DBC8B5"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="ben"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="E4AC6DB1D8BA0861606CF792B4DBC8B5"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="8418.439503456293" y="-6.536993168992922e-13" scale="0.43865476694679045" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<zLine>\t  <arcHeight>\t\t<double value="-141.4561065641304"/>\t  </arcHeight>\t  <id>\t\t<string value="1B87E7F6B3B214F9350354648CAFF224"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="8561.121593438178" y="-6.555990623538816e-13" scale="0.43865476694679045" rotation="1.5707963267948966"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="606.7071989502306"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="baseLine"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="ben"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame2"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="planetChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="8592.146791167223" y="-6.892264536872972e-13" scale="7.907102992874228" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="smartStructure">\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\t\t\t  <xField name="baseline">\t\t\t\t<xJust>\t\t\t\t  <xRef value="3AB8109C3DC4F64A44388084CB6FD8FA"/>\t\t\t\t</xJust>\t\t\t  </xField>\t\t\t  <xField name="children">\t\t\t\t<xArray/>\t\t\t  </xField>\t\t\t  <xField name="id">\t\t\t\t<xString value="23D2AB47F0A1AFAE49829F00F7DCFB36"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="3AB8109C3DC4F64A44388084CB6FD8FA"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="98AAC08B38BEE07DA486EEDA2E6B42C5"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="98AAC08B38BEE07DA486EEDA2E6B42C5"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="8592.146791167223" y="-6.892264536872972e-13" scale="0.11860654489311342" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<zLine>\t  <arcHeight>\t\t<double value="-141.4561065641304"/>\t  </arcHeight>\t  <id>\t\t<string value="3AB8109C3DC4F64A44388084CB6FD8FA"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="8630.726172918094" y="-6.897401201546961e-13" scale="0.11860654489311342" rotation="1.5707963267948966"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="606.7071989502306"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="baseLine"/>\t\t</array>\t  </styleClasses>\t</zLine>  </array></zObjects></prezi>';
break;case 2:this.Ib='\n<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2">\n  <xFields>\n    <xField name="topicType">\n      <xEnum type="TopicType" value="WrappedInTopicContainer"/>\n    </xField>\n  </xFields>\n  <aspectRatio>\n    <aspectRatio value="16:9"/>\n  </aspectRatio>\n  <documentStyle>\n    <documentStyle>\n      <styleDeclarations>\n        <array>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <alpha>\n                  <double value="0"/>\n                </alpha>\n                <fillType>\n                  <fillType value="solid"/>\n                </fillType>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="*.baseLine"/>\n            </styleSelector>\n          </styleDeclaration>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <gradEndAlpha>\n                  <double value="0.7"/>\n                </gradEndAlpha>\n                <gradStartAlpha>\n                  <double value="0.5"/>\n                </gradStartAlpha>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="#EB9DD20ED490A788B46332E81E889EB5"/>\n            </styleSelector>\n          </styleDeclaration>\n        </array>\n      </styleDeclarations>\n    </documentStyle>\n  </documentStyle>\n  <overview>\n    <overview>\n      <xFields>\n        <xField name="usesChapters">\n          <xBool value="true"/>\n        </xField>\n      </xFields>\n      <minimumScale>\n        <transform2D x="0" y="0" scale="2000" rotation="0"/>\n      </minimumScale>\n      <smartStructure>\n        <xConstructor name="chainSmartStructure" type="smartStructure">\n          <xField name="children">\n            <xArray>\n              <xRef value="planet"/>\n            </xArray>\n          </xField>\n          <xField name="id">\n            <xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\n          </xField>\n        </xConstructor>\n      </smartStructure>\n    </overview>\n  </overview>\n  <path>\n    <array>\n      <flyToOverview/>\n      <flyToObject>\n        <target>\n          <ref value="planet"/>\n        </target>\n      </flyToObject>\n      <flyToOverview/>\n    </array>\n  </path>\n  <templateInfo>\n    <templateInfo>\n      <baseId>\n        <string value="sphere_linear_-_blue"/>\n      </baseId>\n      <themeId>\n        <string value="sphere_linear_-_blue_default"/>\n      </themeId>\n    </templateInfo>\n  </templateInfo>\n  <zObjects>\n    <array>\n      <xConstructor name="zTopicContainer" type="zObject">\n        <xField name="id">\n          <xString value="planet"/>\n        </xField>\n        <xField name="topic">\n          <xConstructor type="topic" name="planetChapter">\n            <xField name="smartStructure">\n              <xConstructor type="smartStructure" name="linearSmartStructure">\n                <xField name="baseline">\n                  <xJust>\n                    <xRef value="planetbaseline"/>\n                  </xJust>\n                </xField>\n                <xField name="children">\n                  <xArray/>\n                </xField>\n                <xField name="id">\n                  <xString value="EF9DAF6186A36E790CB6729EEF71FC18"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="position">\n              <xConstructor type="position" name="absolute">\n                <xField name="localToWorld">\n                  <xTransform2D x="-1384.0043765465798" y="0" scale="341.39553657049083" rotation="0"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="topicChildren">\n              <xArray>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="planetbaseline"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="visual"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="EB9DD20ED490A788B46332E81E889EB5"/>\n                  </xField>\n                </xRecord>\n              </xArray>\n            </xField>\n          </xConstructor>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame3"/>\n          </xArray>\n        </xField>\n      </xConstructor>\n      <xConstructor name="zShape" type="zObject">\n        <xField name="id">\n          <xString value="EB9DD20ED490A788B46332E81E889EB5"/>\n        </xField>\n        <xField name="shapeType">\n          <xEnum type="ShapeType" value="oval"/>\n        </xField>\n        <xField name="localToWorld">\n          <xTransform2D x="-1384.0043765465798" y="0" scale="5.1209330485573625" rotation="0"/>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame3"/>\n          </xArray>\n        </xField>\n        <xField name="width">\n          <xDouble value="600"/>\n        </xField>\n        <xField name="height">\n          <xDouble value="600"/>\n        </xField>\n      </xConstructor>\n      <zLine>\n        <id>\n          <string value="planetbaseline"/>\n        </id>\n        <localToWorld>\n          <transform2D x="113.86854015644894" y="0" scale="5.120933048557363" rotation="1.5707963267948966"/>\n        </localToWorld>\n        <startEndDistance>\n          <double value="675.499814951862"/>\n        </startEndDistance>\n        <arcHeight>\n          <double value="-194.99999999999997"/>\n        </arcHeight>\n      </zLine>\n    </array>\n  </zObjects>\n</prezi>\n';
break;case 3:this.Ib='\n<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2">\n  <xFields>\n    <xField name="topicType">\n      <xEnum type="TopicType" value="WrappedInTopicContainer"/>\n    </xField>\n  </xFields>\n  <aspectRatio>\n    <aspectRatio value="16:9"/>\n  </aspectRatio>\n  <documentStyle>\n    <documentStyle>\n      <styleDeclarations>\n        <array>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <alpha>\n                  <double value="0"/>\n                </alpha>\n                <fillType>\n                  <fillType value="solid"/>\n                </fillType>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="*.baseLine"/>\n            </styleSelector>\n          </styleDeclaration>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <gradEndAlpha>\n                  <double value="0.7"/>\n                </gradEndAlpha>\n                <gradStartAlpha>\n                  <double value="0.5"/>\n                </gradStartAlpha>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="#9B8F7C2A1855997607A21BC4EB3607C8"/>\n            </styleSelector>\n          </styleDeclaration>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <gradEndAlpha>\n                  <double value="0.7"/>\n                </gradEndAlpha>\n                <gradStartAlpha>\n                  <double value="0.5"/>\n                </gradStartAlpha>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="#049EBD641430A7D62535396D7D7F6A08"/>\n            </styleSelector>\n          </styleDeclaration>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <gradEndAlpha>\n                  <double value="0.7"/>\n                </gradEndAlpha>\n                <gradStartAlpha>\n                  <double value="0.5"/>\n                </gradStartAlpha>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="#8DF22C8037F8A5D94D5BDB6A3C851DD1"/>\n            </styleSelector>\n          </styleDeclaration>\n        </array>\n      </styleDeclarations>\n    </documentStyle>\n  </documentStyle>\n  <overview>\n    <overview>\n      <xFields>\n        <xField name="usesChapters">\n          <xBool value="true"/>\n        </xField>\n      </xFields>\n      <minimumScale>\n        <transform2D x="0" y="0" scale="2000" rotation="0"/>\n      </minimumScale>\n      <smartStructure>\n        <xConstructor name="chainSmartStructure" type="smartStructure">\n          <xField name="children">\n            <xArray>\n              <xRef value="planet"/>\n            </xArray>\n          </xField>\n          <xField name="id">\n            <xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\n          </xField>\n        </xConstructor>\n      </smartStructure>\n    </overview>\n  </overview>\n  <path>\n    <array>\n      <flyToOverview/>\n      <flyToObject>\n        <target>\n          <ref value="planet"/>\n        </target>\n      </flyToObject>\n      <flyToObject>\n        <target>\n          <ref value="subtopic"/>\n        </target>\n      </flyToObject>\n      <flyToObject>\n        <target>\n          <ref value="grandchild"/>\n        </target>\n      </flyToObject>\n      <flyToOverview/>\n    </array>\n  </path>\n  <templateInfo>\n    <templateInfo>\n      <baseId>\n        <string value="sphere_linear_-_blue"/>\n      </baseId>\n      <themeId>\n        <string value="sphere_linear_-_blue_default"/>\n      </themeId>\n    </templateInfo>\n  </templateInfo>\n  <zObjects>\n    <array>\n      <xConstructor name="zTopicContainer" type="zObject">\n        <xField name="id">\n          <xString value="planet"/>\n        </xField>\n        <xField name="topic">\n          <xConstructor type="topic" name="planetChapter">\n            <xField name="smartStructure">\n              <xConstructor type="smartStructure" name="linearSmartStructure">\n                <xField name="baseline">\n                  <xJust>\n                    <xRef value="planetbaseline"/>\n                  </xJust>\n                </xField>\n                <xField name="children">\n                  <xArray>\n                    <xRef value="subtopic"/>\n                  </xArray>\n                </xField>\n                <xField name="id">\n                  <xString value="6492728DD4FCB59B523C90728AACDEBF"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="position">\n              <xConstructor type="position" name="absolute">\n                <xField name="localToWorld">\n                  <xTransform2D x="-773.7561269597054" y="0" scale="341.39553657049083" rotation="0"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="topicChildren">\n              <xArray>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="planetbaseline"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="subtopic"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="visual"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="9B8F7C2A1855997607A21BC4EB3607C8"/>\n                  </xField>\n                </xRecord>\n              </xArray>\n            </xField>\n          </xConstructor>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame3"/>\n          </xArray>\n        </xField>\n      </xConstructor>\n      <xConstructor name="zShape" type="zObject">\n        <xField name="id">\n          <xString value="9B8F7C2A1855997607A21BC4EB3607C8"/>\n        </xField>\n        <xField name="shapeType">\n          <xEnum type="ShapeType" value="oval"/>\n        </xField>\n        <xField name="localToWorld">\n          <xTransform2D x="-1384.0043765465798" y="0" scale="5.1209330485573625" rotation="0"/>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame3"/>\n          </xArray>\n        </xField>\n        <xField name="width">\n          <xDouble value="600"/>\n        </xField>\n        <xField name="height">\n          <xDouble value="600"/>\n        </xField>\n      </xConstructor>\n      <zLine>\n        <id>\n          <string value="planetbaseline"/>\n        </id>\n        <localToWorld>\n          <transform2D x="113.86854015644894" y="0" scale="5.120933048557363" rotation="1.5707963267948966"/>\n        </localToWorld>\n        <startEndDistance>\n          <double value="675.499814951862"/>\n        </startEndDistance>\n        <arcHeight>\n          <double value="-194.99999999999997"/>\n        </arcHeight>\n      </zLine>\n      <xConstructor name="zTopicContainer" type="zObject">\n        <xField name="id">\n          <xString value="subtopic"/>\n        </xField>\n        <xField name="topic">\n          <xConstructor type="topic" name="planetChapter">\n            <xField name="smartStructure">\n              <xConstructor type="smartStructure" name="linearSmartStructure">\n                <xField name="baseline">\n                  <xJust>\n                    <xRef value="FA3D3D2F7C9048D910581F846C4AF217baseline"/>\n                  </xJust>\n                </xField>\n                <xField name="children">\n                  <xArray>\n                    <xRef value="grandchild"/>\n                  </xArray>\n                </xField>\n                <xField name="id">\n                  <xString value="D5DDFB9A1F5D5340F02A41483C62E3D5"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="position">\n              <xConstructor type="position" name="absolute">\n                <xField name="localToWorld">\n                  <xTransform2D x="754.1520374691986" y="-3.979039320256561e-13" scale="106.13943881039378" rotation="0"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="topicChildren">\n              <xArray>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="FA3D3D2F7C9048D910581F846C4AF217baseline"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="grandchild"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="visual"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="049EBD641430A7D62535396D7D7F6A08"/>\n                  </xField>\n                </xRecord>\n              </xArray>\n            </xField>\n          </xConstructor>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame2"/>\n          </xArray>\n        </xField>\n      </xConstructor>\n      <xConstructor name="zShape" type="zObject">\n        <xField name="id">\n          <xString value="049EBD641430A7D62535396D7D7F6A08"/>\n        </xField>\n        <xField name="shapeType">\n          <xEnum type="ShapeType" value="oval"/>\n        </xField>\n        <xField name="localToWorld">\n          <xTransform2D x="613.1595123907919" y="-3.979039320256561e-13" scale="1.5920915821559067" rotation="0"/>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame2"/>\n          </xArray>\n        </xField>\n        <xField name="width">\n          <xDouble value="600"/>\n        </xField>\n        <xField name="height">\n          <xDouble value="600"/>\n        </xField>\n      </xConstructor>\n      <zLine>\n        <id>\n          <string value="FA3D3D2F7C9048D910581F846C4AF217baseline"/>\n        </id>\n        <localToWorld>\n          <transform2D x="1131.0222406718804" y="-4.0479903262502474e-13" scale="1.5920915821559067" rotation="1.5707963267948966"/>\n        </localToWorld>\n        <startEndDistance>\n          <double value="606.7071989502306"/>\n        </startEndDistance>\n        <arcHeight>\n          <double value="-141.4561065641304"/>\n        </arcHeight>\n      </zLine>\n      <xConstructor name="zTopicContainer" type="zObject">\n        <xField name="id">\n          <xString value="grandchild"/>\n        </xField>\n        <xField name="topic">\n          <xConstructor type="topic" name="planetChapter">\n            <xField name="smartStructure">\n              <xConstructor type="smartStructure" name="linearSmartStructure">\n                <xField name="baseline">\n                  <xJust>\n                    <xRef value="4EEA4D2D8756796C21B131B54F9A81BAbaseline"/>\n                  </xJust>\n                </xField>\n                <xField name="children">\n                  <xArray/>\n                </xField>\n                <xField name="id">\n                  <xString value="51E2F918E9C72DB260534D3D52E1F54B"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="position">\n              <xConstructor type="position" name="absolute">\n                <xField name="localToWorld">\n                  <xTransform2D x="1243.627778924531" y="-5.400124791776761e-13" scale="28.698724059965873" rotation="0"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="topicChildren">\n              <xArray>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="4EEA4D2D8756796C21B131B54F9A81BAbaseline"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="visual"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="8DF22C8037F8A5D94D5BDB6A3C851DD1"/>\n                  </xField>\n                </xRecord>\n              </xArray>\n            </xField>\n          </xConstructor>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame2"/>\n          </xArray>\n        </xField>\n      </xConstructor>\n      <xConstructor name="zShape" type="zObject">\n        <xField name="id">\n          <xString value="8DF22C8037F8A5D94D5BDB6A3C851DD1"/>\n        </xField>\n        <xField name="shapeType">\n          <xEnum type="ShapeType" value="oval"/>\n        </xField>\n        <xField name="localToWorld">\n          <xTransform2D x="1243.627778924531" y="-5.400124791776761e-13" scale="0.4304808608994881" rotation="0"/>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame2"/>\n          </xArray>\n        </xField>\n        <xField name="width">\n          <xDouble value="600"/>\n        </xField>\n        <xField name="height">\n          <xDouble value="600"/>\n        </xField>\n      </xConstructor>\n      <zLine>\n        <id>\n          <string value="4EEA4D2D8756796C21B131B54F9A81BAbaseline"/>\n        </id>\n        <localToWorld>\n          <transform2D x="1383.6511265741199" y="-5.41876824718644e-13" scale="0.4304808608994881" rotation="1.5707963267948966"/>\n        </localToWorld>\n        <startEndDistance>\n          <double value="606.7071989502306"/>\n        </startEndDistance>\n        <arcHeight>\n          <double value="-141.4561065641304"/>\n        </arcHeight>\n      </zLine>\n    </array>\n  </zObjects>\n</prezi>\n';
break;case 4:this.Ib='\n<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2">\n  <xFields>\n    <xField name="topicType">\n      <xEnum type="TopicType" value="WrappedInTopicContainer"/>\n    </xField>\n  </xFields>\n  <aspectRatio>\n    <aspectRatio value="16:9"/>\n  </aspectRatio>\n  <documentStyle>\n    <documentStyle>\n      <styleDeclarations>\n        <array>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <alpha>\n                  <double value="0"/>\n                </alpha>\n                <fillType>\n                  <fillType value="solid"/>\n                </fillType>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="*.baseLine"/>\n            </styleSelector>\n          </styleDeclaration>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <gradEndAlpha>\n                  <double value="0.7"/>\n                </gradEndAlpha>\n                <gradStartAlpha>\n                  <double value="0.5"/>\n                </gradStartAlpha>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="#EF9DAF6186A36E790CB6729EEF71FC18"/>\n            </styleSelector>\n          </styleDeclaration>\n        </array>\n      </styleDeclarations>\n    </documentStyle>\n  </documentStyle>\n  <overview>\n    <overview>\n      <xFields>\n        <xField name="usesChapters">\n          <xBool value="true"/>\n        </xField>\n      </xFields>\n      <minimumScale>\n        <transform2D x="0" y="0" scale="2000" rotation="0"/>\n      </minimumScale>\n      <smartStructure>\n        <xConstructor name="chainSmartStructure" type="smartStructure">\n          <xField name="children">\n            <xArray>\n              <xRef value="stack"/>\n            </xArray>\n          </xField>\n          <xField name="id">\n            <xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\n          </xField>\n        </xConstructor>\n      </smartStructure>\n    </overview>\n  </overview>\n  <path>\n    <array>\n      <flyToOverview/>\n      <flyToObject>\n        <target>\n          <ref value="page"/>\n        </target>\n      </flyToObject>\n      <flyToOverview/>\n    </array>\n  </path>\n  <templateInfo>\n    <templateInfo>\n      <baseId>\n        <string value="sphere_linear_-_blue"/>\n      </baseId>\n      <themeId>\n        <string value="sphere_linear_-_blue_default"/>\n      </themeId>\n    </templateInfo>\n  </templateInfo>\n  <zObjects>\n    <array>\n      <xConstructor name="zTopicContainer" type="zObject">\n        <xField name="id">\n          <xString value="stack"/>\n        </xField>\n        <xField name="topic">\n          <xConstructor type="topic" name="stackChapter">\n            <xField name="position">\n              <xConstructor type="position" name="absolute">\n                <xField name="localToWorld">\n                  <xTransform2D x="0" y="0" scale="213.33333333333331" rotation="0"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="topicChildren">\n              <xArray>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="page"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="visual"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="EF9DAF6186A36E790CB6729EEF71FC18"/>\n                  </xField>\n                </xRecord>\n              </xArray>\n            </xField>\n          </xConstructor>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame1"/>\n          </xArray>\n        </xField>\n      </xConstructor>\n      <xConstructor name="zShape" type="zObject">\n        <xField name="id">\n          <xString value="EF9DAF6186A36E790CB6729EEF71FC18"/>\n        </xField>\n        <xField name="shapeType">\n          <xEnum type="ShapeType" value="oval"/>\n        </xField>\n        <xField name="localToWorld">\n          <xTransform2D x="0" y="0" scale="10.666666666666666" rotation="0"/>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame1"/>\n          </xArray>\n        </xField>\n        <xField name="width">\n          <xDouble value="600"/>\n        </xField>\n        <xField name="height">\n          <xDouble value="600"/>\n        </xField>\n      </xConstructor>\n      <xConstructor name="zTopicContainer" type="zObject">\n        <xField name="id">\n          <xString value="page"/>\n        </xField>\n        <xField name="topic">\n          <xConstructor type="topic" name="page">\n            <xField name="children">\n              <xArray/>\n            </xField>\n          </xConstructor>\n        </xField>\n        <xField name="styleClasses">\n          <xArray/>\n        </xField>\n      </xConstructor>\n    </array>\n  </zObjects>\n</prezi>\n';
break;case 5:this.Ib='<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2">\n<xFields>\n\t<xField name="topicType">\n\t\t<xEnum type="TopicType" value="WrappedInTopicContainer"/>\n\t</xField>\n</xFields>\n<aspectRatio>\n\t<aspectRatio value="16:9"/>\n</aspectRatio>\n<documentStyle>\n\t<documentStyle>\n\t\t<styleDeclarations>\n\t\t\t<array>\n\t\t\t\t<styleDeclaration>\n\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t\t<alpha>\n\t\t\t\t\t\t\t\t<double value="0"/>\n\t\t\t\t\t\t\t</alpha>\n\t\t\t\t\t\t\t<fillType>\n\t\t\t\t\t\t\t\t<fillType value="solid"/>\n\t\t\t\t\t\t\t</fillType>\n\t\t\t\t\t\t</styleBlock>\n\t\t\t\t\t</styleBlock>\n\t\t\t\t\t<styleSelector>\n\t\t\t\t\t\t<simpleSelector value="*.baseLine"/>\n\t\t\t\t\t</styleSelector>\n\t\t\t\t</styleDeclaration>\n\t\t\t\t<styleDeclaration>\n\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t\t<gradEndAlpha>\n\t\t\t\t\t\t\t\t<double value="0.7"/>\n\t\t\t\t\t\t\t</gradEndAlpha>\n\t\t\t\t\t\t\t<gradStartAlpha>\n\t\t\t\t\t\t\t\t<double value="0.5"/>\n\t\t\t\t\t\t\t</gradStartAlpha>\n\t\t\t\t\t\t</styleBlock>\n\t\t\t\t\t</styleBlock>\n\t\t\t\t\t<styleSelector>\n\t\t\t\t\t\t<simpleSelector value="#A4618369B7F36091EB23A334BF83A37C"/>\n\t\t\t\t\t</styleSelector>\n\t\t\t\t</styleDeclaration>\n\t\t\t\t<styleDeclaration>\n\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t\t<gradEndAlpha>\n\t\t\t\t\t\t\t\t<double value="0.7"/>\n\t\t\t\t\t\t\t</gradEndAlpha>\n\t\t\t\t\t\t\t<gradStartAlpha>\n\t\t\t\t\t\t\t\t<double value="0.5"/>\n\t\t\t\t\t\t\t</gradStartAlpha>\n\t\t\t\t\t\t</styleBlock>\n\t\t\t\t\t</styleBlock>\n\t\t\t\t\t<styleSelector>\n\t\t\t\t\t\t<simpleSelector value="#9584E558D872FEA1AAB1D0D260E9DFBB"/>\n\t\t\t\t\t</styleSelector>\n\t\t\t\t</styleDeclaration>\n\t\t\t\t<styleDeclaration>\n\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t\t<gradEndAlpha>\n\t\t\t\t\t\t\t\t<double value="0.7"/>\n\t\t\t\t\t\t\t</gradEndAlpha>\n\t\t\t\t\t\t\t<gradStartAlpha>\n\t\t\t\t\t\t\t\t<double value="0.5"/>\n\t\t\t\t\t\t\t</gradStartAlpha>\n\t\t\t\t\t\t</styleBlock>\n\t\t\t\t\t</styleBlock>\n\t\t\t\t\t<styleSelector>\n\t\t\t\t\t\t<simpleSelector value="#65E3A2D12AB973680C3F0D9533D2717C"/>\n\t\t\t\t\t</styleSelector>\n\t\t\t\t</styleDeclaration>\n\t\t\t\t<styleDeclaration>\n\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t\t<gradEndAlpha>\n\t\t\t\t\t\t\t\t<double value="0.7"/>\n\t\t\t\t\t\t\t</gradEndAlpha>\n\t\t\t\t\t\t\t<gradStartAlpha>\n\t\t\t\t\t\t\t\t<double value="0.5"/>\n\t\t\t\t\t\t\t</gradStartAlpha>\n\t\t\t\t\t\t</styleBlock>\n\t\t\t\t\t</styleBlock>\n\t\t\t\t\t<styleSelector>\n\t\t\t\t\t\t<simpleSelector value="#E2F0212A31C6109B532A23BAF73643D8"/>\n\t\t\t\t\t</styleSelector>\n\t\t\t\t</styleDeclaration>\n\t\t\t</array>\n\t\t</styleDeclarations>\n\t</documentStyle>\n</documentStyle>\n<overview>\n\t<overview>\n\t\t<xFields>\n\t\t\t<xField name="usesChapters">\n\t\t\t\t<xBool value="true"/>\n\t\t\t</xField>\n\t\t</xFields>\n\t\t<minimumScale>\n\t\t\t<transform2D x="0" y="0" scale="2000" rotation="0"/>\n\t\t</minimumScale>\n\t\t<smartStructure>\n\t\t\t<xConstructor name="chainSmartStructure" type="smartStructure">\n\t\t\t\t<xField name="children">\n\t\t\t\t\t<xArray>\n\t\t\t\t\t\t<xRef value="top_planet"/>\n\t\t\t\t\t</xArray>\n\t\t\t\t</xField>\n\t\t\t\t<xField name="id">\n\t\t\t\t\t<xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\n\t\t\t\t</xField>\n\t\t\t</xConstructor>\n\t\t</smartStructure>\n\t</overview>\n</overview>\n<path>\n\t<array>\n\t\t<flyToOverview/>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="top_planet"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="stack1_page1"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="stack1_page2"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="inner_planet"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="stack2_page1"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToOverview/>\n\t</array>\n</path>\n<templateInfo>\n\t<templateInfo>\n\t\t<baseId>\n\t\t\t<string value="sphere_linear_-_blue"/>\n\t\t</baseId>\n\t\t<themeId>\n\t\t\t<string value="sphere_linear_-_blue_default"/>\n\t\t</themeId>\n\t</templateInfo>\n</templateInfo>\n<zObjects>\n\t<array>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="top_planet"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="planetChapter">\n\t\t\t\t\t<xField name="smartStructure">\n\t\t\t\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\n\t\t\t\t\t\t\t<xField name="baseline">\n\t\t\t\t\t\t\t\t<xJust>\n\t\t\t\t\t\t\t\t\t<xRef value="D15107317F9FD6F036D33A625B5FCD7Dbaseline"/>\n\t\t\t\t\t\t\t\t</xJust>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t\t\t<xRef value="stack1"/>\n\t\t\t\t\t\t\t\t\t<xRef value="inner_planet"/>\n\t\t\t\t\t\t\t\t\t<xRef value="stack2"/>\n\t\t\t\t\t\t\t\t</xArray>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="id">\n\t\t\t\t\t\t\t\t<xString value="82A7DD4D007AFFC7FEEA81EEA242D0F4"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="10544.619194246661" y="0" scale="711.1111111111111" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="D15107317F9FD6F036D33A625B5FCD7Dbaseline"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="inner_planet"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack2"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="A4618369B7F36091EB23A334BF83A37C"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="A4618369B7F36091EB23A334BF83A37C"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="9600" y="0" scale="10.666666666666666" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<zLine>\n\t\t\t<id>\n\t\t\t\t<string value="D15107317F9FD6F036D33A625B5FCD7Dbaseline"/>\n\t\t\t</id>\n\t\t\t<localToWorld>\n\t\t\t\t<transform2D x="13069.567431657972" y="-4.6195671499629117e-14" scale="10.666666666666666" rotation="1.5707963267948966"/>\n\t\t\t</localToWorld>\n\t\t\t<startEndDistance>\n\t\t\t\t<double value="606.7071989502306"/>\n\t\t\t</startEndDistance>\n\t\t\t<arcHeight>\n\t\t\t\t<double value="-141.4561065641304"/>\n\t\t\t</arcHeight>\n\t\t</zLine>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack1"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="stackChapter">\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="13288.421108157756" y="-2058.5737122814726" scale="57.682559232888124" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack1_page1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack1_page2"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="9584E558D872FEA1AAB1D0D260E9DFBB"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="9584E558D872FEA1AAB1D0D260E9DFBB"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="13288.421108157756" y="-2058.5737122814726" scale="2.884127961644406" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack1_page1"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="page">\n\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="inner_planet"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="planetChapter">\n\t\t\t\t\t<xField name="smartStructure">\n\t\t\t\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\n\t\t\t\t\t\t\t<xField name="baseline">\n\t\t\t\t\t\t\t\t<xJust>\n\t\t\t\t\t\t\t\t\t<xRef value="B2684DB95E3CE2E75222798661B1B796baseline"/>\n\t\t\t\t\t\t\t\t</xJust>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="id">\n\t\t\t\t\t\t\t\t<xString value="73723C1289EB77C832F8339812A0A2AB"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="13824.000000000002" y="-9.094947017729282e-13" scale="192.27519744296063" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="B2684DB95E3CE2E75222798661B1B796baseline"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="65E3A2D12AB973680C3F0D9533D2717C"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame2"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="65E3A2D12AB973680C3F0D9533D2717C"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="13824.000000000002" y="-9.094947017729282e-13" scale="2.8841279616444098" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame2"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<zLine>\n\t\t\t<id>\n\t\t\t\t<string value="B2684DB95E3CE2E75222798661B1B796baseline"/>\n\t\t\t</id>\n\t\t\t<localToWorld>\n\t\t\t\t<transform2D x="14762.125916667708" y="-9.094947017729282e-13" scale="2.8841279616444098" rotation="1.5707963267948966"/>\n\t\t\t</localToWorld>\n\t\t\t<startEndDistance>\n\t\t\t\t<double value="606.7071989502306"/>\n\t\t\t</startEndDistance>\n\t\t\t<arcHeight>\n\t\t\t\t<double value="-141.4561065641304"/>\n\t\t\t</arcHeight>\n\t\t</zLine>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack1_page2"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="page">\n\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack2"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="stackChapter">\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="13288.421108157758" y="2058.5737122814708" scale="57.682559232888124" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack2_page1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="E2F0212A31C6109B532A23BAF73643D8"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="E2F0212A31C6109B532A23BAF73643D8"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="13288.421108157758" y="2058.5737122814708" scale="2.884127961644406" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack2_page1"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="page">\n\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t</array>\n</zObjects>\n</prezi>\n';
break;case 6:this.Ib='<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2">\n<xFields>\n\t<xField name="topicType">\n\t\t<xEnum type="TopicType" value="WrappedInTopicContainer"/>\n\t</xField>\n</xFields>\n<aspectRatio>\n\t<aspectRatio value="16:9"/>\n</aspectRatio>\n<overview>\n\t<overview>\n\t\t<xFields>\n\t\t\t<xField name="usesChapters">\n\t\t\t\t<xBool value="true"/>\n\t\t\t</xField>\n\t\t</xFields>\n\t\t<minimumScale>\n\t\t\t<transform2D x="0" y="0" scale="2000" rotation="0"/>\n\t\t</minimumScale>\n\t\t<smartStructure>\n\t\t\t<xConstructor name="chainSmartStructure" type="smartStructure">\n\t\t\t\t<xField name="chainLinks">\n\t\t\t\t\t<xArray/>\n\t\t\t\t</xField>\n\t\t\t\t<xField name="children">\n\t\t\t\t\t<xArray>\n\t\t\t\t\t\t<xRef value="top_planet"/>\n\t\t\t\t\t</xArray>\n\t\t\t\t</xField>\n\t\t\t\t<xField name="id">\n\t\t\t\t\t<xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\n\t\t\t\t</xField>\n\t\t\t</xConstructor>\n\t\t</smartStructure>\n\t</overview>\n</overview>\n<path>\n\t<array>\n\t\t<flyToOverview/>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="top_planet"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="stack1_page1"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="stack1_page2"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="inner_planet"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="stack2_page1"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToOverview/>\n\t</array>\n</path>\n<templateInfo>\n\t<templateInfo>\n\t\t<baseId>\n\t\t\t<string value="sphere_linear_-_blue"/>\n\t\t</baseId>\n\t\t<themeId>\n\t\t\t<string value="sphere_linear_-_blue_default"/>\n\t\t</themeId>\n\t</templateInfo>\n</templateInfo>\n<zObjects>\n\t<array>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="top_planet"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="planetChapter">\n\t\t\t\t\t<xField name="smartStructure">\n\t\t\t\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\n\t\t\t\t\t\t\t<xField name="baseline">\n\t\t\t\t\t\t\t\t<xJust>\n\t\t\t\t\t\t\t\t\t<xRef value="D15107317F9FD6F036D33A625B5FCD7Dbaseline"/>\n\t\t\t\t\t\t\t\t</xJust>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t\t\t<xRef value="stack1"/>\n\t\t\t\t\t\t\t\t\t<xRef value="inner_planet"/>\n\t\t\t\t\t\t\t\t\t<xRef value="stack2"/>\n\t\t\t\t\t\t\t\t</xArray>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="id">\n\t\t\t\t\t\t\t\t<xString value="E17E515CDA7E01F5FFB65838A6FB1396"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="10688.825592328882" y="0" scale="711.1111111111111" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="D15107317F9FD6F036D33A625B5FCD7Dbaseline"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="inner_planet"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack2"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="647D1241761691B45A3BF5288EFA28F1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="647D1241761691B45A3BF5288EFA28F1"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="9600" y="0" scale="10.666666666666666" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<zLine>\n\t\t\t<id>\n\t\t\t\t<string value="D15107317F9FD6F036D33A625B5FCD7Dbaseline"/>\n\t\t\t</id>\n\t\t\t<localToWorld>\n\t\t\t\t<transform2D x="13069.567431657972" y="-4.6195671499629117e-14" scale="10.666666666666666" rotation="1.5707963267948966"/>\n\t\t\t</localToWorld>\n\t\t\t<startEndDistance>\n\t\t\t\t<double value="606.7071989502306"/>\n\t\t\t</startEndDistance>\n\t\t\t<arcHeight>\n\t\t\t\t<double value="-141.4561065641304"/>\n\t\t\t</arcHeight>\n\t\t</zLine>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack1"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="stackChapter">\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="13288.421108157756" y="-2058.5737122814726" scale="57.682559232888124" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack1_page1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack1_page2"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="EEF8C675995BADA1DADD4BDC3F8043BC"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="EEF8C675995BADA1DADD4BDC3F8043BC"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="13288.421108157756" y="-2058.5737122814726" scale="2.884127961644406" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack1_page1"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="page">\n\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="inner_planet"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="planetChapter">\n\t\t\t\t\t<xField name="smartStructure">\n\t\t\t\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\n\t\t\t\t\t\t\t<xField name="baseline">\n\t\t\t\t\t\t\t\t<xJust>\n\t\t\t\t\t\t\t\t\t<xRef value="B2684DB95E3CE2E75222798661B1B796baseline"/>\n\t\t\t\t\t\t\t\t</xJust>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="id">\n\t\t\t\t\t\t\t\t<xString value="60EE8CBB69D88FCAB3B8ADDD633E38EA"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="13824.000000000002" y="-9.094947017729282e-13" scale="192.27519744296063" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="B2684DB95E3CE2E75222798661B1B796baseline"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="CB7C5A78E40C191218D60EB848818FB8"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame2"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="CB7C5A78E40C191218D60EB848818FB8"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="13824.000000000002" y="-9.094947017729282e-13" scale="2.8841279616444098" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame2"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<zLine>\n\t\t\t<id>\n\t\t\t\t<string value="B2684DB95E3CE2E75222798661B1B796baseline"/>\n\t\t\t</id>\n\t\t\t<localToWorld>\n\t\t\t\t<transform2D x="14762.125916667708" y="-9.094947017729282e-13" scale="2.8841279616444098" rotation="1.5707963267948966"/>\n\t\t\t</localToWorld>\n\t\t\t<startEndDistance>\n\t\t\t\t<double value="606.7071989502306"/>\n\t\t\t</startEndDistance>\n\t\t\t<arcHeight>\n\t\t\t\t<double value="-141.4561065641304"/>\n\t\t\t</arcHeight>\n\t\t</zLine>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack1_page2"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="page">\n\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack2"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="stackChapter">\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="13288.421108157758" y="2058.5737122814708" scale="57.682559232888124" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack2_page1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="2AE3418BBBA54D13B5E6BE770C893ED0"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="2AE3418BBBA54D13B5E6BE770C893ED0"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="13288.421108157758" y="2058.5737122814708" scale="2.884127961644406" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack2_page1"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="page">\n\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t</array>\n</zObjects>\n</prezi>\n';
break;case 7:this.Ib='<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2"><xFields>  <xField name="topicType">\t<xEnum type="TopicType" value="WrappedInTopicContainer"/>  </xField></xFields><aspectRatio>  <aspectRatio value="16:9"/></aspectRatio><overview>  <overview>\t<xFields>\t  <xField name="usesChapters">\t\t<xBool value="true"/>\t  </xField>\t</xFields>\t<minimumScale>\t  <transform2D x="0" y="0" scale="2000" rotation="0"/>\t</minimumScale>\t<smartStructure>\t  <xConstructor name="chainSmartStructure" type="smartStructure">\t\t<xField name="chainLinks">\t\t  <xArray/>\t\t</xField>\t\t<xField name="children">\t\t  <xArray>\t\t\t<xRef value="stack"/>\t\t  </xArray>\t\t</xField>\t\t<xField name="id">\t\t  <xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\t\t</xField>\t  </xConstructor>\t</smartStructure>  </overview></overview><path>  <array>\t<flyToOverview/>\t<flyToObject>\t  <target>\t\t<ref value="page"/>\t  </target>\t</flyToObject>\t<flyToOverview/>  </array></path><templateInfo>  <templateInfo>\t<baseId>\t  <string value="sphere_linear_-_blue"/>\t</baseId>\t<themeId>\t  <string value="sphere_linear_-_blue_default"/>\t</themeId>  </templateInfo></templateInfo><zObjects>  <array>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="stack"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="stackChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="0" y="0" scale="213.33333333333331" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="page"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="5CA88A0F19ED7648AE16792B49D2844B"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="5CA88A0F19ED7648AE16792B49D2844B"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="0" y="0" scale="10.666666666666666" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="page"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray/>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="page">\t\t  <xField name="children">\t\t\t<xArray/>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>  </array></zObjects></prezi>'}return this}assetManager(a){this.ml=
a;return this}$s(a,b,c){let d=a.getIPrezi();this.Ea=Pa.Df.createCetApplication(a,b);this.Ea.getMainStage().setAspectRatio(d.getAspectRatio());a=this.Ea.getMainStage();null!=c&&a.resizeStage(c);this.i=Pa.Df.wt(this.Ea);this.Ea.getMainStage().setScene(this.i,this.i);this.Ea.initializeLoop(n.Bacon.newBus())}addEntity(a){let b=this.i.getEntityList().createEntity(a);b.set(k.j.getDefComponentKey(),f.CetModel.ID.Z_OBJECT);b.set(k.j.getDecoratorComponentKey(),!0);var c=m.DOM.createLocalSessionWithCorrection(m.DOM.emptyPrezi(),
()=>{}).getPrezi();a=m.DOM.createZTriangle(a);c.getTypedZObjects().append(a);k.j.setPdomCompForTest(b,new Aa.ne(c.getTypedZObjects().getTyped(c.getTypedZObjects().length()-1)));b.set(f.CetModel.ID.RECTANGULAR.HEIGHT,20);b.set(f.CetModel.ID.RECTANGULAR.WIDTH,20);b.set(f.CetModel.ID.HAS_FILL.ALPHA,1);b.set(f.CetModel.ID.HAS_FILL.GRAD_END_ALPHA,1);b.set(f.CetModel.ID.HAS_FILL.GRAD_START_ALPHA,1);b.set(f.CetModel.ID.HAS_FILL.GRAD_START_COLOR,t.Geometry.colorFromRGBInt(0));b.set(f.CetModel.ID.HAS_FILL.GRAD_END_COLOR,
t.Geometry.colorFromRGBInt(0));k.j.setTransformComp(b,t.Geometry.transform2dFromRad({x:-80,y:0},1,0));c=t.Geometry.rectangleFromData({x:0,y:0,width:20,height:20});l.f.setLocalBounds(b,c);k.j.updateLocalBounds(b).setBoundingShape(t.Geometry.obbFromRect(c.getData()));b.set(h.CetRendererModule.getDrawingDimensionsKey(),t.Geometry.rectangleFromData({x:0,y:0,height:20,width:20}));b.setComponent(h.CetRendererModule.getDrawComponentKey(),h.CetRendererModule.createRectangleRenderer());k.j.setGrouping(b,"NotGroup");
k.j.setVisibility(b,!0,1);return b}refresh(){this.i.sm();this.i.update();return this}setMargins(a,b,c,d){this.Ea.getMainStage().setMargins(a,b,c,d,!0);this.Ea.qa.update();return this}focusTo(a,b){this.Ea.getMainStage().focusToId(a,!1,b);this.Ea.getMainStage().forceDraw();return this}render(){this.Ea.getMainStage().markViewChanged();this.Ea.qa.update();this.Ea.getBaseScene().update();return this}commit(){this.i.sm();return this}};var Mc={};Object.defineProperty(Mc,"__esModule",{value:!0});Mc.Xr=class{constructor(a){this.i=
a}getChildrenIds(a,b){return this.Me(a,[b])}Me(a,b){const c=this.i.getEntityById(a);if(null==c)return[];if(b.some((a)=>a===e.TopicChildBehavior.Content)){const b=e.Cet.createHierarchyQuery(this.i);if(a===this.i.getPreziW().getOverview().getEntity().getId())return b.getTopLevelEntities();if(this.Dg(c))return b.getChildrenIds(c)}return this.ou(c,b.map((a)=>this.Nm(a)))}Dg(a){a=a.getWrapper(f.CetModel.ID.Z_OBJECT.W);return a.is(f.CetModel.ID.Z_TOPIC_CONTAINER)&&a.getTopic().is(f.CetModel.ID.PAGE)}getChildrenIdsVisibleOutside(a){return this.Me(a,
[e.TopicChildBehavior.Cover,e.TopicChildBehavior.Visual,e.TopicChildBehavior.Surface])}getChildrenIdsVisibleInside(a){return this.Me(a,[e.TopicChildBehavior.Content,e.TopicChildBehavior.Visual,e.TopicChildBehavior.Surface,e.TopicChildBehavior.Master])}getChildrenIdsVisibleBelow(a){return this.Me(a,[e.TopicChildBehavior.Visual,e.TopicChildBehavior.Master])}getChildrenIdsVisibleOutsideAndInside(a){return this.Me(a,[e.TopicChildBehavior.Visual,e.TopicChildBehavior.Surface])}hasBehavior(a,b){return null==
this.getChildReferer(a)?b===e.TopicChildBehavior.Content:null!=this.getBehaviorReferer(a,b)}getBehavior(a){a=e.Cet.getBehavior(this.i.getEntityById(a));if(a===f.CetModel.ID.COVER)return e.TopicChildBehavior.Cover;if(a===f.CetModel.ID.VISUAL)return e.TopicChildBehavior.Visual;if(a!==f.CetModel.ID.CONTENT){if(a===f.CetModel.ID.SURFACE)return e.TopicChildBehavior.Surface;if(a===f.CetModel.ID.MASTER)return e.TopicChildBehavior.Master}return e.TopicChildBehavior.Content}getBehaviorReferer(a,b){a=this.i.getEntityById(a);
return e.Cet.getReferer(a,this.Nm(b))}getChildReferer(a){a=this.i.getEntityById(a);return e.Cet.getReferer(a)}Nm(a){switch(a){case e.TopicChildBehavior.Cover:return f.CetModel.ID.COVER;case e.TopicChildBehavior.Content:return f.CetModel.ID.CONTENT;case e.TopicChildBehavior.Visual:return f.CetModel.ID.VISUAL;case e.TopicChildBehavior.Surface:return f.CetModel.ID.SURFACE;case e.TopicChildBehavior.Master:return f.CetModel.ID.MASTER;default:x.Utils.assertNever(a)}}isVisibleOutside(a){a=this.getBehavior(a);
switch(a){case e.TopicChildBehavior.Cover:case e.TopicChildBehavior.Visual:case e.TopicChildBehavior.Surface:return!0;case e.TopicChildBehavior.Content:case e.TopicChildBehavior.Master:return!1;default:x.Utils.assertNever(a)}}isVisibleInside(a){a=this.getBehavior(a);switch(a){case e.TopicChildBehavior.Content:case e.TopicChildBehavior.Master:case e.TopicChildBehavior.Visual:case e.TopicChildBehavior.Surface:return!0;case e.TopicChildBehavior.Cover:return!1;default:x.Utils.assertNever(a)}}isVisibleBelow(a){a=
this.getBehavior(a);switch(a){case e.TopicChildBehavior.Content:case e.TopicChildBehavior.Master:return!0;case e.TopicChildBehavior.Visual:case e.TopicChildBehavior.Surface:case e.TopicChildBehavior.Cover:return!1;default:x.Utils.assertNever(a)}}isVisibleOutsideAndInside(a){a=this.getBehavior(a);switch(a){case e.TopicChildBehavior.Visual:case e.TopicChildBehavior.Surface:return!0;case e.TopicChildBehavior.Content:case e.TopicChildBehavior.Master:case e.TopicChildBehavior.Cover:return!1;default:x.Utils.assertNever(a)}}ou(a,
b){a=a.getWrapper(f.CetModel.ID.Z_TOPIC_CONTAINER.W).getTopic();if(null==a)return[];const c=a.getEntity();a=[];if(c.isDef(f.CetModel.ID.HAS_TOPIC_CHILDREN)){var d=c.getComponent(f.CetModel.ID.HAS_TOPIC_CHILDREN.TOPIC_CHILDREN);for(const c of d.items())if(d=this.i.getEntityById(c),null!=d&&d.isDef(f.CetModel.ID.TOPIC_CHILD)){const c=this.i.getEntityById(d.getComponent(f.CetModel.ID.TOPIC_CHILD.BEHAVIOUR).getValue());b.some((a)=>c.isDef(a))&&a.push(d.get(f.CetModel.ID.TOPIC_CHILD.CHILD))}}else if(c.isDef(f.CetModel.ID.HAS_CHILDREN)&&
b.some((a)=>a.isDef(f.CetModel.ID.CONTENT)))for(d of c.getWrapper(f.CetModel.ID.HAS_CHILDREN.W).getChildren().items())a.push(d);return a}};var V={};Object.defineProperty(V,"__esModule",{value:!0});V.xb=class{static get(a){switch(a){case e.AnimationType.PAGE_FADE_IN:return V.xb.xr;case e.AnimationType.PAGE_FADE_OUT:return V.xb.yr;case e.AnimationType.INSTANT:return V.xb.Uq;case e.AnimationType.GENERAL:return V.xb.Oq;default:return{duration:300,delay:150}}}};V.xb.Uq={duration:0,delay:0};V.xb.Oq={duration:300,
delay:250};V.xb.Nx={duration:300,delay:150};V.xb.Ox={duration:300,delay:150};V.xb.xr={duration:200,delay:150};V.xb.yr={duration:200,delay:300};var Ia={};Object.defineProperty(Ia,"__esModule",{value:!0});Ia.fe=class{constructor(a){this.i=a}getWorldBoundsForInteraction(a,b){const c=this.i.getEntityById(a);a=e.Cet.createTopicChildrenQuery(this.i).getChildrenIdsVisibleOutside(a);return this.getUnionWorldBoundsParentAligned(c,a,b)}getWorldBoundsForLayout(a,b){const c=this.i.getEntityById(a),d=e.Cet.createTopicChildrenQuery(this.i).getChildrenIdsVisibleOutsideAndInside(a);
return 1>d.length?this.getWorldBoundsForInteraction(a,b):this.getUnionWorldBoundsParentAligned(c,d,b)}getAnchorWorldBounds(a,b){return this.getWorldBoundsForLayout(a,b)}getLocalBoundsForHittest(a){let b=a.getComponent(h.CetRendererModule.getLocalBoundsComponentKey()).getGraphicsBounds();f.CetModel.textKludge.isEntityText(a)&&!a.getWrapper(f.CetModel.ID.HAS_FONT.W).getDisplayBackground()&&(b=b.inflate(Ia.fe.Vk,Ia.fe.Vk));return b}getUnionWorldBoundsParentAligned(a,b,c){return 1<=b.length?this.getUnionWorldBoundsAlignedToReference(e.Cet.transform(a).getLocalToWorld(),
b,c):this.jn(a,c)}getUnionWorldBoundsAlignedToReference(a,b,c){if(1<b.length){let d=null,e=a.invert();b.forEach((a)=>{a=this.i.getEntityById(a);a=this.jn(a,c).transform(e);d=null==d?a.getBounds():d.union(a.getBounds())});return t.Geometry.obbFromRect(d.getData()).transform(a)}if(1===b.length)return a=this.i.getEntityById(b[0]),e.Cet.world(a).getWorldBoundingShape();throw"cannot calculate bounds of empty set";}jn(a,b=e.TextBoundsOptions.TextBox){if(f.CetModel.textKludge.isEntityText(a)){let c;const d=
a.get(h.CetRendererModule.getZTextBoundsKey());switch(b){case e.TextBoundsOptions.Glyphs:c=d.glyphs;break;case e.TextBoundsOptions.TextBox:c=d.textbox;break;case e.TextBoundsOptions.Visible:c=d.visible;break;case e.TextBoundsOptions.SelectionBox:c=d.selectionbox;break;case e.TextBoundsOptions.ZoomBounds:c=k.j.draw(a).calculateZoomBounds(a);break;default:x.Utils.assertNever(b)}a=e.Cet.transform(a).getLocalToWorld();return t.Geometry.obbFromRect(c.getData()).transform(a)}return e.Cet.world(a).getWorldBoundingShape()}entitiesOutOfBounds(a,
b){const c=e.Cet.createTopicChildrenQuery(this.i),d=b.some((a)=>!c.hasBehavior(a,e.TopicChildBehavior.Cover));var f=this.i.getEntityById(a);const h=e.Cet.world(this.i.getEntityById(a)).getWorldBounds(),k=this.getUnionWorldBoundsParentAligned(f,b).getObb(),l=d?1.25:2;return h.inflateXY(h.getWidthHalf()*(l-1),h.getHeightHalf()*(l-1)).intersects(k)||!d&&(a=e.Cet.createTopicChildrenQuery(this.i).getChildrenIdsVisibleOutside(a).filter((a)=>-1===b.indexOf(a)),0<a.length&&(f=this.getUnionWorldBoundsParentAligned(f,
a).getObb(),f.inflateXY(.25*f.getWidthHalf(),.25*f.getHeightHalf()).intersects(k)))?!1:!0}};Ia.fe.Vk=5;var xb={};Object.defineProperty(xb,"__esModule",{value:!0});xb.cl=class extends Ia.fe{constructor(a,b){super(a);this.camera=b;this.kl=10;this.Ar=this.zr=50}Ws(a,b,c){const d=a.map((a)=>this.i.getEntityById(a));null==c&&(c=d.map((a)=>e.Cet.transform(a).getLocalToWorld()));let g=a=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,k=Number.NEGATIVE_INFINITY;for(let m=0;m<d.length;++m){var l=(b.topic===
e.TopicBoundsOptions.zoomArea&&d[m].isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?e.Cet.world(d[m]).getWorldBounds():this.getWorldBoundsForInteraction(d[m].getId(),b.text)).transform(e.Cet.transform(d[m]).getLocalToWorld().invert().concat(c[m])).getBounds();b.topic===e.TopicBoundsOptions.withPadding&&d[m].isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)&&(l=l.inflate(b.topicPaddingX,b.topicPaddingY));l=l.getData();a=Math.min(a,l.y);g=Math.min(g,l.x);h=Math.max(h,l.x+l.width);k=Math.max(k,l.y+l.height)}b=h-g;c=k-a;
return t.Geometry.obbFromData(g+b/2,a+c/2,b,c,0)}bn(a,b){const c=a.map((a)=>e.Cet.transform(this.i.getEntityById(a)).getLocalToWorld().concat(this.camera.getTransform()));return this.Ws(a,b,c)}Bu(a){return null==a?{text:e.TextBoundsOptions.TextBox,topic:e.TopicBoundsOptions.layout}:{text:null!=a.text?a.text:e.TextBoundsOptions.TextBox,topic:null!=a.topic?a.topic:e.TopicBoundsOptions.layout,topicPaddingX:a.topic===e.TopicBoundsOptions.withPadding?a.topicPaddingX:null,topicPaddingY:a.topic===e.TopicBoundsOptions.withPadding?
a.topicPaddingY:null}}getScreenAABBForEntities(a,b){return this.bn(a,this.Bu(b)).getBounds()}getWorldBBForEntitiesScreenAxisAligned(a,b){return this.bn(a,{topic:e.TopicBoundsOptions.layout,text:b}).transform(this.camera.getTransform().invert())}getMarginCorrectedViewportForEntity(a){var b=this.camera.getMarginCorrectedViewport(),c=this.camera.getTransform().invert();a=t.Geometry.obbFromRect(e.Cet.calculateZoomBounds(this.i,a).getData()).transform(e.Cet.transform(a).getLocalToWorld()).inflateXY(this.Ar*
c.getScale(),this.zr*c.getScale());b=b.inflate(this.kl,this.kl);c=t.Geometry.transform2dFromRad(a.getCenter(),c.getScale(),c.getRotationRad());c=t.Geometry.obbFromRect(b.getData()).transform(c);return a.inflateXY(Math.max(0,c.getWidth()-a.getWidth()),Math.max(0,c.getHeight()-a.getHeight()))}getLogoBoundsInScreen(a,b){var c;a=a.getEntityById(b);a=null===(c=e.Cet.localBounds(a))||void 0===c?void 0:c.getGraphicsBounds();if(null==a)return null;c=-a.getTopLeft().x-.5*a.getWidth();b=a.getTopLeft().y-.5*
a.getHeight();const d=this.camera.getMarginCorrectedViewport();return t.Geometry.obbFromRect({x:d.getBottomLeft().x+c,y:d.getBottomLeft().y-a.getHeight()-b,width:a.getWidth(),height:a.getHeight()})}};var k={};Object.defineProperty(k,"__esModule",{value:!0});k.Jh=class extends Error{constructor(a){super(a);Object.setPrototypeOf(this,k.Jh.prototype)}};k.Cf=class extends Error{constructor(a){super(a);Object.setPrototypeOf(this,k.Cf.prototype)}};k.Xh=class extends Error{constructor(a){super(a);Object.setPrototypeOf(this,
k.Xh.prototype)}};class id extends R.Wa{constructor(a){super();this.kill=a}dispose(){this.kill()}}k.ma=class{constructor(){this.errorOfflineAssetId="###ERROR###";this.DEFAULT_IMAGE_SIZE=this.DEFAULT_THUMBNAIL_SIZE=42;this.pathKludge=new jd;this.ik=this.createOverlayComponentKey("SpinnerOverlay")}createScreenBoundsCalculator(a,b){return new xb.cl(a,b)}createBoundsCalculator(a){return new Ia.fe(a)}createDisposableComponent(a){return new id(a)}createCetApplication(a,b,c,d,e,f){return new ob.Ek(a,c,d,
b,()=>T.VideoModule.createVideo(),null,!0,e,f)}getBehavior(a){a=this.Om(a);return null!=a?a.def:null}Om(a){if(null==a)return null;var b=a.get(f.CetModel.ID.TOPIC_CHILD.CHILD_PARENT);b=null!=b&&0<b.length?b[0]:null;a=a.getEntityList().getEntityById(b);return null==a?null:{def:a.getChild(f.CetModel.ID.TOPIC_CHILD.BEHAVIOUR).getDef(),gx:a}}getReferer(a,b=null){const c=this.Om(a);if(null==c||null!=b&&!c.def.isDef(b))return null;b=c.gx.get(f.CetModel.ENTITY_OWNER_ID());a=a.getEntityList().getEntityById(b);
return null==a?null:a.get(f.CetModel.ENTITY_OWNER_ID())}createHierarchyQuery(a){return new pb.Nk(a)}createTopicChildrenQuery(a){return new Mc.Xr(a)}setupPdomLogging(a){qb.Zk.Kw(a)}createAssetManager(a){return Vc.AssetLoader.createAssetManager(a)}createCetTestHelperBuilder(){return new Pa.Df}world(a){return l.f.world(a)}updateWorld(a){return l.f.world(a)}setWorld(a,b){a.set(f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD,b);h.CetRendererModule.updateWorldProperties(a);return a}visibility(a,b=!1){return l.f.visibility(a,
b)}updateVisibility(a){return l.f.updateVisibility(a)}commentVisibility(a){return l.f.commentVisibility(a)}updateCommentVisibility(a){return l.f.updateCommentVisibility(a)}grouping(a){return l.f.grouping(a)}zOrder(a){return l.f.zOrder(a)}hasZOrder(a){return null!=l.f.zOrder(a)}setZOrderComp(a,b){return l.f.setZOrderComp(a,b)}transform(a){return l.f.transform(a)}getMask_Killme(a){const b=a.getMask();return null==b?t.Geometry.rectangleFromData({x:0,y:0,width:a.getWidth(),height:a.getHeight()}):b}getCurrentPathPositionKey(){null==
k.ma.Zl&&(k.ma.Zl=f.CetModel.createValueComponentKey("current_path_position",!1,!1));return k.ma.Zl}setTransformComp(a,b){k.j.updateTransform(a).setLocalToWorld(b);return a}updateTransform(a){return k.j.xt(a)}Fw(a,b){var c=a.getMutableWrapper(f.CetModel.ID.Z_TOPIC_CONTAINER.W).getMutableTopic().getEntity();c.isDef(f.CetModel.ID.HAS_POSITION)&&(c=c.getMutableWrapper(f.CetModel.ID.HAS_POSITION.W).getMutablePosition().getEntity(),c.isDef(f.CetModel.ID.ABSOLUTE)?c.getMutableWrapper(f.CetModel.ID.ABSOLUTE.W).setLocalToWorld(b):
u.LoggerModule.getLoggerManager().createLogger("cet_static").error({action:"set_topic_position",object:"object",trigger:"machine",payload:{error:"Setting position of automatically calculated topics is not implemented!",Zc:a.getId()}}))}xt(a){return a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?new z.xd({getEntity:()=>a,getId:()=>a.getId(),asMutableEntity:()=>a,getLocalToWorld:()=>h.CetRendererModule.getLocalToWorld(a),getWorldToLocal:()=>h.CetRendererModule.getLocalToWorld(a).invert(),setLocalToWorld:(b)=>
{k.j.Fw(a,b);h.CetRendererModule.updateWorldProperties(a)},toIPdom:()=>null}):new z.xd(a.getMutableWrapper(f.CetModel.ID.TRANSFORMED.W))}draw(a){a=a.getUntypedComponent(h.CetRendererModule.getDrawComponentKey(),!1);return null!=a?a:null}sendEvent(a,b,c){null!=b&&(a=a.getEntityById(b),this.Yj(a,c))}Yj(a,b){var c;null!=a&&(null===(c=e.Cet.draw(a))||void 0===c?void 0:c.onEvent(b))}mutableDraw(a){a=a.getUntypedComponent(h.CetRendererModule.getDrawComponentKey(),!1);return null!=a?a:null}fading(a){return l.f.fading(a)}hasPdomComponent(a){return null!=
a.getComponent(l.f.MODEL)}getPdomCompKey(){return l.f.MODEL}setPdomCompForTest(a,b){a.setComponent(l.f.MODEL,b);return a}image(a){return a.isDef(f.CetModel.ID.IMAGE)?k.j.draw(a):null}video(a){return a.isDef(f.CetModel.ID.Z_VIDEO)?k.j.draw(a):null}createEntityListForTest(){return new Ma.Hf(new L.Rf(new Wa.Sh,"test",null,null,!1),new gb.Sk)}createComponentFactoryForTest(){return new mb.Hk}setFadingComp(a,b){return l.f.setFadingComp(a,b)}setVisibility(a,b,c=1){return l.f.setVisibility(a,b,c)}setFocusBehavior(a,
b){return l.f.setFocusBehavior(a,b)}setGrouping(a,b,c,d){return l.f.setGrouping(a,b,c,d)}setGroupingComp(a,b){return l.f.setGroupingComp(a,b)}toggleDebugFlag(a){return A.da.toggleDebugFlag(a)}getMutableFillComponent(a){return a.getMutableWrapper(f.CetModel.ID.HAS_FILL.W)}setFillComponentWithSolidColor(a,b,c){a.set(f.CetModel.ID.HAS_FILL.FILL_TYPE,f.FillType.Solid);a.set(f.CetModel.ID.HAS_COLOR.COLOR,b);a.set(f.CetModel.ID.HAS_FILL.ALPHA,c);return a}setWorldComp(a,b){return l.f.setWorldComp(a,b)}border(a){return a.getWrapper(f.CetModel.ID.HAS_BORDER.W)}localBounds(a){return h.CetRendererModule.getLocalBoundsComponent(a)}updateLocalBounds(a){return h.CetRendererModule.getMutableLocalBoundsComponent(a)}calculateZoomBounds(a,
b){let c=k.j.draw(b).calculateZoomBounds(b);a=k.j.createHierarchyQuery(a);a.isChapterWithSmartStructure(b.getId())&&(c=a.getTopicLocalZoomBounds_killme(b),c=h.CetRendererModule.addPaddingToBounds(c,b.get(f.CetModel.ID.HAS_PADDING.PADDING)));return c}fill(a){return a.getWrapper(f.CetModel.ID.HAS_FILL.W)}setBorder(a,b,c,d){a.set(f.CetModel.ID.HAS_BORDER.BORDER_THICKNESS,b);null!=c&&a.set(f.CetModel.ID.HAS_BORDER.BORDER_COLOR,c);null!=d&&a.set(f.CetModel.ID.HAS_BORDER.BORDER_ALPHA,d);return a}sortInZOrder(a){return h.CetRendererModule.sortEntitiesInZOrder(a)}shapedText(a){return a.getComponent(l.f.ya).getShapedText()}hasShapedText(a){return a.hasComponent(l.f.ya)}shapedTextVersion(a){return a.hasComponent(l.f.ya)?
a.getComponent(l.f.ya).getVersion():0}setText_Killme(a,b){a.setComponent(l.f.ya,{lp:()=>{},getShapedText:()=>b,getVersion:()=>0,setVersion:()=>{},setOnEntity:()=>{},dispose:()=>{},incrementVersion:()=>{}});return a}setText(a,b,c){let d=a.getMutableComponent(l.f.ya);if(null==d)throw Error("shapedtext component is missing");d.lp(a,b,c);return a}createSceneBuilderForTest(){return new Va.Rh(new Wa.Sh,null,null,null)}Du(){return[...h.CetRendererModule.getBoundsComponentKeys(),h.CetRendererModule.getDrawComponentKey(),
h.CetRendererModule.getIsLoadedComponentKey(),f.CetModel.getNewEntityCompKey(),l.f.ya,h.CetRendererModule.getInEditFontSizeComponentKey(),f.CetModel.ID.Z_SHAPE.SHAPE_TYPE,...f.CetModel.textKludge.getTextComponentKeys(),l.f.Pf,...f.CetModel.ID.HAS_FILL.getFields(),...f.CetModel.ID.STYLED.getFields(),...f.CetModel.ID.HAS_COLOR_FILTER.getFields(),h.CetRendererModule.getTextUnderlineComponentKey(),...f.CetModel.ID.BACKGROUND.getFields(),f.CetModel.ID.BACKGROUND_LAYER.DEPTH,f.CetModel.ID.BACKGROUND_LAYER.FADE_SCALE,
h.CetRendererModule.getDrawingDimensionsKey(),f.CetModel.ID.NEXT_LOGO_V1.BACKGROUND_COLOR,f.CetModel.ID.NEXT_LOGO_V1.BACKGROUND_ALPHA,f.CetModel.ID.HAS_CORNER_RADIUS.CORNER_RADIUS,f.CetModel.ID.HAS_FONT.BACKGROUND_CORNER_RADIUS,l.f.Vh,h.CetRendererModule.getHidePlaceholderAssetKey()]}getComponentKey(a){return a._compkey_}getDrawComponentKey(){return h.CetRendererModule.getDrawComponentKey()}getFadingComponentKey(){return h.CetRendererModule.getFadingComponentKey()}getZOrderComponentKey(){return h.CetRendererModule.getZOrderComponentKey()}getNotCalculatedIntoOverviewCompKey(){null==
k.ma.so&&(k.ma.so=f.CetModel.createValueComponentKey("notCalculatedIntoOverviewKey",!1,!1));return k.ma.so}getDisableSpinnerKey(){null==k.ma.cm&&(k.ma.cm=f.CetModel.createValueComponentKey("disableSpinnerKey",!1,!1));return k.ma.cm}curvedLine(a){return a.getWrapper(f.CetModel.ID.CURVED_LINE.W)}getMutableCurvedLine(a){return a.getMutableWrapper(f.CetModel.ID.CURVED_LINE.W)}hasCurvedLine(a){return a.isDef(f.CetModel.ID.CURVED_LINE)}mediaAsset(a){return a.getWrapper(f.CetModel.ID.MEDIA_ASSET.W)}mutableMediaAsset(a){return a.getMutableWrapper(f.CetModel.ID.MEDIA_ASSET.W)}transformedImage(a){return a.getWrapper(f.CetModel.ID.TRANSFORMED_IMAGE.W)}mutableTransformedImage(a){return a.getMutableWrapper(f.CetModel.ID.TRANSFORMED_IMAGE.W)}curvedLineStartPoint(a){return h.CetRendererModule.CurvedLineCalculation().getStartPoint(a)}curvedLineEndPoint(a){return h.CetRendererModule.CurvedLineCalculation().getEndPoint(a)}isCurvedLineInverse(a){return h.CetRendererModule.CurvedLineCalculation().isInverse(a)}curvedLineOrigin(a){return h.CetRendererModule.CurvedLineCalculation().getOrigin(a)}curvedLineRadius(a){return h.CetRendererModule.CurvedLineCalculation().getRadius(a)}curvedLineStartAngle(a){return h.CetRendererModule.CurvedLineCalculation().getStartAngle(a)}curvedLineEndAngle(a){return h.CetRendererModule.CurvedLineCalculation().getEndAngle(a)}getArrowHeadLength(){return h.CetRendererModule.ArrowCalculation().getHeadLength()}createIdDataEvent(a,
b){return new sc.Wq(a,b)}getAspectRatioClipComponentKey(){return l.f.Bk}getDefComponentKey(){return f.CetModel.DEF()}getDecoratorComponentKey(){return l.f.Kh}getPendingInsertComponentKey(){return l.f.PENDING_INSERT}getSelectionTextRangeComponentKey(){return l.f.Pf}getTextCaretOffsetComponentKey(){return l.f.hl}getTextSelectionFocusedComponentKey(){return l.f.Vh}createSimpleReplaceMergeStrategy(){let a=new Ya.Mh;a.Gh=e.MergeType.REPLACE;a.sh=e.MergeType.REPLACE;a.sg=e.MergeType.REPLACE;a.rg=e.MergeType.REPLACE;
a.qg=e.MergeType.REPLACE;a.bg=e.MergeType.REPLACE;return a}createDiffReplaceMergeStrategy(){let a=new Ya.Mh;a.Gh=e.MergeType.REPLACE_DIFFED;a.sh=e.MergeType.REPLACE_DIFFED;a.sg=e.MergeType.REPLACE_DIFFED;a.rg=e.MergeType.REPLACE_DIFFED;a.qg=e.MergeType.REPLACE_DIFFED;a.bg=e.MergeType.REPLACE_DIFFED;return a}createSimpleKeepMergeStrategy(){let a=new Ya.Mh;a.Gh=e.MergeType.KEEP;a.sh=e.MergeType.KEEP;a.sg=e.MergeType.KEEP;a.rg=e.MergeType.KEEP;a.qg=e.MergeType.KEEP;a.bg=e.MergeType.KEEP;return a}createFastForwardNavigationStrategy(a){return new Fa.je(a)}createSimpleFlyingNavigationStrategy(){return new ab.el}createImmediateNavigationStrategy(){return new vc.Yq}createAutoPlayer(a,
b){return new uc.gq(a,b)}createAutoplaySpeedTestHelper(a,b){return new yb.hq(a,b)}createEntityGroup(a,b){return new rc.Aq(a,b)}getEntityHittestDisabledKey(){return l.f.Qq}getTemporaryEntityHittestDisabledKey(){return l.f.Ur}getAnimationData(a){return V.xb.get(a)}createTransformTween(a,b,c,d,e){return(new W.Hb).createTransformTween(a,b,c,d,e)}createAlphaTween(a,b,c,d,e){return(new W.Hb).createAlphaTween(a,b,c,d,e)}createTextWrapWidthTween(a,b,c,d){return(new W.Hb).createTextWrapWidthTween(a,b,c,d)}createTweenFactory(){return new W.Hb}getShapedTextKey(){return l.f.ya}pathPositionFromStepIndex_killMe(a,
b=0){return new xa.me(a,b)}getStyleClass(a){a=a.getComponent(f.CetModel.ID.STYLED.STYLE_CLASSES);return null!=a&&0<a.length()?a.getAt(0):null}getStyleClassFromEnum(a,...b){return this.matchStyleClassFromEnum(a.getComponent(f.CetModel.ID.STYLED.STYLE_CLASSES).items(),...b)}matchStyleClassFromEnum(a,...b){for(const c of a)if(a=this.Xm(c,b),null!=a)return a;return null}setStyleClass(a,b){let c=a.getMutableWrapper(f.CetModel.ID.STYLED.W).getMutableStyleClasses();for(;0<c.length();)c.removeAt(0);null!=
b&&c.add(b);this.Ro(a.getEntityList().getScene(),[a.getId()])}setStyleClassFromEnum(a,b,...c){let d=a.getMutableWrapper(f.CetModel.ID.STYLED.W).getMutableStyleClasses();for(let a=0;a<d.length();)null!=this.Xm(d.getAt(a),c)?d.removeAt(a):a++;null!=b&&d.add(b);this.Ro(a.getEntityList().getScene(),[a.getId()])}Xm(a,b){for(const c of b)for(const b in c)if(c.hasOwnProperty(b)&&a===c[b])return c[b];return null}Ro(a,b){const c=a.getPreziW().getMutableDocumentStyle().getMutableStyleDeclarations();a=this.au(a,
b);for(b=a.length-1;0<=b;b--)c.removeAt(a[b])}au(a,b){let c=0;const d=[];a.getPreziW().getMutableDocumentStyle().getMutableStyleDeclarations().forEachMutable((a)=>{a=a.getStyleSelector().toString();0===a.indexOf("#")&&(null!=b?-1!==b.indexOf(a.substr(1))&&d.push(c):d.push(c));c++});return d}fixIPrezi(a,b){return f.CetModel.createPreziFixer(b).fixIPrezi(a)}cetSessionFactoryInternal(a){return new Jc.nq(f.CetModel.createPreziFixer(f.getDocumentGenerationFromFeatureSwitches()),a,new Bc.mq)}createEditorPath(a){return new ia.zq(a)}createPlaybackPath(a){return new ia.al(a)}getPathVisibilityKey(){null==
k.ma.zo&&(k.ma.zo=f.CetModel.createValueComponentKey("path-visibility",!1,!1));return k.ma.zo}Lm(){null==k.ma.Al&&(k.ma.Al=f.CetModel.createValueComponentKey("audio-buffer",!1,!1,!0));return k.ma.Al}getAssetThumbnailKey(){null==k.ma.yl&&(k.ma.yl=f.CetModel.createValueComponentKey("asset-thumbnail",!1,!1,!0));return k.ma.yl}calcOverviewBoundsData(a,b){const c=a.getPreziW().getOverview().getEntity();var d=[];if(b)d=e.Cet.createHierarchyQuery(a).getReachableEntities(c.getId()).map((b)=>a.getEntityById(b));
else for(let b of a.getPreziW().getZObjects())d.push(b.getEntity());let g=null;d.forEach((a)=>{if(a.getId()!==c.getId()){var d=a.getChild(f.CetModel.ID.Z_TOPIC_CONTAINER.TOPIC);null!=d&&(d.isDef(f.CetModel.ID.PLANET_CHAPTER)||b&&d.isDef(f.CetModel.ID.STACK_CHAPTER))||a.get(e.Cet.getNotCalculatedIntoOverviewCompKey())||a.get(f.CetModel.ID.CONNECTOR.DEGENERATE_INVISIBLE)||null==k.j.world(a)||(a=this.getAxisAlignedWorldRectangle(a,b),null!=a&&(d=a.getData(),isNaN(d.height)||isNaN(d.width)||isNaN(d.x)||
isNaN(d.y)||(null!=g&&null!=a?g=g.union(a):null==g&&(g=a))))}});d=this.Wu(a,c,g);return{documentWorldAABB:g,documentWithMinimumSizeAABB:d,localToWorld:this.calcOverviewLocalToWorld(c,d)}}calcOverviewLocalToWorld(a,b){a=h.CetRendererModule.getLocalBoundsComponent(a);a=b.getWidth()/a.getGraphicsBounds().getWidth()<b.getHeight()/a.getGraphicsBounds().getHeight()?b.getHeight()/a.getGraphicsBounds().getHeight():b.getWidth()/a.getGraphicsBounds().getWidth();b={x:b.getCenter().x,y:b.getCenter().y};return t.Geometry.transform2dFromDeg(b,
a,0)}getAxisAlignedWorldRectangle(a,b){var c;return b&&f.CetModel.textKludge.isEntityText(a)?(b=a.get(h.CetRendererModule.getZTextBoundsKey()).visible,a=e.Cet.transform(a).getLocalToWorld(),b.transformAABB(t.Geometry.createFromTransform(a))):null===(c=e.Cet.world(a))||void 0===c?void 0:c.getWorldAxisAlignedBounds()}Wu(a,b,c){let d=b.get(f.CetModel.ID.OVERVIEW.MINIMUM_SCALE);if(null!=d)return a=k.j.localBounds(b).getGraphicsBounds().transformAABB(t.Geometry.createFromTransform(d)),null!=c?c.union(a):
a;if(null!=c)return c;c=e.Cet.parseAspectRatio(a.getPreziW().getAspectRatio());return t.Geometry.rectangleFromData({x:-c.width/2,y:-c.height/2,width:c.width,height:c.height})}getTargetTransformForBounds(a,b,c){a=a.getData();c=c.getData();var d=t.Geometry.createFromTransform(b);b=t.Geometry.createFromTransform(t.Geometry.transform2dFromRad({x:a.x+a.width/2,y:a.y+a.height/2},1,0));b.concat(d);d=a.width/c.width;a=a.height/c.height;if(0===d||0===a)a=d=1;b.invert();b.scale(1/Math.max(d,a));return b.toTransform()}getTargetTransform(a,
b,c){b=a.getEntityById(b);if(null==b)return null;a=k.j.calculateZoomBounds(a,b);return k.j.getTargetTransformForBounds(a,k.j.transform(b).getLocalToWorld(),c)}Ui(a,b,c,d,f){b=a.getEntityById(b);return H.isActive("js-no-rotation-zoom")&&!this.us(b,a)&&f===e.CameraNavigationTrigger.free?(a=(new xb.cl(a,d)).getWorldBBForEntitiesScreenAxisAligned([b.getId()],e.TextBoundsOptions.ZoomBounds),d=a.getBounds(),f=t.Geometry.rectangleFromData({x:-d.getWidth()/2,y:-d.getHeight()/2,width:d.getWidth(),height:d.getHeight()}),
k.j.getTargetTransformForBounds(f,t.Geometry.transform2dFromRad(d.getCenter(),1,a.getObb().getRotationRadians()),c)):k.j.getTargetTransform(a,b.getId(),c)}us(a,b){return(new pb.Nk(b)).isZTopicContainer(a.getId())||a.isDef(f.CetModel.ID.Z_ZOOM_AREA)||a.isDef(f.CetModel.ID.Z_VIDEO)||a.getId()===b.getPreziW().getOverview().getId()}getViewportWorldIfFocusedOnEntity(a,b,c){a=k.j.getTargetTransform(b,a.getId(),c.getViewport());return t.Geometry.obbFromRect(c.getViewport().getData()).transform(a.invert())}createOverlayComponentKey(a){return N.Ia.createOverlayComponentKey(a,
!0)}createOverlayComponent(a,b){return N.Ia.createOverlayComponent(a,b)}getLegacyOverlayComponentKey(){return N.Ia.getLegacyOverlayComponentKey()}cleanupTransformation(a){null!=a&&(a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?(a=a.getMutableWrapper(f.CetModel.ID.Z_TOPIC_CONTAINER.W).getMutableTopic().getEntity(),a.discardOwnComponent(f.CetModel.ID.HAS_POSITION.POSITION),a=a.getMutableWrapper(f.CetModel.ID.HAS_POSITION.W).getMutablePosition(),null!=a&&a.getEntity().discardOwnComponent(f.CetModel.ID.ABSOLUTE.LOCAL_TO_WORLD)):
a.discardOwnComponent(f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD))}Hu(a){return null==a?0:a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?(a=a.getWrapper(f.CetModel.ID.Z_TOPIC_CONTAINER.W).getTopic().getEntity().getWrapper(f.CetModel.ID.HAS_POSITION.W).getPosition(),null!=a?a.getEntity().getComponent(f.CetModel.ID.ABSOLUTE.LOCAL_TO_WORLD).getVersion():0):a.getComponent(f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD).getVersion()}isSystemInit(a){return"init"in a}isInflator(a){return"initializeEntities"in a}hasIndirectTriggerConfig(a){return"getRequiredKeysForIndirectTrigger"in
a}createCoeditOfflineOnlineSwitchHandler(a,b){return x.Utils.ActorSystem().startSyncActor("CoeditOfflineOnlineSwitchHandler",Kc.pq,{startedInOffline:a,isPresenting:b})}createDummyCoeditOfflineOnlineSwitchHandler(){const a={actionsWired(){},desktopNetworkOnlineStatusUpdate(){},coeditInitialConnectionFailure(){},coeditFinishedAndWaitingForGoOnline(){},coeditReconnected(){},mediaAssetSyncSuccess(){},mediaAssetSyncNonRetryableFailure(){},mediaAssetSyncRetryableFailure(){},cetSyncFinished(){},connectionLost(){},
editorModeChanged(){}};return{get currentBehaviourName(){return"dummyState"},tell(){return a}}}createImagePatcher(a){return new Oa.If(a)}createPdfPatcher(a){return new yc.Er(a)}createVideoPatcher(a){return new zc.$r(a)}createChartPatcher(a){return new xc.oq(a)}createAudioPatcher(a){return new wc.cq(a)}getErrorInfo(a){return{get isCannotStartTransactionError(){return a instanceof k.Jh},get isCannotFinishTransactionError(){return a instanceof k.Cf},get isTransactionNotInProgressError(){return a instanceof
k.Xh}}}getEditorApiLogger(){null==k.ma.jm&&(k.ma.jm=new qc.yq);return k.ma.jm}parseAspectRatio(a){return f.CetModel.parseAspectRatio(a)}createPreziDOMStatCollector(a){return new Ac.Gr(a)}getZTextFixer(a){let b=a;for(;null!=b;){for(const c of b.vg())if(c instanceof M.$h)return c.getZTextFixer(a);b=b.getParentScene()}return null}addSpinner(a,b){null!=b&&Ga.qe.qs(b,a)}removeSpinner(a){null!=a&&Ga.qe.dw(a)}createTestIdGenerator(a){const b=m.DOM.createSeededIdGenerator(a);let c=0;return{generateId:()=>
{const a=b.generateId(),e=`${c}_`;c++;return`${e}${a.substring(e.length)}`}}}selectBestMatchingFontFace(a,b){let c=0,d=null;for(let e of b)if(b=e.fontStyle===a.fontStyle&&e.fontWeight===a.fontWeight?4:e.fontStyle===f.FontStyle.Normal&&e.fontWeight===e.fontWeight?3:e.fontStyle===a.fontStyle&&e.fontWeight===f.FontWeight.Normal?2:e.fontStyle===f.FontStyle.Normal&&e.fontWeight===f.FontWeight.Normal?1:0,b>c&&(d=e,c=b),4===c)break;return d}};class jd{assertEditorPathV2(a){var b;a=a.getEditorPath();x.Utils.assert(0<
(null===(b=m.DOM.RuntimeTypeInfo().safeCastToEditorPathV2(a))||void 0===b?void 0:b.getSteps().length()),"editorpathV2 expected")}getEditorPathComponent(a){a=a.getPreziW();this.assertEditorPathV2(a);return a.getEditorPath().getEntity().getComponent(f.CetModel.ID.EDITOR_PATH_V2.STEPS)}getEditorPathStepWList(a){a=a.getPreziW();this.assertEditorPathV2(a);return[...a.getEditorPath().getSteps()]}getIEditorPathStepsFromIPrezi(a){this.assertEditorPathV2(a);return[...f.CetModel.pdomIterable(a.getEditorPath().getSteps())]}getISomeEditorPathActionW(a){return(null===
a||void 0===a?0:a.isDef(f.CetModel.ID.EDITOR_PATH_ACTION))?a.getWrapper(f.CetModel.ID.EDITOR_PATH_ACTION.W):null}getISomeEditorPathStepW(a){return(null===a||void 0===a?0:a.isDef(f.CetModel.ID.EDITOR_PATH_STEP))?a.getWrapper(f.CetModel.ID.EDITOR_PATH_STEP.W):null}}k.j=new k.ma;var e={};Object.defineProperty(e,"__esModule",{value:!0});(function(a){a[a.Visible=0]="Visible";a[a.TextBox=1]="TextBox";a[a.Glyphs=2]="Glyphs";a[a.SelectionBox=3]="SelectionBox";a[a.ZoomBounds=4]="ZoomBounds"})(e.TextBoundsOptions||
(e.TextBoundsOptions={}));(function(a){a[a.layout=0]="layout";a[a.zoomArea=1]="zoomArea";a[a.withPadding=2]="withPadding"})(e.TopicBoundsOptions||(e.TopicBoundsOptions={}));(function(a){a[a.Local=0]="Local";a[a.Remote=1]="Remote"})(e.EditKind||(e.EditKind={}));(function(a){a[a.InitialConnectionFailure=0]="InitialConnectionFailure";a[a.AccessDeniedError=1]="AccessDeniedError";a[a.MultiUserLockError=2]="MultiUserLockError";a[a.TransportError=3]="TransportError";a[a.ConnectionLost=4]="ConnectionLost";
a[a.Reconnected=5]="Reconnected";a[a.HardResetedPreziIsAvailable=6]="HardResetedPreziIsAvailable";a[a.RoomInfoChanged=7]="RoomInfoChanged";a[a.RequestSync=8]="RequestSync";a[a.RemoteChangesAvailable=9]="RemoteChangesAvailable";a[a.RoomKeyValueStoreChanged=10]="RoomKeyValueStoreChanged";a[a.PeerKeyValueStoreChanged=11]="PeerKeyValueStoreChanged";a[a.KeyValueStoresReset=12]="KeyValueStoresReset";a[a.Finished=13]="Finished";a[a.IllegalStateError=14]="IllegalStateError";a[a.SessionReady=15]="SessionReady";
a[a.InvalidDocumentStateError=16]="InvalidDocumentStateError";a[a.OfflineTimerTriggered=17]="OfflineTimerTriggered";a[a.ReconnectingFromFinished=18]="ReconnectingFromFinished";a[a.ResetUndoRedo=19]="ResetUndoRedo"})(e.CetNetworkEventType||(e.CetNetworkEventType={}));(function(a){a.success="success";a.creationLimitReached="creationLimitReached";a.generalFailure="generalFailure"})(e.CetPreziCreatorResultKind||(e.CetPreziCreatorResultKind={}));(function(a){a[a.StyleSheet=0]="StyleSheet";a[a.Entity=1]=
"Entity";a[a.EntitiesModified=2]="EntitiesModified";a[a.Document=3]="Document"})(e.ChangeEventKind||(e.ChangeEventKind={}));(function(a){a.RENDER_ZOOMED_OUT_TO_SHOW_SURROUNDINGS=1;a.USE_PARTITION_RENDERER=2;a.DRAW_PARTITION_BORDERS=3;a.RENDER_PARTITIONS_ON_DEMAND=4;a.SHOW_OBJECT_IDS=5;a.QUADTREE_BOUNDS=7;a.CAMERA_AREA=8;a.CHECK_INVARIANTS=10})(e.DebugFlag||(e.DebugFlag={}));(function(a){a[a.ToId=0]="ToId";a[a.ToRectangle=1]="ToRectangle";a[a.ToOverview=2]="ToOverview"})(e.NavigationActionTargetType||
(e.NavigationActionTargetType={}));(function(a){a[a.Focus=0]="Focus";a[a.Fly=1]="Fly";a[a.FadeIn=2]="FadeIn";a[a.FadeOut=3]="FadeOut";a[a.Snap=4]="Snap";a[a.Slide=5]="Slide"})(e.NavigationActionAnimationType||(e.NavigationActionAnimationType={}));(function(a){a[a.Start=0]="Start";a[a.End=1]="End";a[a.Cancel=2]="Cancel"})(e.NavigationActionAnimationPhase||(e.NavigationActionAnimationPhase={}));(function(a){a.path="path";a.free="free"})(e.CameraNavigationTrigger||(e.CameraNavigationTrigger={}));(function(a){a[a.ANIMATE_ONLY_CURRENT=
0]="ANIMATE_ONLY_CURRENT";a[a.NEVER_ANIMATE=1]="NEVER_ANIMATE"})(e.StageTweenMode||(e.StageTweenMode={}));(function(a){a[a.NONE=0]="NONE";a[a.FLY=1]="FLY";a[a.SNAP_IN=2]="SNAP_IN";a[a.SNAP_OUT=3]="SNAP_OUT";a[a.FOCUS=4]="FOCUS"})(e.CameraNavigationType||(e.CameraNavigationType={}));(function(a){a[a.None=0]="None";a[a.Pan=1]="Pan";a[a.Zoom=2]="Zoom";a[a.Fly=3]="Fly"})(e.CameraTransitionType||(e.CameraTransitionType={}));(function(a){a[a.ZOOM_IN=0]="ZOOM_IN";a[a.ZOOM_OUT=1]="ZOOM_OUT"})(e.ZoomingDirection||
(e.ZoomingDirection={}));(function(a){a[a.NoZoom=0]="NoZoom";a[a.ZoomIn=1]="ZoomIn";a[a.ZoomOut=2]="ZoomOut"})(e.ZoomingEvent||(e.ZoomingEvent={}));(function(a){a[a.WithinLimits=0]="WithinLimits";a[a.ZoomInLimitReached=1]="ZoomInLimitReached";a[a.ZoomOutLimitReached=2]="ZoomOutLimitReached"})(e.ZoomingLimit||(e.ZoomingLimit={}));(function(a){a[a.PanningStarted=0]="PanningStarted";a[a.PanningFinished=1]="PanningFinished"})(e.PanningEvent||(e.PanningEvent={}));(function(a){a[a.TransitionStarted=0]=
"TransitionStarted";a[a.TransitionFinished=1]="TransitionFinished"})(e.TransitionEvent||(e.TransitionEvent={}));(function(a){a[a.EndTransaction=0]="EndTransaction";a[a.BeginOtherTransaction=1]="BeginOtherTransaction";a[a.AbortTransaction=2]="AbortTransaction";a[a.RollbackTransaction=3]="RollbackTransaction"})(e.FinishEventKind||(e.FinishEventKind={}));(function(a){a[a.KEEP=0]="KEEP";a[a.REPLACE=1]="REPLACE";a[a.REPLACE_DIFFED=2]="REPLACE_DIFFED";a[a.REPLACE_DIFFED_CUSTOM=3]="REPLACE_DIFFED_CUSTOM"})(e.MergeType||
(e.MergeType={}));(function(a){a[a.UPDATE=0]="UPDATE";a[a.PRE_RENDER=1]="PRE_RENDER";a[a.UPDATE_ONCE=2]="UPDATE_ONCE";a[a.FIXER=3]="FIXER";a[a.TWEEN=4]="TWEEN";a[a.GEOMETRY=5]="GEOMETRY";a[a.DOCUMENT=6]="DOCUMENT"})(e.UpdatePhase||(e.UpdatePhase={}));(function(a){a.next="next";a.prev="prev";a["goto"]="goto"})(e.NavigationIntent||(e.NavigationIntent={}));(function(a){a[a.NEW_TRANSITION=0]="NEW_TRANSITION";a[a.JUMP=1]="JUMP";a[a.ACCELERATE=2]="ACCELERATE";a[a.ACCELERATE_2=3]="ACCELERATE_2";a[a.INVERSE_ACCELERATE=
4]="INVERSE_ACCELERATE";a[a.INVERSE_ACCELERATE_2=5]="INVERSE_ACCELERATE_2"})(e.NavigationMode||(e.NavigationMode={}));(function(a){a[a.NEW_TARGET=0]="NEW_TARGET";a[a.CONTINUE=1]="CONTINUE";a[a.TURN_BACK=2]="TURN_BACK"})(e.NavigationChange||(e.NavigationChange={}));(function(a){a[a.START=0]="START";a[a.STOP=1]="STOP";a[a.WAIT=2]="WAIT";a[a.RESTART=3]="RESTART";a[a.NEXT=4]="NEXT"})(e.AutoPlayEventType||(e.AutoPlayEventType={}));(function(a){a[a.NONE=0]="NONE";a[a.OWN_VISUAL=1]="OWN_VISUAL";a[a.ALL_VISUALS=
2]="ALL_VISUALS";a[a.ALL_VISUALS_AND_BACKGROUND=3]="ALL_VISUALS_AND_BACKGROUND"})(e.VisualBackgroundReachLevel||(e.VisualBackgroundReachLevel={}));(function(a){a.Cover="cover";a.Content="content";a.Visual="visual";a.Surface="surface";a.Master="master"})(e.TopicChildBehavior||(e.TopicChildBehavior={}));(function(a){a[a.IMMEDIATE=0]="IMMEDIATE";a[a.ANIMATION=1]="ANIMATION"})(e.TweenMode||(e.TweenMode={}));(function(a){a[a.INSTANT=0]="INSTANT";a[a.GENERAL=1]="GENERAL";a[a.OVERVIEW_FADE_IN=2]="OVERVIEW_FADE_IN";
a[a.OVERVIEW_FADE_OUT=3]="OVERVIEW_FADE_OUT";a[a.PAGE_FADE_IN=4]="PAGE_FADE_IN";a[a.PAGE_FADE_OUT=5]="PAGE_FADE_OUT";a[a.COVER_ITEM_FADE_OUT=6]="COVER_ITEM_FADE_OUT";a[a.CONTENT_FADE_IN=7]="CONTENT_FADE_IN";a[a.CONTENT_FADE_OUT=8]="CONTENT_FADE_OUT";a[a.SUBTOPIC_FADE_IN=9]="SUBTOPIC_FADE_IN";a[a.SIBLING_FADE_OUT=10]="SIBLING_FADE_OUT"})(e.AnimationType||(e.AnimationType={}));(function(a){a.SHAPE="shape";a.IMAGE="image";a.PDF="pdf";a.TEXT="text";a.LINE="line";a.ARROW="arrow"})(e.PreziDOMStatElementType||
(e.PreziDOMStatElementType={}));e.Cet=k.j;return Tc=e});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_cet",["require","prezi.engine.dom","prezi.engine.dom.converter.xpdom2","prezi.geometry","prezi_bacon","prezi_cet_model","prezi_cet_renderer","prezi_externalserviceprovider","prezi_featureswitcher","prezi_logger","prezi_nativeapitypes","prezi_service_assetloader","prezi_service_data","prezi_service_fontcatalogue","prezi_service_media","prezi_textmodel","prezi_utils","prezi_video"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_cet.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi.engine.dom"),require("prezi.engine.dom.converter.xpdom2"),require("prezi.geometry"),require("prezi_bacon"),require("prezi_cet_model"),require("prezi_cet_renderer"),require("prezi_externalserviceprovider"),require("prezi_featureswitcher"),require("prezi_logger"),require("prezi_nativeapitypes"),require("prezi_service_assetloader"),require("prezi_service_data"),require("prezi_service_fontcatalogue"),require("prezi_service_media"),require("prezi_textmodel"),require("prezi_utils"),require("prezi_video"));}else{this["prezi_cet"]=__factory(this["prezi.engine.dom"],this["prezi.engine.dom.converter.xpdom2"],this["prezi.geometry"],this["prezi_bacon"],this["prezi_cet_model"],this["prezi_cet_renderer"],this["prezi_externalserviceprovider"],this["prezi_featureswitcher"],this["prezi_logger"],this["prezi_nativeapitypes"],this["prezi_service_assetloader"],this["prezi_service_data"],this["prezi_service_fontcatalogue"],this["prezi_service_media"],this["prezi_textmodel"],this["prezi_utils"],this["prezi_video"]);}}).call(this);