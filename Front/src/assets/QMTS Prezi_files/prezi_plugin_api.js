;(function(){var baseUrl;var __factory=function(){var React=arguments[0];var ReactDOM=arguments[1];var ReactTransitionGroup=arguments[2];var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_plugin_api";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi.geometry":dependencies[3],"prezi_app_utils":dependencies[4],"prezi_bacon":dependencies[5],"prezi_cet":dependencies[6],"prezi_cet_model":dependencies[7],"prezi_cet_model_editor":dependencies[8],"prezi_cet_renderer":dependencies[9],"prezi_editor_error":dependencies[10],"prezi_editor_store_common":dependencies[11],"prezi_editor_store_mode":dependencies[12],"prezi_editor_store_object":dependencies[13],"prezi_editor_store_ui":dependencies[14],"prezi_featureswitcher":dependencies[15],"prezi_i18n":dependencies[16],"prezi_logger":dependencies[17],"prezi_nativeapitypes":dependencies[18],"prezi_ppt_service":dependencies[19],"prezi_service_data":dependencies[20],"prezi_service_fontcatalogue":dependencies[21],"prezi_sound_playback":dependencies[22],"prezi_spotlight":dependencies[23],"prezi_uaparser":dependencies[24],"prezi_utils":dependencies[25],"prezi_widgets":dependencies[26]}};})(),React,ReactDOM,ReactTransitionGroup);};})(arguments);var moduleImpl=(function(){return module(function(z,k,wa,Za){function xa(a,b,d,f,h){return null!=a?(c)=>{b.callWithUAT((b)=>a(b,{shiftKey:c.shiftKey}));d.closePopup(f,h);c.stopPropagation()}:null}function oa(a,b,d){const f=ba;return(h)=>{if(!a||f!==ba)return h(b());const c=d();try{return h(c)}finally{c.kill()}}}function D(a){var b;return null==a?null:"url"in a?(a=a.url,null===a||void 0===a?void 0:a.substring(Math.max(0,a.length-32),a.length)):"aspectRatio"in a?null:null===(b=a.canvas)||void 0===b?void 0:b.id}function ya(a){var b;
return{id:a.id,enabled:null!==(b=a.enabled)&&void 0!==b?b:!0,icon:a.icon,title:a.title}}function C(a,b,d){return a?null==d||""===d?b:`${b} ${d}`:null}function Q(a){return null!=a?a:()=>{}}var A=z.dependencies.prezi_app_utils,K=z.dependencies.prezi_bacon,q=z.dependencies.prezi_cet,za=z.dependencies.prezi_cet_model,p=z.dependencies.prezi_cet_model_editor,Aa=z.dependencies.prezi_editor_error,H=z.dependencies.prezi_editor_store_mode,M=z.dependencies.prezi_editor_store_object,x=z.dependencies.prezi_editor_store_ui,
R=z.dependencies.prezi_featureswitcher,pa=z.dependencies.prezi_i18n,E=z.dependencies.prezi_logger,ca=z.dependencies.prezi_nativeapitypes,Ba=z.dependencies.prezi_service_data,U=z.dependencies.prezi_uaparser,e=z.dependencies.prezi_widgets,Ca=z.dependencies.prezi_sound_playback,r=z.dependencies.prezi_utils,V={};Object.defineProperty(V,"__esModule",{value:!0});V.AudioController=class{initialize(a,b,d){null!=this.currentPlayer&&this.currentPlayer.getBuffer()!==a&&this.stop(this.currentPlayer.getBuffer());
this.currentPlayer=Ca.SoundPlaybackModule.createAudioPlayer(this,a,!1);this.currentPlayer.initialize(1,b);this.onCurrentPlayerStop=d}stop(a){null!=this.currentPlayer&&this.currentPlayer.getBuffer()===a&&(this.currentPlayer.stop(),this.onCurrentPlayerStop())}pause(a){null!=this.currentPlayer&&this.currentPlayer.getBuffer()===a&&this.currentPlayer.pause()}play(a){null!=this.currentPlayer&&this.currentPlayer.getBuffer()===a&&this.currentPlayer.play()}seek(a,b){null!=this.currentPlayer&&this.currentPlayer.getBuffer()===
a&&this.currentPlayer.seek(b)}getAudioContext(){return r.AudioUtils.getAudioContext()}};var u={wrapIntoKillable:function(a){return new Proxy(a,new u.KillableProxyHandler)},asKillable:function(a,b){a=(0,u.wrapIntoKillable)(a);try{return b(a)}finally{a.kill()}}};Object.defineProperty(u,"__esModule",{value:!0});u.KillableProxyHandler=class{constructor(){this.killed=!1}get(a,b){if("isKillableNotKilled"===b)return()=>!this.killed;if(this.killed)throw new u.IllegalStateException("Object already killed");
if("kill"===b)return()=>{"kill"in a&&"function"===typeof a.kill&&a.kill();this.killed=!0};b=a[b];return"function"===typeof b?b.bind(a):b}set(a,b,d){if(this.killed)throw new u.IllegalStateException("Object already killed");a[b]=d;return!0}};u.IllegalStateException=class extends Error{constructor(a){super(a);Object.setPrototypeOf(this,u.IllegalStateException.prototype)}};var g={mapActionsToMenuItemUIDescription:function(a,b,d){return null!=a&&0<a.length?a.map((a,h)=>a===e.DropdownMenuSeparatorConst?
{createReactElement:(a)=>k.createElement(e.DropdownMenuSeparator,{key:`${a.popupIds[a.popupIds.length-1]}-separator-${a.key}`})}:"content"in a?{createReactElement:(b)=>k.createElement(e.DropdownMenuSectionHeader,{key:`${b.popupIds[b.popupIds.length-1]}-header-${b.key}`,content:a.content,bottomPadding:a.bottomPadding})}:{action:a,createReactElement:(f)=>{const c=`${f.popupIds[f.popupIds.length-1]}`;return k.createElement(e.DropdownMenuItem,{id:`${c}-${a.id}`,key:h,onClick:xa((b)=>a.onClick(b),b,d,
c,f.parentIds),enabled:a.enabled,icon:a.icon,title:a.title})}}):null},concatUrlParts:function(a){return a.map((a)=>`${a}/`).join("")},selectionToTransformedSelection:function(a,b){return{allObjects:b.allEntityIds.map((b)=>a.lookup.base(b)).filter(da(p.base.ObjectKind.transformedObject)),groups:b.groupIds.map((b)=>a.lookup.base(b)).filter(da(p.base.ObjectKind.group)),nonGroupedObjects:b.nonGroupedEntityIds.map((b)=>a.lookup.base(b)).filter(da(p.base.ObjectKind.transformedObject))}},selectionToReadonlyTransformedSelection:function(a,
b){return{allObjects:b.allEntityIds.map((b)=>a.lookup.base(b)).filter(ea(p.base.ObjectKind.transformedObject)),groups:b.groupIds.map((b)=>a.lookup.base(b)).filter(ea(p.base.ObjectKind.group)),nonGroupedObjects:b.nonGroupedEntityIds.map((b)=>a.lookup.base(b)).filter(ea(p.base.ObjectKind.transformedObject))}},selectionToTransformedSelectionChange:function(a,b){a=(0,g.selectionToReadonlyTransformedSelection)(a,b);return{allObjects:a.allObjects.map((a)=>a.ref),groups:a.groups.map((a)=>a.ref),nonGroupedObjects:a.nonGroupedObjects.map((a)=>
a.ref)}},createItemContainers:function(a,b,d){var f;return null===(f=null===a||void 0===a?void 0:a.filter((a)=>null!=a))||void 0===f?void 0:f.map((a,f)=>(0,g.wrapIntoItemContainer)(f,a.props,a.createItemElement({parentIds:null,popupIds:b,currentScrollIntoViewIds:d})))},wrapIntoItemContainer:function(a,b,d){return k.createElement(e.ItemContainer,Object.assign({},b,{key:a}),d)},mapToCreateReactElement:function(a){return null===a||void 0===a?void 0:a.map((a)=>({createReactElement:(b)=>(0,g.wrapIntoItemContainer)(b.key,
a.props,a.createItemElement({currentScrollIntoViewIds:b.currentScrollIntoViewIds,parentIds:b.parentIds,popupIds:b.popupIds}))}))},isATValid:function(a){return a instanceof W&&a.valid||a instanceof qa&&a.isValid()},checkAT:function(a){if(!(0,g.isATValid)(a))throw Error("UserActionToken is expired");},invalidateAsyncUserActionTokensI:function(){ba++},createCallWithAat:function(a){return oa(a instanceof W&&a.valid,()=>({___ASYNC_ACTION_TOKEN___:void 0,isValid:()=>!1}),()=>new qa)},createCallWithMat:function(a){return oa(a instanceof
g.UserActionTokenImpl&&a.valid,()=>({___MESSAGE_ACTION_TOKEN___:void 0,isValid:()=>!1}),()=>new Da)},createUatForTestI:function(){return new g.UserActionTokenImpl},getPopupId:function(a){return a+"-popup"},convertButtonSize:function(a){return a===c.ButtonSize.Small?e.ExtendedButtonSize.Small:e.ExtendedButtonSize.Large},convertButtonColor:function(a){switch(a){case c.ButtonColor.Gray:return e.ExtendedButtonColor.Gray;case c.ButtonColor.Ghost:return e.ExtendedButtonColor.Ghost;case c.ButtonColor.Green:return e.ExtendedButtonColor.Green;
case c.ButtonColor.Gold:return e.ExtendedButtonColor.Gold;case c.ButtonColor.Red:return e.ExtendedButtonColor.Red;case c.ButtonColor.Blue:return e.ExtendedButtonColor.Blue;default:r.Utils.assertNever(a,`Unknown color: ${a}`)}}},Ea=this&&g.__awaiter||function(a,b,d,f){function h(a){return a instanceof d?a:new d(function(b){b(a)})}return new (d||(d=Promise))(function(d,c){function n(a){try{m(f.next(a))}catch(t){c(t)}}function e(a){try{m(f["throw"](a))}catch(t){c(t)}}function m(a){a.done?d(a.value):
h(a.value).then(n,e)}m((f=f.apply(a,b||[])).next())})};Object.defineProperty(g,"__esModule",{value:!0});var da=p.base.editorIs,ea=p.base.readerIs;let ba=0;class W{constructor(){this.valid=!0}doAsync(a,b){return Ea(this,void 0,void 0,function*(){const d=(0,g.createCallWithAat)(this),f=yield a;return d((a)=>b(a,f))})}kill(){this.valid=!1}}g.UserActionTokenImpl=class extends W{};class Da extends W{isValid(){return this.valid}}class qa{constructor(){this.valid=!0}isValid(){return this.valid}kill(){this.valid=
!1}}g.CallHandler=class{constructor(a){this.errorHandler=a}callWithUAT(a,b){return this.call(()=>{const b=new g.UserActionTokenImpl;try{return a(b)}finally{b.kill()}},b)}call(a,b){try{return a()}catch(d){return this.errorHandler(d),b}}};g.MaybeImpl=class{constructor(){this.hasValue=()=>!1}setValue(a){this.hasValue=()=>!0;this.value=a}};g.Memo=class extends k.Component{access(a){return a.reduce((a,d)=>a[d],this.props.props)}createProxy(a,b){if(a instanceof Function){const a=[];for(var d=b;null!=d;d=
d.prev)a.push(d.key);a.reverse();return(...b)=>this.access(a)(...b)}if(a instanceof Array)return a.map((d,h)=>this.createProxy(a[h],{prev:b,key:h}));if(r.Utils.isPlainObject(a)){d={};for(const f of Object.keys(a))d[f]=this.createProxy(a[f],{prev:b,key:f});return d}return a}shouldComponentUpdate(a){return!r.Utils.deepEqualsExcludingFunctions(this.props.props,a.props)}render(){this.proxy=this.createProxy(this.props.props,null);return this.props.create(this.proxy)}};var B={wrapItemAction:function(a,
b){return null==b?null:Object.assign(Object.assign({},ya(b)),{onClick:()=>a.callWithUAT((a)=>b.onClick(a))})}};Object.defineProperty(B,"__esModule",{value:!0});B.SimpleListItemUIImpl=class{constructor(a,b,d){this.applicationController=a;this.callHandler=b;this.popupController=d}getOnMore(a,b){return null==a||0===a.length?null:(a)=>{this.popupController.togglePopup(a);null!=b&&this.popupController.isPopupOpen(a)&&this.callHandler.call(b)}}getOnClick(a){return null!=a?(b)=>this.callHandler.callWithUAT((d)=>
a(d,{shiftKey:b.shiftKey})):null}isSelected(a,b){return null!=b&&a===b}image(a){const b=D(a.src),d=this.getOnClick(a.onClick),f=null==a.requestImage?null:()=>this.callHandler.call(a.requestImage),h=this.getOnMore(a.actions,a.onShowActions);return{containerKind:c.ContainerKind.simpleList,id:a.id,key:b,title:a.title,titlePostfix:a.titlePostfix,createReactElement:(c)=>{var n;c={selected:this.isSelected(a.id,c.activeId),checked:e.CheckedState.none,popupIds:c.popupIds,src:a.src,requestImage:f,hoverContent:a.hoverContent,
info:a.info,title:C(c.showTitle,a.title,a.titlePostfix),onClick:d,primaryAction:(0,B.wrapItemAction)(this.callHandler,a.primaryAction),actions:g.mapActionsToMenuItemUIDescription(a.actions,this.callHandler,this.popupController),actionWrapperPosition:e.ActionWrapperPosition.top,stickyActions:a.stickyActions,onMore:h,blendColor:a.blendColor,disabled:null!==(n=a.disabled)&&void 0!==n?n:!1,dataLookup:a.dataLookup,content:a.content,badge:a.badge,badgeTooltipText:a.badgeTooltipText,addChecker:a.addChecker};
return k.createElement(e.Image,Object.assign({key:b},c))}}}droppableImage(a){const b=()=>this.applicationController.setListDropHandler((b)=>{this.callHandler.callWithUAT((d)=>a.onDrop(d,{dropKind:c.DropKind.drag,stageX:b.stageX,stageY:b.stageY,targetTopic:b.targetTopic}))}),d=()=>{this.callHandler.callWithUAT((b)=>a.onDrop(b,{dropKind:c.DropKind.click,stageX:null,stageY:null,targetTopic:null}))},f=D(a.src),h=null==a.requestImage?null:()=>this.callHandler.call(a.requestImage),n=this.getOnMore(a.actions,
a.onShowActions);return{containerKind:c.ContainerKind.simpleList,id:a.id,key:f,title:a.title,titlePostfix:a.titlePostfix,createReactElement:(c)=>{var m;c={selected:this.isSelected(a.id,c.activeId),checked:e.CheckedState.none,popupIds:c.popupIds,src:a.src,requestImage:h,hoverContent:a.hoverContent,info:a.info,title:C(c.showTitle,a.title,a.titlePostfix),onClick:d,primaryAction:(0,B.wrapItemAction)(this.callHandler,a.primaryAction),actions:g.mapActionsToMenuItemUIDescription(a.actions,this.callHandler,
this.popupController),actionWrapperPosition:e.ActionWrapperPosition.top,stickyActions:a.stickyActions,onMore:n,blendColor:a.blendColor,disabled:null!==(m=a.disabled)&&void 0!==m?m:!1,dataLookup:a.dataLookup,content:a.content,getDropData:b,preziDataMimeParams:a.preziDataMimeParams,badge:a.badge,badgeTooltipText:a.badgeTooltipText,addChecker:a.addChecker};return k.createElement(e.DroppableImage,Object.assign({key:f},c))}}}folder(a){const b=D(a.src),d=this.getOnClick(a.onClick),f=null==a.requestImage?
null:()=>this.callHandler.call(a.requestImage);return{containerKind:c.ContainerKind.simpleList,id:a.id,key:b,title:a.title,titlePostfix:a.titlePostfix,createReactElement:(h)=>{var c;h={selected:this.isSelected(a.id,h.activeId),checked:e.CheckedState.none,popupIds:h.popupIds,src:a.src,requestImage:f,hoverContent:a.hoverContent,info:a.info,title:C(h.showTitle,a.title,a.titlePostfix),onClick:d,primaryAction:null,actions:null,actionWrapperPosition:null,stickyActions:null,onMore:null,blendColor:a.blendColor,
disabled:null!==(c=a.disabled)&&void 0!==c?c:!1,dataLookup:a.dataLookup,content:a.content};return k.createElement(e.Folder,Object.assign({key:b},h))}}}error(a){return{id:null,containerKind:c.ContainerKind.simpleList,title:a.title,titlePostfix:a.titlePostfix,key:"error",createReactElement:(b)=>{b={title:C(b.showTitle,a.title,a.titlePostfix),dataLookup:a.dataLookup};return k.createElement(e.ErrorItem,Object.assign({key:"error"},b))}}}lock(a){const b=this.getOnClick(a.onClick),d=D(a.src);return{containerKind:c.ContainerKind.simpleList,
id:null,createReactElement:(f)=>{f={src:a.src,title:C(f.showTitle,a.title,a.titlePostfix),onClick:b,blendColor:a.blendColor,disabled:a.disabled,dataLookup:a.dataLookup,tooltipText:a.tooltipText};return k.createElement(e.LockedImage,Object.assign({key:d},f))},title:a.title,titlePostfix:a.titlePostfix,key:d}}text(a){var b;const d={title:a.title,icon:a.icon,text:a.text,dataLookup:a.dataLookup,onClick:this.getOnClick(a.onClick),onDeleteClick:null!=a.onDeleteClick?()=>this.callHandler.callWithUAT(a.onDeleteClick):
null},f=null!==(b=a.dataLookup)&&void 0!==b?b:`${a.title}|${a.text}`;return{containerKind:c.ContainerKind.simpleList,id:null,createReactElement:()=>k.createElement(e.TextListItem,Object.assign({key:f},d)),title:null,titlePostfix:null,key:f}}};B.MultiSelectListItemUIImpl=class{constructor(a,b){this.applicationController=a;this.callHandler=b}getChecked(a,b){return null!=b&&-1!==b.indexOf(a)?e.CheckedState.checked:e.CheckedState.unchecked}getOnClick(a,b,d,f){return(h)=>{let c;if(h.shiftKey&&0!==(null===
d||void 0===d?void 0:d.length)){h=b.indexOf(d[d.length-1]);let f=b.indexOf(a),n=b.slice(Math.min(h,f),Math.max(h,f)+1);f<h&&(n=n.reverse());c=[...d.filter((a)=>0>n.indexOf(a)),...n]}else c=null!=a&&0<=d.indexOf(a)?d.filter((b)=>b!==a):[...d,a];this.callHandler.call(()=>f({selectedIds:c}))}}getGetDropData(a,b,d){return()=>{const f=0>b.indexOf(a)?[a]:b;return this.applicationController.setListDropHandler((a)=>{this.callHandler.callWithUAT((b)=>{d(b,{dropKind:c.DropKind.drag,stageX:a.stageX,stageY:a.stageY,
targetTopic:a.targetTopic,draggedIds:f})})})}}image(a){const b=a.id,d=D(a.src),f=null==a.requestImage?null:()=>this.callHandler.call(a.requestImage);return{containerKind:c.ContainerKind.multiSelectList,id:b,key:d,title:a.title,titlePostfix:a.titlePostfix,createReactElement:(h)=>{var c;const m=this.getOnClick(b,h.allIds,h.selectedIds,h.onSelectionChange);h={selected:!1,checked:this.getChecked(b,h.selectedIds),popupIds:h.popupIds,src:a.src,requestImage:f,hoverContent:a.hoverContent,info:a.info,title:C(h.showTitle,
a.title,a.titlePostfix),onClick:m,primaryAction:null,actions:null,actionWrapperPosition:null,stickyActions:null,onMore:null,blendColor:a.blendColor,disabled:null!==(c=a.disabled)&&void 0!==c?c:!1,dataLookup:a.dataLookup,content:a.content,badge:a.badge,badgeTooltipText:a.badgeTooltipText,addChecker:a.addChecker};return k.createElement(e.Image,Object.assign({key:d},h))}}}droppableImage(a){const b=a.id,d=D(a.src),f=null==a.requestImage?null:()=>this.callHandler.call(a.requestImage);return{containerKind:c.ContainerKind.multiSelectList,
id:a.id,key:d,title:a.title,titlePostfix:a.titlePostfix,createReactElement:(c)=>{var h;const m=this.getOnClick(b,c.allIds,c.selectedIds,c.onSelectionChange),v=this.getChecked(b,c.selectedIds),w=this.getGetDropData(b,c.selectedIds,c.onDrop);c={selected:!1,checked:v,popupIds:c.popupIds,src:a.src,requestImage:f,hoverContent:a.hoverContent,info:a.info,title:C(c.showTitle,a.title,a.titlePostfix),onClick:m,primaryAction:null,actions:null,actionWrapperPosition:null,stickyActions:null,onMore:null,blendColor:a.blendColor,
disabled:null!==(h=a.disabled)&&void 0!==h?h:!1,dataLookup:a.dataLookup,content:a.content,getDropData:w,preziDataMimeParams:c.preziDataMimeParams,badge:a.badge,badgeTooltipText:a.badgeTooltipText,addChecker:a.addChecker};return k.createElement(e.DroppableImage,Object.assign({key:d},c))}}}error(a){return{id:null,containerKind:c.ContainerKind.multiSelectList,title:a.title,titlePostfix:a.titlePostfix,key:"error",createReactElement:(b)=>{b={title:C(b.showTitle,a.title,a.titlePostfix),dataLookup:a.dataLookup};
return k.createElement(e.ErrorItem,Object.assign({key:"error"},b))}}}};B.TimelineListItemUIImpl=class{constructor(a,b){this.callHandler=a;this.popupController=b}getOnClick(a){return null!=a?(b)=>this.callHandler.callWithUAT((d)=>a(d,{shiftKey:b.shiftKey})):null}getOnMouseEnter(a){return null!=a?()=>this.callHandler.callWithUAT((b)=>a(b)):null}getOnMouseLeave(a){return null!=a?()=>this.callHandler.callWithUAT((b)=>a(b)):null}getOnMore(a,b){return null==a||0===a.length?null:(a)=>{this.popupController.togglePopup(a);
null!=b&&this.popupController.isPopupOpen(a)&&this.callHandler.call(b)}}isEqual(a,b){return null!=b&&a===b}deck(a){var b;const d=null!==(b=a.id)&&void 0!==b?b:D(a.src),f=this.getOnClick(a.onClick),h=this.getOnMouseEnter(a.onMouseEnter),n=this.getOnMouseLeave(a.onMouseLeave),m=null==a.requestImage?null:()=>this.callHandler.call(a.requestImage),v=this.getOnMore(a.actions,a.onShowActions);return{containerKind:c.ContainerKind.timelineList,id:a.id,key:d,title:a.title,titlePostfix:a.titlePostfix,height:149.625,
createReactElement:(b)=>{var c;const w=this.isEqual(a.id,b.activeId),l=this.isEqual(a.id,b.secondaryActiveId);b={selected:w,thinBorder:l,checked:e.CheckedState.none,popupIds:b.popupIds,src:a.src,requestImage:m,hoverContent:a.hoverContent,info:a.info,title:C(b.showTitle,a.title,a.titlePostfix),onClick:f,onMouseEnter:h,onMouseLeave:n,primaryAction:(0,B.wrapItemAction)(this.callHandler,a.primaryAction),actions:g.mapActionsToMenuItemUIDescription(a.actions,this.callHandler,this.popupController),actionWrapperPosition:e.ActionWrapperPosition.top,
stickyActions:a.stickyActions,onMore:v,blendColor:a.blendColor,disabled:null!==(c=a.disabled)&&void 0!==c?c:!1,dataLookup:a.dataLookup,content:a.content,badges:a.badges,reorderCallbacks:a.canStartReorder?b.reorderCallbacks:null,isDraggable:a.canStartReorder&&null!=b.reorderCallbacks,showDeck:a.showDeck};return k.createElement(g.Memo,{key:d,props:b,create:(a)=>k.createElement(e.TimelineDeckItem,Object.assign({},a))})}}}frame(a){var b;const d=null!==(b=a.id)&&void 0!==b?b:D(a.src),f=this.getOnClick(a.onClick),
h=this.getOnMouseEnter(a.onMouseEnter),n=this.getOnMouseLeave(a.onMouseLeave),m=null==a.requestImage?null:()=>this.callHandler.call(a.requestImage),v=this.getOnMore(a.actions,a.onShowActions);return{containerKind:c.ContainerKind.timelineList,id:a.id,key:d,title:a.title,titlePostfix:a.titlePostfix,height:149.625,createReactElement:(b)=>{var c;const w=this.isEqual(a.id,b.activeId),l=this.isEqual(a.id,b.secondaryActiveId);b={selected:w,thinBorder:l,checked:e.CheckedState.none,popupIds:b.popupIds,src:a.src,
requestImage:m,hoverContent:a.hoverContent,info:a.info,title:C(b.showTitle,a.title,a.titlePostfix),onClick:f,onMouseEnter:h,onMouseLeave:n,primaryAction:(0,B.wrapItemAction)(this.callHandler,a.primaryAction),actions:g.mapActionsToMenuItemUIDescription(a.actions,this.callHandler,this.popupController),actionWrapperPosition:e.ActionWrapperPosition.top,stickyActions:a.stickyActions,onMore:v,blendColor:a.blendColor,disabled:null!==(c=a.disabled)&&void 0!==c?c:!1,dataLookup:a.dataLookup,content:a.content,
badges:a.badges,reorderCallbacks:a.canStartReorder?b.reorderCallbacks:null,isDraggable:a.canStartReorder&&null!=b.reorderCallbacks};return k.createElement(g.Memo,{key:d,props:b,create:(a)=>k.createElement(e.TimelineFrameItem,Object.assign({},a))})}}}main(a){var b;const d=null!==(b=a.id)&&void 0!==b?b:D(a.src),f=this.getOnClick(a.onClick),h=this.getOnMouseEnter(a.onMouseEnter),n=this.getOnMouseLeave(a.onMouseLeave),m=null==a.requestImage?null:()=>this.callHandler.call(a.requestImage),v=this.getOnMore(a.actions,
a.onShowActions);return{containerKind:c.ContainerKind.timelineList,id:a.id,key:d,title:a.title,titlePostfix:a.titlePostfix,height:167.375,createReactElement:(b)=>{var c;b={selected:this.isEqual(a.id,b.activeId),checked:e.CheckedState.none,popupIds:b.popupIds,src:a.src,requestImage:m,hoverContent:a.hoverContent,info:a.info,title:C(b.showTitle,a.title,a.titlePostfix),onClick:f,onMouseEnter:h,onMouseLeave:n,primaryAction:(0,B.wrapItemAction)(this.callHandler,a.primaryAction),actions:g.mapActionsToMenuItemUIDescription(a.actions,
this.callHandler,this.popupController),actionWrapperPosition:e.ActionWrapperPosition.top,stickyActions:a.stickyActions,onMore:v,blendColor:a.blendColor,disabled:null!==(c=a.disabled)&&void 0!==c?c:!1,dataLookup:a.dataLookup,content:a.content,badges:a.badges,reorderCallbacks:a.canStartReorder?b.reorderCallbacks:null,isDraggable:a.canStartReorder&&null!=b.reorderCallbacks};return k.createElement(g.Memo,{key:d,props:b,create:(a)=>k.createElement(e.TimelineMainItem,Object.assign({},a))})}}}text(a){const b=
a.dataLookup,d=this.getOnClick(a.onClick),f=this.getOnMouseEnter(a.onMouseEnter),h=this.getOnMouseLeave(a.onMouseLeave);return{containerKind:c.ContainerKind.timelineList,id:a.id,key:b,title:a.title,titlePostfix:a.titlePostfix,height:32,createReactElement:(c)=>{const n=this.isEqual(a.id,c.secondaryActiveId);c={title:C(c.showTitle,a.title,a.titlePostfix),tooltipText:a.tooltipText,onClick:d,onMouseEnter:f,onMouseLeave:h,dataLookup:a.dataLookup,icon:a.icon,text:a.text,timelineAction:(0,B.wrapItemAction)(this.callHandler,
a.timelineAction),onDeleteClick:null!=a.onDeleteClick?()=>this.callHandler.callWithUAT(a.onDeleteClick):null,reorderCallbacks:a.canStartReorder?c.reorderCallbacks:null,isDraggable:a.canStartReorder&&null!=c.reorderCallbacks,thinBorder:n};return k.createElement(g.Memo,{key:b,props:c,create:(a)=>k.createElement(e.TimelineTextItem,Object.assign({},a))})}}}};B.MenuItemUIImpl=class{constructor(a,b){this.callHandler=a;this.popupController=b}getOnClick(a,b,d){return null!=a?(f)=>{this.callHandler.callWithUAT((b)=>
a(b,{shiftKey:f.shiftKey}));this.popupController.closePopup(b,d);f.stopPropagation()}:null}header(a){return{createReactElement:(b)=>k.createElement(e.DropdownMenuSectionHeader,{key:`${b.popupIds[b.popupIds.length-1]}-header-${b.key}`,content:a.content,bottomPadding:a.bottomPadding})}}menuItem(a){return{action:a,createReactElement:(b)=>{const d=`${b.popupIds[b.popupIds.length-1]}`;return k.createElement(e.DropdownMenuItem,{id:`${d}-${a.id}`,key:b.key,onClick:this.getOnClick((b)=>a.onClick(b),d,b.parentIds),
enabled:a.enabled,icon:a.icon,title:a.title})}}}separator(){return{createReactElement:(a)=>k.createElement(e.DropdownMenuSeparator,{key:`${a.popupIds[a.popupIds.length-1]}-separator-${a.key}`})}}};var X={};Object.defineProperty(X,"__esModule",{value:!0});X.ButtonUIImpl=class{constructor(a,b,d,f){this.popupUI=a;this.callHandler=b;this.popupController=d;this.applicationController=f;this.menuItemUI=u.wrapIntoKillable(new B.MenuItemUIImpl(this.callHandler,this.popupController))}button(a){return{createButtonReactElement:(b,
d,f)=>{b=null==a.onClick?null:()=>this.callHandler.callWithUAT(a.onClick);return k.createElement(e.NormalButton,{key:d,buttonColor:g.convertButtonColor(a.color),content:a.content,id:a.id,onClick:b,disabled:a.disabled,tooltipText:a.tooltipText,tooltipPosition:a.tooltipPosition,fitParent:a.flexibleWidth,size:g.convertButtonSize(f),shape:a.shape,flexibleWidth:a.flexibleWidth,minTextWidthPx:null})}}}repeatButton(a){return{createButtonReactElement:(b,d,f)=>{b=null==a.onDown?null:()=>this.callHandler.callWithUAT(a.onDown);
const c=null==a.onRepeat?null:()=>this.callHandler.callWithUAT(a.onRepeat),n=null==a.onUp?null:()=>this.callHandler.callWithUAT(a.onUp);return k.createElement(e.NormalButton,{key:d,buttonColor:g.convertButtonColor(a.color),content:a.content,id:a.id,disabled:a.disabled,tooltipText:a.tooltipText,tooltipPosition:a.tooltipPosition,fitParent:a.flexibleWidth,size:g.convertButtonSize(f),shape:a.shape,flexibleWidth:a.flexibleWidth,repeatClick:!0,onDown:b,onRepeat:c,onUp:n,minTextWidthPx:null})}}}comboButton(a){return this.toggleComboButton((b)=>
Object.assign(Object.assign({},a(b)),{pushed:!1}))}toggleComboButton(a){const b=a(this.popupUI);return{createButtonReactElement:(a,f,h)=>{const d=b.id+"-popupOpener-popup",m=(a)=>this.popupController.togglePopup(d,a);return k.createElement(e.ComboButton,{key:f,id:b.id,buttonColor:g.convertButtonColor(b.color),popupIds:a.popupIds,parentIds:a.parentIds,currentScrollIntoViewIds:a.currentScrollIntoViewIds,alignment:null,hidePopupPointer:b.hidePopupPointer,popupHeight:b.popupHeight?b.popupHeight:c.PopupHeight.Full,
content:b.content,size:g.convertButtonSize(h),shape:b.shape,disabled:b.disabled,onDropdownClick:()=>{m(a.parentIds)},onButtonClick:()=>this.callHandler.callWithUAT((a)=>b.onClick(a)),popupHeader:g.mapToCreateReactElement(b.popupHeader),popupContent:g.mapToCreateReactElement(b.popupContent),popupFooter:g.mapToCreateReactElement(b.popupFooter),dataLookup:b.id,tooltipText:b.tooltipText,tooltipPosition:b.tooltipPosition,fitParent:b.flexibleWidth,flexibleWidth:b.flexibleWidth,onOpened:b.onOpen})}}}comboMenuButton(a){const b=
a(this.menuItemUI);return{createButtonReactElement:(a,f,c)=>{const d=b.id+"-popupOpener-popup",h=(a)=>{this.popupController.togglePopup(d,a);null!=b.onOpen&&this.popupController.isPopupOpen(d)&&this.callHandler.call(b.onOpen)};return k.createElement(e.ComboMenuButton,{key:f,id:b.id,buttonColor:g.convertButtonColor(b.color),popupIds:a.popupIds,parentIds:a.parentIds,hidePopupPointer:b.hidePopupPointer,content:b.content,size:g.convertButtonSize(c),shape:b.shape,disabled:b.disabled,popupPosition:b.popupPosition,
onDropdownClick:()=>{h(a.parentIds)},actions:b.actions,onButtonClick:()=>{this.popupController.closePopup(d,a.popupIds);this.callHandler.callWithUAT((a)=>{b.onClick(a)})},dataLookup:b.id,tooltipText:b.tooltipText,tooltipPosition:b.tooltipPosition,fitParent:b.flexibleWidth,flexibleWidth:b.flexibleWidth})}}}menuButton(a){const b=a(this.menuItemUI);return{createButtonReactElement:(a,f,c)=>{const d=b.id+"-popupOpener-popup",h=(a)=>this.popupController.togglePopup(d,a);return k.createElement(e.MenuButton,
{key:f,id:b.id,buttonColor:g.convertButtonColor(b.color),popupIds:a.popupIds,parentIds:a.parentIds,hidePopupPointer:b.hidePopupPointer,content:b.content,size:g.convertButtonSize(c),shape:b.shape,disabled:b.disabled,popupPosition:b.popupPosition,onDropdownClick:()=>{h(a.parentIds);null!=b.onOpen&&this.popupController.isPopupOpen(d)&&this.callHandler.call(b.onOpen)},actions:b.actions,dataLookup:b.id,tooltipText:b.tooltipText,tooltipPosition:b.tooltipPosition,fitParent:b.flexibleWidth,flexibleWidth:b.flexibleWidth,
showArrow:b.showArrow,minTextWidthPx:null})}}}submenuButton(a){return{createButtonReactElement:(b,d,f)=>{const h=a.id+"-popupOpener-popup",n=(a)=>this.popupController.togglePopup(h,a),m=null==a.actions?null:a.actions.map((a)=>{var b;return a===c.SubmenuSeparatorConst?a:Object.assign(Object.assign({},a),{pushed:null!==(b=a.pushed)&&void 0!==b?b:!1,onClick:()=>this.callHandler.callWithUAT((b)=>a.onClick(b))})});return k.createElement(e.SubmenuButton,{key:d,id:a.id,buttonColor:g.convertButtonColor(a.color),
popupIds:b.popupIds,parentIds:b.parentIds,content:a.content,size:g.convertButtonSize(f),shape:a.shape,disabled:a.disabled,popupPosition:a.popupPosition,onDropdownClick:()=>{n(b.parentIds);null!=a.onOpen&&this.popupController.isPopupOpen(h)&&this.callHandler.call(a.onOpen)},actions:m,dataLookup:a.id,tooltipText:a.tooltipText,tooltipPosition:a.tooltipPosition,fitParent:a.flexibleWidth,flexibleWidth:a.flexibleWidth,showArrow:a.showArrow})}}}popupButton(a){const b=a(this.popupUI);return{createButtonReactElement:(a,
f,h)=>{const d=b.id+"-popupOpener-popup",m=(a)=>this.popupController.togglePopup(d,a);return k.createElement(e.PopupButton,{id:b.id,buttonColor:g.convertButtonColor(b.color),popupIds:a.popupIds,parentIds:a.parentIds,currentScrollIntoViewIds:a.currentScrollIntoViewIds,alignment:null,hidePopupPointer:b.hidePopupPointer,popupHeight:b.popupHeight?b.popupHeight:c.PopupHeight.Full,content:b.content,size:g.convertButtonSize(h),showArrow:b.showArrow,disabled:b.disabled,onClick:()=>{m(a.parentIds)},popupHeader:g.mapToCreateReactElement(b.popupHeader),
popupContent:g.mapToCreateReactElement(b.popupContent),popupFooter:g.mapToCreateReactElement(b.popupFooter),dataLookup:b.id,tooltipText:b.tooltipText,tooltipPosition:b.tooltipPosition,fitParent:b.flexibleWidth,flexibleWidth:b.flexibleWidth,shape:b.shape,popupPosition:"left",onOpened:b.onOpen,minTextWidthPx:null})}}}upload(a){return{createButtonReactElement:(b,d,f)=>{const h=this.applicationController.getFilePickerDescriptions(),n=a.id+"-popupOpener-popup",m=b.parentIds,v=(b,d)=>{var f;this.popupController.closePopup(n,
m);null!=a.onClick&&this.callHandler.call(a.onClick);const h=null!==(f=a.fileFilter)&&void 0!==f?f:{};this.applicationController.selectFile(d,h,(b,d)=>{this.callHandler.callWithUAT((f)=>{if(null!=a.onFileSelected&&c.FileFilter.passes(h,b))a.onFileSelected(f,{file:b,source:d});else if(null!=a.onInvalidFileSelected&&null!=b)a.onInvalidFileSelected(f,{fileName:b.name,source:d})})})};return 0===h.length?k.createElement(e.NormalButton,{key:d,buttonColor:null!=a.color?g.convertButtonColor(a.color):e.ExtendedButtonColor.Gray,
content:a.content,id:a.id,onClick:()=>this.callHandler.callWithUAT((a)=>v(a,null)),disabled:a.disabled,tooltipText:a.tooltipText,tooltipPosition:a.tooltipPosition,size:g.convertButtonSize(f),fitParent:a.flexibleWidth,flexibleWidth:a.flexibleWidth,shape:a.shape,minTextWidthPx:null}):k.createElement(e.ComboMenuButton,{id:a.id,key:d,buttonColor:null!=a.color?g.convertButtonColor(a.color):e.ExtendedButtonColor.Gray,onButtonClick:()=>this.callHandler.callWithUAT((a)=>v(a,null)),onDropdownClick:()=>{this.popupController.togglePopup(n,
m);this.popupController.isPopupOpen(n)&&E.avro.Avro.createDefaultLogger().logShowUploadOptions()},content:a.content,size:g.convertButtonSize(f),actions:g.mapActionsToMenuItemUIDescription([{id:a.id+"-option-upload-from-computer",onClick:(a)=>v(a,null),icon:e.IconSmallId.Upload,enabled:!0,title:pa.I18n.ts("Upload from computer")},c.DropdownMenuSeparatorConst,...h.map((b)=>({icon:b.icon,enabled:!0,onClick:(a)=>v(a,b.id),id:a.id+"-option-"+b.id,title:b.name}))],this.callHandler,this.popupController),
hidePopupPointer:!1,popupIds:b.popupIds,parentIds:b.parentIds,disabled:a.disabled,dataLookup:a.id,tooltipText:a.tooltipText,tooltipPosition:a.tooltipPosition,fitParent:a.flexibleWidth,flexibleWidth:a.flexibleWidth,shape:a.shape})}}}toggle(a){return{createButtonReactElement:(b,d,f)=>{b={content:a.content,id:a.id,onClick:null==a.onClick?null:()=>this.callHandler.callWithUAT(a.onClick),disabled:a.disabled,tooltipText:a.tooltipText,tooltipPosition:a.tooltipPosition,fitParent:a.flexibleWidth,flexibleWidth:a.flexibleWidth,
size:g.convertButtonSize(f),shape:a.shape,minTextWidthPx:null};return k.createElement(e.ToggleButton,Object.assign({key:d},b,{pushed:a.pushed}))}}}label(a){return{createButtonReactElement:(b,d)=>k.createElement(e.ButtonRowLabel,{key:d,content:a,inline:!0})}}checkbox(a){return{createButtonReactElement:(b,d)=>k.createElement(e.Checkbox,Object.assign({key:d},{label:a.label,onCheck:null==a.onCheck?null:(b)=>this.callHandler.callWithUAT((d)=>a.onCheck(d,b)),checked:a.checked,disabled:a.disabled,dataLookup:a.id,
isToggleSwitch:a.isToggleSwitch,tooltipText:a.tooltipText}))}}};var G={},Fa=this&&G.__rest||function(a,b){var d={},f;for(f in a)Object.prototype.hasOwnProperty.call(a,f)&&0>b.indexOf(f)&&(d[f]=a[f]);if(null!=a&&"function"===typeof Object.getOwnPropertySymbols){var c=0;for(f=Object.getOwnPropertySymbols(a);c<f.length;c++)0>b.indexOf(f[c])&&Object.prototype.propertyIsEnumerable.call(a,f[c])&&(d[f[c]]=a[f[c]])}return d};Object.defineProperty(G,"__esModule",{value:!0});G.BaseUIImpl=class{constructor(a,
b,d,f,h,n,e,v){this.containerKind=a;this.applicationController=b;this.callHandler=d;this.popupController=f;this.colorGridProvider=h;this.maybeEditorSession=n;this.audioController=e;this.simpleUi=u.wrapIntoKillable(new B.SimpleListItemUIImpl(this.applicationController,this.callHandler,this.popupController));this.multiUi=u.wrapIntoKillable(new B.MultiSelectListItemUIImpl(this.applicationController,this.callHandler));this.timelineUi=u.wrapIntoKillable(new B.TimelineListItemUIImpl(this.callHandler,this.popupController));
this.popupUi=this.containerKind===c.ContainerKind.popup?this:u.wrapIntoKillable(v(c.ContainerKind.popup));this.buttonUi=u.wrapIntoKillable(new X.ButtonUIImpl(this.popupUi,this.callHandler,this.popupController,this.applicationController))}itemContainerHasMargin(){return this.containerKind===c.ContainerKind.dialogRow}getItemContainerWidth(){return this.containerKind===c.ContainerKind.dialogRow?null:e.DialogItemCellWidth.single}kill(){this.simpleUi.kill();this.multiUi.kill();this.timelineUi.kill();this.popupUi!==
this&&this.popupUi.kill()}static createColorGridsFromColorGridArgss(a,b,d,f){return b.map((b)=>({colors:b.colors,id:b.id,title:b.title,buttons:null==b.buttonArgs?null:g.wrapIntoItemContainer(a.key,{kind:e.ItemContainerKind.horizontal,dataWidget:e.DataWidget.Buttons,justifyContent:c.ButtonAlign.Start,flexWrap:e.FlexWrap.wrap,noMargin:!0},null==b.buttonArgs?[]:b.buttonArgs.map((b,d)=>f.button(b).createButtonReactElement(a,d,c.ButtonSize.Small)))}))}horizontal(a){return{kind:e.ItemContainerKind.horizontal,
dataWidget:a,noMargin:this.itemContainerHasMargin()}}horizontalWidth(a){return{kind:e.ItemContainerKind.horizontal,dataWidget:a,noMargin:this.itemContainerHasMargin(),width:this.getItemContainerWidth()}}horizontalNoMargin(a){return{kind:e.ItemContainerKind.horizontal,dataWidget:a,noMargin:!0}}button(a,b,d){const f=d(this.buttonUi);return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:Object.assign(Object.assign({},this.horizontal(e.DataWidget.Buttons)),{justifyContent:b,flexWrap:e.FlexWrap.wrap,
alignItems:"center"}),createItemElement:(b)=>f.map((d,f)=>d.createButtonReactElement(b,f,a))}}splitButtons(a,b,d){const f=b(this.buttonUi),h=d(this.buttonUi);return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:Object.assign(Object.assign({},this.horizontal(e.DataWidget.Buttons)),{justifyContent:c.ButtonAlign.Start,flexWrap:e.FlexWrap.wrap,alignItems:"center"}),createItemElement:(b)=>[k.createElement(e.ButtonSide,{key:"left",align:"left"},f.map((d,f)=>d.createButtonReactElement(b,
f,a))),k.createElement(e.ButtonSide,{key:"right",align:"right"},h.map((d,f)=>d.createButtonReactElement(b,f,a)))]}}droparea(a){const b=(b,d)=>this.callHandler.callWithUAT((f)=>{null!=b&&(c.FileFilter.passes(a.filter,b)?null===a||void 0===a?void 0:a.onFileSelected(f,{file:b,source:d}):null!=a.onInvalidFileSelected&&(null===a||void 0===a?void 0:a.onInvalidFileSelected(f,{fileName:b.name,source:d})))}),d=a.hideUploadButton?null:this.buttonUi.upload({color:a.color,id:"drop-area-button",fileFilter:a.filter,
onFileSelected:a.onFileSelected,onInvalidFileSelected:a.onInvalidFileSelected,content:{text:pa.I18n.ts("Upload a file")}});return{kind:c.ItemKind.Container,containerKind:this.containerKind,props:this.horizontal(e.DataWidget.DropArea),createItemElement:(f)=>k.createElement(e.DropArea,{onDrop:(a)=>b(a,"DROPPED"),illustration:a.illustration,text:a.text,minHeight:200,errorText:a.errorText,caption:a.caption,showSpinner:a.showSpinner,url:a.url,dataLookup:a.dataLookup,disabled:a.disabled},null===d||void 0===
d?void 0:d.createButtonReactElement(f,0,c.ButtonSize.Small))}}progressBar(a){const {id:b,caption:d,title:f,percentage:h,titleTooltip:n,errorText:m,onCancel:g,onRestart:w,control:l}=a,F=g?()=>this.callHandler.callWithUAT((a)=>g(a)):null;return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:this.horizontalNoMargin(e.DataWidget.ProgressBar),createItemElement:()=>k.createElement(e.ProgressBar,{id:b,caption:d,title:f,titleTooltip:n,percentage:h,errorText:m,onCancel:F,onRestart:w,control:l})}}separator(a=
!1){return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:this.horizontalNoMargin(e.DataWidget.HorizontalSeparator),createItemElement:()=>k.createElement(e.HorizontalSeparator,{nospace:a})}}sectionHeader(a){return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:this.horizontal(e.DataWidget.SectionHeader),createItemElement:()=>k.createElement(e.SidebarSectionHeader,{content:a.content,bottomPadding:a.bottomPadding})}}label(a,b=!1){return{kind:c.ItemKind.Simple,containerKind:this.containerKind,
props:this.horizontal(e.DataWidget.Label),createItemElement:()=>k.createElement(e.SidebarParagraph,{content:a,breakWord:b})}}paragraph(a,b,d=!1){const f=this.sectionHeader({content:a}),h=(a)=>b.map((b,f)=>{b=this.label(b,d);return g.wrapIntoItemContainer(`text_${f}`,b.props,b.createItemElement(a))});return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:{kind:e.ItemContainerKind.vertical,dataWidget:e.DataWidget.Paragraph,noMargin:!0},createItemElement:(a)=>[g.wrapIntoItemContainer("title",
f.props,f.createItemElement(a)),...h(a)]}}caution(a,b){return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:this.horizontal(e.DataWidget.Caution),createItemElement:()=>k.createElement(e.Caution,{text:a,type:b})}}infoMessage(a){return this.caution(a,e.CautionTypes.Info)}errorMessage(a){return this.caution(a,e.CautionTypes.Error)}checkbox(a){const b=(b)=>this.callHandler.callWithUAT((d)=>a.onCheck(d,b));return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:this.horizontal(e.DataWidget.Checkbox),
createItemElement:()=>k.createElement(e.Checkbox,{dataLookup:a.id,onCheck:b,checked:a.checked,disabled:a.disabled,label:a.label,isToggleSwitch:a.isToggleSwitch,tooltipText:a.tooltipText})}}numericSlider(a){const b={dataLookup:a.dataLookup,title:a.title,value:a.value,disabled:a.disabled,steps:a.steps,onChange:(b,f,c)=>this.callHandler.callWithUAT((d)=>a.onChange(d,{value:b,source:f,isFinal:c})),displayNumericSelector:!0,numericSelectorMultiplier:null!=a.steps?1:100};return{kind:c.ItemKind.Simple,containerKind:this.containerKind,
props:this.horizontal(e.DataWidget.NumericSlider),createItemElement:()=>k.createElement(e.Slider,Object.assign({},b))}}slider(a){const b={title:a.title,value:a.value,disabled:a.disabled,steps:a.steps,onChange:(b,f,c)=>this.callHandler.callWithUAT((d)=>a.onChange(d,{value:b,isFinal:c})),displayNumericSelector:!1,numericSelectorMultiplier:null!=a.steps?1:100};return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:this.horizontal(e.DataWidget.Slider),createItemElement:()=>k.createElement(e.Slider,
Object.assign({},b))}}inputField(a){return this.textarea(Object.assign(Object.assign({},a),{rows:null,flexibleHeight:!1}))}textarea(a){const b={type:"text",onValueChange:"onValueChange"in a&&null!=a.onValueChange?(b)=>this.callHandler.callWithUAT((d)=>a.onValueChange(d,b)):null,onEnter:"onEnter"in a&&null!=a.onEnter?()=>this.callHandler.callWithUAT((b)=>a.onEnter(b)):null,bottomText:a.bottomText,id:a.id,errorText:a.errorText,placeholderText:a.placeholderText,value:a.value,rows:a.rows,disabled:a.disabled,
maxLength:"maxLength"in a?a.maxLength:null,readonly:"readonly"in a?a.readonly:null,autofocus:"autofocus"in a?a.autofocus:!1,tooltipText:a.tooltipText,tooltipPosition:a.tooltipPosition,fitParent:!0,selectOnFocus:"selectOnFocus"in a?a.selectOnFocus:!1,onFocusLost:"onFocusLost"in a?()=>this.callHandler.callWithUAT((b)=>a.onFocusLost(b)):null};return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:{kind:a.flexibleHeight?e.ItemContainerKind.verticalDynamic:e.ItemContainerKind.horizontal,
dataWidget:e.DataWidget.Textarea,noMargin:this.itemContainerHasMargin(),width:this.getItemContainerWidth()},createItemElement:()=>k.createElement(e.InputField,Object.assign({key:b.id},b))}}audio(a){return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:this.horizontal(e.DataWidget.Audio),createItemElement:({popupIds:b,parentIds:d})=>{b={id:a.id,onClick:a.onClick,audioBuffer:a.audioBuffer,audioPlayer:this.audioController,actions:g.mapActionsToMenuItemUIDescription(a.actions,this.callHandler,
this.popupController),onMore:(a)=>{this.popupController.togglePopup(a,d)},popupIds:b};return k.createElement(e.Audio,Object.assign({},b))}}}searchField(a){const {onSearchButtonClick:b,onValueChange:d,onEnter:f}=a,h={bottomText:a.bottomText,id:a.id,errorText:a.errorText,onValueChange:(a)=>this.callHandler.callWithUAT((b)=>d(b,a)),onEnter:f?()=>this.callHandler.callWithUAT((a)=>f(a)):null,placeholderText:a.placeholderText,value:a.value,disabled:a.disabled,readonly:!1,maxLength:a.maxLength,onSearchButtonClick:b?
()=>this.callHandler.callWithUAT((a)=>b(a)):null,autofocus:a.autofocus,tooltipText:a.tooltipText,tooltipPosition:a.tooltipPosition,fitParent:!0,selectOnFocus:a.selectOnFocus,onFocusLost:"onFocusLost"in a?()=>this.callHandler.callWithUAT((b)=>a.onFocusLost(b)):null};return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:this.horizontalWidth(e.DataWidget.SearchField),createItemElement:()=>[k.createElement(e.SearchField,Object.assign({key:a.id},h))]}}dropdown(a){return{kind:c.ItemKind.Simple,
containerKind:this.containerKind,props:this.horizontalWidth(e.DataWidget.Dropdown),createItemElement:({popupIds:b,parentIds:d})=>{b={activeId:a.activeId,onChange:null!=a.onChange?(b,c)=>this.callHandler.callWithUAT((f)=>{a.onChange(f,b);return this.popupController.closePopup(c,d)}):null,options:a.options.map((a)=>({id:a.id,title:a.title,disabled:a.disabled||!1})),openedIds:b,onOpen:(a)=>this.popupController.openPopup(a,d),disabled:a.disabled||!1,placeholderText:a.placeholderText||"",dataLookup:a.id,
tooltipText:a.tooltipText};return k.createElement(e.Dropdown,Object.assign({},b))}}}popupDropdown(a){const b=a(this.popupUi),d=b.id+"-popup",f=(a)=>this.popupController.togglePopup(d,a);return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:this.horizontal(e.DataWidget.PopupDropdown),createItemElement:(a)=>k.createElement(e.PopupDropdown,{id:b.id,popupIds:a.popupIds,parentIds:a.parentIds,currentScrollIntoViewIds:a.currentScrollIntoViewIds,alignment:null,hidePopupPointer:b.hidePopupPointer,
popupHeight:b.popupHeight?b.popupHeight:c.PopupHeight.Full,popupHeader:g.mapToCreateReactElement(b.popupHeader),popupContent:g.mapToCreateReactElement(b.popupContent),popupFooter:g.mapToCreateReactElement(b.popupFooter),dataLookup:b.id,disabled:b.disabled,onClick:()=>{f(a.parentIds)},text:b.text,textDisabled:b.textDisabled,popupOpener:!0,tooltipText:b.tooltipText,onOpened:b.onOpen})}}colorPicker(a){const b=(b,d,f,c)=>this.callHandler.callWithUAT((h)=>a.onChange(h,{newFill:b,fills:d,source:f,isFinal:c})),
d=(b)=>{(this.popupController.isPopupOpen(a.id)||null==a.onShowPopup||this.callHandler.call(a.onShowPopup))&&this.popupController.togglePopup(`${a.id}-popupOpener-popup`,b)},f=(a)=>(b)=>this.popupController.togglePopup(b,a);return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:a.expanded?this.horizontalNoMargin(e.DataWidget.ColorPicker):Object.assign(Object.assign({},this.horizontal(e.DataWidget.ColorPicker)),{alignItems:"center"}),createItemElement:(c)=>{var h,m=null==a.customColors?
[]:a.customColors;m=null==this.colorGridProvider?m:this.colorGridProvider.getColorGrids(m,!1!==a.showThemeColors);m={id:a.id,disabled:a.disabled,label:a.label,title:a.title,expanded:a.expanded,fills:a.fills,onChange:b,onColorButtonClick:()=>{d(c.parentIds)},onColorpickerDropdownClick:a.expanded?f(c.parentIds):f([...null!==(h=c.parentIds)&&void 0!==h?h:[],`${a.id}-popupOpener-popup`]),showPopup:-1!==c.popupIds.indexOf(`${a.id}-popupOpener-popup`),openedPopupIds:c.popupIds,parentIds:c.parentIds,colorGrids:G.BaseUIImpl.createColorGridsFromColorGridArgss(c,
m,this.callHandler,this.buttonUi),showColorWheel:a.showColorWheel,snapshotRenderer:this.maybeEditorSession.hasValue()?this.maybeEditorSession.value.snapshotRenderer:null,isOverlayColorPicker:a.isOverlayColorPicker,colorButtonTooltipProps:a.colorButtonTooltipProps,popupPosition:"left",hidePopupPointer:!1,size:e.ExtendedButtonSize.Small,currentScrollIntoViewIds:c.currentScrollIntoViewIds,onOpened:a.onOpen};return a.expanded?k.createElement(e.ColorPickerSidebar,{expanded:a.expanded,title:m.title,onChange:m.onChange,
onColorpickerDropdownClick:m.onColorpickerDropdownClick,fills:m.fills,colorGrids:m.colorGrids,showColorWheel:m.showColorWheel,id:`${m.id}-popup`,snapshotRenderer:m.snapshotRenderer,isOverlayColorPicker:m.isOverlayColorPicker,openedPopupIds:c.popupIds}):k.createElement(e.ColorPickerButton,Object.assign({},m))}}}simpleColorPicker(a){const {onColorSelect:b}=a,d=Fa(a,["onColorSelect"]),{id:f}=a,h=(a)=>this.callHandler.callWithUAT((d)=>b(d,a)),n=(a)=>this.popupController.togglePopup(f,a);return{kind:c.ItemKind.Simple,
containerKind:this.containerKind,props:Object.assign(Object.assign({},this.horizontal(e.DataWidget.SimpleColorPicker)),{justifyContent:"space-between",alignItems:"center"}),createItemElement:(b)=>[null!=a.label?k.createElement(e.SidebarParagraph,{content:a.label}):null,k.createElement(e.SimpleColorPicker,Object.assign({onColorButtonClick:()=>{n(b.parentIds)},onColorSelect:h,showPopup:-1!==b.popupIds.indexOf(f)},d))]}}tabMenuButtons(a){const b={activeId:a.activeId,onChange:null!=a.onChange?(b)=>this.callHandler.callWithUAT((d)=>
a.onChange(d,b)):null,options:a.options};return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:this.horizontal(e.DataWidget.TabMenuButtons),createItemElement:()=>k.createElement(e.SidebarTabMenu,Object.assign({},b))}}illustration(a,b){return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:Object.assign(Object.assign({},this.horizontalNoMargin(e.DataWidget.Illustration)),{justifyContent:"center"}),createItemElement:()=>k.createElement(e.SidebarIllustration,{caption:a,illustrationId:b})}}vimeoVideo(a){const b=
{playerKind:e.PlayerKind.vimeo,videoId:a.videoId,autoplay:null!=a.autoplay?a.autoplay:!0,muted:null!=a.muted?a.muted:!0,onLoaded:a.onLoaded,onEnded:a.onEnded,onPlay:a.onPlay,onPause:a.onPause,onMute:a.onMute,onUnmute:a.onUnmute};return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:this.horizontal(e.DataWidget.VimeoVideo),createItemElement:()=>k.createElement(e.Video,Object.assign({},b))}}spinner(a,b){return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:Object.assign(Object.assign({},
this.horizontal(e.DataWidget.Spinner)),{justifyContent:"center"}),createItemElement:()=>k.createElement(e.Spinner,{color:a,spinnerSize:b})}}image(a){const b=null!=a.actions?a.actions.map((a)=>Object.assign(Object.assign({},a),{onClick:null!=a.onClick?()=>this.callHandler.callWithUAT((b)=>a.onClick(b)):null})):[];return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:{kind:e.ItemContainerKind.horizontal,dataWidget:e.DataWidget.Image,noMargin:a.noMargin},createItemElement:()=>k.createElement(e.ImageComponent,
{src:a.src,dataLookup:a.id,title:a.title,noMargin:a.noMargin,actions:b,hasBorder:a.hasBorder})}}imageCheckbox(a){const b=(b)=>{this.callHandler.callWithUAT((d)=>{a.onCheck(d,b)})};return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:this.horizontalNoMargin(e.DataWidget.ImageCheckbox),createItemElement:()=>k.createElement(e.ImageCheckbox,{imgUrl:a.imgUrl,checked:a.checked,hasLightColor:a.hasLightColor,onCheck:b,disabled:a.disabled,dataLookup:a.id})}}collapseSection(a){const b={id:a.id,
title:a.title},d=a.items.filter((a)=>null!=a);return{kind:c.ItemKind.Container,containerKind:this.containerKind,props:this.horizontalNoMargin(e.DataWidget.CollapseSection),createItemElement:(a)=>k.createElement(e.CollapseSection,Object.assign({},b),d.map((b,d)=>g.wrapIntoItemContainer(d,b.props,b.createItemElement(a))))}}containerWithColoredBackground(a){const b=a.content.filter((a)=>null!=a);return{kind:c.ItemKind.Container,containerKind:this.containerKind,props:this.horizontalNoMargin(e.DataWidget.ContainerWithColoredBackground),
createItemElement:(a)=>k.createElement(e.SidebarContainerWithBackground,null,b.map((b,d)=>g.wrapIntoItemContainer(d,b.props,b.createItemElement(a))))}}getListItemSize(a){switch(a){case c.ListItemType.full:case c.ListItemType.numbered:return e.ListItemSize.full;case c.ListItemType.large:return e.ListItemSize.large;case c.ListItemType.small:return e.ListItemSize.small;default:return r.Utils.assertNever(a,`Unknown ListItemType: ${a}`)}}getColumnLayout(a,b){if(b)return e.ListColumnLayout.normal;switch(a){case c.ContainerKind.extraExtraLargeDialog:case c.ContainerKind.extraLargeDialog:return e.ListColumnLayout.triple;
case c.ContainerKind.mediumDialog:return e.ListColumnLayout.double;case c.ContainerKind.sidebar:case c.ContainerKind.popup:case c.ContainerKind.leftSidebar:return e.ListColumnLayout.normal;case c.ContainerKind.alertDialog:case c.ContainerKind.smallDialog:case c.ContainerKind.largeDialog:case c.ContainerKind.dialog:case c.ContainerKind.dialogRow:throw Error(`Not allowed ContainerKind: ${a}`);default:r.Utils.assertNever(a,`Not allowed ContainerKind: ${a}`)}}verticalListI(a){const b=a.itemLayout,d=this.getListItemSize(a.itemType),
f=a.itemType===c.ListItemType.numbered,h=this.getColumnLayout(this.containerKind,f),n=f?e.ListType.numbered:e.ListType.simple,m=(c,m)=>a.needItemContainer?f?k.createElement(e.NumberedListItemContainer,Object.assign({},{itemLayout:b,columnLayout:h,itemSize:d,listType:n,index:c}),m):k.createElement(e.SimpleListItemContainer,Object.assign({},{itemLayout:b,columnLayout:h,itemSize:d,listType:n}),m):m;return{kind:c.ItemKind.Simple,containerKind:this.containerKind,props:{kind:null!=a.flexGrow&&0!==a.flexGrow?
e.ItemContainerKind.verticalDynamic:e.ItemContainerKind.vertical,dataWidget:e.DataWidget.VerticalList,noMargin:!0},createItemElement:(b)=>{let f=0;const v={itemLayout:a.itemLayout,columnLayout:h,listType:n,itemSize:d,requestAdditionalItems:()=>this.callHandler.call(()=>{var b;return null===(b=a.requestAdditionalItems)||void 0===b?void 0:b.call(a)}),flexGrow:a.flexGrow,isOnPopup:this.containerKind===c.ContainerKind.popup,progress:null==a.progress?e.ListProgress.finished:a.progress,id:a.id,onReorderStart:a.onReorderStart,
onReorderEnd:a.onReorderEnd,showTimeline:a.showTimeline,noMargin:a.noMargin,animate:a.animate,currentScrollIntoViewIds:b.currentScrollIntoViewIds,items:a.items.map((h,n,v)=>{v=0===n?null:v[n-1].addAfterActions;var w=h.addAfterActions,l=(d,f)=>{const h=`${a.id}-${n}-${d}`;return{forceVisible:0<=b.popupIds.indexOf(`${h}-popup`),element:this.buttonUi.menuButton(()=>({id:h,content:{icon:c.IconSmallId.Plus},actions:g.mapActionsToMenuItemUIDescription(f,this.callHandler,this.popupController),color:c.ButtonColor.Blue,
shape:c.ButtonShape.Circle,popupPosition:"right"})).createButtonReactElement({key:d,popupIds:b.popupIds,parentIds:b.parentIds,currentScrollIntoViewIds:b.currentScrollIntoViewIds},0,c.ButtonSize.Small)}};const F={index:n,showTitle:a.showTitle,title:h.title,titlePostfix:h.titlePostfix,itemSize:d,multiline:null!=a.multilineTitle?a.multilineTitle:a.itemLayout===c.ListItemLayout.dynamic,addBeforeGhost:null!=v&&0<v.length?l("before-ghost",null):null,addBeforeButton:null!=v&&0<v.length?l("before-button",
v):null,addAfterGhost:null!=w&&0<w.length?l("after-ghost",null):null,addAfterButton:null!=w&&0<w.length?l("after-button",w):null};v=f;w=h.height;f=l=null==w||null==v?null:v+w;return{id:h.id,top:v,height:w,bottom:l,createElement:(d)=>k.createElement(e.ListItemWithTitle,Object.assign({key:this.getListItemKey(h,n)},F),m(n,h.createReactElement({popupIds:b.popupIds,reorderCallbacks:d,showTitle:!a.showTitle})))}})};return k.createElement(e.VerticalList,Object.assign({},v))}}}simpleList(a){const b=a(this.simpleUi);
return this.verticalListI({itemType:b.itemType,flexGrow:b.flexGrow,requestAdditionalItems:b.requestAdditionalItems,progress:b.progress,showTitle:b.showTitle,multilineTitle:b.multilineTitle,itemLayout:b.itemLayout,id:b.id,onReorderStart:null,onReorderEnd:null,showTimeline:!1,needItemContainer:!0,noMargin:!1,items:b.items.map((a)=>({key:a.key,title:a.title,titlePostfix:a.titlePostfix,id:a.id,height:null,createReactElement:(d)=>a.createReactElement({popupIds:d.popupIds,reorderCallbacks:d.reorderCallbacks,
activeId:b.activeId,showTitle:!b.showTitle}),addAfterActions:[]})),animate:!1})}multiSelectList(a){const b=a(this.multiUi),d=b.items.map((a)=>a.id);return this.verticalListI({itemType:b.itemType,flexGrow:b.flexGrow,requestAdditionalItems:b.requestAdditionalItems,progress:b.progress,showTitle:b.showTitle,multilineTitle:b.multilineTitle,itemLayout:b.itemLayout,id:b.id,onReorderStart:null,onReorderEnd:null,showTimeline:!1,needItemContainer:!0,noMargin:!1,items:b.items.map((a)=>({key:a.key,title:a.title,
titlePostfix:a.titlePostfix,id:a.id,height:null,createReactElement:(c)=>a.createReactElement({popupIds:c.popupIds,reorderCallbacks:c.reorderCallbacks,selectedIds:b.selectedIds,allIds:d,onSelectionChange:b.onSelectionChange,onDrop:b.onDrop,preziDataMimeParams:b.preziDataMimeParams,showTitle:!b.showTitle}),addAfterActions:[]})),animate:!1})}timelineList(a){var b;const d=a(this.timelineUi);return this.verticalListI({itemType:c.ListItemType.full,flexGrow:1,requestAdditionalItems:null,progress:null,showTitle:!1,
multilineTitle:null,itemLayout:c.ListItemLayout.dynamic,id:d.id,onReorderStart:null==d.onReorderStart?null:(a)=>this.callHandler.call(()=>d.onReorderStart({fromIndex:a})),onReorderEnd:null==d.onReorderEnd?null:(a,b,c)=>this.callHandler.callWithUAT((f)=>d.onReorderEnd(f,{fromIndex:a,count:b,toIndex:c})),showTimeline:!0,needItemContainer:!1,noMargin:!0,items:d.items.map((a)=>({key:a.key,title:a.title,titlePostfix:a.titlePostfix,id:a.id,height:a.height,createReactElement:(b)=>a.createReactElement({popupIds:b.popupIds,
reorderCallbacks:b.reorderCallbacks,activeId:d.activeId,showTimeline:!0,secondaryActiveId:d.secondaryActiveId,showTitle:!0}),addAfterActions:[]})),animate:null!==(b=d.animate)&&void 0!==b?b:!1})}getListItemKey(a,b){return[b,null===a||void 0===a?void 0:a.key].filter((a)=>null!=a).join("-")}};G.ExtendedDialogUIImpl=class extends G.BaseUIImpl{constructor(a,b,d,c,h,e,m,g,k){super(a,b,d,c,h,e,m,g);this.dialogRowUI=k}dialogItemRow(a){var b;const d=a(this.dialogRowUI),f={[c.DialogItemRowLayout.medium_1_1]:[e.DialogItemCellWidth.single,
e.DialogItemCellWidth.single],[c.DialogItemRowLayout.medium_1_small_1]:[e.DialogItemCellWidth.singleSmaller,e.DialogItemCellWidth.tiny,e.DialogItemCellWidth.singleSmaller],[c.DialogItemRowLayout.medium_2]:[e.DialogItemCellWidth.double],[c.DialogItemRowLayout.extraLarge_1_1_1]:[e.DialogItemCellWidth.single,e.DialogItemCellWidth.single,e.DialogItemCellWidth.single],[c.DialogItemRowLayout.extraLarge_big_small_big]:[e.DialogItemCellWidth.oneAndHalf,e.DialogItemCellWidth.tiny,e.DialogItemCellWidth.oneAndHalf],
[c.DialogItemRowLayout.extraLarge_1_2]:[e.DialogItemCellWidth.single,e.DialogItemCellWidth.double],[c.DialogItemRowLayout.extraLarge_2_1]:[e.DialogItemCellWidth.double,e.DialogItemCellWidth.single],[c.DialogItemRowLayout.extraLarge_3]:[e.DialogItemCellWidth.triple]},h={backgroundColor:d.backgroundColor?d.backgroundColor:"#ffffff",hasBottomBorder:d.hasBottomBorder,verticalAlignment:null!==(b=d.verticalAlignment)&&void 0!==b?b:c.DialogItemRowVerticalAlignment.center};return{kind:c.ItemKind.Container,
containerKind:this.containerKind,props:this.horizontalNoMargin(e.DataWidget.DialogItemRow),createItemElement:(a)=>k.createElement(e.DialogItemRow,Object.assign({},h),d.items.map((b,c)=>k.createElement(e.DialogItemCell,{width:f[d.layout][c],key:c},g.wrapIntoItemContainer(c,b.props,b.createItemElement(a)))))}}};var fa={};Object.defineProperty(fa,"__esModule",{value:!0});fa.DialogCreatorImpl=class{constructor(a,b,d){this.dialogManager=a;this.applicationUI=b;this.buttonUI=d}alert(a){a=a(this.applicationUI.alertDialog);
a=this.createDialogItem(e.DialogType.small,a.id,a.title,null,[this.applicationUI.alertDialog.label(a.description)],a.onOpen,a.onClose,null,null,null,null!=a.footer?a.footer(this.buttonUI):null,a.hideOverlay,a.height,a.caution);this.applicationUI.dialogItems.set(a.id,a)}extraLarge(a){a=a(this.applicationUI.extraLargeDialog);a=this.createDialogItem(e.DialogType.extraLarge,a.id,a.title,a.subtitle,a.content,a.onOpen,a.onClose,a.onCloseButtonClicked,a.onBackButtonClicked,a.header,null!=a.footer?a.footer(this.buttonUI):
null,a.hideOverlay,a.height,a.caution);this.applicationUI.dialogItems.set(a.id,a)}extraExtraLarge(a){a=a(this.applicationUI.extraExtraLargeDialog);a=this.createDialogItem(e.DialogType.extraExtraLarge,a.id,a.title,a.subtitle,a.content,a.onOpen,a.onClose,a.onCloseButtonClicked,a.onBackButtonClicked,a.header,null!=a.footer?a.footer(this.buttonUI):null,a.hideOverlay,a.height,a.caution);this.applicationUI.dialogItems.set(a.id,a)}large(a){a=a(this.applicationUI.largeDialog);a=this.createDialogItem(e.DialogType.large,
a.id,a.title,a.subtitle,a.content,a.onOpen,a.onClose,a.onCloseButtonClicked,a.onBackButtonClicked,a.header,null!=a.footer?a.footer(this.buttonUI):null,a.hideOverlay,a.height,a.caution);this.applicationUI.dialogItems.set(a.id,a)}medium(a){a=a(this.applicationUI.mediumDialog);a=this.createDialogItem(e.DialogType.medium,a.id,a.title,a.subtitle,a.content,a.onOpen,a.onClose,a.onCloseButtonClicked,a.onBackButtonClicked,a.header,null!=a.footer?a.footer(this.buttonUI):null,a.hideOverlay,a.height,a.caution);
this.applicationUI.dialogItems.set(a.id,a)}small(a){a=a(this.applicationUI.smallDialog);a=this.createDialogItem(a.align===c.DialogAlign.center?e.DialogType.small:e.DialogType.corner,a.id,a.title,null,a.content,a.onOpen,a.onClose,a.onCloseButtonClicked,a.onBackButtonClicked,a.header,null!=a.footer?a.footer(this.buttonUI):null,a.hideOverlay,a.height,a.caution);this.applicationUI.dialogItems.set(a.id,a)}createDialogItem(a,b,d,f,h,n,m,v,w,l,F,t,q,p){const ra=null==F?null:[this.applicationUI.largeDialog.button(c.ButtonSize.Large,
c.ButtonAlign.End,()=>F)],r=null!=v?()=>{v();this.dialogManager.hide(b)}:null;return{id:b,title:d,hideOverlay:t,onOpen:()=>{null!=n&&this.applicationUI.callHandler.call(()=>n())},onClose:()=>{null!=m&&this.applicationUI.callHandler.call(()=>m())},createReactElement:(c)=>k.createElement(e.Dialog,{key:`${c.key}-${b}`,title:d,subtitle:f,dialogType:a,onClose:r,onBack:w,header:null!=l?g.createItemContainers(l,c.popupIds,c.currentScrollIntoViewIds):null,footer:null!=ra?g.createItemContainers(ra,c.popupIds,
c.currentScrollIntoViewIds):null,caution:p,height:q},g.createItemContainers(h,c.popupIds,c.currentScrollIntoViewIds))}}};var I={extractAction:function(a){if("action"in a){const b=a.action.args;return{onClick:(a)=>b.onExecute(a,c.ActionTrigger.Mouse),title:null!=b.shortcut.title?b.shortcut.title():null,icon:null!=b.shortcut.icon?b.shortcut.icon():null,tooltip:null!=b.shortcut.tooltip?b.shortcut.tooltip():null,enabled:b.enabled,shortcut:b.shortcut}}return a}};Object.defineProperty(I,"__esModule",{value:!0});
I.ShortcutActionImpl=class{constructor(a){this.args=a}};var ha={};Object.defineProperty(ha,"__esModule",{value:!0});ha.PropertyBarUIImpl=class{constructor(a,b,d,c,h,e,m,g){this.callHandler=a;this.pluginEnabled=b;this.colorGridProvider=d;this.popupController=c;this.popupManager=h;this.popupUi=e;this.buttonUi=m;this.maybeEditorSession=g}formatToolTip(a){var b=a.shortcut;a=a.tooltip;b=null==b||null==b.key?null:(b.alt?U.PreziUAParser.getAltKeyOnPlatform():"")+(b.shift?U.PreziUAParser.getShiftKeyOnPlatform():
"")+(b.osCmd?U.PreziUAParser.getCmdKeyOnPlatform():"")+(b.ctrl?U.PreziUAParser.getCtrlKeyOnPlatform():"")+String.fromCharCode(b.key).toUpperCase();return null==a&&null==b?null:null!=a&&null==b?a:null==a&&null!=b?b:`${a} (${b})`}button(a){return this.toggle(Object.assign(Object.assign({},a),{pushed:!1}))}toggle(a){const b=I.extractAction(a),d=b.onClick?()=>this.callHandler.callWithUAT(b.onClick):()=>{};return{weight:a.weight,groupWeight:a.groupWeight,id:a.id,createReactElement:(c)=>k.createElement(e.NormalButton,
{id:a.id,key:c.key,buttonColor:e.ExtendedButtonColor.Transparent,size:e.ExtendedButtonSize.PropertyBar,content:{icon:b.icon,text:b.title},onClick:d,disabled:!this.isEnabled(b.enabled),tooltipText:this.formatToolTip(b),pushed:a.pushed,minTextWidthPx:null}),containerKind:c.ContainerKind.propertybar}}repeatButton(a){const b=null==a.onDown?null:()=>this.callHandler.callWithUAT(a.onDown),d=null==a.onRepeat?null:()=>this.callHandler.callWithUAT(a.onRepeat),f=null==a.onUp?null:()=>this.callHandler.callWithUAT(a.onUp);
return{weight:a.weight,groupWeight:a.groupWeight,id:a.id,createReactElement:(c)=>k.createElement(e.NormalButton,{id:a.id,key:c.key,buttonColor:e.ExtendedButtonColor.Transparent,size:e.ExtendedButtonSize.PropertyBar,content:{text:a.title,icon:a.icon},disabled:!this.isEnabled(a.enabled),tooltipText:this.formatToolTip({tooltip:a.tooltip}),repeatClick:!0,onDown:b,onRepeat:d,onUp:f,minTextWidthPx:null}),containerKind:c.ContainerKind.propertybar}}colorPicker(a){const b=a.id+"-popupOpener-popup",d=()=>this.popupManager.togglePopup(a.id),
f=null!=a.onChange?(b,d,c,f)=>this.callHandler.callWithUAT((h)=>a.onChange(h,{newFill:b,fills:d,source:c,isFinal:f})):()=>{};return{weight:a.weight,groupWeight:a.groupWeight,id:a.id,createReactElement:(c)=>{this.popupManager.registerPopup(a.id,b,c.parentIds);const h=this.colorGridProvider.getColorGrids(null==a.customColors?[]:a.customColors,!1!==a.showThemeColors);return k.createElement(e.ColorPickerButton,{id:a.id,disabled:!this.isEnabled(a.enabled),title:a.title,icon:a.icon,expanded:!0,fills:a.fills,
onChange:f,onColorButtonClick:d,onColorpickerDropdownClick:(a)=>{var d;this.popupController.togglePopup(a,[...null!==(d=c.parentIds)&&void 0!==d?d:[],b])},showPopup:-1!==c.popupIds.indexOf(`${a.id}-popupOpener-popup`),openedPopupIds:c.popupIds,parentIds:c.parentIds,colorGrids:G.BaseUIImpl.createColorGridsFromColorGridArgss(c,h,this.callHandler,this.buttonUi),showColorWheel:a.showColorWheel,snapshotRenderer:this.maybeEditorSession.hasValue()?this.maybeEditorSession.value.snapshotRenderer:null,isOverlayColorPicker:a.isOverlayColorPicker,
colorButtonTooltipProps:a.colorButtonTooltipProps,popupPosition:"bottom",popupAlignment:"left",hidePopupPointer:!0,size:e.ExtendedButtonSize.PropertyBar,currentScrollIntoViewIds:c.currentScrollIntoViewIds,onOpened:a.onOpen})},containerKind:c.ContainerKind.propertybar}}popupButton(a){return this.togglePopupButton((b)=>Object.assign(Object.assign({},a(b)),{pushed:!1}))}togglePopupButton(a){const b=a(this.popupUi),d=b.id+"-popupOpener-popup",f=()=>this.popupManager.togglePopup(b.id);return{weight:b.weight,
groupWeight:b.groupWeight,id:b.id,createReactElement:(a)=>{this.popupManager.registerPopup(b.id,d,a.parentIds);return k.createElement(e.PopupButton,{id:b.id,key:a.key,buttonColor:e.ExtendedButtonColor.Transparent,size:e.ExtendedButtonSize.PropertyBar,content:b.content,disabled:!this.isEnabled(!b.disabled),onClick:f,popupIds:a.popupIds,parentIds:a.parentIds,currentScrollIntoViewIds:a.currentScrollIntoViewIds,alignment:null,tooltipText:b.tooltipText,tooltipPosition:b.tooltipPosition,popupHeader:g.mapToCreateReactElement(b.popupHeader),
popupContent:g.mapToCreateReactElement(b.popupContent),popupFooter:g.mapToCreateReactElement(b.popupFooter),dataLookup:b.id,popupHeight:b.popupHeight?b.popupHeight:c.PopupHeight.Full,showArrow:b.showArrow,hidePopupPointer:!0,popupAlignment:"left",popupPosition:"bottom",onOpened:b.onOpen,minTextWidthPx:null,pushed:b.pushed})},containerKind:c.ContainerKind.propertybar}}comboButton(a){return this.toggleComboButton((b)=>Object.assign(Object.assign({},a(b)),{pushed:!1}))}toggleComboButton(a){const b=a(this.popupUi),
d=b.id+"-popupOpener-popup",f=()=>this.popupManager.togglePopup(b.id);return{weight:b.weight,groupWeight:b.groupWeight,id:b.id,createReactElement:(a)=>{this.popupManager.registerPopup(b.id,d,a.parentIds);return k.createElement(e.ComboButton,{key:a.key,id:b.id,buttonColor:e.ExtendedButtonColor.Transparent,popupIds:a.popupIds,parentIds:a.parentIds,currentScrollIntoViewIds:a.currentScrollIntoViewIds,hidePopupPointer:!0,alignment:"left",popupHeight:b.popupHeight?b.popupHeight:c.PopupHeight.Full,content:b.content,
size:e.ExtendedButtonSize.PropertyBar,disabled:b.disabled,onDropdownClick:f,onButtonClick:()=>this.callHandler.callWithUAT((a)=>b.onClick(a)),popupHeader:g.mapToCreateReactElement(b.popupHeader),popupContent:g.mapToCreateReactElement(b.popupContent),popupFooter:g.mapToCreateReactElement(b.popupFooter),dataLookup:b.id,tooltipText:b.tooltipText,tooltipPosition:b.tooltipPosition,onOpened:b.onOpen,pushed:b.pushed})},containerKind:c.ContainerKind.propertybar}}submenu(a){const b=a.id+"-popupOpener-popup",
d=()=>this.popupManager.togglePopup(a.id),f=null==a.items?null:a.items.map((a)=>{var b;if(a===c.SubmenuSeparatorConst)return a;const d=I.extractAction(a);return Object.assign(Object.assign({},a),{pushed:null!==(b=a.pushed)&&void 0!==b?b:!1,onClick:()=>this.callHandler.callWithUAT((b)=>a.onClick(b)),enabled:this.isEnabled(d.enabled)})});return{weight:a.weight,groupWeight:a.groupWeight,id:a.id,createReactElement:(c)=>{this.popupManager.registerPopup(a.id,b,c.parentIds);return k.createElement(e.SubmenuButton,
{key:c.key,id:a.id,buttonColor:e.ExtendedButtonColor.Transparent,size:e.ExtendedButtonSize.PropertyBar,popupIds:c.popupIds,parentIds:c.parentIds,content:{text:a.title,icon:a.icon},disabled:"enabled"in a?!a.enabled:!1,onDropdownClick:d,actions:f,dataLookup:a.id,tooltipText:a.tooltip,showArrow:!0,popupPosition:"bottom",popupAlignment:"left"})},containerKind:c.ContainerKind.propertybar}}dropdownMenu(a){return this.dropdownMenuI(a,null)}editableDropdownMenu(a){const b=null==a.onEnter?null:()=>this.callHandler.callWithUAT(a.onEnter),
d=null==a.onValueChange?null:(b)=>this.callHandler.callWithUAT((d)=>a.onValueChange(d,b)),c=null==a.onFocusLost?null:()=>this.callHandler.callWithUAT(a.onFocusLost);return this.dropdownMenuI(a,()=>k.createElement(e.MenuButtonInputComponent,{dataLookup:"dropdown-input",disabled:null!=a.enabled&&!a.enabled,readonly:!1,autofocus:a.autofocus,maxLength:a.maxLength,onEnter:b,onValueChange:d,placeholderText:null,rows:null,selectOnFocus:a.selectOnFocus,type:"text",value:a.title,size:e.ExtendedButtonSize.PropertyBar,
stopOnClick:!0,onFocusLost:c}))}dropdownMenuI(a,b){const d=a.id+"-popupOpener-popup",f=()=>{this.popupManager.togglePopup(a.id);null!=a.onOpen&&this.popupController.isPopupOpen(d)&&this.callHandler.call(a.onOpen)};return{weight:a.weight,groupWeight:a.groupWeight,id:a.id,createReactElement:(c)=>{this.popupManager.registerPopup(a.id,d,c.parentIds);var h=-1!==c.popupIds.indexOf(d);h=null!=b&&h?b():null;return k.createElement(e.MenuButton,{id:a.id,key:c.key,buttonColor:e.ExtendedButtonColor.Transparent,
size:e.ExtendedButtonSize.PropertyBar,popupIds:c.popupIds,parentIds:c.parentIds,hidePopupPointer:!0,content:{text:a.title,icon:a.icon},disabled:null!=a.enabled&&!a.enabled,popupPosition:"bottom",popupAlignment:"left",onDropdownClick:f,overlayComponent:h,actions:g.mapActionsToMenuItemUIDescription(a.items,this.callHandler,this.popupController),dataLookup:a.id,tooltipText:a.tooltip,showArrow:!0,minTextWidthPx:a.minTextWidthPx})},containerKind:c.ContainerKind.propertybar}}toolSwitch(a){const b=a.onClick?
(b,c)=>this.callHandler.callWithUAT((b)=>{a.onClick(b,c)}):()=>{};return{weight:a.weight,groupWeight:a.groupWeight,id:a.id,createReactElement:()=>k.createElement(e.ToolSwitch,{onClick:b,id:a.id,leftTooltipText:a.leftTooltipText,rightTooltipText:a.rightTooltipText,leftIcon:a.leftIcon,rightIcon:a.rightIcon,activeSide:a.activeSide}),containerKind:c.ContainerKind.propertybar}}isEnabled(a){return this.pluginEnabled&&!1!==a}};var Y={};Object.defineProperty(Y,"__esModule",{value:!0});Y.ApplicationUIImpl=
class{constructor(a,b,d,f,h,e,m,g,k,l,F,t){this.callHandler=a;this.closeContextMenu=d;this.pluginEnabled=f;this.shortcutDefintions=F;this.newSidebarArgs=new Map;this.newSpotlightArgs=new Map;this.dropDownMenuItems=[];this.tabMenuItems=[];this.contextMenuItems=[];this.propertyBarItems=[];this.navigationBarItems=[];this.registeredShortcutActions=[];this.dialogItems=new Map;this.colorGrids=[];this.createBaseUI=(d)=>u.wrapIntoKillable(new G.BaseUIImpl(d,b,a,h,g,l,t,this.createBaseUI));d=(d)=>u.wrapIntoKillable(new G.ExtendedDialogUIImpl(d,
b,a,h,g,l,t,this.createBaseUI,this.dialogRow));this.popup=this.createBaseUI(c.ContainerKind.popup);this.sidebar=this.createBaseUI(c.ContainerKind.sidebar);this.leftSidebar=this.createBaseUI(c.ContainerKind.leftSidebar);this.dialogRow=this.createBaseUI(c.ContainerKind.dialogRow);this.alertDialog=this.createBaseUI(c.ContainerKind.alertDialog);this.smallDialog=this.createBaseUI(c.ContainerKind.smallDialog);this.mediumDialog=d(c.ContainerKind.mediumDialog);this.largeDialog=this.createBaseUI(c.ContainerKind.largeDialog);
this.extraLargeDialog=d(c.ContainerKind.extraLargeDialog);this.extraExtraLargeDialog=d(c.ContainerKind.extraExtraLargeDialog);d=new X.ButtonUIImpl(this.popup,a,h,b);this.propertybar=u.wrapIntoKillable(new ha.PropertyBarUIImpl(a,f,g,h,m,this.popup,d,l));this.dialog=u.wrapIntoKillable(new fa.DialogCreatorImpl(e,this,d))}kill(){this.sidebar.kill();this.leftSidebar.kill();this.alertDialog.kill();this.smallDialog.kill();this.mediumDialog.kill();this.largeDialog.kill();this.extraLargeDialog.kill();this.popup.kill();
this.propertybar.kill();this.dialog.kill()}createSidebar(a,b){this.newSidebarArgs.set(a,()=>{const a=u.asKillable(this.createBaseUI(c.ContainerKind.sidebar),(a)=>b(a));return null==a?null:Object.assign(Object.assign({},a),{onOpen:Q(a.onOpen),onClose:Q(a.onClose),onPageBack:Q(a.onPageBack),onCloseButtonClicked:Q(a.onCloseButtonClicked)})})}createLeftSidebar(a){a=a(this.leftSidebar);null!=a&&(this.newLeftSidebarArgs=Object.assign(Object.assign({},a),{onPageBack:Q(a.onPageBack)}))}getDialogItems(){return this.dialogItems}createPropertyBarItem(a){a=
a(this.propertybar);this.propertyBarItems.push(a)}createNavigationBarItem(a){a=a(this.propertybar);this.navigationBarItems.push(a)}createColorGrid(a){this.colorGrids.push(a)}spotlight(a){const b=(a)=>{const b=a.callout;return Object.assign(Object.assign({},a),{around:"uiElementId"in a.around?{uiElementSelector:`[data-lookup="${a.around.uiElementId}"]`}:"preziElementId"in a.around?{canvasElementId:a.around.preziElementId}:"virtualElementId"in a.around?{virtualElementId:a.around.virtualElementId}:r.Utils.assertNever(a.around),
callout:b&&Object.assign(Object.assign({},b),{onClose:"onClose"in b&&null!=b.onClose?()=>this.callHandler.callWithUAT(b.onClose):void 0,buttons:"buttons"in b&&null!=b.buttons?b.buttons.map((a)=>Object.assign(Object.assign({},a),{onClick:()=>this.callHandler.callWithUAT(a.onClick)})):void 0})})},d=a.overlay?a.overlay.holes.map((a)=>b(a)):null,c=a.highlights?a.highlights.map((a)=>b(Object.assign(Object.assign({},a),{strict:!0}))):null;this.newSpotlightArgs.set(a.id,Object.assign(Object.assign({},a),
{overlay:a.overlay?Object.assign(Object.assign({},a.overlay),{holes:d}):null,highlights:c,onClose:()=>{}}))}createTopMenuItem(a,b){const d=(a)=>{switch(a.kind){case c.MenuItemKind.largeMenu:return{title:a.title,icon:a.icon,tooltip:a.tooltip,fills:a.fills,kind:c.MenuItemKind.largeMenu,categoryWeight:a.categoryWeight,id:a.id,weight:a.weight,enabled:!0,items:a.items.map((a)=>d(a))};case c.MenuItemKind.largeButton:{const b=I.extractAction(a),d=this.pluginEnabled&&(null==b.enabled||b.enabled);return Object.assign(Object.assign({},
b),{onClick:b.onClick?()=>this.callHandler.callWithUAT(b.onClick):()=>{},color:this.colorFromNamedColor(a.color),kind:c.MenuItemKind.largeButton,defaultSelected:a.defaultSelected,categoryWeight:a.categoryWeight,id:a.id,weight:a.weight,enabled:d&&("enabled"in a?a.enabled:!0)})}}};switch(b.kind){case c.MenuItemKind.largeMenu:this.tabMenuItems=[...this.tabMenuItems,{parent:a,child:d(b)}];break;case c.MenuItemKind.largeButton:this.tabMenuItems=[...this.tabMenuItems,{parent:a,child:d(b)}];break;default:r.Utils.assertNever(b,
`invalid menuitem kind ${b}`)}}createMenuItem(a){switch(a.kind){case c.MenuItemKind.dropdownDivider:this.dropDownMenuItems=[...this.dropDownMenuItems,Object.assign(Object.assign({},a),{enabled:!0})];break;case c.MenuItemKind.context:{const b=I.extractAction(a);this.contextMenuItems=[...this.contextMenuItems,Object.assign(Object.assign(Object.assign({},a),b),{enabled:this.pluginEnabled&&(null==b.enabled||b.enabled),onClick:(a,c)=>{null!=b.onClick&&this.callHandler.callWithUAT((d)=>b.onClick(d,{stageX:a,
stageY:c}));this.closeContextMenu()}})];break}case c.MenuItemKind.dropdown:{const b=I.extractAction(a),d=this.pluginEnabled&&(null==b.enabled||b.enabled);this.dropDownMenuItems=[...this.dropDownMenuItems,Object.assign(Object.assign(Object.assign({},a),b),{enabled:d,onClick:b.onClick?()=>this.callHandler.callWithUAT(b.onClick):()=>{}})];break}default:r.Utils.assertNever(a,`invalid menuitem kind ${a}`)}}colorFromNamedColor(a){if(null==a)return null;switch(a){case c.NamedColors.topicButton:return"#1aa651";
default:r.Utils.assertNever(a)}}createAction(a){if(!Object.keys(this.shortcutDefintions||{}).some((b)=>this.shortcutDefintions[b]===a.shortcut))throw Error(`Unregistered shortcut: ${JSON.stringify(a.shortcut)}`);const b=new I.ShortcutActionImpl(a);this.registeredShortcutActions.push(b);return b}};var ia={};Object.defineProperty(ia,"__esModule",{value:!0});ia.MessageHandlerImpl=class{constructor(){this.messageQueue=[];this.messageProcessors=new Map}registerMessageProcessor(a,b){this.messageProcessors.set(a.name,
b);this.processPendingMessages()}unregisterMessageProcessor(a){this.messageProcessors.delete(a.name)}sendMessage(a,b){this.enqueueMessage("object"===typeof b&&"uat"in b?g.createCallWithMat(b.uat):null,a,b);this.processPendingMessages()}enqueueMessage(a,b,d){this.messageQueue.push({callWithMat:a,pluginDescription:b,message:d})}processPendingMessages(){window.setTimeout(()=>{const a=[];for(let b of this.messageQueue){const d=this.getMessageProcessor(b.pluginDescription.name);null!=d?null==b.callWithMat?
d.processMessage(b.message):b.callWithMat((a)=>{const c=Object.assign({},b.message);delete c.uat;c.mat=a;d.processMessage(c)}):a.push(b)}this.messageQueue=a},0)}getMessageProcessor(a){return this.messageProcessors.get(a)}};var J={};Object.defineProperty(J,"__esModule",{value:!0});J.UIContainer=class extends k.Component{constructor(){super(...arguments);this.unsubscribe=null;this.state={content:null};this.nextState=null}shouldComponentUpdate(a,b){return!(this.props.id===a.id&&this.props.contentStream===
a.contentStream&&r.Utils.arrayEquals(this.props.popupIds,a.popupIds)&&r.Utils.shallowCompare(this.state,b))}componentDidMount(){null!=this.props.contentStream&&(this.unsubscribe=this.filterStream(this.props.contentStream,this.props.id).onValue((a)=>{null==this.nextState&&r.Utils.callAtEndOfFrame(()=>{const a=this.nextState;this.nextState=null;this.setState(a)});this.nextState={content:a}}))}filterStream(a,b){return a.filter((a)=>null!=a&&a.id===b)}componentWillReceiveProps(a){if(a.contentStream!==
this.props.contentStream||a.id!==this.props.id)null!=this.unsubscribe&&this.unsubscribe(),null!=a.contentStream&&(this.unsubscribe=this.filterStream(a.contentStream,a.id).onValue((a)=>{this.setState({content:a})}))}componentWillUnmount(){null!=this.unsubscribe&&this.unsubscribe()}render(){return k.createElement("div",{style:{height:"100%",width:"100%"},"data-lookup":this.props.id},this.state.content&&this.state.content.createReactElement({popupIds:this.props.popupIds,parentIds:null,currentScrollIntoViewIds:this.props.currentScrollIntoViewIds}))}};
J.UIContainer.displayName="UIContainer";var ja={};Object.defineProperty(ja,"__esModule",{value:!0});ja.DialogManagerImpl=class{constructor(a,b){this.dialogController=a;this.isEnabled=b;this.currentDialogProps={kind:x.DialogKind.None};this._dialogItems=new Map;this._iframeItems=new Map;this.modalContentBus=K.Bacon.newBus();this.modalContentProperty=this.modalContentBus.toProperty(null);this.modalContentProperty.onValue(()=>{})}getDialogItem(a){const b=this._dialogItems.get(a.id);return null!=b?b:this._iframeItems.get(a.id)}setDialogItems(a){this._dialogItems=
a;this.currentDialogProps.kind===x.DialogKind.Custom&&(null==this.getDialogItem(this.currentDialogProps)?this.hide(this.currentDialogProps.id):this.refreshModalContent())}handleStop(){this.currentDialogProps.kind!==x.DialogKind.None&&this.closeUnchecked(this.currentDialogProps)}showBuiltIn(a,b){if(this.isEnabled()){if(null==a)throw Error("dialogID should not be null");this.currentDialogProps={kind:x.DialogKind.Builtin,id:a,isModal:!0,onClose:b};this.dialogController.openDialog(this.currentDialogProps)}}hideBuiltIn(a){if(this.isEnabled()){if(null==
a)throw Error("dialogID should not be null");this.closeUnchecked({kind:x.DialogKind.Builtin,id:a})}}show(a){if(this.isEnabled()){var b={kind:x.DialogKind.Custom,id:a};a=this.getDialogItem(b);if(null!=a){b=Object.assign(Object.assign({},b),{isModal:!a.hideOverlay});var d=this.currentDialogProps;this.currentDialogProps=b;this.refreshModalContent();if(!x.dialogPropsEq(d,b)&&(this.dialogController.openDialog(b),a.onOpen))a.onOpen()}}}hide(a){this.isEnabled()&&this.closeUnchecked({kind:x.DialogKind.Custom,
id:a})}showIframe(a,b=null,d=c.DialogType.full,f=null,h=null,n=null){if(!this.isEnabled())return null;const c="iframe_"+Math.random().toString(16),g=()=>{this.hide(c)};this._iframeItems.set(c,{id:c,title:"",hideOverlay:!1,onOpen:f,onClose:h,createReactElement:()=>k.createElement(e.IFrameDialog,{dialogType:d,title:b,onClose:g,src:a,height:n})});this.show(c);return c}closeUnchecked(a){this.currentDialogProps.kind!==x.DialogKind.None&&x.dialogIdEq(this.currentDialogProps,a)&&(this.dialogController.closeDialog(a),
this.currentDialogProps={kind:x.DialogKind.None})}onCloseDialog(a){if(x.dialogIdEq(this.currentDialogProps,a))switch(a.kind){case x.DialogKind.Custom:a=this.getDialogItem(a);if(null!=a&&null!=a.onClose)a.onClose();this.currentDialogProps={kind:x.DialogKind.None};this.refreshModalContent();break;case x.DialogKind.Builtin:if(this.currentDialogProps.kind===x.DialogKind.Builtin&&null!=this.currentDialogProps.onClose)this.currentDialogProps.onClose();this.currentDialogProps={kind:x.DialogKind.None};break;
default:r.Utils.assertNever(a)}}onRender(a,b,d){return this.isEnabled()?null!=this.getDialogItem(a)?(a={id:a.id,contentStream:this.modalContentProperty,popupIds:b,currentScrollIntoViewIds:d},k.createElement(e.DialogOverlay,{hideOverlay:this.currentDialogProps.kind===x.DialogKind.Custom?this.getDialogItem(this.currentDialogProps).hideOverlay:!1},k.createElement(J.UIContainer,Object.assign({},a)))):null:null}refreshModalContent(){if(this.currentDialogProps.kind===x.DialogKind.Custom){const a=this.getDialogItem(this.currentDialogProps);
this.modalContentBus.push({id:this.currentDialogProps.id,containerKind:c.ContainerKind.dialog,createReactElement:a.createReactElement})}else this.modalContentBus.push({id:null,containerKind:c.ContainerKind.dialog,createReactElement:()=>null})}};var ka={};Object.defineProperty(ka,"__esModule",{value:!0});ka.PopupManagerImpl=class{constructor(a){this.popupController=a;this.logger=E.LoggerModule.getLoggerManager().createLogger("PopupManagerImpl");this.registry=new Map}resetPopupRegistry(){this.registry.clear()}registerPopup(a,
b,d){this.registry.set(a,{popupId:b,parentIds:d})}closePopup(a){const b=this.registry.get(a);null==b?this.logger.error({object:"invalidClosePopup",action:"PopupManager",trigger:"machine",payload:{popupid:a}}):this.popupController.closePopup(b.popupId,b.parentIds)}openPopup(a){const b=this.registry.get(a);null==b?this.logger.error({object:"invalidOpenPopup",action:"PopupManager",trigger:"machine",payload:{popupid:a}}):this.popupController.openPopup(b.popupId,b.parentIds)}togglePopup(a){const b=this.registry.get(a);
null==b?this.logger.error({object:"invalidTogglePopup",action:"PopupManager",trigger:"machine",payload:{popupid:a}}):this.popupController.togglePopup(b.popupId,b.parentIds)}};var la={};Object.defineProperty(la,"__esModule",{value:!0});la.ServiceApiImpl=class{constructor(a,b){this.relativeUrlParts=a;this.pluginServiceProvider=b}access(a,b,d,c){return this.pluginServiceProvider.serviceAccess(a,this.buildUrl(b,d),c)}read(a,b,d){return this.pluginServiceProvider.serviceRead(a,this.buildUrl(b,d))}buildUrl(a,
b){a=`/${g.concatUrlParts(this.relativeUrlParts.concat(a))}`;if(null==b)return a;const d=Object.keys(b).map((a)=>`${a}=${encodeURIComponent(b[a])}`).join("&");return""===d?a:`${a}?${d}`}};var S={};Object.defineProperty(S,"__esModule",{value:!0});S.SidebarManagerImpl=class{constructor(a,b,d){this.sidebarController=a;this.isEnabled=b;this.callHandler=d;this.sidebarArgss=new Map;this.sidebarContentBus=K.Bacon.newBus();this.sidebarContentProperty=this.sidebarContentBus.toProperty(null);this.sidebarContentProperty.onValue(()=>
{})}setSidebarArgss(a){this.sidebarArgss=a;null!=this.currentSidebar&&(a=this.sidebarArgss.get(this.currentSidebar.id)(),null==a||null!=this.currentSidebar.pageId&&null==a.pages[this.currentSidebar.pageId]?this.close(this.currentSidebar.id):this.refreshSidebarContent())}handleStop(){null!=this.currentSidebar&&this.closeUnchecked(this.currentSidebar.id)}close(a){this.isEnabled()&&this.closeUnchecked(a)}closeUnchecked(a){null!=this.currentSidebar&&this.currentSidebar.id===a&&this.sidebarController.closeSidebar(a)}open(a,
b){var d;if(this.isEnabled()&&this.sidebarArgss.has(a)){var c=this.sidebarArgss.get(a)();if(null!=c&&(null==b||b in c.pages)){var h=null===(d=this.currentSidebar)||void 0===d?void 0:d.id;if(null!=h&&h!==a&&(d=this.sidebarArgss.get(this.currentSidebar.id)(),null!=d))d.onClose(this.currentSidebar.pageId);this.currentSidebar={id:a,pageId:b};this.refreshSidebarContent();h!==a&&(this.sidebarController.openSidebar(a),c.onOpen&&this.callHandler.call(()=>c.onOpen({pageId:b})))}}}toggle(a){null!=this.currentSidebar&&
this.currentSidebar.id===a?this.close(a):this.open(a)}onCloseSidebar(a){if(null!=this.currentSidebar&&a===this.currentSidebar.id){a=this.sidebarArgss.get(a)();if(null!=a)a.onClose(this.currentSidebar.pageId);this.currentSidebar=null;this.refreshSidebarContent()}}onRender(a,b,d){return this.isEnabled()&&null!=this.sidebarArgss.get(a)?k.createElement(J.UIContainer,Object.assign({},{id:a,contentStream:this.sidebarContentProperty,popupIds:b,currentScrollIntoViewIds:d})):null}refreshSidebarContent(){let a=
!1;if(null!=this.currentSidebar){const b=this.sidebarArgss.get(this.currentSidebar.id)();if(null!=b){a=!0;const d=this.currentSidebar.pageId,f=null!=d?b.pages[d]:b.root;this.sidebarContentBus.push({id:this.currentSidebar.id,containerKind:c.ContainerKind.sidebar,createReactElement:(a)=>{const c={id:null!=d?d:"sidebar-root-page",title:f.title,onClose:()=>{if(null!=b.onCloseButtonClicked)b.onCloseButtonClicked();this.close(this.currentSidebar.id)},disableClose:b.disableClose,onBack:null==d?null:()=>
{b.onPageBack(d);this.open(this.currentSidebar.id)},header:g.createItemContainers(f.header,a.popupIds,a.currentScrollIntoViewIds),footer:g.createItemContainers(f.footer,a.popupIds,a.currentScrollIntoViewIds)};return k.createElement(e.SidebarContent,Object.assign({key:a.key},c),g.createItemContainers(f.content,a.popupIds,a.currentScrollIntoViewIds))}})}}a||this.sidebarContentBus.push({id:null,containerKind:c.ContainerKind.sidebar,createReactElement:()=>null})}};S.LeftSidebarManagerImpl=class{constructor(a){this.isEnabled=
a;this.sidebarContentBus=K.Bacon.newBus();this.sidebarContentProperty=this.sidebarContentBus.toProperty(null);this.sidebarContentProperty.onValue(()=>{})}setSidebarArgs(a){this.sidebarArgs=a;if(null==this.sidebarArgs)this.currentPageId=null;else{if(null==this.sidebarArgs.pages||null==this.sidebarArgs.pages[this.currentPageId])this.currentPageId=null;this.refreshSidebarContent()}}onRender(a,b){return this.isEnabled()&&null!=this.sidebarArgs?k.createElement(J.UIContainer,Object.assign({},{id:"left-sidebar",
contentStream:this.sidebarContentProperty,popupIds:a,currentScrollIntoViewIds:b})):null}refreshSidebarContent(){if(null!=this.sidebarArgs){const a=null!=this.currentPageId?this.sidebarArgs.pages[this.currentPageId]:this.sidebarArgs.root;this.sidebarContentBus.push({id:"left-sidebar",containerKind:c.ContainerKind.sidebar,createReactElement:(b)=>{const d={id:null!=this.currentPageId?this.currentPageId:"sidebar-root-page",title:a.title,onClose:null,disableClose:!0,onBack:null,header:g.createItemContainers(a.header,
b.popupIds,b.currentScrollIntoViewIds),footer:g.createItemContainers(a.footer,b.popupIds,b.currentScrollIntoViewIds)};return k.createElement(e.SidebarContent,Object.assign({key:b.key},d),g.createItemContainers(a.content,b.popupIds,b.currentScrollIntoViewIds))}})}else this.sidebarContentBus.push({id:null,containerKind:c.ContainerKind.sidebar,createReactElement:()=>null})}};var ma={};Object.defineProperty(ma,"__esModule",{value:!0});ma.SpotlightManagerImpl=class{constructor(a,b){this.spotlightController=
a;this.enabled=b;this._spotlightArgss=new Map}set spotlightArgss(a){null==this.currentId||a.has(this.currentId)||this.close(this.currentId);this._spotlightArgss=a;a.has(this.currentId)&&this.refreshView()}close(a){this.enabled()&&this.closeUnchecked(a)}closeUnchecked(a){this.currentId===a&&null!=this.hideCallback&&this.hideCallback()}refreshView(){null!=this.currentId&&this.updateView(this.currentId,!1)}updateView(a,b){const d=this._spotlightArgss.get(a),c=null!=d;c&&(b&&this.close(this.currentId),
this.hideCallback=this.spotlightController.showSpotlight({id:a,overlay:d.overlay?{opacity:d.overlay.opacity,color:d.overlay.color,holes:d.overlay.holes}:null,highlights:d.highlights?d.highlights:null,onClose:()=>{this.hideCallback=this.currentId=null;d.onClose()}}));return c}open(a){this.enabled()&&this.updateView(a,!0)&&(this.currentId=a)}toggle(a){this.enabled()&&(this.currentId===a?this.close(a):this.open(a))}handleStop(){this.closeUnchecked(this.currentId)}};var N={};Object.defineProperty(N,"__esModule",
{value:!0});N.PluginApiDialogManagerImpl=class{constructor(a,b,d){this.dialogManager=a;this.isEnabled=b;this.errorDialogController=d}hide(a){this.isEnabled()&&this.dialogManager.hide(a)}hideBuiltIn(a){this.isEnabled()&&this.dialogManager.hideBuiltIn(a)}show(a){this.isEnabled()&&this.dialogManager.show(a)}showBuiltIn(a,b){this.isEnabled()&&this.dialogManager.showBuiltIn(a,b)}showIFrame(a){return this.isEnabled()?this.dialogManager.showIframe(a.url,a.title,a.size,a.onOpen,a.onClose,a.height):null}showBuiltInError(a,
b){this.isEnabled()&&this.errorDialogController.openErrorModal({errorCase:a,unclosable:b})}showError(a,b,d){this.isEnabled()&&this.errorDialogController.openErrorModal({errorCase:Aa.EditorErrorCase.PLUGIN_ERROR,unclosable:!1,customDialogContent:{titleTemplate:a,explanationTemplate:b,errorId:d}})}onCloseDialog(a){this.dialogManager.onCloseDialog(a)}setDialogItems(a){this.dialogManager.setDialogItems(a)}onRender(a,b,d){return this.dialogManager.onRender(a,b,d)}handleStop(){this.dialogManager.handleStop()}};
N.ApplicationApiImpl=class{constructor(a,b,d,f,h,e,g,k,w,l,F,t,q,p,r=M.emptySelectionInfo(),u=null,y,x,A,z,Ga,Ha,B,C,D,E,G,H,K,Ia,Ja,L,J){this.serviceMocks=a;this.callHandler=b;this.applicationController=d;this.contextMenuController=h;this.spotlightController=e;this.pluginServiceProvider=g;this.pluginDescription=k;this.plugin=w;this.fileInsertDialogProvider=l;this.networkStatus=F;this.panModeEnabled=t;this.currentTopic=q;this.applicationMode=p;this.selection=r;this.textSelectionInfo=u;this.popupController=
y;this.colorGridProvider=z;this.uiChanged=Ga;this.isDesktop=Ha;this.currentUserLicenseInformation=B;this.currentNavigationEvent=C;this.currentCameraZoomEvent=D;this.keyboardEventMatcher=E;this.maybeDocumentSession=G;this.currentUserSettings=H;this.currentDocumentEvents=K;this.serviceOptions=Ia;this.audioController=Ja;this.currentAssetsReady=L;this.exporterRegistered=J;this._dropDownMenuItems=[];this._contextMenuItems=[];this._tabMenuItems=[];this._propertyBarItems=[];this._navigationBarItems=[];this._colorGrids=
[];this.declaredShortcutActions=new Map;this.registeredActions=[];this.fileDropHandlers=[];this.urlDropHandlers=[];this.styledTextHandlers=[];this.documentChangeHandlers=[];this.navigationHandlers=[];this.cameraZoomHandlers=[];this.applicationModeChangeHandlers=[];this.afterPasteHandlers=[];this.styleSheetChangeHandlers=[];this.networkStatusChangeHandlers=[];this.panModeChangeHandlers=[];this.currentTopicChangeHandlers=[];this.licenseChangeHandlers=[];this.selectionChangeHandlers=[];this.textSelectionChangeHandlers=
[];this.textEditEventHandlers=[];this.assetsReadyChangeHandlers=[];this.planetLayouters=new Map;this.stackLayouters=new Map;this.overviewLayouters=new Map;this.contentLayouters=new Map;this.filePickers=new Map;this.exporters=new Map;this.topicThemeAppliers=new Map;this.enabledInApplicationModes=[c.ApplicationMode.Edit,c.ApplicationMode.AnimationPreview];this.userSettingsChangeHandlers=[];this.documentEventHandlers=[];this.disposed=!1;this.updateUiState=()=>{};this.pluginDescription.supportsPlaybackMode&&
this.enabledInApplicationModes.push(c.ApplicationMode.Playback);this.pluginDescription.pluginDescriptionKind===c.PluginDescriptionKind.readonly&&this.enabledInApplicationModes.push(c.ApplicationMode.View);this.sidebarManager=new S.SidebarManagerImpl(f,()=>this.enabled(),this.callHandler);this.popupManager=new ka.PopupManagerImpl(this.popupController);this.leftSidebarManager=new S.LeftSidebarManagerImpl(()=>this.enabled());this.spotlightManager=new ma.SpotlightManagerImpl(e,()=>this.enabled());this.dialogManager=
new N.PluginApiDialogManagerImpl(new ja.DialogManagerImpl(x,()=>this.enabled()),()=>this.enabled(),A);this.declaredShortcutActions=new Map(Object.keys(this.pluginDescription.shortcuts||{}).map((a)=>[this.pluginDescription.shortcuts[a],new I.ShortcutActionImpl({onExecute:()=>{},shortcut:this.pluginDescription.shortcuts[a]})]))}setEditorSession(a){this.maybeDocumentSession.setValue(a);this.updateUiState()}set dropDownMenuItems(a){this._dropDownMenuItems=a}get dropDownMenuItems(){return this._dropDownMenuItems}set contextMenuItems(a){this._contextMenuItems=
a}get contextMenuItems(){return this._contextMenuItems}set tabMenuItems(a){this._tabMenuItems=a}get tabMenuItems(){return this._tabMenuItems}set propertyBarItems(a){this._propertyBarItems=a}get propertyBarItems(){return this._propertyBarItems}set navigationBarItems(a){this._navigationBarItems=a}get navigationBarItems(){return this._navigationBarItems}set colorGrids(a){this._colorGrids=a}get colorGrids(){return this._colorGrids}declareUI(a,b){let d=Object.assign({},a);const c=this,h=`declareUI in plugin "${this.pluginDescription.name}"`;
class g{constructor(){this.isForbid=!1}checkForbid(a){if(this.isForbid)throw Error(`UIRoot.${a} is not allowed inside ${h}`);}get sidebar(){this.checkForbid("sidebar");return c.sidebarManager}get spotlight(){this.checkForbid("spotlight");return c.spotlightManager}get dialog(){this.checkForbid("dialog");return c.dialogManager}get popup(){this.checkForbid("popup");return c.popupManager}getState(){return d}setState(a){this.checkForbid("setState");d=Object.assign(Object.assign({},d),a);c.handleUpdateUiState()}scrollIntoView(...a){this.checkForbid("scrollIntoView");
const b=c.applicationController.setCurrentScrollIntoViewIds(a);e.scrollIntoView(a).then(()=>{c.applicationController.clearCurrentScrollIntoViewIds(b)})}forbid(a){if(this.isForbid)throw Error(`UIRoot already forbid for ${h}`);this.isForbid=!0;try{return a()}finally{this.isForbid=!1}}}const m=new g;this.updateUiState=()=>{const a=new Y.ApplicationUIImpl(this.callHandler,this.applicationController,()=>this.contextMenuController.closeContextMenu(),this.enabled(),this.popupController,this.dialogManager,
this.popupManager,this.colorGridProvider,this.fileInsertDialogProvider,this.maybeDocumentSession,this.pluginDescription.shortcuts,this.audioController);u.asKillable(a,(a)=>{m.forbid(()=>{this.maybeDocumentSession.hasValue()?this.maybeDocumentSession.value.document.forbidRead(h,()=>{b(d,a)}):b(d,a)});this.dropDownMenuItems=a.dropDownMenuItems;this.tabMenuItems=a.tabMenuItems;this.contextMenuItems=a.contextMenuItems;this.propertyBarItems=a.propertyBarItems;this.navigationBarItems=a.navigationBarItems;
this.colorGrids=a.colorGrids;this.registeredActions=a.registeredShortcutActions;this.dialogManager.setDialogItems(a.getDialogItems());this.sidebarManager.setSidebarArgss(a.newSidebarArgs);this.leftSidebarManager.setSidebarArgs(a.newLeftSidebarArgs);this.spotlightManager.spotlightArgss=a.newSpotlightArgs});this.uiChanged()};return m}onNavigation(a){this.navigationHandlers.push(a)}onCameraZoom(a){this.cameraZoomHandlers.push(a)}onDocumentChange(a){this.documentChangeHandlers.push(a)}onApplicationModeChange(a){this.applicationModeChangeHandlers.push(a)}onAfterPaste(a){this.afterPasteHandlers.push(a)}onStyleSheetChange(a){this.styleSheetChangeHandlers.push(a)}onNetworkStatusChange(a){this.networkStatusChangeHandlers.push(a)}onPanModeChange(a){this.panModeChangeHandlers.push(a)}onSelectionChange(a){this.selectionChangeHandlers.push(a)}onTextSelectionChange(a){this.textSelectionChangeHandlers.push(a)}onTextEdit(a){this.textEditEventHandlers.push(a)}onCurrentTopicChange(a){this.currentTopicChangeHandlers.push(a)}onAssetsReadyChange(a){this.assetsReadyChangeHandlers.push(a)}onFileDrop(a,
b){this.fileDropHandlers.push((d,f)=>c.FileFilter.passes(a,f.data.file)?(b(d,f),!0):!1)}registerPlanetLayout(a,b){this.planetLayouters.set(a,b);return a}registerStackLayout(a,b){this.stackLayouters.set(a,b);return a}registerOverviewLayout(a,b){this.overviewLayouters.set(a,b);return a}registerContentLayout(a,b){this.contentLayouters.set(a,b);return a}registerFilePicker(a){this.filePickers.set(a.id,a);this.applicationController.updateAllUiState()}registerExporter(a){this.exporters.set(a.format,a);this.exporterRegistered(a.format)}handleFileSelect(a,
b){return this.enabled()&&(a=this.filePickers.get(a),null!=a)?a.selectFile(b):null}getFilePickerDescriptions(){return this.enabled()?[...this.filePickers.entries()].map(([a,b])=>({id:a,icon:b.icon,name:b.name})):[]}onTopicThemeApplication(a,b){this.topicThemeAppliers.set(a,b)}onURLDrop(a){this.urlDropHandlers.push(a)}onTextDrop(a){this.styledTextHandlers.push(a)}onLicenseChange(a){this.licenseChangeHandlers.push(a)}service(a,b){const d=this.serviceMocks[g.concatUrlParts(a)];return null!=d?d:b(new la.ServiceApiImpl(a,
this.pluginServiceProvider))}getActiveFeatureSwitches(){return R.FeatureSwitcher.getActiveFeatures()}getAllFeatureSwitches(){return R.FeatureSwitcher.getAllFeatures()}onCloseSidebar(a){this.sidebarManager.onCloseSidebar(a)}onCloseDialog(a){this.dialogManager.onCloseDialog(a)}setNetworkStatus(a){this.handleEnabledChange(()=>{this.networkStatus=a});this.handleNetworkStatusChange(a)}setPanMode(a){this.handlePanModeChange(a)}handleEnabledChange(a){const b=this.enabled();a();a=this.enabled();b!==a&&(a?
this.handleStart():this.handleStop())}enabled(){return!this.disposed&&this.pluginIsEnabledInMode(this.applicationMode)&&(this.networkStatus===c.NetworkStatus.Online||this.pluginDescription.supportsOffline===c.SupportsOffline.always||this.pluginDescription.supportsOffline===c.SupportsOffline.desktop&&this.isDesktop)}handleKeyboardEvent(a){if(!this.enabled())return!1;for(let b of[...this.registeredActions,...this.declaredShortcutActions.values()])if(this.keyboardEventMatcher.matching(a,Object.assign({type:"keydown"},
b.args.shortcut)))return b.args.enabled&&this.callHandler.callWithUAT((a)=>b.args.onExecute(a,c.ActionTrigger.Keyboard)),a.preventDefault(),a.stopPropagation(),!0;return!1}handlePlanetLayoutEvent(a,b,d,c){if(this.enabled()&&this.planetLayouters.has(a)){const f=this.planetLayouters.get(a);this.callHandler.call(()=>{f.apply(b,d,c)});return!0}return!1}handlePlanetLayoutIsValid(a,b){if(this.enabled()&&this.planetLayouters.has(a)){const d=this.planetLayouters.get(a);return this.callHandler.call(()=>d.isValid(b),
!1)}return!1}handleStackLayoutIsValid(a,b){if(this.enabled()&&this.stackLayouters.has(a)){const d=this.stackLayouters.get(a);return this.callHandler.call(()=>d.isValid(b),!1)}return!1}handleStackLayoutEvent(a,b,d,c){if(this.enabled()&&this.stackLayouters.has(a)){const f=this.stackLayouters.get(a);this.callHandler.call(()=>{f.apply(b,d,c)});return!0}return!1}runOnDesktop(){return this.isDesktop}handleContentLayoutIsValid(a,b){if(this.enabled()&&this.contentLayouters.has(a)){const d=this.contentLayouters.get(a);
return this.callHandler.call(()=>d.isValid(b),!1)}return!1}handleContentLayoutEvent(a,b,d){if(this.enabled()&&this.contentLayouters.has(a)){const c=this.contentLayouters.get(a);this.callHandler.call(()=>{c.apply(b,d)});return!0}return!1}handleOverviewLayoutEvent(a,b,d,c){if(this.enabled()&&this.overviewLayouters.has(a)){const f=this.overviewLayouters.get(a);this.callHandler.call(()=>{f.apply(b,d,c)});return!0}return!1}handleOverviewLayoutIsValid(a,b){if(this.enabled()&&this.overviewLayouters.has(a)){const d=
this.overviewLayouters.get(a);return this.callHandler.call(()=>d.isValid(b),!1)}return!1}handleTopicLayoutApplication(a,b,d){if(this.enabled()&&this.topicThemeAppliers.has(a)){const c=this.topicThemeAppliers.get(a);this.callHandler.call(()=>{c(b,d)});return!0}return!1}handleFileDrop(a,b){let d=!1;this.enabled()&&0<this.fileDropHandlers.length&&this.callHandler.callWithUAT((a)=>{for(let c of this.fileDropHandlers)if(c(a,b)){d=!0;break}});return d}handleURLDrop(a){let b=!1;this.enabled()&&0<this.urlDropHandlers.length&&
this.callHandler.callWithUAT((d)=>{for(let c of this.urlDropHandlers)if(c(d,a)){b=!0;break}});return b}handleStyledTextDrop(a){let b=!1;this.enabled()&&0<this.styledTextHandlers.length&&this.callHandler.callWithUAT((d)=>{for(let c of this.styledTextHandlers)if(c(d,a)){b=!0;break}});return b}handleRenderSidebar(a,b,d){return this.sidebarManager.onRender(a,b,d)}handleRenderLeftSidebar(a,b){return this.leftSidebarManager.onRender(a,b)}handleRenderModal(a,b,d){return this.dialogManager.onRender(a,b,d)}notifyAllChangeEventListeners(){this.callHandler.call(()=>
{this.documentChangeHandlers.forEach((a)=>a());this.styleSheetChangeHandlers.forEach((a)=>a())})}handleNavigation(a){this.currentNavigationEvent=a;null!=a&&this.enabled()&&this.callHandler.call(()=>{this.navigationHandlers.forEach((b)=>b(a))})}handleCameraZoom(a){this.currentCameraZoomEvent=a;null!=a&&this.enabled()&&this.callHandler.call(()=>{this.cameraZoomHandlers.forEach((b)=>b(a))})}handleDocumentChange(a){if(this.enabled()){const b=[q.ChangeEventKind.Document,q.ChangeEventKind.EntitiesModified,
q.ChangeEventKind.Entity].some((b)=>a.some((a)=>a.kind===b)),d=a.some((a)=>a.kind!==q.ChangeEventKind.Document&&(a.kind!==q.ChangeEventKind.StyleSheet||a.selector&&0===a.selector.toString().indexOf("#"))?!1:!0);this.callHandler.call(()=>{b&&this.documentChangeHandlers.forEach((a)=>a());d&&this.styleSheetChangeHandlers.forEach((a)=>a())})}}handleNetworkStatusChange(a){this.enabled()&&this.callHandler.call(()=>{this.networkStatusChangeHandlers.forEach((b)=>b(a))})}handlePanModeChange(a){this.enabled()&&
this.callHandler.call(()=>{this.panModeChangeHandlers.forEach((b)=>b(a))})}handleSelectionChange(a){this.selection=a;if(this.enabled()&&this.maybeDocumentSession.hasValue()){const b=this.maybeDocumentSession.value.document.read((b)=>g.selectionToTransformedSelectionChange(b,a));this.callHandler.call(()=>{this.selectionChangeHandlers.forEach((a)=>a(b))})}}handleTextSelectionChange(a){this.textSelectionInfo=a;this.enabled()&&this.callHandler.call(()=>{this.textSelectionChangeHandlers.forEach((b)=>b(a))})}handleTextEdit(a){let b=
!1;this.enabled()&&0<this.textEditEventHandlers.length&&this.callHandler.callWithUAT((d)=>{for(let c of this.textEditEventHandlers)if(c(d,a)){b=!0;break}});return b}handleApplicationModeChange(a){this.enabled()&&this.callHandler.call(()=>{this.applicationModeChangeHandlers.forEach((b)=>b(a))});this.handleEnabledChange(()=>{this.applicationMode=a})}handleStartPdfExport(a){let b=!1;this.enabled()&&this.exporters.has(c.ExportFormat.pdf)&&this.callHandler.call(()=>{this.exporters.get(c.ExportFormat.pdf).start(a);
b=!0});return b}handleCancelPdfExport(){let a=!1;this.enabled()&&this.exporters.has(c.ExportFormat.pdf)&&this.callHandler.call(()=>{this.exporters.get(c.ExportFormat.pdf).cancel();a=!0});return a}handleAfterPaste(a){this.enabled()&&this.callHandler.call(()=>{this.afterPasteHandlers.forEach((b)=>b(a))})}handleCurrentTopicChange(a){this.currentTopic=a;this.enabled()&&null!=this.currentTopic&&this.callHandler.call(()=>{this.currentTopicChangeHandlers.forEach((b)=>b(a))})}handleLicenseChange(a){this.currentUserLicenseInformation=
a;this.enabled()&&this.callHandler.call(()=>{this.licenseChangeHandlers.forEach((b)=>b(a))})}handleAssetsReadyChange(a){this.currentAssetsReady=a;this.enabled()&&this.callHandler.call(()=>{this.assetsReadyChangeHandlers.forEach((b)=>b(a))})}handleStart(){this.handleUserSettingsChange(this.currentUserSettings);this.handleAssetsReadyChange(this.currentAssetsReady);for(let a of this.currentDocumentEvents)this.handleDocumentEventI(a);this.notifyAllChangeEventListeners();this.handleSelectionChange(this.selection);
this.handleTextSelectionChange(this.textSelectionInfo);this.handleApplicationModeChange(this.applicationMode);this.handleCurrentTopicChange(this.currentTopic);this.handleLicenseChange(this.currentUserLicenseInformation);this.handleNetworkStatusChange(this.networkStatus);this.handlePanModeChange(this.panModeEnabled);this.handleNavigation(this.currentNavigationEvent);this.handleCameraZoom(this.currentCameraZoomEvent);this.updateUiState()}handleStop(){null!=this.plugin.unload&&this.plugin.unload();this.sidebarManager.handleStop();
this.spotlightManager.handleStop();this.dialogManager.handleStop();this.updateUiState()}processMessage(a){return this.enabled()?(this.callHandler.call(()=>this.plugin.processMessage(a)),!0):!1}pluginIsEnabledInMode(a){return 0<=this.enabledInApplicationModes.indexOf(a)}onUserSettingsChange(a){this.userSettingsChangeHandlers.push(a)}handleUserSettingsChange(a){this.currentUserSettings=a;if(this.enabled())for(let b of this.userSettingsChangeHandlers)this.callHandler.call(()=>b(a))}onDocumentEvent(a){this.documentEventHandlers.push(a)}handleDocumentEvent(a){this.currentDocumentEvents.push(a);
this.handleDocumentEventI(a)}handleDocumentEventI(a){if(this.enabled())for(let b of this.documentEventHandlers)this.callHandler.callWithUAT(()=>b(a))}handleUpdateUiState(){this.enabled()&&this.updateUiState()}dispose(){this.disposed||this.handleEnabledChange(()=>this.disposed=!0)}};var y={guard:function(a,b,d,c){return(f)=>{try{return d(f)}catch(n){return a(b,n),c}}}},O=this&&y.__awaiter||function(a,b,d,c){function f(a){return a instanceof d?a:new d(function(b){b(a)})}return new (d||(d=Promise))(function(d,
e){function h(a){try{n(c.next(a))}catch(t){e(t)}}function g(a){try{n(c["throw"](a))}catch(t){e(t)}}function n(a){a.done?d(a.value):f(a.value).then(h,g)}n((c=c.apply(a,b||[])).next())})};Object.defineProperty(y,"__esModule",{value:!0});var sa=p.base.getBoundsInWorld,l=p.base.ObjectKind;y.DocumentSessionImpl=class{constructor(a,b,d,c,e,g,m,k,l){this.scene=a;this.progressiveAssetManager=b;this.preziMetaData=d;this.runner=c;this.cetPreziSaver=e;this.cetMetadataSaver=g;this.cetApp=m;this.assetsReady=l;
this.noReadInside=null;k.onValue((a)=>{this.preziMetaData=a})}get preziXml(){return this.scene.getPreziXml()}initIntent(a){return Object.assign(Object.assign({},a),{trigger:"plugin-api"})}parseCopyDataAsync(a){return p.CetModelEditor.parseCopyDataAsync(this.cetApp,a)}executeApiCommand(a,b,d={}){g.checkAT(a);return this.runner.executeApiCommand(b,this.initIntent(d))}executeLegacyCommand(a,b,d={}){g.checkAT(a);return this.runner.executeLegacyCommand(b,this.initIntent(d))}read(a){if(null!=this.noReadInside)throw Error(`Document read is not allowed inside ${this.noReadInside}`);
return this.runner.read(a)}forbidRead(a,b){if(null!=this.noReadInside)throw Error(`Read is already forbidden inside ${this.noReadInside}`);this.noReadInside=a;try{return b()}finally{this.noReadInside=null}}beginLongRunningCommand(a,b,d){g.checkAT(a);return new y.LongRunningCtxImpl(this.runner,this.initIntent(b),d)}save(a){return(new Promise((b)=>{g.checkAT(a);this.cetPreziSaver.save().take(1).onValue((a)=>b(a))})).then((a)=>{switch(a){case ca.SaveResult.Success:return c.SaveResult.Success;case ca.SaveResult.Error:return c.SaveResult.Error;
case ca.SaveResult.ErrorExternalEdit:return c.SaveResult.ErrorExternalEdit;default:return r.Utils.assertNever(a)}})}setDocumentTitle(a){return this.cetMetadataSaver.savePreziTitle(a).then(()=>{})}setDocumentLogoType(a){return this.cetMetadataSaver.savePreziLogoType(a).then(()=>{})}};y.LongRunningCtxImpl=class{constructor(a,b,d){this.onBeforeFinish=d;this.asyncCommand=a.beginAsyncApiCommand(b,(a)=>{try{const b=a.reason;switch(b){case p.FinishEventKind.AbortTransaction:case p.FinishEventKind.RollbackTransaction:this.onBeforeFinish({reason:b});
break;case p.FinishEventKind.BeginOtherTransaction:case p.FinishEventKind.EndTransaction:this.asyncCommand.execute((a)=>{this.onBeforeFinish({reason:b,api:a})});break;default:r.Utils.assertNever(b)}}finally{this.asyncCommand=null}})}isActive(){return null!=this.asyncCommand}rollback(){if(!this.isActive())throw Error("Ctx is inactive");this.asyncCommand.rollback()}end(){if(!this.isActive())throw Error("Ctx is inactive");this.asyncCommand.end()}execute(a,b){g.checkAT(a);if(!this.isActive())throw Error("Ctx is inactive");
return this.asyncCommand.execute(b)}};y.VideoBackgroundApiImpl=class{constructor(a){this.stage=a;this.width=1600;this.flip={left:this.width,width:-this.width};this.nonFlip={left:0,width:this.width}}startWithWebcam(a,b,d){return O(this,void 0,void 0,function*(){g.checkAT(a);try{this.stopI();let a=yield navigator.mediaDevices.getUserMedia({video:{deviceId:b,width:1280,height:720,facingMode:"user",audio:!1}});this.updateBackgroundVideoParams(Object.assign({onlyEditMode:d,source:a,live:!0},this.flip));
if(!a)return{status:c.VideoBackgroundStatusCode.playbackStartFailure,error:"Failed to initialize camera stream!"}}catch(f){return{status:c.VideoBackgroundStatusCode.genericFailure,error:f}}return{status:c.VideoBackgroundStatusCode.successfullyStarted}})}startFromUrl(a,b,d){g.checkAT(a);this.stopI();this.updateBackgroundVideoParams(Object.assign({onlyEditMode:d,source:b,live:!0},this.flip));return{status:c.VideoBackgroundStatusCode.successfullyStarted}}set live(a){this.updateBackgroundVideoParams({live:a})}get live(){return this.stage.getBackgroundVideoParams().live}set flipped(a){this.updateBackgroundVideoParams(this.flipped?
this.nonFlip:this.flip)}get flipped(){return this.stage.getBackgroundVideoParams().left!==this.nonFlip.left}stop(a){g.checkAT(a);this.stopI()}stopI(){this.cleanupCurrentStream();this.updateBackgroundVideoParams({source:null})}cleanupCurrentStream(){const a=this.stage.getBackgroundVideoParams();if(null!=a.source&&"string"!==typeof a.source&&"getTracks"in a.source)for(const b of a.source.getTracks())b.stop()}updateBackgroundVideoParams(a){this.stage.updateBackgroundVideoParams(a)}};class Z{constructor(a){a.onValue((a)=>
this.editorMode=a)}}y.ApplicationEditModeImpl=class extends Z{constructor(a,b,d){super(d);this.changeModeAction=a;this.changeEditingKindAction=b;this.modeStream=d;this.drawInsertModeCallbacks=null}isActive(){return this.editorMode.kind===A.EditorMode.edit}setActive(a){g.checkAT(a);this.eraseDrawInsertModeCallbacks();this.changeModeAction({newMode:A.EditorMode.edit,trigger:"api"})}setMaskEditingMode(a,b,d,c){g.checkAT(a);this.eraseDrawInsertModeCallbacks();this.changeEditingKindAction({editingKind:H.EditingKind.imageMask,
isFixedAspect:c,maskedImageId:b,target:d})}setNormalMode(a){g.checkAT(a);this.eraseDrawInsertModeCallbacks();this.changeEditingKindAction({editingKind:H.EditingKind.normal})}setDrawInsertMode(a,b,d,c){g.checkAT(a);this.drawInsertModeCallbacks={onCreateObject:d,onFinish:c};this.changeEditingKindAction({editingKind:H.EditingKind.drawInsert,defaultSize:b})}triggerCreateDrawedObject(a,b,d){if(this.editorMode.kind!==A.EditorMode.edit||this.editorMode.editingKind!==H.EditingKind.drawInsert)throw Error("Cannot create drawed object in mode: "+
this.editorMode);return null!=this.drawInsertModeCallbacks?this.drawInsertModeCallbacks.onCreateObject(a,b,d):null}triggerFinishDrawObject(a){if(this.editorMode.kind!==A.EditorMode.edit||this.editorMode.editingKind!==H.EditingKind.drawInsert)throw Error("Cannot finish draw object in mode: "+this.editorMode);if(null!=this.drawInsertModeCallbacks)this.drawInsertModeCallbacks.onFinish(a)}eraseDrawInsertModeCallbacks(){this.drawInsertModeCallbacks=null}};class Ka extends Z{constructor(a,b){super(b);this.changeModeAction=
a;this.modeStream=b}isActive(){return this.editorMode.kind===A.EditorMode.playback&&!this.editorMode.showTopmenu&&!this.editorMode.presenterNotesFlow}setActive(a,b){g.checkAT(a);this.changeModeAction({newMode:A.EditorMode.playback,shouldGoFullscreen:!0,shouldSeekPathToStart:b,linkClickedFlow:!1,presenterNotesFlow:!1,showTopmenu:!1,trigger:"api"})}}class La extends Z{constructor(a,b){super(b);this.changeModeAction=a;this.modeStream=b}isActive(){return this.editorMode.kind===A.EditorMode.playback&&
this.editorMode.showTopmenu&&!this.editorMode.presenterNotesFlow}setActive(a){g.checkAT(a);this.changeModeAction({newMode:A.EditorMode.playback,shouldGoFullscreen:!1,shouldSeekPathToStart:!1,linkClickedFlow:!1,presenterNotesFlow:!1,showTopmenu:!0,trigger:"api"})}}class Ma extends Z{constructor(a,b){super(b);this.changeModeAction=a;this.modeStream=b}isActive(){return this.editorMode.kind===A.EditorMode.playback&&this.editorMode.presenterNotesFlow}setActive(a){g.checkAT(a);this.changeModeAction({newMode:A.EditorMode.playback,
shouldGoFullscreen:!1,shouldSeekPathToStart:!1,linkClickedFlow:!1,presenterNotesFlow:!0,showTopmenu:!1,trigger:"api"})}}y.ApplicationModeApiImpl=class{constructor(a,b,d,c){this.changeModeAction=a;this.changeEditingKindAction=b;this.modeStream=d;this.openPresenterNotesWindow=c;this.editMode=new y.ApplicationEditModeImpl(a,b,d);this.presentMode=new Ka(a,d);this.previewMode=new La(a,d);this.presenterViewMode=new Ma(a,d)}};y.HoverDecoratorOnCanvasApiImpl=class{constructor(a){this.editorStore=a}setHovered(a,
b){g.checkAT(a);this.editorStore.setUiHoveredEntityIds(b.map((a)=>a.id))}};y.NavigationApiImpl=class{constructor(a,b,d,c){this.scene=a;this.navigationControl=b;this.changeModeAction=d;this.editorStore=c;this.editorStore.getCurrentTopicStream().onValue((a)=>{this.currentTopicId=a})}goToPathElement(a,b){return O(this,void 0,void 0,function*(){g.checkAT(a);return new Promise((a)=>{const d=p.CetModelEditor.createPathElementIdToPlaybackPathPositionMapFromScene(this.scene);let c=null;switch(b.kind){case l.fadeIn:case l.fadeOut:break;
case l.backToParent:c=b.backTo.target.ref;break;case l.visitStack:b=b.children[0];c=b.target.ref;break;case l.zoom:case l.visitPage:case l.visitPlanet:case l.visitOverview:c=b.target.ref;break;default:r.Utils.assertNever(b)}p.CetModelEditor.setCameraAndPathFor({navigationControl:this.navigationControl,pathPosition:d.get(b.id)});Promise.resolve().then(()=>{if(null==c)a();else(c.kind===l.overview?this.navigationControl.flyToOverview():this.navigationControl.flyToId(c.id,q.CameraNavigationTrigger.path)).onValue((b)=>
{b.phase!==q.NavigationActionAnimationPhase.End&&b.phase!==q.NavigationActionAnimationPhase.Cancel||a()})})})})}focusTo(a,b){g.checkAT(a);return new Promise((a)=>{const d=b.id,c=b.is(l.overview);p.CetModelEditor.setCameraAndPathFor({navigationControl:this.navigationControl,pathPosition:p.CetModelEditor.getPathPositionForTarget({allowForwardActions:!0,navigationControl:this.navigationControl,targetId:d})});Promise.resolve().then(()=>{(c?this.navigationControl.focusToOverview(!0):this.navigationControl.focusToId(d,
!0,q.CameraNavigationTrigger.free)).onValue(()=>{a()})})})}flyTo(a,b){g.checkAT(a);return new Promise((a)=>{const d=b.id,c=b.is(l.overview);p.CetModelEditor.setCameraAndPathFor({navigationControl:this.navigationControl,pathPosition:p.CetModelEditor.getPathPositionForTarget({navigationControl:this.navigationControl,targetId:d,allowForwardActions:!0})});Promise.resolve().then(()=>{(c?this.navigationControl.flyToOverview():this.navigationControl.flyToId(d,q.CameraNavigationTrigger.free)).onValue((b)=>
{b.phase!==q.NavigationActionAnimationPhase.End&&b.phase!==q.NavigationActionAnimationPhase.Cancel||a()})})})}zoom(a,b,d){g.checkAT(a);if(!(0>=b)){a=this.navigationControl.getCamera().getMarginCorrectedViewport().getCenter();if(1>=b)b={direction:q.ZoomingDirection.ZOOM_OUT,unlimitedZoomOut:!1,zoomingCenter:a,wheelDelta:1/b,currentTopicId:this.currentTopicId,isInstant:d};else{const c=q.Cet.createScreenBoundsCalculator(this.scene,this.navigationControl.getCamera()),e=this.scene.getEntityById(this.currentTopicId);
b={direction:q.ZoomingDirection.ZOOM_IN,zoomingCenter:a,wheelDelta:b,boundsWithin:c.getMarginCorrectedViewportForEntity(e),isInstant:d}}this.navigationControl.getCamera().startBoundedZoom(this.scene,b)}}setPanMode(a,b){g.checkAT(a);this.editorStore.setPanModeEnabled(b)}previewAnimation(a,b){return O(this,void 0,void 0,function*(){g.checkAT(a);var d=p.CetModelEditor.createPathElementIdToPlaybackPathPositionMapFromScene(this.scene),c=b.id;const e=b.parent;let n=null;for(let a=e.children.indexOf(b);0<=
a;a--){const b=e.children[a];if(b.is(l.zoom)){n=b.target.is(l.stackTopic)?b.target.pageChildren[0]:b.target;break}else if(b.is(l.visitPage)){n=b.target;break}else if(b.is(l.visitPlanet)||b.is(l.visitStack)){n=b.target.parent;break}else b.is(l.fadeIn)||b.is(l.fadeOut)||r.Utils.assertNever(b,"Unknown type")}this.changeModeAction({newMode:A.EditorMode.animationPreview,trigger:"machine"});null==n&&(n=e.target);yield this.flyTo(a,n);c=d.get(c);d=this.navigationControl.getPathNavigator().getPath().getPathPosition(c.step,
c.action);c=this.navigationControl.getPathNavigator().getPath().getPathPosition(c.step,c.action-1);this.navigationControl.getPathNavigator().jump(c);yield this.wait(700);this.navigationControl.getPathNavigator().go(d);d=Math.max(q.Cet.getAnimationData(q.AnimationType.CONTENT_FADE_OUT).duration,q.Cet.getAnimationData(q.AnimationType.CONTENT_FADE_IN).duration);yield this.wait(d+700);this.changeModeAction({newMode:A.EditorMode.edit,trigger:"machine"})})}wait(a){return O(this,void 0,void 0,function*(){return new Promise((b)=>
{setTimeout(b,a)})})}};y.EditorSessionImpl=class{constructor(a,b,d,c,e,g,m,k,l,q,F){this.document=a;this.insertTarget=b;this.positionFinder=d;this.selection=c;this.coverEdit=e;this.applicationMode=g;this.navigation=m;this.hoverDecoratorOnCanvas=k;this.stage=l;this.snapshotRenderer=q;this.videoBackground=F}snapshot(a,b,d,c=null){return O(this,void 0,void 0,function*(){const f=null==c?null:new Set(r.Utils.flatten(c.map((a)=>a.is(l.topic)?r.Utils.flatten([a.cover.contentChildren,a.visual.contentChildren]).map((a)=>
a.id):[a.id])));return(yield this.stage.createSnapshotCanvas(sa(a),b,d,(a)=>{if(null!=f&&!f.has(a.getId())||!q.Cet.hasPdomComponent(a))return 0;a=q.Cet.visibility(a);return a.isVisible()?a.getAlpha():0},!0,()=>!0)).canvas})}snapshotPathElement(a,b,d,c,e){return O(this,void 0,void 0,function*(){var f=b.is(p.base.ObjectKind.fadeIn)||b.is(p.base.ObjectKind.fadeOut);const h=(new Na(a,f)).get(b),g=new Set(this.stage.getModelScene().getEntityList().asArray().filter((a)=>a.isDef(za.CetModel.ID.BACKGROUND_LAYER)?
!0:q.Cet.hasPdomComponent(a)&&null!=q.Cet.draw(a)&&h.getVisible(a.getId())).map((a)=>a.getId()));f=h.getTargetLayoutBox();return yield this.stage.createSnapshotCanvas(sa(f),d,!0,(a)=>{a=a.getId();return g.has(a)?1:0},c,e)})}};y.ReaderSessionImpl=class{constructor(a,b){this.editorSessionImpl=a;this.userHasEditRights=!1;b.onValue((a)=>this.userHasEditRights=a);this.documentSession=new Oa(a.document,()=>this.userHasEditRights)}get navigation(){return this.editorSessionImpl.navigation}snapshot(a,b,d,
c){return this.editorSessionImpl.snapshot(a,b,d,c)}get document(){return this.documentSession}canEditTheDocument(){return this.userHasEditRights}get positionFinder(){this.checkEditRights("positionFinder");return this.editorSessionImpl.positionFinder}get applicationMode(){this.checkEditRights("applicationMode");return this.editorSessionImpl.applicationMode}get hoverDecoratorOnCanvas(){this.checkEditRights("hoverDecoratorOnCanvas");return this.editorSessionImpl.hoverDecoratorOnCanvas}get videoBackground(){this.checkEditRights("videoBackground");
return this.editorSessionImpl.videoBackground}get insertTarget(){this.checkEditRights("insertTarget");return this.editorSessionImpl.insertTarget}get selection(){this.checkEditRights("selection");return this.editorSessionImpl.selection}get coverEdit(){this.checkEditRights("coverEdit");return this.editorSessionImpl.coverEdit}checkEditRights(a){if(!this.userHasEditRights)throw Error(`Not allow to perform edit operation: ${a}`);}};class Oa{constructor(a,b){this.documentSessionImpl=a;this.userHasEditRights=
b}get assetsReady(){return this.documentSessionImpl.assetsReady}get preziMetaData(){return this.documentSessionImpl.preziMetaData}get preziXml(){return this.documentSessionImpl.preziXml}read(a){return this.documentSessionImpl.read(a)}get progressiveAssetManager(){this.checkEditRights("progressiveAssetManager");return this.documentSessionImpl.progressiveAssetManager}parseCopyDataAsync(a){this.checkEditRights("parseCopyDataAsync");return this.documentSessionImpl.parseCopyDataAsync(a)}save(a){this.checkEditRights("save");
return this.documentSessionImpl.save(a)}executeApiCommand(a,b,d){this.checkEditRights("executeApiCommand");return this.documentSessionImpl.executeApiCommand(a,b,d)}executeLegacyCommand(a,b,d){this.checkEditRights("executeLegacyCommand");return this.documentSessionImpl.executeLegacyCommand(a,b,d)}beginLongRunningCommand(a,b,d){this.checkEditRights("beginLongRunningCommand");return this.documentSessionImpl.beginLongRunningCommand(a,b,d)}setDocumentTitle(a){this.checkEditRights("setDocumentTitle");return this.documentSessionImpl.setDocumentTitle(a)}setDocumentLogoType(a){this.checkEditRights("setDocumentLogoType");
return this.documentSessionImpl.setDocumentLogoType(a)}checkEditRights(a){if(!this.userHasEditRights())throw Error(`Not allow to perform edit operation: ${a}`);}}var P;(function(a){a.In="In";a.Out="Out"})(P||(P={}));class Na{constructor(a,b){this.api=a;this.cache={elementMap:new Map,pathElements:null,pathElementIds:null,viewPathElementIds:new Set,ancestorMap:new Map,fadeMap:new Map};this.cache.pathElements=a.structuredPath.pathElementsInOrder;this.cache.viewPathElementIds=b?new Set(a.structuredPath.viewPathElementsInOrder.map((a)=>
a.id)):null;this.cache.pathElementIds=this.cache.pathElements.map((a)=>a.id);this.cache.pathElements.forEach((a,b)=>{if(a.is(l.fadeIn)||a.is(l.fadeOut)){b={index:b,kind:a.is(l.fadeIn)?P.In:P.Out};a=a.targets.concat(...a.groupTargets.map((a)=>a.members));for(const d of a){a=d.id;let c=this.cache.fadeMap.get(a);null==c&&(c=[],this.cache.fadeMap.set(a,c));c.push(b)}}})}isValid(a){return null==this.cache.viewPathElementIds||this.cache.viewPathElementIds.has(a)}get(a){a=this.cache.pathElementIds.indexOf(a.id);
return this.getByIndex(a)}getNext(a){return this.getByIndex(a.index+1)}getPrev(a){return this.getByIndex(a.index-1)}getByIndex(a){let b=this.cache.elementMap.get(a);null==b&&(b=new Pa(this,this.api,this.cache.pathElements[a],a),this.cache.elementMap.set(a,b));return b}getAncestorIds(a){const b=a.id;let d=this.cache.ancestorMap.get(b);null==d&&(a.is(l.overview)?d=new Set:(a=a.parent,d=new Set([a.id,...this.getAncestorIds(a)])),this.cache.ancestorMap.set(b,d));return d}getFadeInfos(a){const b=a.id;
let d=this.cache.fadeMap.get(b);null==d&&(d=a.is(l.overview)?[]:this.getFadeInfos(a.parent),this.cache.fadeMap.set(b,d));return d}}class Pa{constructor(a,b,d,c){this.exPath=a;this.api=b;this.pathElement=d;this.index=c;this.cache={parent:null,visibilityMap:new Map,targetLayoutBox:null,visibleInParentMap:new Map}}getParent(){null==this.cache.parent&&(this.cache.parent=this.calcParent());return this.cache.parent}getVisible(a){let b=this.cache.visibilityMap.get(a);null==b&&(b=this.calcVisible(a),this.cache.visibilityMap.set(a,
b));return b}getTargetLayoutBox(){null==this.cache.targetLayoutBox&&(this.cache.targetLayoutBox=this.calcTargetLayoutBox());return this.cache.targetLayoutBox}calcTargetLayoutBox(){var a=this.pathElement;if(!this.exPath.isValid(a.id))return this.exPath.getPrev(this).getTargetLayoutBox();if(a.is(l.visitOverview)||a.is(l.visitPlanet)||a.is(l.visitPage))return a.target.zoomLayoutBox;if(a.is(l.visitStack))return this.exPath.getNext(this).getTargetLayoutBox();if(a.is(l.backToParent))return a.backTo.target.zoomLayoutBox;
if(a.is(l.zoom))return a=a.target,a.is(l.simpleObject)?a.layoutBox:a.zoomLayoutBox;if(a.is(l.fadeIn)||a.is(l.fadeOut))return this.exPath.getPrev(this).getTargetLayoutBox();r.Utils.assertNever(a,"Unknown pathelement")}calcVisible(a){a=this.api.lookup.base(a);if(null==a||!a.is(l.simpleObject)||a.is(l.zoomArea))return!1;if(a.is(l.text)||a.is(l.image)||a.is(l.swf)||a.is(l.pdf))if(R.isActive("js-pdom-upgrade-show-placeholders-in-present-mode")){if(!a.is(l.image)&&a.isPlaceholder)return!1}else{if(a.isPlaceholder)return!1}else"isPlaceholder"in
a&&r.Utils.assertNever(a,"Unknown placeholder");const b=this.exPath.getFadeInfos(a);if(0<b.length){const a=b[0];let c=null;for(const a of b){if(a.index>this.index)break;c=a}if(null!=c&&c.kind===P.Out||null==c&&a.kind===P.In)return!1}return this.getVisibleInParent(a.parent)}getVisibleInParent(a){let b=this.cache.visibleInParentMap.get(a.id);null==b&&(b=this.calcVisibleInParent(a),this.cache.visibleInParentMap.set(a.id,b));return b}calcVisibleInParent(a){const b=this.getParent();if(a.id===b.id)return!0;
if(a.is(l.overview)||a.is(l.planetTopic)||a.is(l.page))return!1;const c=a.parent;return(a.is(l.surface)||a.is(l.visual)||a.is(l.master))&&c.id===b.id||(a.is(l.cover)||a.is(l.surface)||a.is(l.visual))&&c.parent.id===b.id||(a.is(l.master)||a.is(l.visual))&&this.exPath.getAncestorIds(b).has(c.id)?!0:!1}calcParent(){const a=this.pathElement,b=a.kind;if(!this.exPath.isValid(a.id))return this.exPath.getPrev(this).getParent();if(a.is(l.visitStack))return this.exPath.getNext(this).getParent();if(a.is(l.freePathChild))return this.exPath.getPrev(this).getParent();
if(a.is(l.visitPlanet)||a.is(l.visitOverview)||a.is(l.visitPage))return a.target;if(a.is(l.backToParent))return a.backTo.target;r.Utils.assertNever(a,`Unknown pathElement ${b}`)}}var L={},T=this&&L.__awaiter||function(a,b,c,f){function d(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,e){function h(a){try{k(f.next(a))}catch(t){e(t)}}function g(a){try{k(f["throw"](a))}catch(t){e(t)}}function k(a){a.done?c(a.value):d(a.value).then(h,g)}k((f=f.apply(a,b||[])).next())})};
Object.defineProperty(L,"__esModule",{value:!0});L.ApplicationControllerImpl=class{constructor(a,b,d,f,e,k,m,l,w,q,p,t,r,u,y,x,A,z,B,C){this.sidebarController=a;this.contextMenuController=b;this.spotlightController=d;this.pluginServiceProvider=f;this.serviceMocks=e;this.fileInsertDialogProvider=k;this.popupController=m;this.dialogController=l;this.errorDialogController=w;this.uiChanged=q;this.isDesktop=r;this.keyboardEventMatcher=y;this.messageHandler=x;this.serviceOptions=z;this.exporterRegistered=
B;this.userHasEditRightsStream=C;this.applicationApis=[];this.logger=E.LoggerModule.getLoggerManager().createLogger("ApplicationControllerImpl");this.networkStatus=c.NetworkStatus.Online;this.panModeEnabled=!1;this.selectionInfo=M.emptySelectionInfo();this.userLicenseInformation=this.cameraZoomEvent=this.navigationEvent=this.textSelectionInfo=null;this.assetsReady=!1;this.currentTopic=null;this.applicationMode=c.ApplicationMode.Edit;this.audioController=new V.AudioController;this.currentDocumentEvents=
[];this.maybeEditorSession=new g.MaybeImpl;this.initialUat=new g.UserActionTokenImpl;this.listDrop=this.currentScrollIntoViewInfo=null;this.sidebarController.getClosedSidebarStream().onValue((a)=>{for(const b of this.applicationApis)b.onCloseSidebar(a)});this.dialogController.getClosedDialogIdStream().onValue((a)=>{for(const b of this.applicationApis)b.onCloseDialog(a)});this.userSettings={getUserId:()=>A,getBoolean:(a)=>p.getBoolean(a),setBoolean:(a,b)=>p.setBoolean(a,b),getObject:(a)=>p.getObject(a),
setObject:(a,b)=>p.setObject(a,b)};this.deviceSettings={setInteractionMode:(a)=>t.setInteractionMode(a),getInteractionMode:()=>t.getInteractionMode(),isInteractionModeInitialized:()=>t.isInteractionModeInitialized()};u.onValue((a)=>{for(const b of this.applicationApis)if(b.handleKeyboardEvent(a))break});this.behaviorExtensions={planetLayouter:new Qa(()=>this.applicationApis),stackLayouter:new Ra(()=>this.applicationApis),topicThemeApplicator:new Sa(()=>this.applicationApis),overviewLayouter:new Ta(()=>
this.applicationApis),contentLayouter:new Ua(()=>this.applicationApis)}}resetPlugins(){this.reset(c.PluginDescriptionKind.regular)}resetPreloadedPlugins(){this.reset(c.PluginDescriptionKind.preloaded)}reset(a){this.applicationApis=this.applicationApis.filter((b)=>{if(b.pluginDescription.pluginDescriptionKind===a){try{this.messageHandler.unregisterMessageProcessor(b.pluginDescription),b.dispose()}catch(d){E.LoggerModule.logException(this.logger,"plugin","reset, scene not updated?",d)}return!1}return!0})}textEdit(a){return this.applicationApis.some((b)=>
b.handleTextEdit(a))}fileDrop(a,b){return this.applicationApis.some((c)=>c.handleFileDrop(a,b))}selectFile(a,b,d){for(let c of this.applicationApis)try{const f=c.handleFileSelect(a,b);if(null!=f){f.then((b)=>d(b,a)).catch((a)=>{this.createLogException(c.pluginDescription)("selectFile",a)});return}}catch(h){this.createLogException(c.pluginDescription)("selectFile",h)}E.avro.Avro.createDefaultLogger().logOpenUploadDialog({upload_object_type:c.FileFilter.getMimeTypes(b).join(","),upload_source:"LOCAL"});
return this.fileInsertDialogProvider.launchFileInsertDialog(b,(a)=>{d(a,"LOCAL")})}afterPaste(a){this.applicationApis.forEach((b)=>b.handleAfterPaste(a))}urlDrop(a){return this.applicationApis.some((b)=>b.handleURLDrop(a))}styledTextDrop(a){return this.applicationApis.some((b)=>b.handleStyledTextDrop(a))}setListDropHandler(a){const b=r.Utils.generateUUID();this.listDrop={id:b,handler:a};return{dragId:b}}listItemDrop(a){null!=this.listDrop&&this.listDrop.id===a.data.dragId&&this.listDrop.handler(a)}renderSidebar(a,
b){for(const c of this.applicationApis){const d=c.handleRenderSidebar(a,b,this.getCurrentScrollIntoViewIds());if(null!=d)return d}return null}renderLeftSidebar(a){for(const b of this.applicationApis){const c=b.handleRenderLeftSidebar(a,this.getCurrentScrollIntoViewIds());if(null!=c)return c}return null}renderDialog(a,b){for(const c of this.applicationApis){const d=c.handleRenderModal(a,b,this.getCurrentScrollIntoViewIds());if(null!=d)return d}return null}setNetworkStatus(a){this.networkStatus=a;for(const b of this.applicationApis)b.setNetworkStatus(a)}setPanMode(a){this.panModeEnabled=
a;for(const b of this.applicationApis)b.setPanMode(a)}handleNavigationEvent(a){if(this.maybeEditorSession.hasValue()&&null!=a){const b=this.maybeEditorSession.value.document.read((b)=>{const c=p.CetModelEditor.createPathElementIdToPlaybackPathPositionMap(b);for(let [d,f]of c.entries())if(a.getToPos().isSame(f))return b.lookup.pathElement(d).ref;return null});this.navigationEvent=null==b?null:{intent:a.getIntent(),pathElementRef:b}}else this.navigationEvent=null;for(const a of this.applicationApis)a.handleNavigation(this.navigationEvent)}handleCameraZoomEvent(a){this.maybeEditorSession.hasValue()&&
(this.cameraZoomEvent=a);for(const a of this.applicationApis)a.handleCameraZoom(this.cameraZoomEvent)}documentChanged(a){for(const b of this.applicationApis)b.handleDocumentChange(a)}licenseChanged(a){this.userLicenseInformation=a;for(const b of this.applicationApis)b.handleLicenseChange(a)}assetsReadyChanged(a){this.assetsReady=a;for(const b of this.applicationApis)b.handleAssetsReadyChange(a)}setSelection(a){this.selectionInfo=a;for(const b of this.applicationApis)b.handleSelectionChange(a)}setTextSelection(a){this.textSelectionInfo=
a;for(const b of this.applicationApis)b.handleTextSelectionChange(a)}setCurrentTopic(a){this.currentTopic=a;for(const b of this.applicationApis)b.handleCurrentTopicChange(a)}setApplicationMode(a){this.applicationMode=a;for(const b of this.applicationApis)b.handleApplicationModeChange(a)}startPdfExport(a){for(const b of this.applicationApis)if(b.handleStartPdfExport(a))break}cancelPdfExport(){for(const a of this.applicationApis)if(a.handleCancelPdfExport())break}createDrawedObject(a,b,c){if(this.maybeEditorSession.hasValue()){const d=
this.maybeEditorSession.value.applicationMode.editMode;if(d.isActive())return d.triggerCreateDrawedObject(a,b,c)}throw Error("Invalid call of function: createDrawedObject");}finishDrawObject(){const a=E.LoggerModule.getLoggerManager().createLogger("ApplicationController"),b=new g.CallHandler((b)=>E.LoggerModule.logException(a,"ApplicationController","errorHandler",b));if(this.maybeEditorSession.hasValue()){const a=this.maybeEditorSession.value.applicationMode.editMode;if(a.isActive()){b.callWithUAT((b)=>
a.triggerFinishDrawObject(b));return}}throw Error("Invalid call of function: finishDrawObject");}updateAllUiState(){for(const a of this.applicationApis)a.handleUpdateUiState()}updateCache(a,b,c){const d=r.Utils.flatten(this.applicationApis.map((a)=>c(a))),e=a();null!=e&&e.length===d.length&&null==e.find((a,b)=>a!==d[b])||b(d);return a()}getMenuItems(){return this.updateCache(()=>this.menuItemsCache,(a)=>{this.menuItemsCache=a},(a)=>a.dropDownMenuItems)}getTopMenuItems(){return this.updateCache(()=>
this.tabMenuItemsCache,(a)=>{this.tabMenuItemsCache=a},(a)=>a.tabMenuItems)}getContextMenuItems(){return this.updateCache(()=>this.contextMenuItemsCache,(a)=>{this.contextMenuItemsCache=a},(a)=>a.contextMenuItems)}getFilePickerDescriptions(){const a=[];for(let b of this.applicationApis)a.push(...b.getFilePickerDescriptions());a.sort((a,c)=>a.name.localeCompare(c.name));return a}getPropertyBarItems(){return this.applicationApis.map((a)=>a.propertyBarItems).reduce((a,b)=>a.concat(b),[])}getNavigationBarItems(){return this.applicationApis.map((a)=>
a.navigationBarItems).reduce((a,b)=>a.concat(b),[])}setEditorSession(a){if(this.maybeEditorSession.hasValue())throw Error("DocumentSession already initialized");this.maybeEditorSession.setValue(a);for(const b of this.applicationApis)b.setEditorSession(a)}userSettingsChange(a){this.currentUserSettings=a;for(let b of this.applicationApis)b.handleUserSettingsChange(a)}documentEvent(a){this.currentDocumentEvents.push(a);for(let b of this.applicationApis)b.handleDocumentEvent(a)}createLogException(a){const b=
E.LoggerModule.getLoggerManager().createLogger(a.name);return(c,f)=>{E.LoggerModule.logException(b,a.name,c,f)}}registerPreloadedPlugin(a,b){return T(this,void 0,void 0,function*(){const c=this.createLogException(a),f=new g.CallHandler((a)=>c("errorHandler",a));if(null==a.featureSwitches||R.evaluateFeatureSwitchCondition(a.featureSwitches)){const d=(yield b()).createPlugin(),e=this.applicationApis.findIndex((b)=>b.pluginDescription.name===a.name);if(0<=e){const a=this.applicationApis[e];this.applicationApis.splice(e,
1);a.handleStop()}const g=new N.ApplicationApiImpl(this.serviceMocks,f,this,this.sidebarController,this.contextMenuController,this.spotlightController,this.pluginServiceProvider,a,d,this.fileInsertDialogProvider,this.networkStatus,this.panModeEnabled,this.currentTopic,this.applicationMode,this.selectionInfo,this.textSelectionInfo,this.popupController,this.dialogController,this.errorDialogController,this,this.uiChanged,this.isDesktop,this.userLicenseInformation,this.navigationEvent,this.cameraZoomEvent,
this.keyboardEventMatcher,this.maybeEditorSession,this.currentUserSettings,this.currentDocumentEvents,this.serviceOptions,this.audioController,this.assetsReady,this.exporterRegistered);y.guard(c,"init",()=>{u.asKillable(g,(b)=>{d.pluginDescription=a;d.pluginAccess=this;d.userSettings=this.userSettings;d.deviceSettings=this.deviceSettings;d.init(b)});g.handleStart();this.applicationApis.push(g);this.messageHandler.registerMessageProcessor(a,g)},null)(null)}})}registerPlugin(a,b){return T(this,void 0,
void 0,function*(){return this.registerPluginI(a,b,(b,c)=>{b.session=c;b.pluginDescription=a})})}registerReadonlyPlugin(a,b){return T(this,void 0,void 0,function*(){return this.registerPluginI(a,b,(b,c)=>{b.session=new y.ReaderSessionImpl(c,this.userHasEditRightsStream);b.pluginDescription=a})})}registerPluginI(a,b,c){return T(this,void 0,void 0,function*(){if(!this.maybeEditorSession.hasValue())throw Error("DocumentSession not initialized");const d=this.createLogException(a),e=new g.CallHandler((a)=>
d("errorHandler",a)),k=this.maybeEditorSession;if(null==a.featureSwitches||R.evaluateFeatureSwitchCondition(a.featureSwitches)){const f=(yield b()).createPlugin(),h=this.applicationApis.findIndex((b)=>b.pluginDescription.name===a.name);if(0<=h){const a=this.applicationApis[h];this.applicationApis.splice(h,1);a.handleStop()}const g=new N.ApplicationApiImpl(this.serviceMocks,e,this,this.sidebarController,this.contextMenuController,this.spotlightController,this.pluginServiceProvider,a,f,this.fileInsertDialogProvider,
this.networkStatus,this.panModeEnabled,this.currentTopic,this.applicationMode,this.selectionInfo,this.textSelectionInfo,this.popupController,this.dialogController,this.errorDialogController,this,this.uiChanged,this.isDesktop,this.userLicenseInformation,this.navigationEvent,this.cameraZoomEvent,this.keyboardEventMatcher,k,this.currentUserSettings,this.currentDocumentEvents,this.serviceOptions,this.audioController,this.assetsReady,this.exporterRegistered);y.guard(d,"init",()=>{u.asKillable(g,(a)=>{c(f,
this.maybeEditorSession.value);f.pluginAccess=this;f.userSettings=this.userSettings;f.deviceSettings=this.deviceSettings;f.init(a)});g.handleStart();this.applicationApis.push(g);this.messageHandler.registerMessageProcessor(a,g)},null)(null)}})}send(a,b){this.messageHandler.sendMessage(a,b)}getColorGrids(a,b){const c=null==a?[]:[...a];b&&this.applicationApis.forEach((a)=>{c.push(...a.colorGrids)});return c}getCurrentScrollIntoViewIds(){var a,b;return null!==(b=null===(a=this.currentScrollIntoViewInfo)||
void 0===a?void 0:a.ids)&&void 0!==b?b:[]}setCurrentScrollIntoViewIds(a){const b=r.Utils.generateUUID();this.currentScrollIntoViewInfo={uuid:b,ids:null!==a&&void 0!==a?a:[]};this.uiChanged();return b}clearCurrentScrollIntoViewIds(a){var b;if((null===(b=this.currentScrollIntoViewInfo)||void 0===b?void 0:b.uuid)!==a)return!1;this.currentScrollIntoViewInfo=null;this.uiChanged();return!0}};L.SnapshotRendererImpl=class{constructor(a,b){this.stage=b;this.stagePos={x:0,y:0};a.onValue((a)=>{this.stagePos=
a})}drawSampleForMouse(a){return T(this,void 0,void 0,function*(){var b=a.width;const c=a.height,f=this.stage.getStageCamera().getStageArea().getData();b={x:this.stagePos.x-f.x-b/2,y:this.stagePos.y-f.y-c/2,width:b,height:c};yield this.stage.getRenderer().drawSample(a,b)})}};class Qa{constructor(a){this.getApplicationApis=a}apply(a,b,c,f){for(const d of this.getApplicationApis())if(d.handlePlanetLayoutEvent(a,b,c,f))return!0;return!1}isValid(a,b){for(const c of this.getApplicationApis())if(c.handlePlanetLayoutIsValid(a,
b))return!0;return!1}}class Ra{constructor(a){this.getApplicationApis=a}apply(a,b,c,f){for(const d of this.getApplicationApis())if(d.handleStackLayoutEvent(a,b,c,f))return!0;return!1}isValid(a,b){for(const c of this.getApplicationApis())if(c.handleStackLayoutIsValid(a,b))return!0;return!1}}class Ua{constructor(a){this.getApplicationApis=a}apply(a,b,c){for(const d of this.getApplicationApis())if(d.handleContentLayoutEvent(a,b,c))return!0;return!1}isValid(a,b){for(const c of this.getApplicationApis())if(c.handleContentLayoutIsValid(a,
b))return!0;return!1}}class Ta{constructor(a){this.getApplicationApis=a}apply(a,b,c,f){for(const d of this.getApplicationApis())if(d.handleOverviewLayoutEvent(a,b,c,f))return!0;return!1}isValid(a,b){for(const c of this.getApplicationApis())if(c.handleOverviewLayoutIsValid(a,b))return!0;return!1}}class Sa{constructor(a){this.getApplicationApis=a}apply(a,b,c){for(const d of this.getApplicationApis())if(d.handleTopicLayoutApplication(a,b,c))return!0;return!1}}var na={};Object.defineProperty(na,"__esModule",
{value:!0});var aa=p.base.ObjectKind;na.PluginSessionImpl=class{constructor(a,b,d,f,e,g,k,l,w,q,p,t,u,y,x,z,B,C,D,E,G){this.documentEvents=C;this.exporterRegistered=E;this.serviceMocks={};p=Ba.DataServiceModule.createUserSettingsStore(p);this.applicationController=new L.ApplicationControllerImpl(b,d,f,e,this.serviceMocks,g,k,l,w,q,p,G,t,u,y,x,z,D,E,a.getUserHasEditRightsStream());a.getDeferredNetworkStatusStream().skipDuplicates().onValue((a)=>{this.applicationController.setNetworkStatus(1===a?c.NetworkStatus.Online:
c.NetworkStatus.Offline)});a.getDeferredPanModeStream().skipDuplicates().onValue((a)=>{this.applicationController.setPanMode(a)});a.getDeferredUserLicenseInformationStream().onValue((a)=>{this.applicationController.licenseChanged(a)});a.getDeferredCurrentTopicStream().onValue((a)=>{this.applicationController.setCurrentTopic(a)});a.getDeferredNavigationEventStream().onValue((a)=>{this.applicationController.handleNavigationEvent(a)});a.getDeferredModeStream().onValue((a)=>{this.applicationController.setApplicationMode(((a)=>
{switch(a){case A.EditorMode.animationPreview:return c.ApplicationMode.AnimationPreview;case A.EditorMode.edit:return c.ApplicationMode.Edit;case A.EditorMode.follow:return c.ApplicationMode.Follow;case A.EditorMode.info:return c.ApplicationMode.Info;case A.EditorMode.playback:return c.ApplicationMode.Playback;case A.EditorMode.templateChooser:return c.ApplicationMode.TemplateChooser;case A.EditorMode.view:return c.ApplicationMode.View;default:return r.Utils.assertNever(a)}})(a.kind))});B.onValue((a)=>
this.applicationController.userSettingsChange(a));C.filter((a)=>{switch(a.kind){case c.DocumentEventKind.Create:return!0;case c.DocumentEventKind.Metadata:return null!=a.preziOid;default:r.Utils.assertNever(a)}}).onValue((a)=>this.applicationController.documentEvent(a))}onDocumentLoaded(a,b,d,f,e,g,k,l,w,r,F,t,u,x,z,A,B,C,E,D,G,H,I,J,M){H=new L.SnapshotRendererImpl(H,D);a=p.CetModelEditor.createRunner(a,d,F,this.applicationController.behaviorExtensions,t);e=new Va(e);g=this.createSelectionApi(k,g,
w);F=p.CetModelEditor.createProgressiveAssetManager(b.preziOid,d,u,q.Cet.createAudioPatcher(t),q.Cet.createImagePatcher(t),q.Cet.createChartPatcher(t),q.Cet.createVideoPatcher(t),q.Cet.createPdfPatcher(t),x,z,A,B,F,C,E,t,J.getMainStage().getRenderer().getAssetManager());w=w.getTextEditEvents().map((a)=>()=>this.applicationController.textEdit(a));t=K.Bacon.combineWith((a,b)=>({changeEvents:a,textSelectionState:b}),d.getImmediateChangeStream(q.ChangeEventKind.Entity).filter((a)=>a.some((a)=>a.componentKey===
q.Cet.getSelectionTextRangeComponentKey()||a.componentKey===q.Cet.getTextCaretOffsetComponentKey())),k.getTextSelectionStateStream()).filter(({textSelectionState:a})=>null!=a).map(({textSelectionState:a})=>{a=a.isSingleSelection()?d.getEntityById(a.getEntityIds()[0]):null;if(null!=a){const b=a.get(q.Cet.getSelectionTextRangeComponentKey()),d=a.get(q.Cet.getTextCaretOffsetComponentKey());return{offset:null!=b?b.start:d,length:null!=b?b.end-b.start:0,caretPosition:null!=b&&b.start===d?c.CaretPosition.Start:
c.CaretPosition.End,id:a.getId(),isFocused:a.get(q.Cet.getTextSelectionFocusedComponentKey())}}return null}).skipDuplicates((a,b)=>null==a||null==b?a===b:a.offset===b.offset&&a.length===b.length&&a.id===b.id&&a.caretPosition===b.caretPosition&&a.isFocused===b.isFocused).map((a)=>()=>this.applicationController.setTextSelection(a));u=k.getSelectionStream().map((a)=>()=>this.applicationController.setSelection(a));K.Bacon.mergeAll([w,t,u]).onValue((a)=>Promise.resolve().then(()=>a()));I.onValue((a)=>
{this.applicationController.documentChanged(a)});I=new Wa(k.getCoverEditModeStream());const h=K.Bacon.newBus();k.addChangeModeActionStream(h);const m=K.Bacon.newBus();k.addChangeEditingKindStream(m);l=new y.ApplicationModeApiImpl((a)=>{h.push(a)},(a)=>m.push(a),k.getModeStream(),l);r=new y.NavigationApiImpl(d,r,(a)=>{h.push(a)},k);k=new y.HoverDecoratorOnCanvasApiImpl(k);w=new y.VideoBackgroundApiImpl(D);const n=new y.DocumentSessionImpl(d,F,b,a,G,M,J,this.documentEvents.map((a)=>a.kind===c.DocumentEventKind.Metadata&&
null!=a.preziOid?a:null).filter((a)=>null!=a),!1);this.editorSession=new y.EditorSessionImpl(n,e,f,g,I,l,r,k,D,H,w);J.getAssetsReadyProperty().onValue((a)=>{n.assetsReady=a;this.applicationController.assetsReadyChanged(a)});this.applicationController.setEditorSession(this.editorSession);const v=p.CetModelEditor.createCameraControl(D.getCamera());D.getCamera().getCameraTransformStream().filter((a)=>a.currentTransitionType===q.CameraTransitionType.Zoom||a.currentTransitionType===q.CameraTransitionType.Fly).onValue(()=>
{this.applicationController.handleCameraZoomEvent({cameraLayoutBox:v.getScreenLayoutBox()})})}getEditorSession(){return this.editorSession}getThumbnailSession(){return this.editorSession}createSelectionApi(a,b,c){return new Xa(a,b,c)}registerServiceMock(a,b){this.serviceMocks[g.concatUrlParts(a)]=b}get pluginAccess(){return this.applicationController}};class Xa{constructor(a,b,c){this.editorStore=a;this.selectionController=b;this.textSelectionController=c}selectI(a,b){this.selectionController.select({selectedGroupIds:a.filter((a)=>
a.is(aa.group)).map((a)=>a.id),selectedEntityIds:a.filter((a)=>!a.is(aa.group)).map((a)=>a.id),type:b})}addToSelection(a,b){g.checkAT(a);this.selectI(b,M.SelectActionType.add)}removeFromSelection(a,b){g.checkAT(a);this.selectI(b,M.SelectActionType.remove)}setSelection(a,b){g.checkAT(a);this.selectI(b,M.SelectActionType.replace)}toggleSelection(a,b){g.checkAT(a);this.selectI(b,M.SelectActionType.toggle)}getSelectionInfo(a){return g.selectionToTransformedSelection(a,this.editorStore.getSelection())}getReadonlySelectionInfo(a){return g.selectionToReadonlyTransformedSelection(a,
this.editorStore.getSelection())}getTextSelectionInfo(){return this.textSelectionController.getTextSelectionInfo()}setTextSelection(a,b){g.checkAT(a);return this.textSelectionController.setTextSelection(b)}}class Va{constructor(a){this.insertHierarchyDestination=a}getSimpleObjectParent(a){if(this.insertHierarchyDestination.getCurrentKind()===p.InsertHierarchyDestinationKind.COVER)return a.lookup.topic(this.insertHierarchyDestination.getCurrentParentId()).cover;a=a.lookup.base(this.insertHierarchyDestination.getCurrentParentId());
return null!=a&&a.is(aa.simpleObjectParent)?a:null}getSimpleObjectParentReader(a){if(this.insertHierarchyDestination.getCurrentKind()===p.InsertHierarchyDestinationKind.COVER)return a.lookup.topic(this.insertHierarchyDestination.getCurrentParentId()).cover;a=a.lookup.base(this.insertHierarchyDestination.getCurrentParentId());return null!=a&&a.is(aa.simpleObjectParent)?a:null}}class Wa{constructor(a){a.onValue((a)=>this.coverEditMode=a)}getMode(a){return this.getModeI((b)=>a.lookup.base(b))}getReadonlyMode(a){return this.getModeI((b)=>
a.lookup.base(b))}getModeI(a){if(null==this.coverEditMode)return{kind:c.CoverEditModeKind.None};switch(this.coverEditMode.kind){case H.CoverEditModeKind.advanced:a=a(this.coverEditMode.topicId);if(null==a)return{kind:c.CoverEditModeKind.None};this.assertIsTopic(a);return{kind:c.CoverEditModeKind.Advanced,topic:a};case H.CoverEditModeKind.insideAdvanced:a=a(this.coverEditMode.topicOrOverviewId);if(null==a)return{kind:c.CoverEditModeKind.None};this.assertIsTopicOrOverview(a);return{kind:c.CoverEditModeKind.InsideAdvanced,
topicOrOverview:a};case H.CoverEditModeKind.titleEditOnly:a=a(this.coverEditMode.topicId);if(null==a)return{kind:c.CoverEditModeKind.None};this.assertIsTopic(a);return{kind:c.CoverEditModeKind.Title,topic:a};default:r.Utils.assertNever(this.coverEditMode)}}assertIsTopic(a){if(!a.is(p.base.ObjectKind.topic))throw Error(a.id+"is not a topic");}assertIsTopicOrOverview(a){if(!a.is(p.base.ObjectKind.topic)&&!a.is(p.base.ObjectKind.overview))throw Error(a.id+"is not a topic or overview");}}var ua={startRender:function(a,
b,c,e){if(!(b instanceof L.ApplicationControllerImpl))throw Error("not PreloadedApplicationControllerImpl");wa.render(k.createElement(ta,{uiStore:c,applicationController:b,spotlight:e}),a)}};Object.defineProperty(ua,"__esModule",{value:!0});class ta extends k.PureComponent{constructor(){super(...arguments);this.state={modalId:{kind:x.DialogKind.None},popupIds:[]}}componentWillMount(){this.unsubscribe=[this.props.uiStore.getOpenedDialogPropsStream().onValue((a)=>this.setState({modalId:a})),this.props.uiStore.getOpenedPopupIdStream().onValue((a)=>
this.setState({popupIds:[a]}))]}componentWillUnmount(){null!=this.unsubscribe&&this.unsubscribe.forEach((a)=>a())}render(){return k.createElement("div",{style:{lineHeight:"normal",userSelect:"none"}},this.state.modalId.kind===x.DialogKind.Custom?k.createElement("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"}},this.props.applicationController.renderDialog(this.state.modalId,this.state.popupIds)):null,c.createPopupLayer(),this.props.spotlight.ui.render())}}
ta.displayName="PreloadedUI";var c={createMessageHandler:function(){return new ia.MessageHandlerImpl}};Object.defineProperty(c,"__esModule",{value:!0});(function(a){a.image="image";a.mask="mask"})(c.MaskEditTarget||(c.MaskEditTarget={}));(function(a){a.desktop="desktop";a.always="always";a.none="none"})(c.SupportsOffline||(c.SupportsOffline={}));(function(a){a.preloaded="preloaded";a.regular="regular";a.readonly="readonly"})(c.PluginDescriptionKind||(c.PluginDescriptionKind={}));(function(a){a.None=
"none";a.Watermark="watermark";a.DocumentBased="document-based"})(c.PreziLogoType||(c.PreziLogoType={}));(function(a){a.Create="Create";a.Metadata="Metadata"})(c.DocumentEventKind||(c.DocumentEventKind={}));c.initPreloadedUI=function(a,b,c,e){ua.startRender(a,b,c,e)};(function(a){a.None="None";a.Title="Title";a.Advanced="Advanced";a.InsideAdvanced="InsideAdvanced"})(c.CoverEditModeKind||(c.CoverEditModeKind={}));(function(a){a.click="click";a.draw="draw"})(c.DrawInsertIntent||(c.DrawInsertIntent=
{}));(function(a){a.drag="drag";a.click="click"})(c.DropKind||(c.DropKind={}));(function(a){a.Playback="playback";a.Edit="edit";a.View="view";a.Info="info";a.TemplateChooser="templatechooser";a.Follow="follow";a.AnimationPreview="animationPreview"})(c.ApplicationMode||(c.ApplicationMode={}));(function(a){a.Online="Online";a.Offline="Offline"})(c.NetworkStatus||(c.NetworkStatus={}));(function(a){a[a.EndTransaction=0]="EndTransaction";a[a.BeginOtherTransaction=1]="BeginOtherTransaction";a[a.AbortTransaction=
2]="AbortTransaction";a[a.RollbackTransaction=3]="RollbackTransaction"})(c.FinishEventKind||(c.FinishEventKind={}));(function(a){a.Success="Success";a.Error="Error";a.ErrorExternalEdit="ErrorExternalEdit"})(c.SaveResult||(c.SaveResult={}));(function(a){a.Start="start";a.End="end"})(c.CaretPosition||(c.CaretPosition={}));(function(a){a.Insert="insert";a.Command="command"})(c.TextEditEventKind||(c.TextEditEventKind={}));(function(a){a.Enter="Enter";a.Backspace="Backspace";a.Delete="Delete";a.Tab="Tab"})(c.TextEditCommandKind||
(c.TextEditCommandKind={}));c.emptySelectionInfo=function(){return{allObjects:[],groups:[],nonGroupedObjects:[]}};c.emptySelectionChangeInfo=function(){return{allObjects:[],groups:[],nonGroupedObjects:[]}};(function(a){a.next="next";a.prev="prev";a["goto"]="goto"})(c.NavigationIntent||(c.NavigationIntent={}));(function(a){a.file="file";a.preziContent="preziContent"})(c.PasteEventType||(c.PasteEventType={}));(c.ExportFormat||(c.ExportFormat={})).pdf="pdf";(function(a){a.success="success";a.failure=
"failure"})(c.ExportResultStatus||(c.ExportResultStatus={}));(function(a){a.remove="remove";a.reset="reset";a.adjust="adjust"})(c.TopicLayoutEventKind||(c.TopicLayoutEventKind={}));(function(a){a.full="Full";a.extraLarge="ExtraLarge";a.large="Large";a.medium="Medium";a.small="Small";a.corner="Corner"})(c.DialogType||(c.DialogType={}));(function(a){a.Short="Short";a.Full="Full"})(c.PopupHeight||(c.PopupHeight={}));(function(a){a.Hamburger="hamburgerMenu";a.Lab="labMenu";a.Debug="debugMenu";a.Present=
"presentMenu"})(c.MenuId||(c.MenuId={}));(function(a){a.Insert="insertMenu";a.Style="styleMenu";a.Share="shareMenu";a.First="firstItems";a.Media="mediaMenu";a.Shapes="shapesMenu";a.Other="otherItems";a.Present="presentMenu";a.Hamburger="hamburgerMenu"})(c.TopMenuId||(c.TopMenuId={}));(function(a){a.dropdown="dropDown";a.dropdownDivider="dropDownDivider";a.largeButton="largeButton";a.largeMenu="largeMenu";a.context="context"})(c.MenuItemKind||(c.MenuItemKind={}));(function(a){a.Mac="mac";a.Windows=
"windows"})(c.OsKind||(c.OsKind={}));(function(a){a.successfullyStarted="successfullyStarted";a.playbackStartFailure="playbackStartFailure";a.genericFailure="genericFailure"})(c.VideoBackgroundStatusCode||(c.VideoBackgroundStatusCode={}));c.createPluginSession=function(a,b,c,e,g,k,l,p,q,r,u,t,x,y,z,A,B,C,D,E,G){return new na.PluginSessionImpl(a,b,c,e,g,k,l,p,q,r,u,t,x,y,z,A,B,C,D,E,G)};c.createPopupLayer=function(){return k.createElement(e.Layer,{id:"popup-layer",zIndex:203})};c.createApplicationUI_Internal=
function(a,b,c,e,h,k,l,p=()=>{}){class d{get(a,b){b=a[b];return"function"===typeof b?b.bind(a):b}set(a,b,c){a[b]=c;return!0}}return new class extends Y.ApplicationUIImpl{constructor(){super(new Proxy({callWithUAT:(a)=>a(new Proxy({},new d)),call:(a)=>a()},new d),new Proxy({setListDropHandler:(a)=>a(new Proxy({},new d)),getFilePickerDescriptions:()=>[{icon:va.Upload,id:"some-id",name:"some name"}],selectFile:(a,b,c)=>{l.launchFileInsertDialog(b,(a)=>c(a,"LOCAL"))}},new d),new Proxy({},new d),new Proxy({},
new d),new Proxy({togglePopup:b,openPopup:c,closePopup:e,isPopupOpen:h},new d),new Proxy({show:p,hide:()=>{},showBuiltIn:()=>{},hideBuiltIn:()=>{},showError:()=>{},showBuiltInError:()=>{},showIFrame:()=>null},new d),new Proxy({registerPopup:a,openPopup:c,closePopup:e,togglePopup:b},new d),new Proxy({getColorGrids:(a)=>null==a?[]:a},new d),l,new g.MaybeImpl,{},new V.AudioController)}}};c.invalidateAsyncUserActionTokens=function(){g.invalidateAsyncUserActionTokensI()};(c.NamedColors||(c.NamedColors=
{})).topicButton="topicButton";(function(a){a.neutral="neutral";a.blue="blue"})(c.SpinnerColor||(c.SpinnerColor={}));(function(a){a.l="L";a.m="M";a.s="S";a.xs="XS"})(c.SpinnerSize||(c.SpinnerSize={}));(function(a){a.center="center";a.corner="corner"})(c.DialogAlign||(c.DialogAlign={}));(function(a){a.none="none";a.unchecked="unchecked";a.checked="checked"})(c.CheckedState||(c.CheckedState={}));(function(a){a.video="video";a.image="image"})(c.HoverContentType||(c.HoverContentType={}));(function(a){a[a.Gray=
0]="Gray";a[a.Ghost=1]="Ghost";a[a.Blue=2]="Blue";a[a.Red=3]="Red";a[a.Green=4]="Green";a[a.Gold=5]="Gold"})(c.ButtonColor||(c.ButtonColor={}));(function(a){a[a.Small=0]="Small";a[a.Large=1]="Large"})(c.ButtonSize||(c.ButtonSize={}));(function(a){a.Start="flex-start";a.End="flex-end";a.Center="center";a.Justified="space-between"})(c.ButtonAlign||(c.ButtonAlign={}));(function(a){a[a.Rounded=0]="Rounded";a[a.Circle=1]="Circle"})(c.ButtonShape||(c.ButtonShape={}));c.SubmenuSeparatorConst="SubmenuSeparator";
(function(a){a.Restart="Restart";a.Cancel="Cancel";a.None="None"})(c.ProgressBarControl||(c.ProgressBarControl={}));(function(a){a.title="title";a.icon="icon"})(c.TabMenuItemKind||(c.TabMenuItemKind={}));(function(a){a.full="Full";a.large="Large";a.small="Small";a.numbered="Numbered"})(c.ListItemType||(c.ListItemType={}));(function(a){a.dynamic="Dynamic";a.fixed="Fixed"})(c.ListItemLayout||(c.ListItemLayout={}));(function(a){a.finished="finished";a.working="working";a.idle="idle"})(c.ListProgress||
(c.ListProgress={}));(function(a){a.medium_1_1="medium_1_1";a.medium_1_small_1="medium_1_small_1";a.medium_2="medium_2";a.extraLarge_1_1_1="extraLarge_1_1_1";a.extraLarge_big_small_big="extraLarge_big_small_big";a.extraLarge_1_2="extraLarge_1_2";a.extraLarge_2_1="extraLarge_2_1";a.extraLarge_3="extraLarge_3"})(c.DialogItemRowLayout||(c.DialogItemRowLayout={}));(function(a){a.top="top";a.center="center";a.bottom="bottom"})(c.DialogItemRowVerticalAlignment||(c.DialogItemRowVerticalAlignment={}));(function(a){a.circle=
"circle";a.rect="rect";a.rounded="rounded"})(c.HoleShape||(c.HoleShape={}));(function(a){a[a.Image=0]="Image";a[a.Mp4=1]="Mp4"})(c.CalloutMediaTypes||(c.CalloutMediaTypes={}));(function(a){a.leftSidebar="leftSidebar";a.sidebar="sidebar";a.simpleList="simpleList";a.multiSelectList="multiSelectList";a.dialog="dialog";a.fullDialog="fullDialog";a.extraLargeDialog="extraLargeDialog";a.extraExtraLargeDialog="extraExtraLargeDialog";a.largeDialog="largeDialog";a.mediumDialog="mediumDialog";a.smallDialog=
"smallDialog";a.alertDialog="alertDialog";a.dialogRow="dialogRow";a.popup="popup";a.menu="menu";a.propertybar="propertybar";a.timelineList="timelineList"})(c.ContainerKind||(c.ContainerKind={}));(function(a){a.Container="Container";a.Simple="Simple"})(c.ItemKind||(c.ItemKind={}));(function(a){a.Keyboard="keyboard";a.Mouse="mouse"})(c.ActionTrigger||(c.ActionTrigger={}));c.DropdownMenuSeparatorConst="Separator";(function(a){a.Image="image";a.GroupHeader="groupHeader"})(c.PropertyBarDropdownItemKind||
(c.PropertyBarDropdownItemKind={}));(function(a){a[a.Info=0]="Info";a[a.ImportantInfo=1]="ImportantInfo";a[a.Error=2]="Error"})(c.CautionTypes||(c.CautionTypes={}));(function(a){a.contactSalesCommenting="contact_sales_commenting_modal";a.airCreationFromPresent="air_creation_from_present";a.pitchCreationLimit="pitch_creation_limit";a.presenterViewDesktopDownload="presenter_view_desktop_download_modal";a.privacyPaywallWarning="privacy_paywall_warning";a.shareDialogCollaborators="share_dialog_collaborators";
a.shareDialogViewLinks="share_dialog_viewlinks";a.upgradeLicenseIconSearch="upgrade_license_icon_search";a.upgradeLicenseImageSearch="upgrade_license_image_search";a.upgradeLicenseInsertAudio="upgrade_license_insert_audio_modal";a.upgradeLicenseInsertChart="upgrade_license_insert_chart_modal";a.upgradeLicenseInsertVideo="upgrade_license_insert_video_modal";a.upgradeLicenseLivePrezi="upgrade_license_live_prezi_modal";a.upgradeLicenseNoWatermark="upgrade_license_no_watermark";a.upgradeLicenseCustomLogo=
"upgrade_license_custom_logo";a.upgradeLicensePresenterView="upgrade_license_presenter_view_modal";a.upgradeLicenseScheme="upgrade_license_scheme";a.upgradeLicenseShareViewLink="upgrade_license_share_viewlink";a.upgradeLicenseStoryblocks="upgrade_license_storyblocks";a.upgradeLicenseTextScheme="upgrade_license_text_scheme";a.upgradeLicenseMaster="upgrade_license_master";a.upgradeLicenseDownloadForPresentation="upgrade_license_download_for_presentation";a.upgradeLicensePitchPdfExport="upgrade_license_pitch_pdf_export";
a.downloadPresentation="download_for_presentation"})(c.BuiltinDialog||(c.BuiltinDialog={}));(function(a){a[a.A=65]="A";a[a.B=66]="B";a[a.C=67]="C";a[a.D=68]="D";a[a.E=69]="E";a[a.F=70]="F";a[a.G=71]="G";a[a.H=72]="H";a[a.I=73]="I";a[a.J=74]="J";a[a.K=75]="K";a[a.L=76]="L";a[a.M=77]="M";a[a.N=78]="N";a[a.O=79]="O";a[a.P=80]="P";a[a.Q=81]="Q";a[a.R=82]="R";a[a.S=83]="S";a[a.T=84]="T";a[a.U=85]="U";a[a.V=86]="V";a[a.W=87]="W";a[a.X=88]="X";a[a.Y=89]="Y";a[a.Z=90]="Z"})(c.Key||(c.Key={}));c.createUatForTest=
function(){return g.createUatForTestI()};const Ya=["application/octet-stream"];c.FileFilter={passes:(a,b)=>{if(null==b)return!1;if(null==b.type||""===b.type||-1<Ya.indexOf(b.type))return a=c.FileFilter.getExtensions(a),b="."+b.name.split(".").pop().toLowerCase(),0===a.length||0<=a.indexOf(b);a=c.FileFilter.getMimeTypes(a);return 0===a.length||0<=a.indexOf(b.type)},getMimeTypes:(a)=>{let b=[];a.allowAudio&&(b=[...b,"audio/mpeg","audio/mpeg3","audio/x-m4a","audio/mp4a-latm","audio/mp4"]);a.allowImage&&
(b=[...b,"image/png","image/jpg","image/jpeg","image/gif"]);a.allowPdf&&(b=[...b,"application/pdf"]);a.allowVideo&&(b=[...b,"video/mp4"]);a.allowPpt&&(b=[...b,"application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"]);return b},getExtensions:(a)=>{let b=new Set;for(const d of c.FileFilter.getMimeTypes(a))a=r.Utils.getExtensionFromMimeType(d),null!=a&&""!==a&&b.add(a);return[...b]}};(function(a){a.AppIconBluejeans="icon-large-app-icon-bluejeans";a.AppIconGoToMeeting=
"icon-large-app-icon-go-to-meeting";a.AppIconGoogleMeet="icon-large-app-icon-google-meet";a.AppIconMicrosoftTeams="icon-large-app-icon-microsoft-teams";a.AppIconOBS="icon-large-app-icon-o-b-s";a.AppIconSkype="icon-large-app-icon-skype";a.AppIconSlack="icon-large-app-icon-slack";a.AppIconWebex="icon-large-app-icon-webex";a.AppIconZoom="icon-large-app-icon-zoom";a.AssetError="icon-large-asset-error";a.Camera="icon-large-camera";a.Explore="icon-large-explore";a.ExploreOutline="icon-large-explore-outline";
a.Facebook="icon-large-facebook";a.File="icon-large-file";a.FileUpload="icon-large-file-upload";a.GoLive="icon-large-go-live";a.Heart="icon-large-heart";a.HeartOutline="icon-large-heart-outline";a.HelpWithCircle="icon-large-help-with-circle";a.Image="icon-large-image";a.Insert="icon-large-insert";a.LinkedIn="icon-large-linked-in";a.Login="icon-large-login";a.MyLibrary="icon-large-my-library";a.NoCamera="icon-large-no-camera";a.Pause="icon-large-pause";a.Play="icon-large-play";a.Plus="icon-large-plus";
a.Recent="icon-large-recent";a.RecentOutline="icon-large-recent-outline";a.Replay="icon-large-replay";a.Reuse="icon-large-reuse";a.Search="icon-large-search";a.StaffPick="icon-large-staff-pick";a.Style="icon-large-style";a.Twitter="icon-large-twitter";a.YouTube="icon-large-you-tube"})(c.IconLargeId||(c.IconLargeId={}));(function(a){a.AppIconGoogleMeet="icon-mini-app-icon-google-meet";a.AppIconMicrosoftTeams="icon-mini-app-icon-microsoft-teams";a.AppIconWebex="icon-mini-app-icon-webex";a.AppIconZoom=
"icon-mini-app-icon-zoom";a.Check="icon-mini-check";a.ChevronDown="icon-mini-chevron-down";a.ChevronRight="icon-mini-chevron-right";a.ChevronUp="icon-mini-chevron-up";a.Close="icon-mini-close";a.DoubleDropdown="icon-mini-double-dropdown";a.Lock="icon-mini-lock";a.MacOS="icon-mini-mac-o-s";a.VideoConference="icon-mini-video-conference";a.Windows="icon-mini-windows"})(c.IconMiniId||(c.IconMiniId={}));var va;(function(a){a.Add="icon-small-add";a.AddAnimation="icon-small-add-animation";a.AddSlide="icon-small-add-slide";
a.AddToMyLibrary="icon-small-add-to-my-library";a.AddUser="icon-small-add-user";a.AlignCenter="icon-small-align-center";a.AlignContentBottom="icon-small-align-content-bottom";a.AlignContentCenter="icon-small-align-content-center";a.AlignContentLeft="icon-small-align-content-left";a.AlignContentMiddle="icon-small-align-content-middle";a.AlignContentRight="icon-small-align-content-right";a.AlignContentTop="icon-small-align-content-top";a.AlignJustify="icon-small-align-justify";a.AlignLeft="icon-small-align-left";
a.AlignRight="icon-small-align-right";a.Animation="icon-small-animation";a.AppIconBluejeans="icon-small-app-icon-bluejeans";a.AppIconChrome="icon-small-app-icon-chrome";a.AppIconGoToMeeting="icon-small-app-icon-go-to-meeting";a.AppIconGoToMeetingLegacy="icon-small-app-icon-go-to-meeting-legacy";a.AppIconGoogleMeet="icon-small-app-icon-google-meet";a.AppIconJoinMe="icon-small-app-icon-join-me";a.AppIconMicrosoftTeams="icon-small-app-icon-microsoft-teams";a.AppIconOBS="icon-small-app-icon-o-b-s";a.AppIconSkype=
"icon-small-app-icon-skype";a.AppIconSlack="icon-small-app-icon-slack";a.AppIconWebex="icon-small-app-icon-webex";a.AppIconYouTube="icon-small-app-icon-you-tube";a.AppIconZoom="icon-small-app-icon-zoom";a.ArrowBoldUp="icon-small-arrow-bold-up";a.ArrowLineLeft="icon-small-arrow-line-left";a.ArrowLineRight="icon-small-arrow-line-right";a.ArrowsAndLines="icon-small-arrows-and-lines";a.AssetError="icon-small-asset-error";a.Audio="icon-small-audio";a.AverageHeight="icon-small-average-height";a.AverageWidth=
"icon-small-average-width";a.BackgroundRemove="icon-small-background-remove";a.Backward="icon-small-backward";a.Bold="icon-small-bold";a.Bookmark="icon-small-bookmark";a.BorderColor="icon-small-border-color";a.BorderWeight="icon-small-border-weight";a.BrandKit="icon-small-brand-kit";a.Brush="icon-small-brush";a.BulletPoint="icon-small-bullet-point";a.Bynder="icon-small-bynder";a.Camera="icon-small-camera";a.CameraOff="icon-small-camera-off";a.Caption="icon-small-caption";a.Charts="icon-small-charts";
a.Chat="icon-small-chat";a.Check="icon-small-check";a.ChevronDown="icon-small-chevron-down";a.ChevronLeft="icon-small-chevron-left";a.ChevronRight="icon-small-chevron-right";a.ChevronUp="icon-small-chevron-up";a.Clicker="icon-small-clicker";a.Close="icon-small-close";a.Code="icon-small-code";a.Comment="icon-small-comment";a.ContentOff="icon-small-content-off";a.ContentOn="icon-small-content-on";a.Copy="icon-small-copy";a.CoverSettings="icon-small-cover-settings";a.Crop="icon-small-crop";a.Crown="icon-small-crown";
a.Css="icon-small-css";a.CustomStartingpoint="icon-small-custom-startingpoint";a.Cycle="icon-small-cycle";a.DecreaseTextSize="icon-small-decrease-text-size";a.DistributeHorizontal="icon-small-distribute-horizontal";a.DistributeVertical="icon-small-distribute-vertical";a.Docs="icon-small-docs";a.DoubleDropdown="icon-small-double-dropdown";a.Download="icon-small-download";a.Draft="icon-small-draft";a.Dropbox="icon-small-dropbox";a.Dropdown="icon-small-dropdown";a.Edit="icon-small-edit";a.EditChart=
"icon-small-edit-chart";a.EditImage="icon-small-edit-image";a.Emoji="icon-small-emoji";a.Equations="icon-small-equations";a.ExitFullScreen="icon-small-exit-full-screen";a.Explore="icon-small-explore";a.ExploreOutline="icon-small-explore-outline";a.Export="icon-small-export";a.Export2="icon-small-export2";a.EyeDropper="icon-small-eye-dropper";a.Facebook="icon-small-facebook";a.FadeIn="icon-small-fade-in";a.FadeOut="icon-small-fade-out";a.File="icon-small-file";a.FileUpload="icon-small-file-upload";
a.FillColor="icon-small-fill-color";a.Folder="icon-small-folder";a.FolderWithUser="icon-small-folder-with-user";a.Forward="icon-small-forward";a.Fullscreen="icon-small-fullscreen";a.Gif="icon-small-gif";a.Gihpy="icon-small-gihpy";a.GoLive="icon-small-go-live";a.GoogleClassroom="icon-small-google-classroom";a.GoogleClassroomColor="icon-small-google-classroom-color";a.GoogleDrive="icon-small-google-drive";a.GoogleSlides="icon-small-google-slides";a.Group="icon-small-group";a.Hamburger="icon-small-hamburger";
a.HamburgerThick="icon-small-hamburger-thick";a.HandTool="icon-small-hand-tool";a.Heart="icon-small-heart";a.HeartBroken="icon-small-heart-broken";a.HeartOutline="icon-small-heart-outline";a.Help="icon-small-help";a.HelpWithCircle="icon-small-help-with-circle";a.HiddenNew="icon-small-hidden-new";a.History="icon-small-history";a.Home="icon-small-home";a.Icon="icon-small-icon";a.Icons8="icon-small-icons8";a.Image="icon-small-image";a.Import="icon-small-import";a.IncreaseTextSize="icon-small-increase-text-size";
a.Indent="icon-small-indent";a.Info="icon-small-info";a.InfoWithCircle="icon-small-info-with-circle";a.Italic="icon-small-italic";a.Lab="icon-small-lab";a.LeftSidebar="icon-small-left-sidebar";a.LineThicker="icon-small-line-thicker";a.LineThinner="icon-small-line-thinner";a.Link="icon-small-link";a.LinkedIn="icon-small-linked-in";a.LivePrezi="icon-small-live-prezi";a.Lock="icon-small-lock";a.Login="icon-small-login";a.Logout="icon-small-logout";a.MacOS="icon-small-mac-o-s";a.Mail="icon-small-mail";
a.Menu="icon-small-menu";a.Mic="icon-small-mic";a.MicOff="icon-small-mic-off";a.MicOn="icon-small-mic-on";a.MiniZebra="icon-small-mini-zebra";a.Minus="icon-small-minus";a.MoreHorizontal="icon-small-more-horizontal";a.MoreVertical="icon-small-more-vertical";a.MyLibrary="icon-small-my-library";a.Nametag="icon-small-nametag";a.Navigation="icon-small-navigation";a.NewTopic="icon-small-new-topic";a.NotEditable="icon-small-not-editable";a.Offline="icon-small-offline";a.OneDrive="icon-small-one-drive";a.OpenInNew=
"icon-small-open-in-new";a.OtherPopularAppsDark="icon-small-other-popular-apps-dark";a.OtherPopularAppsLight="icon-small-other-popular-apps-light";a.Outdent="icon-small-outdent";a.Path="icon-small-path";a.Pause="icon-small-pause";a.PdfFile="icon-small-pdf-file";a.Placeholder="icon-small-placeholder";a.PlaceholderMidSize="icon-small-placeholder-mid-size";a.PlanetTopic="icon-small-planet-topic";a.Play="icon-small-play";a.Plus="icon-small-plus";a.Ppt="icon-small-ppt";a.PresentOverVideoCall="icon-small-present-over-video-call";
a.Presentation="icon-small-presentation";a.PresenterNotes="icon-small-presenter-notes";a.Preview="icon-small-preview";a.PreziDesign="icon-small-prezi-design";a.Public="icon-small-public";a.Recent="icon-small-recent";a.RecentOultine="icon-small-recent-oultine";a.Record="icon-small-record";a.Redo="icon-small-redo";a.Remove="icon-small-remove";a.Replace="icon-small-replace";a.Replay="icon-small-replay";a.ResizeEnlarge="icon-small-resize-enlarge";a.ResizeShrink="icon-small-resize-shrink";a.Resume="icon-small-resume";
a.Reuse="icon-small-reuse";a.Scale="icon-small-scale";a.Screen="icon-small-screen";a.ScreenRatio="icon-small-screen-ratio";a.ScreenShare="icon-small-screen-share";a.Search="icon-small-search";a.SelectTool="icon-small-select-tool";a.Settings="icon-small-settings";a.Shape="icon-small-shape";a.Share="icon-small-share";a.ShowHidePresenterNotes="icon-small-show-hide-presenter-notes";a.ShowHideSidePanel="icon-small-show-hide-side-panel";a.ShowhideViewport="icon-small-showhide-viewport";a.Shuffle="icon-small-shuffle";
a.Sidebar="icon-small-sidebar";a.StackTopic="icon-small-stack-topic";a.Staffpick="icon-small-staffpick";a.Star="icon-small-star";a.StarOutline="icon-small-star-outline";a.Sticker="icon-small-sticker";a.Stop="icon-small-stop";a.Storyblocks="icon-small-storyblocks";a.StoryblocksCom="icon-small-storyblocks-com";a.StreamerMode="icon-small-streamer-mode";a.Style="icon-small-style";a.StylePresets="icon-small-style-presets";a.Sync="icon-small-sync";a.SyncOutline="icon-small-sync-outline";a.Synced="icon-small-synced";
a.Syntax="icon-small-syntax";a.Tag="icon-small-tag";a.TemplateChooser="icon-small-template-chooser";a.TemplateChooserColored="icon-small-template-chooser-colored";a.Text="icon-small-text";a.TextBackground="icon-small-text-background";a.TextForeground="icon-small-text-foreground";a.Trash="icon-small-trash";a.Trim="icon-small-trim";a.Twitter="icon-small-twitter";a.UnGroup="icon-small-un-group";a.Undo="icon-small-undo";a.Ungroup="icon-small-ungroup";a.Unlisted="icon-small-unlisted";a.Unsplash="icon-small-unsplash";
a.Upload="icon-small-upload";a.User="icon-small-user";a.UserWithCircle="icon-small-user-with-circle";a.UserWithScreen="icon-small-user-with-screen";a.Users="icon-small-users";a.Video="icon-small-video";a.VideoConference="icon-small-video-conference";a.VideoConferenceDisconnectedDark="icon-small-video-conference-disconnected-dark";a.VideoConferenceDisconnectedLight="icon-small-video-conference-disconnected-light";a.ViewMode="icon-small-view-mode";a.ViewModeContentOnly="icon-small-view-mode-content-only";
a.ViewModeContentTransparent="icon-small-view-mode-content-transparent";a.ViewModeHideContent="icon-small-view-mode-hide-content";a.VirtualBackground="icon-small-virtual-background";a.VolumeOff="icon-small-volume-off";a.VolumeOn="icon-small-volume-on";a.Warning="icon-small-warning";a.Watermark="icon-small-watermark";a.Widgets="icon-small-widgets";a.Windows="icon-small-windows";a.Xml2="icon-small-xml2";a.YouTube="icon-small-you-tube";a.ZoomArea="icon-small-zoom-area";a.ZoomIn="icon-small-zoom-in";
a.ZoomOut="icon-small-zoom-out";a.empty="empty"})(va=c.IconSmallId||(c.IconSmallId={}));(function(a){a.Analytics="illustration-large-light-analytics";a.BrokenLink="illustration-large-light-broken-link";a.BrowserRedirect="illustration-large-light-browser-redirect";a.EmailRedirect="illustration-large-light-email-redirect";a.Error="illustration-large-light-error";a.ExportPdfFrom="illustration-large-light-export-pdf-from";a.ExportPdfTo="illustration-large-light-export-pdf-to";a.HappyRectangle="illustration-large-light-happy-rectangle";
a.MyLibrary="illustration-large-light-my-library";a.NoCamera="illustration-large-light-no-camera";a.NoResults="illustration-large-light-no-results";a.Offline="illustration-large-light-offline";a.SadRectangle="illustration-large-light-sad-rectangle";a.SupportedBrowsers="illustration-large-light-supported-browsers";a.UnlockPremiumContent="illustration-large-light-unlock-premium-content"})(c.IllustrationLargeLightId||(c.IllustrationLargeLightId={}));(function(a){a.Audio="illustration-small-audio";a.Camera=
"illustration-small-camera";a.CloudUpload="illustration-small-cloud-upload";a.CreatePreziColor="illustration-small-create-prezi-color";a.CreateVideo="illustration-small-create-video";a.CreateVideoColor="illustration-small-create-video-color";a.GoLiveColor="illustration-small-go-live-color";a.Image="illustration-small-image";a.Import="illustration-small-import";a.Pdf="illustration-small-pdf";a.Ppt="illustration-small-ppt";a.PptColor="illustration-small-ppt-color";a.Prezi="illustration-small-prezi";
a.PreziColor="illustration-small-prezi-color";a.Video="illustration-small-video"})(c.IllustrationSmallId||(c.IllustrationSmallId={}));return c});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_plugin_api",["require","react","react-dom","react-transition-group","prezi.geometry","prezi_app_utils","prezi_bacon","prezi_cet","prezi_cet_model","prezi_cet_model_editor","prezi_cet_renderer","prezi_editor_error","prezi_editor_store_common","prezi_editor_store_mode","prezi_editor_store_object","prezi_editor_store_ui","prezi_featureswitcher","prezi_i18n","prezi_logger","prezi_nativeapitypes","prezi_ppt_service","prezi_service_data","prezi_service_fontcatalogue","prezi_sound_playback","prezi_spotlight","prezi_uaparser","prezi_utils","prezi_widgets"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_plugin_api.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("react"),require("react-dom"),require("react-transition-group"),require("prezi.geometry"),require("prezi_app_utils"),require("prezi_bacon"),require("prezi_cet"),require("prezi_cet_model"),require("prezi_cet_model_editor"),require("prezi_cet_renderer"),require("prezi_editor_error"),require("prezi_editor_store_common"),require("prezi_editor_store_mode"),require("prezi_editor_store_object"),require("prezi_editor_store_ui"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_logger"),require("prezi_nativeapitypes"),require("prezi_ppt_service"),require("prezi_service_data"),require("prezi_service_fontcatalogue"),require("prezi_sound_playback"),require("prezi_spotlight"),require("prezi_uaparser"),require("prezi_utils"),require("prezi_widgets"));}else{this["prezi_plugin_api"]=__factory(React,ReactDOM,ReactTransitionGroup,this["prezi.geometry"],this["prezi_app_utils"],this["prezi_bacon"],this["prezi_cet"],this["prezi_cet_model"],this["prezi_cet_model_editor"],this["prezi_cet_renderer"],this["prezi_editor_error"],this["prezi_editor_store_common"],this["prezi_editor_store_mode"],this["prezi_editor_store_object"],this["prezi_editor_store_ui"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_logger"],this["prezi_nativeapitypes"],this["prezi_ppt_service"],this["prezi_service_data"],this["prezi_service_fontcatalogue"],this["prezi_sound_playback"],this["prezi_spotlight"],this["prezi_uaparser"],this["prezi_utils"],this["prezi_widgets"]);}}).call(this);