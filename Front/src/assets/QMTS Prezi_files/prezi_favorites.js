;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "14.0-9-g58006c6";},getModuleName:function(){return "prezi_favorites";},getModuleVersion:function(){return "release-2023w26-base-4-g4a3c2ed4bcb";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi_cet_model_editor":dependencies[0],"prezi_featureswitcher":dependencies[1],"prezi_i18n":dependencies[2],"prezi_libraryprovider":dependencies[3],"prezi_logger":dependencies[4],"prezi_plugin_api":dependencies[5],"prezi_plugin_meta":dependencies[6],"prezi_replacer":dependencies[7],"prezi_service_data":dependencies[8],"prezi_utils":dependencies[9],"prezi_widgets":dependencies[10]}};})());};})(arguments);var moduleImpl=(function(){return module(function(q){var f=q.dependencies.prezi_plugin_api,y=q.dependencies.prezi_widgets,x=q.dependencies.prezi_cet_model_editor,e=q.dependencies.prezi_i18n,B=q.dependencies.prezi_logger,r=q.dependencies.prezi_replacer,b=q.dependencies.prezi_libraryprovider,k=q.dependencies.prezi_plugin_meta,D=q.dependencies.prezi_utils,A=q.dependencies.prezi_service_data,v=q.dependencies.prezi_featureswitcher,g={};Object.defineProperty(g,"__esModule",{value:!0});g.INSERT_HIGHLIGHT_ID="favoritesInsertHighlight";g.ADD_HIGHLIGHT_ID=
"favoritesAddToFavHighlight";g.EMPTY_HIGHLIGHT_ID="favoritesEmptySidebarHighlight";g.FIRST_ITEM_HIGHLIGHT_ID="favoritesFirstItemHighlight";g.NON_NATIVE_INSERT_HIGHLIGHT_ID="NON_NATIVE_INSERT_HIGHLIGHT_ID";const F={around:{uiElementId:"insert"},shape:y.HoleShape.rounded,callout:null,pulse:!0},E={around:{uiElementId:"property-bar-add-favorites"},shape:y.HoleShape.rounded,pulse:!0},G={around:{uiElementId:"topmenu-insert-item-mylibrary-icon"},shape:y.HoleShape.rounded,pulse:!0},H={around:{uiElementId:"favorites-sidebar"},
shape:y.HoleShape.rounded,pulse:!0},I={around:{uiElementId:"listItem-0"},shape:y.HoleShape.rounded,pulse:!0};g.default=class{constructor(a){this.glassboxLogger=B.avro.Avro.createDefaultLogger();this.userSettingsApi=a;this.canStartOnboarding=!this.isMyLibraryFavoritesOnboardingShown()&&!v.isActive("js-unique-differentiation");this.canShowNonNativeOnboarding=!this.isMyLibraryNonNativeFavoriteOnboardingShown()&&!v.isActive("js-unique-differentiation")}isMyLibraryFavoritesOnboardingShown(){return v.isActive("js-force-favorites-onboarding")?
!1:this.userSettingsApi.getBoolean(A.UserSettingBooleanKeys.MY_LIBRARY_FAVORITES_ONBOARDING_SHOWN)||v.isActive("js-unique-differentiation")}isMyLibraryNonNativeFavoriteOnboardingShown(){return v.isActive("js-force-favorites-onboarding")?!1:this.userSettingsApi.getBoolean(A.UserSettingBooleanKeys.MY_LIBRARY_NON_NATIVE_ONBOARDING_SHOWN)||v.isActive("js-unique-differentiation")}registerSpotlights(a,d){const {insertedImageIdToSpotlight:b}=d.getState();b&&this.canShowNonNativeOnboarding&&a.spotlight({id:g.NON_NATIVE_INSERT_HIGHLIGHT_ID,
overlay:null,highlights:[{around:{preziElementId:b},shape:y.HoleShape.rounded,pulse:!0,callout:{text:e.I18n.ts("Library objects added in Prezi Design can only be edited there."),anchor:"bottom",buttons:[{id:"generic-library-learn-more",text:"Learn More",onClick:()=>{window.open("https://support.prezi.com/hc/articles/360040260973-Adding-and-reusing-content-in-your-library")}}],onClose:()=>{d.spotlight.close(g.NON_NATIVE_INSERT_HIGHLIGHT_ID);this.finishNonNativeOnboarding()}}}]});this.isMyLibraryFavoritesOnboardingShown()||
(a.spotlight({id:g.INSERT_HIGHLIGHT_ID,overlay:null,highlights:[F,G]}),a.spotlight({id:g.ADD_HIGHLIGHT_ID,overlay:null,highlights:[Object.assign(Object.assign({},E),{callout:{text:e.I18n.ts("Add items to your library so you can easily use them again in any presentation or video"),anchor:"bottom",onClose:()=>{this.glassboxLogger.logCloseOnboardingCallout({onboarding_callout_name:"MYLIBRARY_PROPERTYBAR"});this.hideOnboarding(d);this.finishOnboarding()}}})]}));a.spotlight({id:g.EMPTY_HIGHLIGHT_ID,overlay:null,
highlights:[Object.assign(Object.assign({},H),{callout:{text:e.I18n.ts("Select any item in the presentation."),anchor:"left",steps:{currentStep:1,lastStep:3}}})]});a.spotlight({id:g.ADD_HIGHLIGHT_ID,overlay:null,highlights:[Object.assign(Object.assign({},E),{callout:{text:e.I18n.ts("Click here to add your selection to the library."),anchor:"bottom",steps:{currentStep:2,lastStep:3}}})]});a.spotlight({id:g.FIRST_ITEM_HIGHLIGHT_ID,overlay:null,highlights:[Object.assign(Object.assign({},I),{callout:{text:e.I18n.ts("You can access it from here."),
anchor:"left",steps:{currentStep:3,lastStep:3},onClose:()=>this.handleEmptyOnboarding(d,"off")}})]})}startOnboarding(a){this.canStartOnboarding&&setTimeout(()=>a.spotlight.open(g.ADD_HIGHLIGHT_ID),100)}onboardingStep2(a){this.canStartOnboarding&&(a.spotlight.close(g.ADD_HIGHLIGHT_ID),a.spotlight.open(g.INSERT_HIGHLIGHT_ID))}hideOnboarding(a){a.spotlight.close(g.ADD_HIGHLIGHT_ID);a.spotlight.close(g.INSERT_HIGHLIGHT_ID)}finishOnboarding(){this.canStartOnboarding=!1;this.userSettingsApi.setBoolean(A.UserSettingBooleanKeys.MY_LIBRARY_FAVORITES_ONBOARDING_SHOWN,
!0)}finishNonNativeOnboarding(){this.canShowNonNativeOnboarding=!1;this.userSettingsApi.setBoolean(A.UserSettingBooleanKeys.MY_LIBRARY_NON_NATIVE_ONBOARDING_SHOWN,!0)}handleNonNativeInsert(a){a.spotlight.open(g.NON_NATIVE_INSERT_HIGHLIGHT_ID)}handleEmptyOnboarding(a,d){const {emptyOnboardingState:b}=a.getState();switch(d){case "started":"off"===b&&(a.setState({emptyOnboardingState:d}),a.spotlight.open(g.EMPTY_HIGHLIGHT_ID));break;case "selected":"started"===b&&(a.setState({emptyOnboardingState:d}),
a.spotlight.close(g.EMPTY_HIGHLIGHT_ID),a.spotlight.open(g.ADD_HIGHLIGHT_ID));break;case "added":"selected"===b&&(a.setState({emptyOnboardingState:d}),a.spotlight.close(g.ADD_HIGHLIGHT_ID),setTimeout(()=>a.spotlight.open(g.FIRST_ITEM_HIGHLIGHT_ID),1E3));break;case "off":a.setState({emptyOnboardingState:d}),a.spotlight.close(g.EMPTY_HIGHLIGHT_ID),a.spotlight.close(g.ADD_HIGHLIGHT_ID),a.spotlight.close(g.FIRST_ITEM_HIGHLIGHT_ID)}}};var m={};Object.defineProperty(m,"__esModule",{value:!0});m.AllAssetTypesConst=
"all";(m.NonObjectKindAssetType||(m.NonObjectKindAssetType={})).preziDesign="prezi_design";var c={},t=this&&c.__awaiter||function(a,d,b,c){function l(a){return a instanceof b?a:new b(function(d){d(a)})}return new (b||(b=Promise))(function(b,p){function e(a){try{w(c.next(a))}catch(C){p(C)}}function z(a){try{w(c["throw"](a))}catch(C){p(C)}}function w(a){a.done?b(a.value):l(a.value).then(e,z)}w((c=c.apply(a,d||[])).next())})};Object.defineProperty(c,"__esModule",{value:!0});var h=x.base.ObjectKind;c.FavoritesPlugin=
class{constructor(){this.pasteCount=0;this.handleClickTabMenuItem=()=>{this.uiRoot.sidebar.toggle(c.FavoritesPlugin.SIDEBAR_ID);this.glassboxLogger.logClickTabMenuItem({tab_menu_item:"MYLIBRARY"});this.onboardingObj.hideOnboarding(this.uiRoot);this.onboardingObj.finishOnboarding()};this.logger=B.LoggerModule.getLoggerManager().createLogger("prezi_favorites.FavoritesPlugin");this.glassboxLogger=B.avro.Avro.createDefaultLogger()}init(a){this.libraryProvider=b.LibraryProviderModule.getLibraryProvider(a);
this.onboardingObj=new g.default(this.userSettings);this.replacableTracker=r.createReplacableTracker(a,this.session);this.uiRoot=a.declareUI({sidebarOpen:!1,openSidebarOrigin:null,collectionFilter:b.CollectionFilter.allAssets,assetTypeFilter:m.AllAssetTypesConst,favoritesDataState:"none",favorites:[],isMissingItems:!1,selectionType:null,removingFavorite:null,generalErrorMessage:"",emptyOnboardingState:"off",hasClassicFavorites:!1,insertedImageIdToSpotlight:null,mode:"insert",replaceable:{kind:r.ReplaceableKind.none}},
(a,b)=>{this.createMenuItems(b,a,this.uiRoot);this.createSidebar(b,a,this.uiRoot);this.createPropertyBarItems(b,a,this.uiRoot);this.createDialogs(b,a,this.uiRoot);this.onboardingObj.registerSpotlights(b,this.uiRoot)});a.onDocumentChange(()=>{this.session.document.read((a)=>{a=this.session.selection.getReadonlySelectionInfo(a);this.updateStateBySelection(a)})});a.onSelectionChange((a)=>{this.session.document.read((d)=>{const b={allObjects:a.allObjects.map((a)=>d.lookup.resolve(a)),groups:a.groups.map((a)=>
d.lookup.resolve(a)),nonGroupedObjects:a.nonGroupedObjects.map((a)=>d.lookup.resolve(a))};this.updateStateBySelection(b)});0===a.allObjects.length&&(this.onboardingObj.hideOnboarding(this.uiRoot),this.pasteCount>=c.FavoritesPlugin.ONBOARDING_STARTS_UNTIL_PASTES&&this.onboardingObj.finishOnboarding());this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"selected")});a.onAfterPaste(()=>{this.pasteCount++;this.pasteCount<=c.FavoritesPlugin.ONBOARDING_STARTS_UNTIL_PASTES&&(this.onboardingObj.startOnboarding(this.uiRoot),
this.glassboxLogger.logShowOnboardingCallout({onboarding_callout_name:"MYLIBRARY_PROPERTYBAR"}))});v.isActive("js-force-favorites-onboarding")&&this.onboardingObj.startOnboarding(this.uiRoot);this.replacableTracker.onReplaceableChange((a)=>{let d={replaceable:a};a.kind===r.ReplaceableKind.none&&(d=Object.assign(Object.assign({},d),{mode:"insert"}));this.uiRoot.setState(d)})}updateStateBySelection(a){if(a.allObjects.some((a)=>a.is(x.base.ObjectKind.lockable)&&a.locked))this.uiRoot.setState({selectionType:null});
else{const d=a.allObjects;0<d.length?(a=this.getSupportedSelectionObjectKind(d,a.groups),this.uiRoot.setState({selectionType:a})):(this.uiRoot.setState({selectionType:null}),this.onboardingObj.hideOnboarding(this.uiRoot),this.pasteCount>=c.FavoritesPlugin.ONBOARDING_STARTS_UNTIL_PASTES&&this.onboardingObj.finishOnboarding())}}processMessage(a){switch(a.kind){case "openFavoritesSidebar":this.uiRoot.sidebar.open(c.FavoritesPlugin.SIDEBAR_ID);break;case "openFavoritesFromAnotherSidebar":this.uiRoot.setState({openSidebarOrigin:a.origin,
assetTypeFilter:c.FavoritesPlugin.DefaultSelectedAssetTypeForSidebarMap[a.origin],mode:a.mode});this.uiRoot.sidebar.open(c.FavoritesPlugin.SIDEBAR_ID,c.FavoritesPlugin.PAGE_ID);break;default:D.Utils.assertNever(a)}}createMenuItems(a,d){a.createTopMenuItem(f.TopMenuId.Other,{kind:f.MenuItemKind.largeButton,id:"topmenu-insert-item-mylibrary",weight:4,categoryWeight:0,title:c.FavoritesPlugin.TOPMENUITEM_TITLE,icon:f.IconSmallId.MyLibrary,onClick:this.handleClickTabMenuItem});null!=d.selectionType&&a.createMenuItem({kind:f.MenuItemKind.context,
id:"context-menu-add-favorites",title:c.FavoritesPlugin.SIDEBAR_BUTTON_TRANSLATIONS,weight:120,enabled:!0,onClick:(a)=>this.onAddToFavorites(a,"context-menu")})}createPropertyBarItems(a,d){null!=d.selectionType&&a.createPropertyBarItem((a)=>a.button({id:"property-bar-add-favorites",groupWeight:10,weight:101,enabled:!0,icon:f.IconSmallId.AddToMyLibrary,tooltip:c.FavoritesPlugin.SIDEBAR_BUTTON_TRANSLATIONS,onClick:(a)=>this.onAddToFavorites(a,"property-bar")}))}createDialogs(a,d,b){this.createRemoveConfirmDialog(a,
d,b);this.createGeneralErrorDialog(a,d,b);this.createStackPlanetErrorDialog(a,b)}createRemoveConfirmDialog(a){const {removingFavorite:d}=this.uiRoot.getState(),b=()=>{this.uiRoot.dialog.hide(c.FavoritesPlugin.CONFIRM_DELETE_DIALOG_ID);this.uiRoot.setState({removingFavorite:null})};a.dialog.small((a)=>({id:c.FavoritesPlugin.CONFIRM_DELETE_DIALOG_ID,title:e.I18n.ts("Remove from library?"),footer:(a)=>[a.button({color:f.ButtonColor.Red,content:{text:e.I18n.ts("Yes, remove")},id:c.FavoritesPlugin.CONFIRM_DELETE_BUTTON_ID,
onClick:()=>{this.glassboxLogger.logConfirmRemovalFromLibrary({mylibrary_id:d.guid});this.deleteFavorite(d);b()}}),a.button({color:f.ButtonColor.Ghost,content:{text:e.I18n.ts("No, cancel")},id:c.FavoritesPlugin.CANCEL_DELETE_BUTTON_ID,onClick:()=>{this.glassboxLogger.logCancelRemovalFromLibrary();b()}})],content:[a.label(e.I18n.ts("This item will no longer be available in your library. Are you sure you want to remove it?"))],align:f.DialogAlign.center}))}createGeneralErrorDialog(a,d,b){a.dialog.alert(()=>
({id:c.FavoritesPlugin.GENERAL_ERROR_DIALOG_ID,title:c.FavoritesPlugin.SIDEBAR_GENERAL_ERROR_TITLE,description:d.generalErrorMessage,footer:(a)=>[a.button({color:f.ButtonColor.Gray,content:{text:e.I18n.ts("OK")},id:c.FavoritesPlugin.GENERAL_ERROR_CLOSE_BUTTON_ID,onClick:()=>{b.dialog.hide(c.FavoritesPlugin.GENERAL_ERROR_DIALOG_ID);b.setState({generalErrorMessage:""})}})]}))}showGeneralErrorDialog(a){this.uiRoot.setState({generalErrorMessage:a});this.uiRoot.dialog.show(c.FavoritesPlugin.GENERAL_ERROR_DIALOG_ID)}createStackPlanetErrorDialog(a,
d){a.dialog.alert(()=>({id:c.FavoritesPlugin.STACK_INSERT_ERROR_DIALOG_ID,title:e.I18n.ts("Unable to add planet topics to a stack"),description:e.I18n.ts("Your item contains a planet topic type, which can only be added to other planet topics. "),footer:(a)=>[a.button({color:f.ButtonColor.Blue,content:{text:e.I18n.ts("OK")},id:c.FavoritesPlugin.STACK_INSERT_ERROR_BUTTON_ID,onClick:()=>d.dialog.hide(c.FavoritesPlugin.STACK_INSERT_ERROR_DIALOG_ID)}),a.button({color:f.ButtonColor.Ghost,content:{text:e.I18n.ts("Learn more")},
id:c.FavoritesPlugin.STACK_INSERT_ERROR_LEARN_MORE_BUTTON_ID,onClick:()=>window.open("https://prez.is/9pbst46/","_blank_info")})]}))}createSidebar(a,d,b){return a.createSidebar(c.FavoritesPlugin.SIDEBAR_ID,(a)=>({root:this.createRootPage(d,a),pages:{[c.FavoritesPlugin.PAGE_ID]:d.openSidebarOrigin?this.createRootPage(d,a):{title:"",content:[]}},onOpen:()=>{this.loadFavorites();this.glassboxLogger.logShowMyLibraryOptions({library_source:d.openSidebarOrigin?"OTHER_SIDEBAR":"TOOLBAR"});b.setState({sidebarOpen:!0})},
onClose:()=>{b.setState({sidebarOpen:!1,openSidebarOrigin:null});this.glassboxLogger.logCloseMyLibrarySidebar();this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"off")},onPageBack:()=>{const {pluginDescription:a,message:b}=this.getBackToOriginalSidebarMessage(d);a&&b&&this.pluginAccess.send(a,b)}}))}getBackToOriginalSidebarMessage(a){const {pluginDescription:b,message:l}=c.FavoritesPlugin.SidebarDescriptorMap[a.openSidebarOrigin];if(null==b||null==l)return{pluginDescription:b,message:l};let e=
l;b.name===k.assets.name&&(e=Object.assign(Object.assign({},l),{insertMode:a.mode}));return{pluginDescription:b,message:e}}createRootPage(a,b){return{title:c.FavoritesPlugin.SIDEBAR_TITLE,content:this.createRootPageContent(a,b)}}createRootPageContent(a,b){const {favoritesDataState:d}=a;switch(d){case "loading":return[b.spinner(f.SpinnerColor.neutral,y.SpinnerSize.l)];case "success":return[...this.createMyCollectionDropwdown(b,a,this.uiRoot),...this.createFavoritesList(b)];case "error":return[b.illustration(e.I18n.ts("Something went wrong"),
f.IllustrationLargeLightId.Error)];default:return[]}}getFavoriteCollectionsV3(a){return a.systemCollectionKeys&&-1===a.systemCollectionKeys.indexOf(b.CollectionFilter.myUploads)?a.systemCollectionKeys:[b.CollectionFilter.savedAssets]}convertV3ApiResponse(a){const [b,c]=this.getDefaultThumbnailWithStatus(a.thumbnails);return Object.assign(Object.assign({},a),{thumbnailSrc:c,thumbnailStatus:b,videoThumbnailSrc:this.getVideoThumbnailSrc(a.thumbnails),collections:this.getFavoriteCollectionsV3(a)})}loadFavorites(){return t(this,
void 0,void 0,function*(){this.uiRoot.setState({favoritesDataState:"loading"});try{let a,d,c;const e=yield this.libraryProvider.getFavoritesV3();a=e.items.map((a)=>this.convertV3ApiResponse(a));this.initiateThumbnailPolling(a);d=e.meta.isMissingItems;v.isActive("js-mylibrary-enable-list-classic-favorites")?c=-1!==a.findIndex((a)=>a.objectType===b.FavoritesObjectKind.preziClassic):(a=a.filter((a)=>a.objectType!==b.FavoritesObjectKind.preziClassic),c=!1);this.uiRoot.setState({favoritesDataState:"success",
favorites:a,isMissingItems:d,hasClassicFavorites:c})}catch(a){this.uiRoot.setState({favoritesDataState:"error"}),this.logger.error({action:"error",object:"favorites-load",trigger:"machine",payload:{error:`${a}`}})}})}createMyCollectionDropwdown(a,b,c){const {favorites:d,hasClassicFavorites:l}=b;return 0<d.length?[a.sectionHeader({content:e.I18n.ts("My collection")}),a.dropdown({id:"favorites-asset-type-selector",activeId:b.assetTypeFilter,onChange:(a,b)=>{c.setState({assetTypeFilter:b});this.glassboxLogger.logSelectMyLibraryAssetTypeOption({asset_type:this.mapIdToLoggingAssetType(b)});
this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"off")},options:[{id:m.AllAssetTypesConst,title:e.I18n.ts("All items")},...this.generateAssetTypeDropdownOptions(l)]})]:[]}generateAssetTypeDropdownOptions(a){a=[{id:m.NonObjectKindAssetType.preziDesign,title:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[m.NonObjectKindAssetType.preziDesign].plural},...v.isActive("js-mylibrary-enable-list-classic-favorites")&&a?[{id:b.FavoritesObjectKind.preziClassic,title:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.preziClassic].plural}]:
[],{id:b.FavoritesObjectKind.topic,title:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.topic].plural},{id:b.FavoritesObjectKind.image,title:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.image].plural},{id:b.FavoritesObjectKind.gif,title:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.gif].plural},{id:b.FavoritesObjectKind.text,title:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.text].singular},{id:b.FavoritesObjectKind.shape,title:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.shape].plural},
{id:b.FavoritesObjectKind.slide,title:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.slide].plural},{id:b.FavoritesObjectKind.video,title:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.video].plural},{id:b.FavoritesObjectKind.chart,title:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.chart].plural},{id:b.FavoritesObjectKind.pdf,title:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.pdf].plural},{id:b.FavoritesObjectKind.group,title:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.group].plural}];
a.sort((a,b)=>a.title.localeCompare(b.title));return a}openOtherSidebar(a){if(a===b.FavoritesObjectKind.topic){const a=this.session.document.read((a)=>this.session.insertTarget.getSimpleObjectParentReader(a).kind);this.glassboxLogger.logShowTopicInsertOptions({topic_level:a===h.overview?"MAIN_TOPIC":"SUB_TOPIC",topic_sidebar_trigger:"MYLIBRARY"})}const {pluginDescription:d,message:e}=c.FavoritesPlugin.SidebarDescriptorMap[c.FavoritesPlugin.ObjectTypeToSidebarMap[a]];d&&e&&(null!=this.uiRoot.getState().openSidebarOrigin&&
(this.uiRoot.sidebar.close(c.FavoritesPlugin.PAGE_ID),this.uiRoot.sidebar.close(c.FavoritesPlugin.SIDEBAR_ID)),this.pluginAccess.send(d,e))}deleteFavorite(a){return t(this,void 0,void 0,function*(){var {favorites:b}=this.uiRoot.getState();let c=!1;try{c=yield this.libraryProvider.deleteFavoriteV3(a.guid)}catch(p){this.logger.error({action:"error",object:"favorites-delete",trigger:"machine",payload:{error:`${p}`,guid:a.guid}})}c?(b=b.filter((b)=>b.guid!==a.guid),this.uiRoot.setState({favorites:b})):
this.showGeneralErrorDialog(e.I18n.ts("We were unable to delete this item from your library. Please try again."))})}isFavoriteObjectTypeInAssetTypeFilter(a,d){const c=a.objectType;return d===m.AllAssetTypesConst?!0:d===b.FavoritesObjectKind.group?c===b.FavoritesObjectKind.group||c===b.FavoritesObjectKind.composite:d===m.NonObjectKindAssetType.preziDesign?a.data?"design-document"===a.data.dataType:!1:c===d}createFavoritesList(a){const {assetTypeFilter:d,collectionFilter:l,isMissingItems:p,favorites:z}=
this.uiRoot.getState(),w=d===m.AllAssetTypesConst?z:z.filter((a)=>this.isFavoriteObjectTypeInAssetTypeFilter(a,d));if(0<w.length){var u=[];u.push(a.separator());p?(this.glassboxLogger.logShowedMissingMyLibraryItemsMessage({asset_type:d.toUpperCase(),collection_name:l}),u.push(a.label(e.I18n.ts("There are items in your library that cannot be displayed."))),u.push(a.button(f.ButtonSize.Large,f.ButtonAlign.Start,(a)=>[a.button({id:"stack-error-dialog-learn-more-button",color:f.ButtonColor.Gray,content:{text:e.I18n.ts("Learn more")},
onClick:()=>window.open("https://prez.is/12rrhel/","_blank_info")})])),u.push(a.separator())):z.length<=c.FavoritesPlugin.ONBOARDING_VISIBLE_MAX_ITEMS&&(u.push(a.label(e.I18n.ts("Nice collection! You can add more items anytime, including: topics, images, text, icons, shapes, videos, charts, PDFs, and even combined items."))),u.push(a.separator()));u.push(a.simpleList((a)=>({items:w.map((b)=>this.createFavoriteItem(a,b)),itemType:c.FavoritesPlugin.LIST_ITEM_TYPE_MAP[d],itemLayout:f.ListItemLayout.fixed,
id:"favorites/favoritelist"})));return u}if(d===m.AllAssetTypesConst||0===z.length)return[a.illustration(e.I18n.ts("Your favorite assets, all in one place."),f.IllustrationLargeLightId.MyLibrary),a.paragraph(e.I18n.ts("Library"),[e.I18n.ts("Store all your favorite assets for easy access.")]),a.button(f.ButtonSize.Small,f.ButtonAlign.Center,(a)=>[a.button({color:f.ButtonColor.Gray,flexibleWidth:!0,id:"empty-favs-onboarding",content:{text:e.I18n.ts("Get started")},onClick:()=>this.onboardingObj.handleEmptyOnboarding(this.uiRoot,
"started")})]),a.paragraph(e.I18n.ts("Pro Tip"),[e.I18n.ts("You can save assets from other places, too.")]),a.button(f.ButtonSize.Small,f.ButtonAlign.Center,(a)=>[a.button({color:f.ButtonColor.Gray,flexibleWidth:!0,id:"pro-tip-read-more",content:{text:e.I18n.ts("Learn more")},onClick:()=>{window.open("https://support.prezi.com/hc/articles/360040260973-Adding-and-reusing-content-in-your-library","_blank")}})])];if(d===m.NonObjectKindAssetType.preziDesign)return[a.illustration(e.I18n.tsFormatKeys("You don\u2019t have any {assetType} in your library yet",
{assetType:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[d].plural}),f.IllustrationLargeLightId.MyLibrary),a.label(e.I18n.tsFormatKeys("Save {assetType} in Prezi Design to see them in your Library.",{assetType:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[d].plural.toLocaleLowerCase()}))];u=d===b.FavoritesObjectKind.group?[a.illustration(e.I18n.ts("You don\u2019t have any of these items in your library yet"),f.IllustrationLargeLightId.MyLibrary),a.label(e.I18n.ts("Insert items into your presentation so you can add them to your library."))]:
[a.illustration(e.I18n.tsFormatKeys("You don\u2019t have any {assetType} in your library yet",{assetType:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[d].plural}),f.IllustrationLargeLightId.MyLibrary),a.label(e.I18n.tsFormatKeys("Insert {assetType} into your presentation so you can add them to your library.",{assetType:d===b.FavoritesObjectKind.slide?c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[d].plural:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[d].plural.toLocaleLowerCase()}))];-1!==[b.FavoritesObjectKind.chart,
b.FavoritesObjectKind.image,b.FavoritesObjectKind.gif,b.FavoritesObjectKind.pdf,b.FavoritesObjectKind.shape,b.FavoritesObjectKind.topic,b.FavoritesObjectKind.video].indexOf(d)&&u.push(a.button(f.ButtonSize.Large,f.ButtonAlign.Start,(a)=>[a.button({color:f.ButtonColor.Gray,id:"empty-favs-open-other-sidebar",content:{text:e.I18n.tsFormatKeys("Insert {assetType}",{assetType:c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[d].plural})},onClick:()=>this.openOtherSidebar(d)})]));return u}getVideoThumbnailSrc(a){return a.reduce((a,
b)=>{b.urls.mp4&&a.push(b.urls.mp4);return a},[])[0]}getThumbnailWithStatus(a){return t(this,void 0,void 0,function*(){const d=yield this.libraryProvider.getFavoriteThumbnailWithStatus(a.guid,a.dataVersion);return d.status===b.ThumbnailStatus.success?this.getDefaultThumbnailWithStatus(d.thumbnails):d.status===b.ThumbnailStatus.failed?[d.status,""]:[d.status,null]})}getDefaultThumbnailWithStatus(a){const d=a.sort((a,b)=>a.width-b.width);if(a=a.find((a)=>700===a.width))return[b.ThumbnailStatus.success,
a.urls.png];if(0===d.length)return[b.ThumbnailStatus.none,null];if(d[0].urls.png)return[b.ThumbnailStatus.success,d[0].urls.png];if(d[0].urls.jpg)return[b.ThumbnailStatus.success,d[0].urls.jpg];for(const a of d){if(a.urls.png)return[b.ThumbnailStatus.success,a.urls.png];if(a.urls.jpg)return[b.ThumbnailStatus.success,a.urls.jpg]}return[b.ThumbnailStatus.failed,""]}initiateThumbnailPolling(a){return t(this,void 0,void 0,function*(){a.filter((a)=>a.thumbnailStatus===b.ThumbnailStatus.none||a.thumbnailStatus===
b.ThumbnailStatus.inProgress).forEach((a)=>{this.pollThumbnailWithRetries(a)})})}pollThumbnailWithRetries(a,d=0){return t(this,void 0,void 0,function*(){const [e,p]=yield this.getThumbnailWithStatus(a);if(e===b.ThumbnailStatus.inProgress&&d<c.FavoritesPlugin.MAX_RETRIES)setTimeout(()=>{this.pollThumbnailWithRetries(a,++d)},5>d?1E3:500*d);else{const w=Object.assign(Object.assign({},a),{thumbnailSrc:p,thumbnailStatus:d>=c.FavoritesPlugin.MAX_RETRIES?b.ThumbnailStatus.failed:e});var {favorites:f}=this.uiRoot.getState();
f=f.map((a)=>a.guid===w.guid?w:a);this.uiRoot.setState({favorites:f})}})}createFavoriteItem(a,b){const d=b.thumbnailSrc,p=this.isDesignFavorite(b);return a.droppableImage({src:{url:d},badge:p?f.IconSmallId.NotEditable:null,badgeTooltipText:p?e.I18n.ts("Can be edited only in the editor where it was created"):null,addChecker:!0,onDrop:(a,d)=>{this.insertFavorite(a,b,d);this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"off")},primaryAction:{id:"primaryAction",onClick:()=>{this.uiRoot.setState({removingFavorite:b});
this.uiRoot.dialog.show(c.FavoritesPlugin.CONFIRM_DELETE_DIALOG_ID);this.glassboxLogger.logRemoveFromLibraryButton()},icon:f.IconSmallId.Trash,enabled:!0,title:"Delete"}})}getParsedCopyData(a){return t(this,void 0,void 0,function*(){const b=yield this.libraryProvider.getFavoriteDataV3(a);return this.session.document.parseCopyDataAsync(JSON.stringify(b))})}shouldReplace(a,b,c){if(1!==a.length||"insert"===c)return!1;a=a[0];return!(a.is(x.base.ObjectKind.image)||a.is(x.base.ObjectKind.animatedImage)||
a.is(x.base.ObjectKind.pdf))||b.kind!==r.ReplaceableKind.image&&b.kind!==r.ReplaceableKind.animatedImage&&b.kind!==r.ReplaceableKind.pdf?!1:!0}insertCopyData(a,b,f){return t(this,void 0,void 0,function*(){return a.doAsync(b,(a,b)=>{a.isValid()&&this.session.document.executeApiCommand(a,{name:"insertFavorite",run:(d)=>{var p=this.uiRoot.getState(),l=this.session.insertTarget.getSimpleObjectParent(d),n=l.add.inserter(b);n.isValid()?(n=n.insert(),0<n.topics.length&&0===n.simpleObjects.length&&this.fixInsertedTopicPosition(l,
n.topics),0<n.simpleObjects.length&&(this.shouldReplace(n.simpleObjects,p.replaceable,p.mode)?(l=n.simpleObjects[0],l=l.is(x.base.ObjectKind.pdf)?{kind:r.ReplaceKind.pdf,source:r.ReplaceSource.object,object:l}:l.is(x.base.ObjectKind.image)?{kind:r.ReplaceKind.image,source:r.ReplaceSource.object,object:l}:l.is(x.base.ObjectKind.animatedImage)?{kind:r.ReplaceKind.animatedImage,source:r.ReplaceSource.object,object:l}:null,r.replaceObject(d,p.replaceable,l)):(d=1===n.simpleObjects.length?n.simpleObjects[0]:
n.simpleObjects[0].createLayoutGroupWith(n.simpleObjects.slice(1)),p=this.session.positionFinder.findLayoutBox(l,d.layoutBox.size.width,d.layoutBox.size.height,f.stageX,f.stageY).withRotationRad(1===n.simpleObjects.length?0:d.layoutBox.rotationRad),d.fitInto(p))),this.session.selection.setSelection(a,n.simpleObjects),this.session.selection.addToSelection(a,n.topics)):l.is(h.page)||l.is(h.stackTopic)?this.uiRoot.dialog.show(c.FavoritesPlugin.STACK_INSERT_ERROR_DIALOG_ID):this.showGeneralErrorDialog(e.I18n.ts("We were unable to add this item to your library. Please try again."))}})})})}insertMediaId(a,
b,c,p){return t(this,void 0,void 0,function*(){return a.doAsync(b,(a,b)=>{if(a.isValid()){const d=b.exportedImageMediaAssetId;d?(this.session.document.executeApiCommand(a,{name:"insert exported image favorite",run:(a)=>{a=this.session.insertTarget.getSimpleObjectParent(a);var b=this.session.document.progressiveAssetManager.createExportedImageAssetFromMediaId(d);b=a.add.image(b.token);b.fitInto(this.session.positionFinder.findLayoutBox(a,b.layoutBox.size.width,b.layoutBox.size.height,p.stageX,p.stageY));
this.uiRoot.setState({insertedImageIdToSpotlight:b.id})}}),this.onboardingObj.handleNonNativeInsert(this.uiRoot)):(this.showGeneralErrorDialog(e.I18n.ts("We were unable to insert this. Please try again.")),this.logger.error({action:"error",object:"favorites-get-media",trigger:"machine",payload:{message:`No ExportedImageMediaAssetId for favorite with guid: ${c.guid} and dataVersion: ${c.dataVersion}`}}))}})})}isDesignFavorite(a){return a.data?a.data.dataType===b.CopydataTypeEnum.design:!1}isCompatiblePresentationFavorite(a){const d=
this.session.document.read((a)=>a.meta.getSupportedGenerations());return null!=a.data&&a.data.dataType===b.CopydataTypeEnum.presentation&&-1!==d.indexOf(a.data.documentGeneration)}getLoggingAssetType(a){return this.isDesignFavorite(a)?"PUBLISH":a.objectType.toString().toUpperCase()}insertFavorite(a,b,c){return t(this,void 0,void 0,function*(){if(this.isCompatiblePresentationFavorite(b)){var d=this.getParsedCopyData(b.data.dataUrl);this.insertCopyData(a,d,c)}else d=this.libraryProvider.getFavoriteMedia(b.guid),
this.insertMediaId(a,d,b,c);this.glassboxLogger.logInsertMyLibraryItem({asset_type:this.getLoggingAssetType(b),mylibrary_id:b.guid,collection_name:this.isDesignFavorite(b)?"PUBLISH":null,item_origin:null})})}fixInsertedTopicPosition(a,b){if(a.is(h.overview)||a.is(h.planetTopic)){const d=a.topicChildren.slice(0);b.forEach((a)=>{a.fitInto(this.session.positionFinder.findTopicPosition(a,d))});a.is(h.planetTopic)&&a.layout.adjust(b)}}onAddToFavorites(a,b){return t(this,void 0,void 0,function*(){const d=
this.uiRoot.getState().selectionType;switch(b){case "context-menu":this.glassboxLogger.logClickContextMenu({context_item:"ADDTO_MYLIBRARY",object_id:"context-menu-add-favorites",object_type:c.FavoritesPlugin.FavoriteKindToLogObjectType.get(d)});break;case "property-bar":this.glassboxLogger.logClickPropertyBar({property_item:"ADDTO_MYLIBRARY"})}let e=null;this.onboardingObj.onboardingStep2(this.uiRoot);const f=yield this.session.document.executeApiCommand(a,{name:"Add to favorites",run:(a)=>0<this.session.selection.getSelectionInfo(a).allObjects.length?
(e=a.meta.generation,this.getDataAndSnapshot(a)):null});if(f&&e){const a=f.snapshot.toDataURL();this.addToFavorites(f.data,a,this.session.document.preziMetaData.preziOid,e,d,f.assetId);this.flightAnimation(f.layoutBox,a,f.snapshotSize);this.onboardingObj.onboardingStep2(this.uiRoot);this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"added")}})}flightAnimation(a,b){return t(this,void 0,void 0,function*(){const d=a.scaleToWidth(100).size;var c=document.querySelector(".koi-editor-ui-storyline"),e=
c?c.getBoundingClientRect().width:0;c?c.getBoundingClientRect().height:0;var f=(c=document.querySelector("[data-lookup=sidebar-root-page]"))?c.getBoundingClientRect().width:0;c?c.getBoundingClientRect().height:0;var g=document.querySelector(".koi-topmenu");c=g?g.getBoundingClientRect().width:0;g=g?g.getBoundingClientRect().height:0;var h=document.querySelector(".koi-topmenu");h?h.getBoundingClientRect().width:0;h=h?h.getBoundingClientRect().height:0;h=g+h;h=h+(window.innerHeight-h)/2-d.height/2;e=
e+(window.innerWidth-e-f)/2-d.width/2;var n=f=0;this.uiRoot.getState().sidebarOpen?(c=document.querySelector("div [data-lookup=favorites-sidebar]").getBoundingClientRect(),f=c.top+220-d.height/4,n=c.left+(c.width-d.width)/2):(f=document.querySelector("div [data-lookup=insert]"))?(c=f.getBoundingClientRect(),f=c.top+(c.height-d.height/2)/2,n=c.left+(c.width-d.width)/2):(f=g+8,n=c/2-d.width/2);!0;const m=document.createElement("style");m.innerHTML=`
			@keyframes favanim {
			    0% {
			      opacity: 0;
			      transform: scale(0);
			      top: ${h}px;
			      left: ${e}px;
			    }

				20% {
                  opacity: 1;
                  transform: scale(2);
				}

			    30% {
			      opacity: 1;
			      transform: scale(1);
			      top: ${h}px;
			      left: ${e}px;
			    }

				60% {
			      opacity: 1;
			    }

				100% {
			      opacity: 0;
			      transform: scale(0.2);
			      top: ${f}px;
			      left: ${n}px;
			    }
			}
		`;document.head.appendChild(m);const k=document.createElement("img");k.id="fly-animation-object";k.src=b;k.width=100;k.height=100;k.style.zIndex="10000";k.style.position="fixed";k.style.animation="favanim 1.5s";document.body.appendChild(k);window.setTimeout(()=>{document.body.removeChild(k);document.head.removeChild(m)},2500)})}addToFavorites(a,b,c,f,g,h){return t(this,void 0,void 0,function*(){const {favorites:d,assetTypeFilter:l}=this.uiRoot.getState();try{let e;const k=yield this.libraryProvider.createFavoriteV3({data:a,
documentGeneration:f,favoriteType:g,name:`${this.session.document.preziMetaData.title} ${g}`,thumbnailImage:b,origin:{preziOid:c,schemaVersion:"2"}});e=this.convertV3ApiResponse(k);e=Object.assign(Object.assign({},e),{thumbnailSrc:b});this.glassboxLogger.logSavedMyLibraryItem({asset_oid:h,asset_type:this.getLoggingAssetType(e),mylibrary_id:e.guid});const p=this.isFavoriteObjectTypeInAssetTypeFilter(e,l)?l:m.AllAssetTypesConst;this.uiRoot.setState({assetTypeFilter:p,favorites:[e,...d]})}catch(n){this.showGeneralErrorDialog(e.I18n.ts("We were unable to add this item to your library. Please try again.")),
this.logger.error({action:"error",object:"favorites-add",trigger:"machine",payload:{error:`${n}`}})}})}getDataAndSnapshot(a){return t(this,void 0,void 0,function*(){var b=this.session.selection.getSelectionInfo(a).allObjects;let c,e,f;if(1<b.length)e=b[0].createLayoutGroupWith(b.slice(1)).copy().serialize(),c=b.map((a)=>a.layoutBox.aabb).reduce((a,b)=>a.union(b)),f="group";else{var g=b[0].rotationRad;b[0].rotationRad=0;e=b[0].copy().serialize();c=b[0].layoutBox.aabb;f=b[0].id;b[0].rotationRad=g}const h=
{width:700,height:700};b=yield this.session.snapshot(g?c.withRotationRad(g):c,{width:h.width,height:h.height},!1,b);g=document.createElement("canvas");const k=g.getContext("2d");g.width=h.width;g.height=h.height;k.fillStyle="transparent";k.fillRect(0,0,h.width,h.height);k.drawImage(b,0,0);return{data:e,snapshot:g,snapshotSize:h,assetId:f,layoutBox:c}})}getSupportedSelectionObjectKind(a,c){return(1<a.length?1===c.length?b.FavoritesObjectKind.group:b.FavoritesObjectKind.composite:this.mapObjectKindToFavoriteKind(a[0].kind))||
null}mapObjectKindToFavoriteKind(a){return c.FavoritesPlugin.ObjectKindToFavorite.get(a)}mapIdToLoggingAssetType(a){switch(a){case "all":return"ALL";case b.FavoritesObjectKind.chart:return"CHART";case b.FavoritesObjectKind.composite:return"COMPOSITE";case b.FavoritesObjectKind.gif:return"GIF";case b.FavoritesObjectKind.group:return"GROUP";case b.FavoritesObjectKind.image:return"IMAGE";case b.FavoritesObjectKind.pdf:return"PDF";case b.FavoritesObjectKind.preziClassic:return"PREZI_CLASSIC";case b.FavoritesObjectKind.shape:return"SHAPE";
case b.FavoritesObjectKind.slide:return"PPT";case b.FavoritesObjectKind.text:return"TEXT";case b.FavoritesObjectKind.topic:return"TOPIC";case b.FavoritesObjectKind.video:return"VIDEO";case m.NonObjectKindAssetType.preziDesign:return"PREZI_DESIGN";default:D.Utils.assertNever(a)}}};c.FavoritesPlugin.SIDEBAR_ID="favorites-sidebar";c.FavoritesPlugin.PAGE_ID="favorites-ugly-hack-kill-me-please";c.FavoritesPlugin.CONFIRM_DELETE_DIALOG_ID="confirm-delete-favorite-dialog";c.FavoritesPlugin.GENERAL_ERROR_DIALOG_ID=
"general-error-dialog-favorites";c.FavoritesPlugin.STACK_INSERT_ERROR_DIALOG_ID="stack-insert-error-dialog-favorites";c.FavoritesPlugin.GENERAL_ERROR_CLOSE_BUTTON_ID="general-error-close-dialog-favorites";c.FavoritesPlugin.CONFIRM_DELETE_BUTTON_ID="confirm-delete-favorite-button";c.FavoritesPlugin.CANCEL_DELETE_BUTTON_ID="cancel-delete-favorite-button";c.FavoritesPlugin.STACK_INSERT_ERROR_BUTTON_ID="stack-insert-error-button-favorites";c.FavoritesPlugin.STACK_INSERT_ERROR_LEARN_MORE_BUTTON_ID="stack-error-dialog-learn-more-button";
c.FavoritesPlugin.SIDEBAR_TITLE=e.I18n.ts("My Library");c.FavoritesPlugin.TOPMENUITEM_TITLE=e.I18n.ts("My library");c.FavoritesPlugin.ONBOARDING_VISIBLE_MAX_ITEMS=4;c.FavoritesPlugin.ONBOARDING_STARTS_UNTIL_PASTES=2;c.FavoritesPlugin.MAX_RETRIES=10;c.FavoritesPlugin.SIDEBAR_BUTTON_TRANSLATIONS=e.I18n.ts("Add to my library");c.FavoritesPlugin.SIDEBAR_GENERAL_ERROR_TITLE=e.I18n.ts("Something went wrong");c.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS={[b.FavoritesObjectKind.topic]:{plural:e.I18n.ts("Topics"),
singular:e.I18n.ts("Topic")},[b.FavoritesObjectKind.image]:{plural:e.I18n.ts("Images"),singular:e.I18n.ts("Image")},[b.FavoritesObjectKind.gif]:{plural:e.I18n.ts("Stickers and GIFs"),singular:e.I18n.ts("Sticker or GIF")},[b.FavoritesObjectKind.text]:{plural:e.I18n.ts("Text"),singular:e.I18n.ts("Text")},[b.FavoritesObjectKind.shape]:{plural:e.I18n.ts("Shapes"),singular:e.I18n.ts("Shape")},[b.FavoritesObjectKind.slide]:{plural:e.I18n.ts("PowerPoint slides"),singular:e.I18n.ts("PowerPoint slide")},[b.FavoritesObjectKind.video]:{plural:e.I18n.ts("Videos"),
singular:e.I18n.ts("Video")},[b.FavoritesObjectKind.chart]:{plural:e.I18n.ts("Charts"),singular:e.I18n.ts("Chart")},[b.FavoritesObjectKind.pdf]:{plural:e.I18n.ts("Icons and PDFs"),singular:e.I18n.ts("Icon or PDF")},[b.FavoritesObjectKind.group]:{plural:e.I18n.ts("Grouped items"),singular:e.I18n.ts("Grouped item")},[b.FavoritesObjectKind.composite]:{plural:e.I18n.ts("Combined items"),singular:e.I18n.ts("Combined item")},[m.NonObjectKindAssetType.preziDesign]:{plural:e.I18n.ts("Design items"),singular:e.I18n.ts("Design item")},
[b.FavoritesObjectKind.preziClassic]:{plural:e.I18n.ts("Classic items"),singular:e.I18n.ts("Classic item")}};c.FavoritesPlugin.LIST_ITEM_TYPE_MAP={[m.AllAssetTypesConst]:f.ListItemType.small,[b.FavoritesObjectKind.topic]:f.ListItemType.full,[b.FavoritesObjectKind.image]:f.ListItemType.large,[b.FavoritesObjectKind.gif]:f.ListItemType.large,[b.FavoritesObjectKind.text]:f.ListItemType.full,[b.FavoritesObjectKind.shape]:f.ListItemType.large,[b.FavoritesObjectKind.slide]:f.ListItemType.full,[b.FavoritesObjectKind.video]:f.ListItemType.large,
[b.FavoritesObjectKind.chart]:f.ListItemType.large,[b.FavoritesObjectKind.pdf]:f.ListItemType.large,[b.FavoritesObjectKind.group]:f.ListItemType.full,[b.FavoritesObjectKind.composite]:f.ListItemType.full,[m.NonObjectKindAssetType.preziDesign]:f.ListItemType.small,[b.FavoritesObjectKind.preziClassic]:f.ListItemType.large};c.FavoritesPlugin.ObjectKindToFavorite=new Map([[h.planetTopic,b.FavoritesObjectKind.topic],[h.stackTopic,b.FavoritesObjectKind.topic],[h.image,b.FavoritesObjectKind.image],[h.animatedImage,
b.FavoritesObjectKind.gif],[h.text,b.FavoritesObjectKind.text],[h.shape,b.FavoritesObjectKind.shape],[h.slide,b.FavoritesObjectKind.slide],[h.arrow,b.FavoritesObjectKind.shape],[h.line,b.FavoritesObjectKind.shape],[h.video,b.FavoritesObjectKind.video],[h.chart,b.FavoritesObjectKind.chart],[h.pdf,b.FavoritesObjectKind.pdf],[h.swf,b.FavoritesObjectKind.pdf],[h.group,b.FavoritesObjectKind.group]]);c.FavoritesPlugin.FavoriteKindToLogObjectType=new Map([[b.FavoritesObjectKind.topic,"TOPIC"],[b.FavoritesObjectKind.image,
"IMAGE"],[b.FavoritesObjectKind.gif,"ANIMATEDIMAGE"],[b.FavoritesObjectKind.text,"TEXT"],[b.FavoritesObjectKind.shape,"SHAPE"],[b.FavoritesObjectKind.slide,"PPT"],[b.FavoritesObjectKind.video,"VIDEO"],[b.FavoritesObjectKind.chart,"CHART"],[b.FavoritesObjectKind.pdf,"PDF"],[b.FavoritesObjectKind.group,"MULTIPLE"],[b.FavoritesObjectKind.composite,"MULTIPLE"]]);c.FavoritesPlugin.SidebarDescriptorMap={["gif"]:{pluginDescription:k.assets,message:{activeTabId:k.ActiveTabId.gif,insertMode:"insert"}},["sticker"]:{pluginDescription:k.assets,
message:{activeTabId:k.ActiveTabId.sticker,insertMode:"insert"}},["image"]:{pluginDescription:k.assets,message:{activeTabId:k.ActiveTabId.image,insertMode:"insert"}},["icon"]:{pluginDescription:k.assets,message:{activeTabId:k.ActiveTabId.icon,insertMode:"insert"}},["storyblocks"]:{pluginDescription:k.storyblocks,message:{kind:"openStoryblocksSidebar",trigger:"MYLIBRARY"}},["video"]:{pluginDescription:k.videoInsert,message:{kind:k.VideoInsertSidebarMessageKind.open}},["charts"]:{pluginDescription:k.chartInsert,
message:"openChartInsertSidebar"},["arcs"]:{pluginDescription:k.shapeAndArcEditor,message:"openArcInsertSidebar"},["shapes"]:{pluginDescription:k.shapeAndArcEditor,message:"openShapeInsertSidebar"},["slide"]:{pluginDescription:k.pptInsert,message:"requestOpen"}};c.FavoritesPlugin.ObjectTypeToSidebarMap={[b.FavoritesObjectKind.image]:"image",[b.FavoritesObjectKind.gif]:"gif",[b.FavoritesObjectKind.pdf]:"icon",[b.FavoritesObjectKind.chart]:"charts",[b.FavoritesObjectKind.shape]:"shapes",[b.FavoritesObjectKind.slide]:"slide",
[b.FavoritesObjectKind.video]:"video",[b.FavoritesObjectKind.topic]:"storyblocks"};c.FavoritesPlugin.DefaultSelectedAssetTypeForSidebarMap={["gif"]:b.FavoritesObjectKind.gif,["sticker"]:b.FavoritesObjectKind.gif,["image"]:b.FavoritesObjectKind.image,["icon"]:b.FavoritesObjectKind.pdf,["storyblocks"]:v.isActive("js-no-topic-storyblocks")?m.AllAssetTypesConst:b.FavoritesObjectKind.topic,["video"]:b.FavoritesObjectKind.video,["charts"]:b.FavoritesObjectKind.chart,["arcs"]:b.FavoritesObjectKind.shape,
["shapes"]:b.FavoritesObjectKind.shape,["slide"]:b.FavoritesObjectKind.slide};q={};Object.defineProperty(q,"__esModule",{value:!0});q.lazyModule={createPlugin(){return new c.FavoritesPlugin}};return q});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_favorites",["require","prezi_cet_model_editor","prezi_featureswitcher","prezi_i18n","prezi_libraryprovider","prezi_logger","prezi_plugin_api","prezi_plugin_meta","prezi_replacer","prezi_service_data","prezi_utils","prezi_widgets"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_favorites.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi_cet_model_editor"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_libraryprovider"),require("prezi_logger"),require("prezi_plugin_api"),require("prezi_plugin_meta"),require("prezi_replacer"),require("prezi_service_data"),require("prezi_utils"),require("prezi_widgets"));}else{this["prezi_favorites"]=__factory(this["prezi_cet_model_editor"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_libraryprovider"],this["prezi_logger"],this["prezi_plugin_api"],this["prezi_plugin_meta"],this["prezi_replacer"],this["prezi_service_data"],this["prezi_utils"],this["prezi_widgets"]);}}).call(this);